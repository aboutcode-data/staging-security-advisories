advisory_id: CVE-2024-27983
datasource_id: collect_node_js_fix_commits/CVE-2024-27983
datasource_url: https://github.com/nodejs/node
aliases: []
summary: |
  b25b5aca96bfd92dd497aae96af22c6ec1afbd2e:src: ensure to close stream when destroying session

  Co-Authored-By: Anna Henningsen <anna@addaleax.net>
  PR-URL: https://github.com/nodejs-private/node-private/pull/561
  Fixes: https://hackerone.com/reports/2319584
  Reviewed-By: Michael Dawson <midawson@redhat.com>
  Reviewed-By: Marco Ippolito <marcoippolito54@gmail.com>
  Reviewed-By: Matteo Collina <matteo.collina@gmail.com>
  Reviewed-By: Benjamin Gruenbaum <benjamingr@gmail.com>
  CVE-ID: CVE-2024-27983
  6590a8c4e44923d6fbf6548db37e93f5049f73db:2024-04-03, Version 18.20.1 'Hydrogen' (LTS)

  This is a security release.

  Notable changes:

  * CVE-2024-27983 - Assertion failed in node::http2::Http2Session::\~Http2Session() leads to HTTP/2 server crash- (High)
  * CVE-2024-27982 - HTTP Request Smuggling via Content Length Obfuscation - (Medium)
  * llhttp version 9.2.1
  * undici version 5.28.4

  PR-URL: https://github.com/nodejs-private/node-private/pull/573
  24d036ba4564dbb54da4b1714da806bdba5ee688:2024-04-03, Version 20.12.1 'Iron' (LTS)

  This is a security release.

  Notable changes:

  * CVE-2024-27983 - Assertion failed in node::http2::Http2Session::\~Http2Session() leads to HTTP/2 server crash- (High)
  * CVE-2024-27982 - HTTP Request Smuggling via Content Length Obfuscation - (Medium)
  * llhttp version 9.2.1
  * undici version 5.28.4

  PR-URL: https://github.com/nodejs-private/node-private/pull/575/
  957a99c82b82c865c8f74091c29f49c3c217b1fd:2024-04-03, Version 20.12.1 'Iron' (LTS)

  This is a security release.

  Notable changes:

  * CVE-2024-27983 - Assertion failed in node::http2::Http2Session::\~Http2Session() leads to HTTP/2 server crash- (High)
  * CVE-2024-27982 - HTTP Request Smuggling via Content Length Obfuscation - (Medium)
  * llhttp version 9.2.1
  * undici version 5.28.4

  PR-URL: https://github.com/nodejs-private/node-private/pull/575/
  1d526a47af29d59ad196c4e05606b0ec6f8090d9:2024-04-03, Version 18.20.1 'Hydrogen' (LTS)

  This is a security release.

  Notable changes:

  * CVE-2024-27983 - Assertion failed in node::http2::Http2Session::\~Http2Session() leads to HTTP/2 server crash- (High)
  * CVE-2024-27982 - HTTP Request Smuggling via Content Length Obfuscation - (Medium)
  * llhttp version 9.2.1
  * undici version 5.28.4

  PR-URL: https://github.com/nodejs-private/node-private/pull/573
  0fb816dbccde955cd24acc1b16497a91fab507c8:src: ensure to close stream when destroying session

  Co-Authored-By: Anna Henningsen <anna@addaleax.net>
  PR-URL: https://github.com/nodejs-private/node-private/pull/561
  Fixes: https://hackerone.com/reports/2319584
  Reviewed-By: Michael Dawson <midawson@redhat.com>
  Reviewed-By: Marco Ippolito <marcoippolito54@gmail.com>
  Reviewed-By: Matteo Collina <matteo.collina@gmail.com>
  Reviewed-By: Benjamin Gruenbaum <benjamingr@gmail.com>
  CVE-ID: CVE-2024-27983
  3bd39fb474d1252ad52ad3ca3942f38349e15b1e:src: ensure to close stream when destroying session

  Co-Authored-By: Anna Henningsen <anna@addaleax.net>
  Reviewed-By: Michael Dawson <midawson@redhat.com>
  Reviewed-By: Marco Ippolito <marcoippolito54@gmail.com>
  Reviewed-By: Matteo Collina <matteo.collina@gmail.com>
  Reviewed-By: Benjamin Gruenbaum <benjamingr@gmail.com>
  PR-URL: https://github.com/nodejs-private/node-private/pull/561
  Fixes: https://hackerone.com/reports/2319584
  CVE-ID: CVE-2024-27983
  ba1ae6d188df52b25251ccd805d9ad3bc918c327:src: ensure to close stream when destroying session

  Co-Authored-By: Anna Henningsen <anna@addaleax.net>
  PR-URL: https://github.com/nodejs-private/node-private/pull/561
  Fixes: https://hackerone.com/reports/2319584
  Reviewed-By: Michael Dawson <midawson@redhat.com>
  Reviewed-By: Marco Ippolito <marcoippolito54@gmail.com>
  Reviewed-By: Matteo Collina <matteo.collina@gmail.com>
  Reviewed-By: Benjamin Gruenbaum <benjamingr@gmail.com>
  CVE-ID: CVE-2024-27983
impacted_packages:
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: ba1ae6d188df52b25251ccd805d9ad3bc918c327
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 0fb816dbccde955cd24acc1b16497a91fab507c8
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: b25b5aca96bfd92dd497aae96af22c6ec1afbd2e
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 3bd39fb474d1252ad52ad3ca3942f38349e15b1e
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 6590a8c4e44923d6fbf6548db37e93f5049f73db
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 957a99c82b82c865c8f74091c29f49c3c217b1fd
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 24d036ba4564dbb54da4b1714da806bdba5ee688
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 1d526a47af29d59ad196c4e05606b0ec6f8090d9
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/nodejs/node/tree/0fb816dbccde955cd24acc1b16497a91fab507c8
    reference_type: commit
    reference_id: 0fb816dbccde955cd24acc1b16497a91fab507c8
  - url: https://github.com/nodejs/node/tree/1d526a47af29d59ad196c4e05606b0ec6f8090d9
    reference_type: commit
    reference_id: 1d526a47af29d59ad196c4e05606b0ec6f8090d9
  - url: https://github.com/nodejs/node/tree/24d036ba4564dbb54da4b1714da806bdba5ee688
    reference_type: commit
    reference_id: 24d036ba4564dbb54da4b1714da806bdba5ee688
  - url: https://github.com/nodejs/node/tree/3bd39fb474d1252ad52ad3ca3942f38349e15b1e
    reference_type: commit
    reference_id: 3bd39fb474d1252ad52ad3ca3942f38349e15b1e
  - url: https://github.com/nodejs/node/tree/6590a8c4e44923d6fbf6548db37e93f5049f73db
    reference_type: commit
    reference_id: 6590a8c4e44923d6fbf6548db37e93f5049f73db
  - url: https://github.com/nodejs/node/tree/957a99c82b82c865c8f74091c29f49c3c217b1fd
    reference_type: commit
    reference_id: 957a99c82b82c865c8f74091c29f49c3c217b1fd
  - url: https://github.com/nodejs/node/tree/b25b5aca96bfd92dd497aae96af22c6ec1afbd2e
    reference_type: commit
    reference_id: b25b5aca96bfd92dd497aae96af22c6ec1afbd2e
  - url: https://github.com/nodejs/node/tree/ba1ae6d188df52b25251ccd805d9ad3bc918c327
    reference_type: commit
    reference_id: ba1ae6d188df52b25251ccd805d9ad3bc918c327
