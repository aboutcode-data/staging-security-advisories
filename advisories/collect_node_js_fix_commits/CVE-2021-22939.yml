advisory_id: CVE-2021-22939
datasource_id: collect_node_js_fix_commits/CVE-2021-22939
datasource_url: https://github.com/nodejs/node
aliases: []
summary: |
  ea47d836403fa055861b01ea791f9b2da7ee7e7e:2021-08-11, Version 16.6.2 (Current)

  This is a security release.

  Notable Changes:

  - CVE-2021-3672/CVE-2021-22931:
      Improper handling of untypical characters in domain names (High)
  - CVE-2021-22930:
      Use after free on close http2 on stream canceling (High)
  - CVE-2021-22939:
      Incomplete validation of rejectUnauthorized parameter (Low)

  PR-URL: https://github.com/nodejs-private/node-private/pull/280
  02b145083e4aa442c7c171904a68ea7e268b7af0:2021-08-11, Version 14.17.5 'Fermium' (LTS)

  This is a security release.

  Notable Changes:

  - CVE-2021-3672/CVE-2021-22931:
      Improper handling of untypical characters in domain names (High)
  - CVE-2021-22930:
      Use after free on close http2 on stream canceling (High)
  - CVE-2021-22939:
      Incomplete validation of rejectUnauthorized parameter (Low)

  PR-URL: https://github.com/nodejs-private/node-private/pull/279
  e973b55c86886961a913e1138b72fafb875c214a:2021-08-11, Version 12.22.5 'Erbium' (LTS)

  This is a security release.

  Notable Changes:

  - CVE-2021-3672/CVE-2021-22931:
      Improper handling of untypical characters in domain names (High)
  - CVE-2021-22930:
      Use after free on close http2 on stream canceling (High)
  - CVE-2021-22939:
      Incomplete validation of rejectUnauthorized parameter (Low)

  PR-URL: https://github.com/nodejs-private/node-private/pull/278
  635463cb92a4621d246eb338404522e1d65c41f6:tls: validate "rejectUnauthorized: undefined"

  Incomplete validation of rejectUnauthorized parameter (Low)

  If the Node.js https API was used incorrectly and "undefined" was passed
  in for the "rejectUnauthorized" parameter, no error was returned and
  connections to servers with an expired certificate would have been
  accepted.

  CVE-ID: CVE-2021-22939
  Refs: https://nvd.nist.gov/vuln/detail/CVE-2021-22939
  Refs: https://hackerone.com/reports/1278254
  PR-URL: https://github.com/nodejs-private/node-private/pull/276
  Reviewed-By: Rich Trott <rtrott@gmail.com>
  Reviewed-By: Akshay K <iit.akshay@gmail.com>
  Reviewed-By: Robert Nagy <ronagy@icloud.com>
  Reviewed-By: Richard Lau <rlau@redhat.com>
  635463cb92a4621d246eb338404522e1d65c41f6:tls: validate "rejectUnauthorized: undefined"

  Incomplete validation of rejectUnauthorized parameter (Low)

  If the Node.js https API was used incorrectly and "undefined" was passed
  in for the "rejectUnauthorized" parameter, no error was returned and
  connections to servers with an expired certificate would have been
  accepted.

  CVE-ID: CVE-2021-22939
  Refs: https://nvd.nist.gov/vuln/detail/CVE-2021-22939
  Refs: https://hackerone.com/reports/1278254
  PR-URL: https://github.com/nodejs-private/node-private/pull/276
  Reviewed-By: Rich Trott <rtrott@gmail.com>
  Reviewed-By: Akshay K <iit.akshay@gmail.com>
  Reviewed-By: Robert Nagy <ronagy@icloud.com>
  Reviewed-By: Richard Lau <rlau@redhat.com>
  bfe80913e88139da1aa283475cdbc060ea98ae6f:2021-08-11, Version 16.6.2 (Current)

  This is a security release.

  Notable Changes:

  - CVE-2021-3672/CVE-2021-22931:
      Improper handling of untypical characters in domain names (High)
  - CVE-2021-22930:
      Use after free on close http2 on stream canceling (High)
  - CVE-2021-22939:
      Incomplete validation of rejectUnauthorized parameter (Low)

  PR-URL: https://github.com/nodejs-private/node-private/pull/280
  db159ab870b1aa7f55e4e450c81764f22bf0ef80:2021-08-11, Version 14.17.5 'Fermium' (LTS)

  This is a security release.

  Notable Changes:

  - CVE-2021-3672/CVE-2021-22931:
      Improper handling of untypical characters in domain names (High)
  - CVE-2021-22930:
      Use after free on close http2 on stream canceling (High)
  - CVE-2021-22939:
      Incomplete validation of rejectUnauthorized parameter (Low)

  PR-URL: https://github.com/nodejs-private/node-private/pull/279
  151261efb8b85696620f80ecc1f50d9c1f886a1b:2021-08-11, Version 12.22.5 'Erbium' (LTS)

  This is a security release.

  Notable Changes:

  - CVE-2021-3672/CVE-2021-22931:
      Improper handling of untypical characters in domain names (High)
  - CVE-2021-22930:
      Use after free on close http2 on stream canceling (High)
  - CVE-2021-22939:
      Incomplete validation of rejectUnauthorized parameter (Low)

  PR-URL: https://github.com/nodejs-private/node-private/pull/278
  1780bbc3291357f7c3370892eb311fc7a62afe8d:tls: validate "rejectUnauthorized: undefined"

  Incomplete validation of rejectUnauthorized parameter (Low)

  If the Node.js https API was used incorrectly and "undefined" was passed
  in for the "rejectUnauthorized" parameter, no error was returned and
  connections to servers with an expired certificate would have been
  accepted.

  CVE-ID: CVE-2021-22939
  Refs: https://nvd.nist.gov/vuln/detail/CVE-2021-22939
  Refs: https://hackerone.com/reports/1278254
  PR-URL: https://github.com/nodejs-private/node-private/pull/276
  Reviewed-By: Rich Trott <rtrott@gmail.com>
  Reviewed-By: Akshay K <iit.akshay@gmail.com>
  Reviewed-By: Robert Nagy <ronagy@icloud.com>
  Reviewed-By: Richard Lau <rlau@redhat.com>
  1780bbc3291357f7c3370892eb311fc7a62afe8d:tls: validate "rejectUnauthorized: undefined"

  Incomplete validation of rejectUnauthorized parameter (Low)

  If the Node.js https API was used incorrectly and "undefined" was passed
  in for the "rejectUnauthorized" parameter, no error was returned and
  connections to servers with an expired certificate would have been
  accepted.

  CVE-ID: CVE-2021-22939
  Refs: https://nvd.nist.gov/vuln/detail/CVE-2021-22939
  Refs: https://hackerone.com/reports/1278254
  PR-URL: https://github.com/nodejs-private/node-private/pull/276
  Reviewed-By: Rich Trott <rtrott@gmail.com>
  Reviewed-By: Akshay K <iit.akshay@gmail.com>
  Reviewed-By: Robert Nagy <ronagy@icloud.com>
  Reviewed-By: Richard Lau <rlau@redhat.com>
  35b86110e45083a75d7dc8e6be5a930b262494f6:tls: validate "rejectUnauthorized: undefined"

  Incomplete validation of rejectUnauthorized parameter (Low)

  If the Node.js https API was used incorrectly and "undefined" was passed
  in for the "rejectUnauthorized" parameter, no error was returned and
  connections to servers with an expired certificate would have been
  accepted.

  CVE-ID: CVE-2021-22939
  Refs: https://nvd.nist.gov/vuln/detail/CVE-2021-22939
  Refs: https://hackerone.com/reports/1278254
  PR-URL: https://github.com/nodejs-private/node-private/pull/276
  Reviewed-By: Rich Trott <rtrott@gmail.com>
  Reviewed-By: Akshay K <iit.akshay@gmail.com>
  Reviewed-By: Robert Nagy <ronagy@icloud.com>
  Reviewed-By: Richard Lau <rlau@redhat.com>
  35b86110e45083a75d7dc8e6be5a930b262494f6:tls: validate "rejectUnauthorized: undefined"

  Incomplete validation of rejectUnauthorized parameter (Low)

  If the Node.js https API was used incorrectly and "undefined" was passed
  in for the "rejectUnauthorized" parameter, no error was returned and
  connections to servers with an expired certificate would have been
  accepted.

  CVE-ID: CVE-2021-22939
  Refs: https://nvd.nist.gov/vuln/detail/CVE-2021-22939
  Refs: https://hackerone.com/reports/1278254
  PR-URL: https://github.com/nodejs-private/node-private/pull/276
  Reviewed-By: Rich Trott <rtrott@gmail.com>
  Reviewed-By: Akshay K <iit.akshay@gmail.com>
  Reviewed-By: Robert Nagy <ronagy@icloud.com>
  Reviewed-By: Richard Lau <rlau@redhat.com>
  6c7fff6f1d53dfb6c2b184ee41809b8d7614cb80:tls: validate "rejectUnauthorized: undefined"

  Incomplete validation of rejectUnauthorized parameter (Low)

  If the Node.js https API was used incorrectly and "undefined" was passed
  in for the "rejectUnauthorized" parameter, no error was returned and
  connections to servers with an expired certificate would have been
  accepted.

  CVE-ID: CVE-2021-22939
  Refs: https://nvd.nist.gov/vuln/detail/CVE-2021-22939
  Refs: https://hackerone.com/reports/1278254
  PR-URL: https://github.com/nodejs-private/node-private/pull/276
  Reviewed-By: Rich Trott <rtrott@gmail.com>
  Reviewed-By: Akshay K <iit.akshay@gmail.com>
  Reviewed-By: Robert Nagy <ronagy@icloud.com>
  Reviewed-By: Richard Lau <rlau@redhat.com>
  6c7fff6f1d53dfb6c2b184ee41809b8d7614cb80:tls: validate "rejectUnauthorized: undefined"

  Incomplete validation of rejectUnauthorized parameter (Low)

  If the Node.js https API was used incorrectly and "undefined" was passed
  in for the "rejectUnauthorized" parameter, no error was returned and
  connections to servers with an expired certificate would have been
  accepted.

  CVE-ID: CVE-2021-22939
  Refs: https://nvd.nist.gov/vuln/detail/CVE-2021-22939
  Refs: https://hackerone.com/reports/1278254
  PR-URL: https://github.com/nodejs-private/node-private/pull/276
  Reviewed-By: Rich Trott <rtrott@gmail.com>
  Reviewed-By: Akshay K <iit.akshay@gmail.com>
  Reviewed-By: Robert Nagy <ronagy@icloud.com>
  Reviewed-By: Richard Lau <rlau@redhat.com>
impacted_packages:
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 35b86110e45083a75d7dc8e6be5a930b262494f6
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: bfe80913e88139da1aa283475cdbc060ea98ae6f
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 02b145083e4aa442c7c171904a68ea7e268b7af0
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 635463cb92a4621d246eb338404522e1d65c41f6
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: db159ab870b1aa7f55e4e450c81764f22bf0ef80
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 6c7fff6f1d53dfb6c2b184ee41809b8d7614cb80
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: e973b55c86886961a913e1138b72fafb875c214a
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 151261efb8b85696620f80ecc1f50d9c1f886a1b
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 1780bbc3291357f7c3370892eb311fc7a62afe8d
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: ea47d836403fa055861b01ea791f9b2da7ee7e7e
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/nodejs/node/tree/02b145083e4aa442c7c171904a68ea7e268b7af0
    reference_type: commit
    reference_id: 02b145083e4aa442c7c171904a68ea7e268b7af0
  - url: https://github.com/nodejs/node/tree/151261efb8b85696620f80ecc1f50d9c1f886a1b
    reference_type: commit
    reference_id: 151261efb8b85696620f80ecc1f50d9c1f886a1b
  - url: https://github.com/nodejs/node/tree/1780bbc3291357f7c3370892eb311fc7a62afe8d
    reference_type: commit
    reference_id: 1780bbc3291357f7c3370892eb311fc7a62afe8d
  - url: https://github.com/nodejs/node/tree/35b86110e45083a75d7dc8e6be5a930b262494f6
    reference_type: commit
    reference_id: 35b86110e45083a75d7dc8e6be5a930b262494f6
  - url: https://github.com/nodejs/node/tree/635463cb92a4621d246eb338404522e1d65c41f6
    reference_type: commit
    reference_id: 635463cb92a4621d246eb338404522e1d65c41f6
  - url: https://github.com/nodejs/node/tree/6c7fff6f1d53dfb6c2b184ee41809b8d7614cb80
    reference_type: commit
    reference_id: 6c7fff6f1d53dfb6c2b184ee41809b8d7614cb80
  - url: https://github.com/nodejs/node/tree/bfe80913e88139da1aa283475cdbc060ea98ae6f
    reference_type: commit
    reference_id: bfe80913e88139da1aa283475cdbc060ea98ae6f
  - url: https://github.com/nodejs/node/tree/db159ab870b1aa7f55e4e450c81764f22bf0ef80
    reference_type: commit
    reference_id: db159ab870b1aa7f55e4e450c81764f22bf0ef80
  - url: https://github.com/nodejs/node/tree/e973b55c86886961a913e1138b72fafb875c214a
    reference_type: commit
    reference_id: e973b55c86886961a913e1138b72fafb875c214a
  - url: https://github.com/nodejs/node/tree/ea47d836403fa055861b01ea791f9b2da7ee7e7e
    reference_type: commit
    reference_id: ea47d836403fa055861b01ea791f9b2da7ee7e7e
