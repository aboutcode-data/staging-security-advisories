advisory_id: CVE-2023-30589
datasource_id: collect_node_js_fix_commits/CVE-2023-30589
datasource_url: https://github.com/nodejs/node
aliases: []
summary: |
  2e6de554f6b2f7969f6c51bef784ddb74c00a0ab:http: disable request smuggling via empty headers

  PR-URL: https://github.com/nodejs-private/node-private/pull/427
  Fixes: https://hackerone.com/reports/2001873
  Refs: https://github.com/nodejs-private/llhttp-private/pull/13
  Reviewed-By: Matteo Collina <matteo.collina@gmail.com>
  CVE-ID: CVE-2023-30589
  b607b74a4fb3640fc958cff1ff81ca7558134e9d:2023-06-20, Version 18.16.1 'Hydrogen' (LTS)

  This is a security release.

  Notable changes:

  Following CVEs are fixed in this release:

  * CVE-2023-30581: `mainModule.__proto__` Bypass Experimental Policy Mechanism (High)
  * CVE-2023-30585: Privilege escalation via Malicious Registry Key manipulation during Node.js installer repair process (Medium)
  * CVE-2023-30588: Process interuption due to invalid Public Key information in x509 certificates (Medium)
  * CVE-2023-30589: HTTP Request Smuggling via Empty headers separated by CR (Medium)
  * CVE-2023-30590: DiffieHellman does not generate keys after setting a private key (Medium)
  * OpenSSL Security Releases
    * https://www.openssl.org/news/secadv/20230328.txt
    * https://www.openssl.org/news/secadv/20230420.txt
    * https://www.openssl.org/news/secadv/20230530.txt
  * c-ares vulnerabilities:
    * GHSA-9g78-jv2r-p7vc
    * GHSA-8r8p-23f3-64c2
    * GHSA-54xr-f67r-4pc4
    * GHSA-x6mf-cxr9-8q6v

  PR-URL: https://github.com/nodejs-private/node-private/pull/434
  167dc77d85e97db5f8dcbcf110ade634944e02f9:2023-06-20, Version 20.3.1 (Current)

  This is a security release.

  Notable Changes

  The following CVEs are fixed in this release:
  * CVE-2023-30581: `mainModule.__proto__` Bypass Experimental Policy Mechanism (High)
  * CVE-2023-30584: Path Traversal Bypass in Experimental Permission Model (High)
  * CVE-2023-30587: Bypass of Experimental Permission Model via Node.js Inspector (High)
  * CVE-2023-30582: Inadequate Permission Model Allows Unauthorized File Watching (Medium)
  * CVE-2023-30583: Bypass of Experimental Permission Model via fs.openAsBlob() (Medium)
  * CVE-2023-30585: Privilege escalation via Malicious Registry Key manipulation during Node.js installer repair process (Medium)
  * CVE-2023-30586: Bypass of Experimental Permission Model via Arbitrary OpenSSL Engines (Medium)
  * CVE-2023-30588: Process interuption due to invalid Public Key information in x509 certificates (Medium)
  * CVE-2023-30589: HTTP Request Smuggling via Empty headers separated by CR (Medium)
  * CVE-2023-30590: DiffieHellman does not generate keys after setting a private key (Medium)

  * OpenSSL Security Releases
    * [OpenSSL security advisory 28th March](https://www.openssl.org/news/secadv/20230328.txt).
    * [OpenSSL security advisory 20th April](https://www.openssl.org/news/secadv/20230420.txt).
    * [OpenSSL security advisory 30th May](https://www.openssl.org/news/secadv/20230530.txt)

  PR-URL: https://github.com/nodejs-private/node-private/pull/435
  c09acb3ea82fab3553e40b68f923a9b9f00c8eba:2023-06-20, Version 16.20.1 'Gallium' (LTS)

  This is a security release.

  Notable changes:

  Following CVEs are fixed in this release:

  * CVE-2023-30581: `mainModule.__proto__` Bypass Experimental Policy Mechanism (High)
  * CVE-2023-30585: Privilege escalation via Malicious Registry Key manipulation during Node.js installer repair process (Medium)
  * CVE-2023-30588: Process interuption due to invalid Public Key information in x509 certificates (Medium)
  * CVE-2023-30589: HTTP Request Smuggling via Empty headers separated by CR (Medium)
  * CVE-2023-30590: DiffieHellman does not generate keys after setting a private key (Medium)
  * OpenSSL Security Releases
    * https://www.openssl.org/news/secadv/20230328.txt
    * https://www.openssl.org/news/secadv/20230420.txt
    * https://www.openssl.org/news/secadv/20230530.txt
  * c-ares vulnerabilities:
    * GHSA-9g78-jv2r-p7vc
    * GHSA-8r8p-23f3-64c2
    * GHSA-54xr-f67r-4pc4
    * GHSA-x6mf-cxr9-8q6v

  PR-URL: https://github.com/nodejs-private/node-private/pull/432
  9869bdc93d7bd8b439c4a2598607ee779483ee53:2023-06-20, Version 20.3.1 (Current)

  This is a security release.

  Notable Changes

  The following CVEs are fixed in this release:
  * CVE-2023-30581: `mainModule.__proto__` Bypass Experimental Policy Mechanism (High)
  * CVE-2023-30584: Path Traversal Bypass in Experimental Permission Model (High)
  * CVE-2023-30587: Bypass of Experimental Permission Model via Node.js Inspector (High)
  * CVE-2023-30582: Inadequate Permission Model Allows Unauthorized File Watching (Medium)
  * CVE-2023-30583: Bypass of Experimental Permission Model via fs.openAsBlob() (Medium)
  * CVE-2023-30585: Privilege escalation via Malicious Registry Key manipulation during Node.js installer repair process (Medium)
  * CVE-2023-30586: Bypass of Experimental Permission Model via Arbitrary OpenSSL Engines (Medium)
  * CVE-2023-30588: Process interuption due to invalid Public Key information in x509 certificates (Medium)
  * CVE-2023-30589: HTTP Request Smuggling via Empty headers separated by CR (Medium)
  * CVE-2023-30590: DiffieHellman does not generate keys after setting a private key (Medium)

  * OpenSSL Security Releases
    * [OpenSSL security advisory 28th March](https://www.openssl.org/news/secadv/20230328.txt).
    * [OpenSSL security advisory 20th April](https://www.openssl.org/news/secadv/20230420.txt).
    * [OpenSSL security advisory 30th May](https://www.openssl.org/news/secadv/20230530.txt)

  PR-URL: https://github.com/nodejs-private/node-private/pull/435
  8658efe376838821be7f9b4ff25c8bc2e229bb92:2023-06-20, Version 18.16.1 'Hydrogen' (LTS)

  This is a security release.

  Notable changes:

  Following CVEs are fixed in this release:

  * CVE-2023-30581: `mainModule.__proto__` Bypass Experimental Policy Mechanism (High)
  * CVE-2023-30585: Privilege escalation via Malicious Registry Key manipulation during Node.js installer repair process (Medium)
  * CVE-2023-30588: Process interuption due to invalid Public Key information in x509 certificates (Medium)
  * CVE-2023-30589: HTTP Request Smuggling via Empty headers separated by CR (Medium)
  * CVE-2023-30590: DiffieHellman does not generate keys after setting a private key (Medium)
  * OpenSSL Security Releases
    * https://www.openssl.org/news/secadv/20230328.txt
    * https://www.openssl.org/news/secadv/20230420.txt
    * https://www.openssl.org/news/secadv/20230530.txt
  * c-ares vulnerabilities:
    * GHSA-9g78-jv2r-p7vc
    * GHSA-8r8p-23f3-64c2
    * GHSA-54xr-f67r-4pc4
    * GHSA-x6mf-cxr9-8q6v

  PR-URL: https://github.com/nodejs-private/node-private/pull/434
  b53c51995380b1f8d642297d848cab6010d2909c:2023-06-20, Version 16.20.1 'Gallium' (LTS)

  This is a security release.

  Notable changes:

  Following CVEs are fixed in this release:

  * CVE-2023-30581: `mainModule.__proto__` Bypass Experimental Policy Mechanism (High)
  * CVE-2023-30585: Privilege escalation via Malicious Registry Key manipulation during Node.js installer repair process (Medium)
  * CVE-2023-30588: Process interuption due to invalid Public Key information in x509 certificates (Medium)
  * CVE-2023-30589: HTTP Request Smuggling via Empty headers separated by CR (Medium)
  * CVE-2023-30590: DiffieHellman does not generate keys after setting a private key (Medium)
  * OpenSSL Security Releases
    * https://www.openssl.org/news/secadv/20230328.txt
    * https://www.openssl.org/news/secadv/20230420.txt
    * https://www.openssl.org/news/secadv/20230530.txt
  * c-ares vulnerabilities:
    * GHSA-9g78-jv2r-p7vc
    * GHSA-8r8p-23f3-64c2
    * GHSA-54xr-f67r-4pc4
    * GHSA-x6mf-cxr9-8q6v

  PR-URL: https://github.com/nodejs-private/node-private/pull/432
  27e20501aaa251328497a488607564d77ec74724:http: disable request smuggling via empty headers

  PR-URL: https://github.com/nodejs-private/node-private/pull/427
  Fixes: https://hackerone.com/reports/2001873
  Refs: https://github.com/nodejs-private/llhttp-private/pull/13
  Reviewed-By: Matteo Collina <matteo.collina@gmail.com>
  CVE-ID: CVE-2023-30589
  e42ff4b0180f4e0f5712364dd6ea015559640152:http: disable request smuggling via empty headers

  PR-URL: https://github.com/nodejs-private/node-private/pull/429
  Refs: https://github.com/nodejs-private/node-private/pull/427
  Reviewed-By: Rafael Gonzaga <rafael.nunu@hotmail.com>
  Reviewed-By: Matteo Collina <matteo.collina@gmail.com>
  CVE-ID: CVE-2023-30589
  4ff6ba050a07544d1939ac5d2fb5499191a1b9cb:http: disable request smuggling via rempty headers

  PR-URL: https://github.com/nodejs-private/node-private/pull/428
  Refs: https://github.com/nodejs-private/node-private/pull/427
  Reviewed-By: Matteo Collina <matteo.collina@gmail.com>
  Reviewed-By: Rafael Gonzaga <rafael.nunu@hotmail.com>
  CVE-ID: CVE-2023-30589
impacted_packages:
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 27e20501aaa251328497a488607564d77ec74724
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 167dc77d85e97db5f8dcbcf110ade634944e02f9
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 9869bdc93d7bd8b439c4a2598607ee779483ee53
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: b607b74a4fb3640fc958cff1ff81ca7558134e9d
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: c09acb3ea82fab3553e40b68f923a9b9f00c8eba
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 8658efe376838821be7f9b4ff25c8bc2e229bb92
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 4ff6ba050a07544d1939ac5d2fb5499191a1b9cb
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: e42ff4b0180f4e0f5712364dd6ea015559640152
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: b53c51995380b1f8d642297d848cab6010d2909c
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 2e6de554f6b2f7969f6c51bef784ddb74c00a0ab
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/nodejs/node/tree/167dc77d85e97db5f8dcbcf110ade634944e02f9
    reference_type: commit
    reference_id: 167dc77d85e97db5f8dcbcf110ade634944e02f9
  - url: https://github.com/nodejs/node/tree/27e20501aaa251328497a488607564d77ec74724
    reference_type: commit
    reference_id: 27e20501aaa251328497a488607564d77ec74724
  - url: https://github.com/nodejs/node/tree/2e6de554f6b2f7969f6c51bef784ddb74c00a0ab
    reference_type: commit
    reference_id: 2e6de554f6b2f7969f6c51bef784ddb74c00a0ab
  - url: https://github.com/nodejs/node/tree/4ff6ba050a07544d1939ac5d2fb5499191a1b9cb
    reference_type: commit
    reference_id: 4ff6ba050a07544d1939ac5d2fb5499191a1b9cb
  - url: https://github.com/nodejs/node/tree/8658efe376838821be7f9b4ff25c8bc2e229bb92
    reference_type: commit
    reference_id: 8658efe376838821be7f9b4ff25c8bc2e229bb92
  - url: https://github.com/nodejs/node/tree/9869bdc93d7bd8b439c4a2598607ee779483ee53
    reference_type: commit
    reference_id: 9869bdc93d7bd8b439c4a2598607ee779483ee53
  - url: https://github.com/nodejs/node/tree/b53c51995380b1f8d642297d848cab6010d2909c
    reference_type: commit
    reference_id: b53c51995380b1f8d642297d848cab6010d2909c
  - url: https://github.com/nodejs/node/tree/b607b74a4fb3640fc958cff1ff81ca7558134e9d
    reference_type: commit
    reference_id: b607b74a4fb3640fc958cff1ff81ca7558134e9d
  - url: https://github.com/nodejs/node/tree/c09acb3ea82fab3553e40b68f923a9b9f00c8eba
    reference_type: commit
    reference_id: c09acb3ea82fab3553e40b68f923a9b9f00c8eba
  - url: https://github.com/nodejs/node/tree/e42ff4b0180f4e0f5712364dd6ea015559640152
    reference_type: commit
    reference_id: e42ff4b0180f4e0f5712364dd6ea015559640152
