advisory_id: CVE-2024-21892
datasource_id: collect_node_js_fix_commits/CVE-2024-21892
datasource_url: https://github.com/nodejs/node
aliases: []
summary: |
  10ecf400679e04eddab940721cad3f6c1d603b61:src: fix HasOnly(capability) in node::credentials

  SYS_capget with _LINUX_CAPABILITY_VERSION_3 returns the process's
  permitted capabilities as two 32-bit values. To determine if the only
  permitted capability is indeed CAP_NET_BIND_SERVICE, it is necessary to
  check both of those values.

  Not doing so creates a vulnerability that potentially allows
  unprivileged users to inject code into a privileged Node.js process
  through environment variables such as NODE_OPTIONS.

  PR-URL: https://github.com/nodejs-private/node-private/pull/505
  Reviewed-By: Rafael Gonzaga <rafael.nunu@hotmail.com>
  CVE-ID: CVE-2024-21892
  40ff37dfcc29c5b7d312b1bd2697c36ec6b6b609:src: fix HasOnly(capability) in node::credentials

  SYS_capget with _LINUX_CAPABILITY_VERSION_3 returns the process's
  permitted capabilities as two 32-bit values. To determine if the only
  permitted capability is indeed CAP_NET_BIND_SERVICE, it is necessary to
  check both of those values.

  Not doing so creates a vulnerability that potentially allows
  unprivileged users to inject code into a privileged Node.js process
  through environment variables such as NODE_OPTIONS.

  PR-URL: https://github.com/nodejs-private/node-private/pull/505
  Reviewed-By: Rafael Gonzaga <rafael.nunu@hotmail.com>
  CVE-ID: CVE-2024-21892
  e6b4c105e0795fba8afb3f8e910c56ba9e60f4b5:src: fix HasOnly(capability) in node::credentials

  SYS_capget with _LINUX_CAPABILITY_VERSION_3 returns the process's
  permitted capabilities as two 32-bit values. To determine if the only
  permitted capability is indeed CAP_NET_BIND_SERVICE, it is necessary to
  check both of those values.

  Not doing so creates a vulnerability that potentially allows
  unprivileged users to inject code into a privileged Node.js process
  through environment variables such as NODE_OPTIONS.

  PR-URL: https://github.com/nodejs-private/node-private/pull/505
  Reviewed-By: Rafael Gonzaga <rafael.nunu@hotmail.com>
  CVE-ID: CVE-2024-21892
  208b3940c7ca837d8387923185d75e63b1b06c55:src: fix HasOnly(capability) in node::credentials

  SYS_capget with _LINUX_CAPABILITY_VERSION_3 returns the process's
  permitted capabilities as two 32-bit values. To determine if the only
  permitted capability is indeed CAP_NET_BIND_SERVICE, it is necessary to
  check both of those values.

  Not doing so creates a vulnerability that potentially allows
  unprivileged users to inject code into a privileged Node.js process
  through environment variables such as NODE_OPTIONS.

  PR-URL: https://github.com/nodejs-private/node-private/pull/505
  Reviewed-By: Rafael Gonzaga <rafael.nunu@hotmail.com>
  CVE-ID: CVE-2024-21892
impacted_packages:
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 208b3940c7ca837d8387923185d75e63b1b06c55
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 40ff37dfcc29c5b7d312b1bd2697c36ec6b6b609
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: e6b4c105e0795fba8afb3f8e910c56ba9e60f4b5
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 10ecf400679e04eddab940721cad3f6c1d603b61
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/nodejs/node/tree/10ecf400679e04eddab940721cad3f6c1d603b61
    reference_type: commit
    reference_id: 10ecf400679e04eddab940721cad3f6c1d603b61
  - url: https://github.com/nodejs/node/tree/208b3940c7ca837d8387923185d75e63b1b06c55
    reference_type: commit
    reference_id: 208b3940c7ca837d8387923185d75e63b1b06c55
  - url: https://github.com/nodejs/node/tree/40ff37dfcc29c5b7d312b1bd2697c36ec6b6b609
    reference_type: commit
    reference_id: 40ff37dfcc29c5b7d312b1bd2697c36ec6b6b609
  - url: https://github.com/nodejs/node/tree/e6b4c105e0795fba8afb3f8e910c56ba9e60f4b5
    reference_type: commit
    reference_id: e6b4c105e0795fba8afb3f8e910c56ba9e60f4b5
