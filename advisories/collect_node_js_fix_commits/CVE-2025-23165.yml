advisory_id: CVE-2025-23165
datasource_id: collect_node_js_fix_commits/CVE-2025-23165
datasource_url: https://github.com/nodejs/node
aliases: []
summary: |
  b1e9171a44174bf4b2ba6ee045d2af272d07af6d:2025-05-14, Version 22.15.1 'Jod' (LTS)

  This is a security release.

  Notable changes:

  src:
    * (CVE-2025-23166) fix error handling on async crypto operation
  fs:
    * (CVE-2025-23165) add missing call to uv\_fs\_req\_cleanup

  PR-URL: https://github.com/nodejs-private/node-private/pull/712
  1771cdfdcdfa1582a863ae1e11b642153eb34b62:2025-05-14, Version 20.19.2 'Iron' (LTS)

  This is a security release.

  Notable changes:

  src:
    * (CVE-2025-23166) fix error handling on async crypto operation
  deps:
    * (CVE-2025-23167) (SEMVER-MAJOR) update llhttp to 9.2.0
  fs:
    * (CVE-2025-23165) add missing call to uv\_fs\_req\_cleanup

  PR-URL: https://github.com/nodejs-private/node-private/pull/711
  7039b12ae5e0913f7a14da4d9d58ad04d4a4a16e:2025-05-14, Version 22.15.1 'Jod' (LTS)

  This is a security release.

  Notable changes:

  src:
    * (CVE-2025-23166) fix error handling on async crypto operation
  fs:
    * (CVE-2025-23165) add missing call to uv\_fs\_req\_cleanup

  PR-URL: https://github.com/nodejs-private/node-private/pull/712
  10eb2fb02ca31ee6ba14961921aae404ca57a1b5:2025-05-14, Version 20.19.2 'Iron' (LTS)

  This is a security release.

  Notable changes:

  src:
    * (CVE-2025-23166) fix error handling on async crypto operation
  deps:
    * (CVE-2025-23167) (SEMVER-MAJOR) update llhttp to 9.2.0
  fs:
    * (CVE-2025-23165) add missing call to uv\_fs\_req\_cleanup

  PR-URL: https://github.com/nodejs-private/node-private/pull/711
  9e13bf0a81e15c7b3a9f1826dccbcea991d7e63a:fs: add missing call to uv_fs_req_cleanup

  Always call uv_fs_req_cleanup after calling uv_fs_open instead of just
  when uv_fs_open returns a negative result. I referenced ReadFileSync
  from node:js2c when making this change.

  https://github.com/bnoordhuis made the same suggestion based on the
  PR https://github.com/nodejs/node/pull/49691.

  Fixes: https://github.com/nodejs/node/issues/57800
  PR-URL: https://github.com/nodejs/node/pull/57811
  Reviewed-By: Matteo Collina <matteo.collina@gmail.com>
  Reviewed-By: James M Snell <jasnell@gmail.com>
  CVE-ID: CVE-2025-23165
  9f403e98ef45faa25f4e41af7f3a791a70af4a15:fs: add missing call to uv_fs_req_cleanup

  Always call uv_fs_req_cleanup after calling uv_fs_open instead of just
  when uv_fs_open returns a negative result. I referenced ReadFileSync
  from node:js2c when making this change.

  https://github.com/bnoordhuis made the same suggestion based on the
  PR https://github.com/nodejs/node/pull/49691.

  Fixes: https://github.com/nodejs/node/issues/57800
  PR-URL: https://github.com/nodejs/node/pull/57811
  Reviewed-By: Matteo Collina <matteo.collina@gmail.com>
  Reviewed-By: James M Snell <jasnell@gmail.com>
  CVE-ID: CVE-2025-23165
impacted_packages:
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 9f403e98ef45faa25f4e41af7f3a791a70af4a15
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 7039b12ae5e0913f7a14da4d9d58ad04d4a4a16e
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: b1e9171a44174bf4b2ba6ee045d2af272d07af6d
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 1771cdfdcdfa1582a863ae1e11b642153eb34b62
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 10eb2fb02ca31ee6ba14961921aae404ca57a1b5
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 9e13bf0a81e15c7b3a9f1826dccbcea991d7e63a
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/nodejs/node/tree/10eb2fb02ca31ee6ba14961921aae404ca57a1b5
    reference_type: commit
    reference_id: 10eb2fb02ca31ee6ba14961921aae404ca57a1b5
  - url: https://github.com/nodejs/node/tree/1771cdfdcdfa1582a863ae1e11b642153eb34b62
    reference_type: commit
    reference_id: 1771cdfdcdfa1582a863ae1e11b642153eb34b62
  - url: https://github.com/nodejs/node/tree/7039b12ae5e0913f7a14da4d9d58ad04d4a4a16e
    reference_type: commit
    reference_id: 7039b12ae5e0913f7a14da4d9d58ad04d4a4a16e
  - url: https://github.com/nodejs/node/tree/9e13bf0a81e15c7b3a9f1826dccbcea991d7e63a
    reference_type: commit
    reference_id: 9e13bf0a81e15c7b3a9f1826dccbcea991d7e63a
  - url: https://github.com/nodejs/node/tree/9f403e98ef45faa25f4e41af7f3a791a70af4a15
    reference_type: commit
    reference_id: 9f403e98ef45faa25f4e41af7f3a791a70af4a15
  - url: https://github.com/nodejs/node/tree/b1e9171a44174bf4b2ba6ee045d2af272d07af6d
    reference_type: commit
    reference_id: b1e9171a44174bf4b2ba6ee045d2af272d07af6d
