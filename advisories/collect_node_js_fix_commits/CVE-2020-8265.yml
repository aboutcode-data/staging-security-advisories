advisory_id: CVE-2020-8265
datasource_id: collect_node_js_fix_commits/CVE-2020-8265
datasource_url: https://github.com/nodejs/node
aliases: []
summary: |
  ceb0dc907a571edea326d2cd5f846f8d31e95caf:2021-01-04, Version 12.20.1 'Erbium' (LTS)

  Notable changes:

  This is a security release.

  Vulnerabilities fixed:

  - CVE-2020-8265: use-after-free in TLSWrap (High)
  Affected Node.js versions are vulnerable to a use-after-free bug in
  its TLS implementation. When writing to a TLS enabled socket,
  node::StreamBase::Write calls node::TLSWrap::DoWrite with a freshly
  allocated WriteWrap object as first argument. If the DoWrite method
  does not return an error, this object is passed back to the caller
  as part of a StreamWriteResult structure. This may be exploited to
  corrupt memory leading to a Denial of Service or potentially other
  exploits
  - CVE-2020-8287: HTTP Request Smuggling in nodejs
  Affected versions of Node.js allow two copies of a header field in
  a http request. For example, two Transfer-Encoding header fields.
  In this case Node.js identifies the first header field and ignores
  the second. This can lead to HTTP Request Smuggling
  (https://cwe.mitre.org/data/definitions/444.html).
  - CVE-2020-1971: OpenSSL - EDIPARTYNAME NULL pointer de-reference (High)
  This is a vulnerability in OpenSSL which may be exploited through Node.js.
  You can read more about it in
  https://www.openssl.org/news/secadv/20201208.txt

  PR-URL: https://github.com/nodejs-private/node-private/pull/240
  6c80df02d140e2abda48df6fa4db51e71e022224:2021-01-04, Version 10.23.1 'Dubnium' (LTS)

  Notable changes:

  This is a security release.

  Vulnerabilities fixed:

  - CVE-2020-8265: use-after-free in TLSWrap (High)
  Affected Node.js versions are vulnerable to a use-after-free bug in
  its TLS implementation. When writing to a TLS enabled socket,
  node::StreamBase::Write calls node::TLSWrap::DoWrite with a freshly
  allocated WriteWrap object as first argument. If the DoWrite method
  does not return an error, this object is passed back to the caller
  as part of a StreamWriteResult structure. This may be exploited to
  corrupt memory leading to a Denial of Service or potentially other
  exploits
  - CVE-2020-8287: HTTP Request Smuggling in nodejs
  Affected versions of Node.js allow two copies of a header field in
  a http request. For example, two Transfer-Encoding header fields.
  In this case Node.js identifies the first header field and ignores
  the second. This can lead to HTTP Request Smuggling
  (https://cwe.mitre.org/data/definitions/444.html).
  - CVE-2020-1971: OpenSSL - EDIPARTYNAME NULL pointer de-reference (High)
  This is a vulnerability in OpenSSL which may be exploited through Node.js.
  You can read more about it in
  https://www.openssl.org/news/secadv/20201208.txt

  PR-URL: https://github.com/nodejs-private/node-private/pull/239
  a384a0c4c6bee1e7b1ec30417d6f743f59cd3b84:2021-01-04, Version 14.15.4 'Fermium' (LTS)

  This is a security release.

  Notable changes:

  Vulnerabilities fixed:

  - **CVE-2020-1971**: OpenSSL - EDIPARTYNAME NULL pointer de-reference
    (High)
    - This is a vulnerability in OpenSSL which may be exploited through
    Node.js. You can read more about it in
    https://www.openssl.org/news/secadv/20201208.txt

  - **CVE-2020-8265**: use-after-free in TLSWrap (High)
    - Affected Node.js versions are vulnerable to a use-after-free bug in
    its TLS implementation. When writing to a TLS enabled socket,
    node::StreamBase::Write calls node::TLSWrap::DoWrite with a freshly
    allocated WriteWrap object as first argument. If the DoWrite method
    does not return an error, this object is passed back to the caller as
    part of a StreamWriteResult structure. This may be exploited to
    corrupt memory leading to a Denial of Service or potentially other
    exploits.

  - **CVE-2020-8287**: HTTP Request Smuggling in nodejs (Low)
    - Affected versions of Node.js allow two copies of a header field in
    a http request. For example, two Transfer-Encoding header fields. In
    this case Node.js identifies the first header field and ignores the
    second. This can lead to HTTP Request Smuggling
    (https://cwe.mitre.org/data/definitions/444.html).

  PR-URL: https://github.com/nodejs-private/node-private/pull/242
  433ed98b4011a9b7f1e98aa9b111b865dc491fa1:2021-01-04, Version 15.5.1 (Current)

  This is a security release.

  Notable changes:

  Vulnerabilities fixed:

  - **CVE-2020-8265**: use-after-free in TLSWrap (High)
    * Affected Node.js versions are vulnerable to a use-after-free bug in
    its TLS implementation. When writing to a TLS enabled socket,
    node::StreamBase::Write calls node::TLSWrap::DoWrite with a freshly
    allocated WriteWrap object as first argument. If the DoWrite method
    does not return an error, this object is passed back to the caller as
    part of a StreamWriteResult structure. This may be exploited to
    corrupt memory leading to a Denial of Service or potentially other
    exploits.

  - **CVE-2020-8287**: HTTP Request Smuggling in nodejs (Low)
    * Affected versions of Node.js allow two copies of a header field in
    a http request. For example, two Transfer-Encoding header fields. In
    this case Node.js identifies the first header field and ignores the
    second. This can lead to HTTP Request Smuggling
    (https://cwe.mitre.org/data/definitions/444.html).

  PR-URL: https://github.com/nodejs-private/node-private/pull/241
  b0ac080fa77286dbc92b0beb49d1bb4d69c5784e:src: retain pointers to WriteWrap/ShutdownWrap

  Avoids potential use-after-free when wrap req's are synchronously
  destroyed.

  CVE-ID: CVE-2020-8265
  Fixes: https://github.com/nodejs-private/node-private/issues/227
  Refs: https://hackerone.com/bugs?subject=nodejs&report_id=988103
  PR-URL: https://github.com/nodejs-private/node-private/pull/23
  Reviewed-By: Anna Henningsen <anna@addaleax.net>
  Reviewed-By: Matteo Collina <matteo.collina@gmail.com>
  Reviewed-By: Rich Trott <rtrott@gmail.com>
  39fee5d91bc07beab14a1049358ababdd77ce3b1:2021-01-04, Version 15.5.1 (Current)

  This is a security release.

  Notable changes:

  Vulnerabilities fixed:

  - **CVE-2020-8265**: use-after-free in TLSWrap (High)
    * Affected Node.js versions are vulnerable to a use-after-free bug in
    its TLS implementation. When writing to a TLS enabled socket,
    node::StreamBase::Write calls node::TLSWrap::DoWrite with a freshly
    allocated WriteWrap object as first argument. If the DoWrite method
    does not return an error, this object is passed back to the caller as
    part of a StreamWriteResult structure. This may be exploited to
    corrupt memory leading to a Denial of Service or potentially other
    exploits.

  - **CVE-2020-8287**: HTTP Request Smuggling in nodejs (Low)
    * Affected versions of Node.js allow two copies of a header field in
    a http request. For example, two Transfer-Encoding header fields. In
    this case Node.js identifies the first header field and ignores the
    second. This can lead to HTTP Request Smuggling
    (https://cwe.mitre.org/data/definitions/444.html).

  PR-URL: https://github.com/nodejs-private/node-private/pull/241
  04509d6847a2d164b223a77aed0c41fe9ca60e57:2021-01-04, Version 14.15.4 'Fermium' (LTS)

  This is a security release.

  Notable changes:

  Vulnerabilities fixed:

  - **CVE-2020-1971**: OpenSSL - EDIPARTYNAME NULL pointer de-reference
    (High)
    - This is a vulnerability in OpenSSL which may be exploited through
    Node.js. You can read more about it in
    https://www.openssl.org/news/secadv/20201208.txt

  - **CVE-2020-8265**: use-after-free in TLSWrap (High)
    - Affected Node.js versions are vulnerable to a use-after-free bug in
    its TLS implementation. When writing to a TLS enabled socket,
    node::StreamBase::Write calls node::TLSWrap::DoWrite with a freshly
    allocated WriteWrap object as first argument. If the DoWrite method
    does not return an error, this object is passed back to the caller as
    part of a StreamWriteResult structure. This may be exploited to
    corrupt memory leading to a Denial of Service or potentially other
    exploits.

  - **CVE-2020-8287**: HTTP Request Smuggling in nodejs (Low)
    - Affected versions of Node.js allow two copies of a header field in
    a http request. For example, two Transfer-Encoding header fields. In
    this case Node.js identifies the first header field and ignores the
    second. This can lead to HTTP Request Smuggling
    (https://cwe.mitre.org/data/definitions/444.html).

  PR-URL: https://github.com/nodejs-private/node-private/pull/242
  4f8772f9b731118628256189b73cd202149bbd97:src: retain pointers to WriteWrap/ShutdownWrap

  Avoids potential use-after-free when wrap req's are synchronously
  destroyed.

  CVE-ID: CVE-2020-8265
  Fixes: https://github.com/nodejs-private/node-private/issues/227
  Refs: https://hackerone.com/bugs?subject=nodejs&report_id=988103
  PR-URL: https://github.com/nodejs-private/node-private/pull/23
  Reviewed-By: Anna Henningsen <anna@addaleax.net>
  Reviewed-By: Matteo Collina <matteo.collina@gmail.com>
  Reviewed-By: Rich Trott <rtrott@gmail.com>
  9834ef85a0a549a45a98f04dc51af1782a7126ee:src: retain pointers to WriteWrap/ShutdownWrap

  Avoids potential use-after-free when wrap req's are synchronously
  destroyed.

  CVE-ID: CVE-2020-8265
  Fixes: https://github.com/nodejs-private/node-private/issues/227
  Refs: https://hackerone.com/bugs?subject=nodejs&report_id=988103
  PR-URL: https://github.com/nodejs-private/node-private/pull/23
  Reviewed-By: Anna Henningsen <anna@addaleax.net>
  Reviewed-By: Matteo Collina <matteo.collina@gmail.com>
  Reviewed-By: Rich Trott <rtrott@gmail.com>
  87ddc7f10c6463bbcdd9dfc79f1e510a584e616e:2021-01-04, Version 12.20.1 'Erbium' (LTS)

  Notable changes:

  This is a security release.

  Vulnerabilities fixed:

  - CVE-2020-8265: use-after-free in TLSWrap (High)
  Affected Node.js versions are vulnerable to a use-after-free bug in
  its TLS implementation. When writing to a TLS enabled socket,
  node::StreamBase::Write calls node::TLSWrap::DoWrite with a freshly
  allocated WriteWrap object as first argument. If the DoWrite method
  does not return an error, this object is passed back to the caller
  as part of a StreamWriteResult structure. This may be exploited to
  corrupt memory leading to a Denial of Service or potentially other
  exploits
  - CVE-2020-8287: HTTP Request Smuggling in nodejs
  Affected versions of Node.js allow two copies of a header field in
  a http request. For example, two Transfer-Encoding header fields.
  In this case Node.js identifies the first header field and ignores
  the second. This can lead to HTTP Request Smuggling
  (https://cwe.mitre.org/data/definitions/444.html).
  - CVE-2020-1971: OpenSSL - EDIPARTYNAME NULL pointer de-reference (High)
  This is a vulnerability in OpenSSL which may be exploited through Node.js.
  You can read more about it in
  https://www.openssl.org/news/secadv/20201208.txt

  PR-URL: https://github.com/nodejs-private/node-private/pull/240
  5b00de7d67a1372aa342115ad28edd3f78268bb6:src: retain pointers to WriteWrap/ShutdownWrap

  Avoids potential use-after-free when wrap req's are synchronously
  destroyed.

  CVE-ID: CVE-2020-8265
  Fixes: https://github.com/nodejs-private/node-private/issues/227
  PR-URL: https://github.com/nodejs-private/node-private/pull/230
  Refs: https://hackerone.com/bugs?subject=nodejs&report_id=988103
  Reviewed-By: Anna Henningsen <anna@addaleax.net>
  Reviewed-By: Matteo Collina <matteo.collina@gmail.com>
  Reviewed-By: Rich Trott <rtrott@gmail.com>
  811be91dfe623c7569f5fd87b1eaf46074334c94:2021-01-04, Version 10.23.1 'Dubnium' (LTS)

  Notable changes:

  This is a security release.

  Vulnerabilities fixed:

  - CVE-2020-8265: use-after-free in TLSWrap (High)
  Affected Node.js versions are vulnerable to a use-after-free bug in
  its TLS implementation. When writing to a TLS enabled socket,
  node::StreamBase::Write calls node::TLSWrap::DoWrite with a freshly
  allocated WriteWrap object as first argument. If the DoWrite method
  does not return an error, this object is passed back to the caller
  as part of a StreamWriteResult structure. This may be exploited to
  corrupt memory leading to a Denial of Service or potentially other
  exploits
  - CVE-2020-8287: HTTP Request Smuggling in nodejs
  Affected versions of Node.js allow two copies of a header field in
  a http request. For example, two Transfer-Encoding header fields.
  In this case Node.js identifies the first header field and ignores
  the second. This can lead to HTTP Request Smuggling
  (https://cwe.mitre.org/data/definitions/444.html).
  - CVE-2020-1971: OpenSSL - EDIPARTYNAME NULL pointer de-reference (High)
  This is a vulnerability in OpenSSL which may be exploited through Node.js.
  You can read more about it in
  https://www.openssl.org/news/secadv/20201208.txt

  PR-URL: https://github.com/nodejs-private/node-private/pull/239
  7f178663ebffc82c9f8a5a1b6bf2da0c263a30ed:src: use unique_ptr for WriteWrap

  This commit attempts to avoid a use-after-free error by using unqiue_ptr
  and passing a reference to it.

  CVE-ID: CVE-2020-8265
  Fixes: https://github.com/nodejs-private/node-private/issues/227
  PR-URL: https://github.com/nodejs-private/node-private/pull/238
  Reviewed-By: Michael Dawson <midawson@redhat.com>
  Reviewed-By: Tobias Nie√üen <tniessen@tnie.de>
  Reviewed-By: Richard Lau <rlau@redhat.com>
impacted_packages:
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 4f8772f9b731118628256189b73cd202149bbd97
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: b0ac080fa77286dbc92b0beb49d1bb4d69c5784e
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 811be91dfe623c7569f5fd87b1eaf46074334c94
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 04509d6847a2d164b223a77aed0c41fe9ca60e57
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 39fee5d91bc07beab14a1049358ababdd77ce3b1
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 6c80df02d140e2abda48df6fa4db51e71e022224
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 433ed98b4011a9b7f1e98aa9b111b865dc491fa1
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 5b00de7d67a1372aa342115ad28edd3f78268bb6
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 87ddc7f10c6463bbcdd9dfc79f1e510a584e616e
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 7f178663ebffc82c9f8a5a1b6bf2da0c263a30ed
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: a384a0c4c6bee1e7b1ec30417d6f743f59cd3b84
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 9834ef85a0a549a45a98f04dc51af1782a7126ee
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: ceb0dc907a571edea326d2cd5f846f8d31e95caf
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/nodejs/node/tree/04509d6847a2d164b223a77aed0c41fe9ca60e57
    reference_type: commit
    reference_id: 04509d6847a2d164b223a77aed0c41fe9ca60e57
  - url: https://github.com/nodejs/node/tree/39fee5d91bc07beab14a1049358ababdd77ce3b1
    reference_type: commit
    reference_id: 39fee5d91bc07beab14a1049358ababdd77ce3b1
  - url: https://github.com/nodejs/node/tree/433ed98b4011a9b7f1e98aa9b111b865dc491fa1
    reference_type: commit
    reference_id: 433ed98b4011a9b7f1e98aa9b111b865dc491fa1
  - url: https://github.com/nodejs/node/tree/4f8772f9b731118628256189b73cd202149bbd97
    reference_type: commit
    reference_id: 4f8772f9b731118628256189b73cd202149bbd97
  - url: https://github.com/nodejs/node/tree/5b00de7d67a1372aa342115ad28edd3f78268bb6
    reference_type: commit
    reference_id: 5b00de7d67a1372aa342115ad28edd3f78268bb6
  - url: https://github.com/nodejs/node/tree/6c80df02d140e2abda48df6fa4db51e71e022224
    reference_type: commit
    reference_id: 6c80df02d140e2abda48df6fa4db51e71e022224
  - url: https://github.com/nodejs/node/tree/7f178663ebffc82c9f8a5a1b6bf2da0c263a30ed
    reference_type: commit
    reference_id: 7f178663ebffc82c9f8a5a1b6bf2da0c263a30ed
  - url: https://github.com/nodejs/node/tree/811be91dfe623c7569f5fd87b1eaf46074334c94
    reference_type: commit
    reference_id: 811be91dfe623c7569f5fd87b1eaf46074334c94
  - url: https://github.com/nodejs/node/tree/87ddc7f10c6463bbcdd9dfc79f1e510a584e616e
    reference_type: commit
    reference_id: 87ddc7f10c6463bbcdd9dfc79f1e510a584e616e
  - url: https://github.com/nodejs/node/tree/9834ef85a0a549a45a98f04dc51af1782a7126ee
    reference_type: commit
    reference_id: 9834ef85a0a549a45a98f04dc51af1782a7126ee
  - url: https://github.com/nodejs/node/tree/a384a0c4c6bee1e7b1ec30417d6f743f59cd3b84
    reference_type: commit
    reference_id: a384a0c4c6bee1e7b1ec30417d6f743f59cd3b84
  - url: https://github.com/nodejs/node/tree/b0ac080fa77286dbc92b0beb49d1bb4d69c5784e
    reference_type: commit
    reference_id: b0ac080fa77286dbc92b0beb49d1bb4d69c5784e
  - url: https://github.com/nodejs/node/tree/ceb0dc907a571edea326d2cd5f846f8d31e95caf
    reference_type: commit
    reference_id: ceb0dc907a571edea326d2cd5f846f8d31e95caf
