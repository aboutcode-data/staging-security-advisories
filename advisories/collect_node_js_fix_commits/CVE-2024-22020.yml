advisory_id: CVE-2024-22020
datasource_id: collect_node_js_fix_commits/CVE-2024-22020
datasource_url: https://github.com/nodejs/node
aliases: []
summary: |
  24648b5769dbfa71896fa32a402ddcb8ee348a8d:lib,esm: handle bypass network-import via data:

  PR-URL: https://github.com/nodejs-private/node-private/pull/522
  Refs: https://hackerone.com/bugs?subject=nodejs&report_id=2092749
  Reviewed-By: Antoine du Hamel <duhamelantoine1995@gmail.com>
  Reviewed-By: Marco Ippolito <marcoippolito54@gmail.com>
  CVE-ID: CVE-2024-22020
  PR-URL: https://github.com/nodejs/node/pull/53764
  Reviewed-By: Yagiz Nizipli <yagiz.nizipli@sentry.io>
  Reviewed-By: Matteo Collina <matteo.collina@gmail.com>
  4fe0f826a80365ce2512b8193ceaa9466c288aa5:2024-07-08, Version 22.4.1 (Current)

  This is a security release.

  Notable changes:

  * CVE-2024-36138 - Bypass incomplete fix of CVE-2024-27980 (High)
  * CVE-2024-22020 - Bypass network import restriction via data URL (Medium)
  * CVE-2024-22018 - fs.lstat bypasses permission model (Low)
  * CVE-2024-36137 - fs.fchown/fchmod bypasses permission model (Low)
  * CVE-2024-37372 - Permission model improperly processes UNC paths (Low)

  PR-URL: https://github.com/nodejs-private/node-private/pull/617
  0881c1f01ac90006315cae5b9c38cfbf44d37e59:2024-07-08, Version 20.15.1 'Iron' (LTS)

  This is a security release.

  Notable changes:

  * CVE-2024-36138 - Bypass incomplete fix of CVE-2024-27980 (High)
  * CVE-2024-22020 - Bypass network import restriction via data URL (Medium)
  * CVE-2024-22018 - fs.lstat bypasses permission model (Low)
  * CVE-2024-36137 - fs.fchown/fchmod bypasses permission model (Low)
  * CVE-2024-37372 - Permission model improperly processes UNC paths (Low)

  PR-URL: https://github.com/nodejs-private/node-private/pull/608
  4324e11935659a2ed2d17f84bc87b9c9198b4fdf:2024-07-08, Version 18.20.4 'Hydrogen' (LTS)

  This is a security release.

  Notable changes:

  * CVE-2024-36138 - Bypass incomplete fix of CVE-2024-27980 (High)
  * CVE-2024-22020 - Bypass network import restriction via data URL (Medium)

  PR-URL: https://github.com/nodejs-private/node-private/pull/609
  8512434d2beea2ca2fcb85d13175fa30a95ecf77:2024-07-08, Version 22.4.1 (Current)

  This is a security release.

  Notable changes:

  * CVE-2024-36138 - Bypass incomplete fix of CVE-2024-27980 (High)
  * CVE-2024-22020 - Bypass network import restriction via data URL (Medium)
  * CVE-2024-22018 - fs.lstat bypasses permission model (Low)
  * CVE-2024-36137 - fs.fchown/fchmod bypasses permission model (Low)
  * CVE-2024-37372 - Permission model improperly processes UNC paths (Low)

  PR-URL: https://github.com/nodejs-private/node-private/pull/617
  110902ff5e3b1395a2a15cb51fe99902d2c2abfa:lib,esm: handle bypass network-import via data:

  PR-URL: https://github.com/nodejs-private/node-private/pull/522
  Fixes: https://hackerone.com/bugs?subject=nodejs&report_id=2092749
  Reviewed-By: Antoine du Hamel <duhamelantoine1995@gmail.com>
  Reviewed-By: Marco Ippolito <marcoippolito54@gmail.com>
  CVE-ID: CVE-2024-22020
  a407d1f0b3669cc82c755700f0d500fb27cc39ea:2024-07-08, Version 20.15.1 'Iron' (LTS)

  This is a security release.

  Notable changes:

  * CVE-2024-36138 - Bypass incomplete fix of CVE-2024-27980 (High)
  * CVE-2024-22020 - Bypass network import restriction via data URL (Medium)
  * CVE-2024-22018 - fs.lstat bypasses permission model (Low)
  * CVE-2024-36137 - fs.fchown/fchmod bypasses permission model (Low)
  * CVE-2024-37372 - Permission model improperly processes UNC paths (Low)

  PR-URL: https://github.com/nodejs-private/node-private/pull/608
  60e184a6e414e5bc9624acf87433fc4052260116:lib,esm: handle bypass network-import via data:

  PR-URL: https://github.com/nodejs-private/node-private/pull/522
  CVE-ID: CVE-2024-22020
  e922fb64b53530af4ad2e3df298a302225645f5b:2024-07-08, Version 18.20.4 'Hydrogen' (LTS)

  This is a security release.

  Notable changes:

  * CVE-2024-36138 - Bypass incomplete fix of CVE-2024-27980 (High)
  * CVE-2024-22020 - Bypass network import restriction via data URL (Medium)

  PR-URL: https://github.com/nodejs-private/node-private/pull/609
  85abedf1ffe1339cf739a70adc9ddf48384ab7ba:lib,esm: handle bypass network-import via data:

  PR-URL: https://github.com/nodejs-private/node-private/pull/522
  Backport-PR-URL: https://github.com/nodejs-private/node-private/pull/602
  CVE-ID: CVE-2024-22020
impacted_packages:
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 24648b5769dbfa71896fa32a402ddcb8ee348a8d
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 85abedf1ffe1339cf739a70adc9ddf48384ab7ba
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 60e184a6e414e5bc9624acf87433fc4052260116
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 110902ff5e3b1395a2a15cb51fe99902d2c2abfa
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: e922fb64b53530af4ad2e3df298a302225645f5b
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: a407d1f0b3669cc82c755700f0d500fb27cc39ea
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 4324e11935659a2ed2d17f84bc87b9c9198b4fdf
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 0881c1f01ac90006315cae5b9c38cfbf44d37e59
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 8512434d2beea2ca2fcb85d13175fa30a95ecf77
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 4fe0f826a80365ce2512b8193ceaa9466c288aa5
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/nodejs/node/tree/0881c1f01ac90006315cae5b9c38cfbf44d37e59
    reference_type: commit
    reference_id: 0881c1f01ac90006315cae5b9c38cfbf44d37e59
  - url: https://github.com/nodejs/node/tree/110902ff5e3b1395a2a15cb51fe99902d2c2abfa
    reference_type: commit
    reference_id: 110902ff5e3b1395a2a15cb51fe99902d2c2abfa
  - url: https://github.com/nodejs/node/tree/24648b5769dbfa71896fa32a402ddcb8ee348a8d
    reference_type: commit
    reference_id: 24648b5769dbfa71896fa32a402ddcb8ee348a8d
  - url: https://github.com/nodejs/node/tree/4324e11935659a2ed2d17f84bc87b9c9198b4fdf
    reference_type: commit
    reference_id: 4324e11935659a2ed2d17f84bc87b9c9198b4fdf
  - url: https://github.com/nodejs/node/tree/4fe0f826a80365ce2512b8193ceaa9466c288aa5
    reference_type: commit
    reference_id: 4fe0f826a80365ce2512b8193ceaa9466c288aa5
  - url: https://github.com/nodejs/node/tree/60e184a6e414e5bc9624acf87433fc4052260116
    reference_type: commit
    reference_id: 60e184a6e414e5bc9624acf87433fc4052260116
  - url: https://github.com/nodejs/node/tree/8512434d2beea2ca2fcb85d13175fa30a95ecf77
    reference_type: commit
    reference_id: 8512434d2beea2ca2fcb85d13175fa30a95ecf77
  - url: https://github.com/nodejs/node/tree/85abedf1ffe1339cf739a70adc9ddf48384ab7ba
    reference_type: commit
    reference_id: 85abedf1ffe1339cf739a70adc9ddf48384ab7ba
  - url: https://github.com/nodejs/node/tree/a407d1f0b3669cc82c755700f0d500fb27cc39ea
    reference_type: commit
    reference_id: a407d1f0b3669cc82c755700f0d500fb27cc39ea
  - url: https://github.com/nodejs/node/tree/e922fb64b53530af4ad2e3df298a302225645f5b
    reference_type: commit
    reference_id: e922fb64b53530af4ad2e3df298a302225645f5b
