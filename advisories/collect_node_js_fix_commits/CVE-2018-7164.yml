advisory_id: CVE-2018-7164
datasource_id: collect_node_js_fix_commits/CVE-2018-7164
datasource_url: https://github.com/nodejs/node
aliases: []
summary: |
  3217e8e66fa81e787b9f3b18c0c09235f050acee:src: re-add `Realloc()` shrink after reading stream data

  This would otherwise keep a lot of unused memory lying around,
  and in particular add up to a page per chunk of memory overhead
  for network reads, potentially opening a DoS vector if the resulting
  `Buffer` objects are kept around indefinitely (e.g. stored in a list
  and not concatenated until the socket finishes).

  This fixes CVE-2018-7164.

  Refs: https://github.com/nodejs-private/security/issues/186
  Refs: https://github.com/nodejs/node/commit/7c4b09b24bbe7d6a8cbad256f47b30a101a909ea
  PR-URL: https://github.com/nodejs-private/node-private/pull/128
  Reviewed-By: Michael Dawson <michael_dawson@ca.ibm.com>
  Reviewed-By: Evan Lucas <evanlucas@me.com>
  06cab45b2c2121af527b7e305f0176114da741d1:2018-06-12, Version 10.4.1 (Current)

  Notable changes:

  * **Fixes memory exhaustion DoS** (CVE-2018-7164): Fixes a bug introduced
      in 9.7.0 that increases the memory consumed when reading from the network
      into JavaScript using the net.Socket object directly as a stream.
  * **http2**
    * (CVE-2018-7161): Fixes Denial of Service vulnerability by updating the
      http2 implementation to not crash under certain circumstances during cleanup
    * (CVE-2018-1000168): Fixes Denial of Service vulnerability by upgrading
      nghttp2 to 1.32.0
  * **tls** (CVE-2018-7162): Fixes Denial of Service vulnerability by updating
      the TLS implementation to not crash upon receiving
  * **n-api**: Prevent use-after-free in napi_delete_async_work

  PR-URL: https://github.com/nodejs-private/node-private/pull/136
  0fb290a3472c92bff5635405e65432643bcca30e:2018-06-12, Version 9.11.2 (Maintenance)

  Notable changes:

  * **Fixes memory exhaustion DoS** (CVE-2018-7164): Fixes a bug introduced
      in 9.7.0 that increases the memory consumed when reading from the network
      into JavaScript using the net.Socket object directly as a stream.
  * **buffer** (CVE-2018-7167): Fixes Denial of Service vulnerability where
      calling Buffer.fill() could hang
  * **http2**
    * (CVE-2018-7161): Fixes Denial of Service vulnerability by updating the
      http2 implementation to not crash under certain circumstances during cleanup
    * (CVE-2018-1000168): Fixes Denial of Service vulnerability by upgrading
      nghttp2 to 1.32.0
  * **tls** (CVE-2018-7162): Fixes Denial of Service vulnerability by updating
      the TLS implementation to not crash upon receiving

  PR-URL: https://github.com/nodejs-private/node-private/pull/135
  b5339ff549fcd7ff7f228d00d0ff79b78a347dc6:2018-06-12, Version 9.11.2 (Maintenance)

  Notable changes:

  * **Fixes memory exhaustion DoS** (CVE-2018-7164): Fixes a bug introduced
      in 9.7.0 that increases the memory consumed when reading from the network
      into JavaScript using the net.Socket object directly as a stream.
  * **buffer** (CVE-2018-7167): Fixes Denial of Service vulnerability where
      calling Buffer.fill() could hang
  * **http2**
    * (CVE-2018-7161): Fixes Denial of Service vulnerability by updating the
      http2 implementation to not crash under certain circumstances during cleanup
    * (CVE-2018-1000168): Fixes Denial of Service vulnerability by upgrading
      nghttp2 to 1.32.0
  * **tls** (CVE-2018-7162): Fixes Denial of Service vulnerability by updating
      the TLS implementation to not crash upon receiving

  PR-URL: https://github.com/nodejs-private/node-private/pull/135
  be103eba4115eadee7d497aac95531a99312df1c:src: re-add `Realloc()` shrink after reading stream data

  This would otherwise keep a lot of unused memory lying around,
  and in particular add up to a page per chunk of memory overhead
  for network reads, potentially opening a DoS vector if the resulting
  `Buffer` objects are kept around indefinitely (e.g. stored in a list
  and not concatenated until the socket finishes).

  This fixes CVE-2018-7164.

  Refs: https://github.com/nodejs-private/security/issues/186
  Refs: https://github.com/nodejs/node/commit/7c4b09b24bbe7d6a8cbad256f47b30a101a909ea
  PR-URL: https://github.com/nodejs-private/node-private/pull/129
  Reviewed-By: Michael Dawson <michael_dawson@ca.ibm.com>
  Reviewed-By: Evan Lucas <evanlucas@me.com>
  1442cfef73c0a7157b1552658529ae9ff9154de9:2018-06-12, Version 10.4.1 (Current)

  Notable changes:

  * **Fixes memory exhaustion DoS** (CVE-2018-7164): Fixes a bug introduced
      in 9.7.0 that increases the memory consumed when reading from the network
      into JavaScript using the net.Socket object directly as a stream.
  * **http2**
    * (CVE-2018-7161): Fixes Denial of Service vulnerability by updating the
      http2 implementation to not crash under certain circumstances during cleanup
    * (CVE-2018-1000168): Fixes Denial of Service vulnerability by upgrading
      nghttp2 to 1.32.0
  * **tls** (CVE-2018-7162): Fixes Denial of Service vulnerability by updating
      the TLS implementation to not crash upon receiving
  * **n-api**: Prevent use-after-free in napi_delete_async_work

  PR-URL: https://github.com/nodejs-private/node-private/pull/136
  9ba8ed137158609263ca491b5b3b15c3bb14a121:src: re-add `Realloc()` shrink after reading stream data

  This would otherwise keep a lot of unused memory lying around,
  and in particular add up to a page per chunk of memory overhead
  for network reads, potentially opening a DoS vector if the resulting
  `Buffer` objects are kept around indefinitely (e.g. stored in a list
  and not concatenated until the socket finishes).

  This fixes CVE-2018-7164.

  Refs: https://github.com/nodejs-private/security/issues/186
  Refs: https://github.com/nodejs/node/commit/7c4b09b24bbe7d6a8cbad256f47b30a101a909ea
  PR-URL: https://github.com/nodejs-private/node-private/pull/128
  Reviewed-By: Michael Dawson <michael_dawson@ca.ibm.com>
  Reviewed-By: Evan Lucas <evanlucas@me.com>
  10c5adf19b42a09661f3603317f91ed211ba1bfa:test: add `Realloc()` shrink after reading stream data test

  This would otherwise keep a lot of unused memory lying around,
  and in particular add up to a page per chunk of memory overhead
  for network reads, potentially opening a DoS vector if the resulting
  `Buffer` objects are kept around indefinitely (e.g. stored in a list
  and not concatenated until the socket finishes).

  This is to prevent v8.x from becoming susceptible to CVE-2018-7164.

  Refs: https://github.com/nodejs-private/security/issues/186
  Refs: https://github.com/nodejs/node/commit/7c4b09b24bbe7d6a8cbad256f47b30a101a909ea
  PR-URL: https://github.com/nodejs-private/node-private/pull/132
  Reviewed-By: Evan Lucas <evanlucas@me.com>
  Reviewed-By: Michael Dawson <michael_dawson@ca.ibm.com>
impacted_packages:
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 1442cfef73c0a7157b1552658529ae9ff9154de9
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 9ba8ed137158609263ca491b5b3b15c3bb14a121
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 3217e8e66fa81e787b9f3b18c0c09235f050acee
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 0fb290a3472c92bff5635405e65432643bcca30e
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: b5339ff549fcd7ff7f228d00d0ff79b78a347dc6
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 10c5adf19b42a09661f3603317f91ed211ba1bfa
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: be103eba4115eadee7d497aac95531a99312df1c
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 06cab45b2c2121af527b7e305f0176114da741d1
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/nodejs/node/tree/06cab45b2c2121af527b7e305f0176114da741d1
    reference_type: commit
    reference_id: 06cab45b2c2121af527b7e305f0176114da741d1
  - url: https://github.com/nodejs/node/tree/0fb290a3472c92bff5635405e65432643bcca30e
    reference_type: commit
    reference_id: 0fb290a3472c92bff5635405e65432643bcca30e
  - url: https://github.com/nodejs/node/tree/10c5adf19b42a09661f3603317f91ed211ba1bfa
    reference_type: commit
    reference_id: 10c5adf19b42a09661f3603317f91ed211ba1bfa
  - url: https://github.com/nodejs/node/tree/1442cfef73c0a7157b1552658529ae9ff9154de9
    reference_type: commit
    reference_id: 1442cfef73c0a7157b1552658529ae9ff9154de9
  - url: https://github.com/nodejs/node/tree/3217e8e66fa81e787b9f3b18c0c09235f050acee
    reference_type: commit
    reference_id: 3217e8e66fa81e787b9f3b18c0c09235f050acee
  - url: https://github.com/nodejs/node/tree/9ba8ed137158609263ca491b5b3b15c3bb14a121
    reference_type: commit
    reference_id: 9ba8ed137158609263ca491b5b3b15c3bb14a121
  - url: https://github.com/nodejs/node/tree/b5339ff549fcd7ff7f228d00d0ff79b78a347dc6
    reference_type: commit
    reference_id: b5339ff549fcd7ff7f228d00d0ff79b78a347dc6
  - url: https://github.com/nodejs/node/tree/be103eba4115eadee7d497aac95531a99312df1c
    reference_type: commit
    reference_id: be103eba4115eadee7d497aac95531a99312df1c
