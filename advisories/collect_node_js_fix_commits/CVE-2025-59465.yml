advisory_id: CVE-2025-59465
datasource_id: collect_node_js_fix_commits/CVE-2025-59465
datasource_url: https://github.com/nodejs/node
aliases: []
summary: |
  32b03d0604d362ca3e7d30077f2440fe7fd4133c:lib: add TLSSocket default error handler

  This prevents the server from crashing due to an unhandled rejection
  when a TLSSocket connection is abruptly destroyed during initialization
  and the user has not attached an error handler to the socket.
  e.g:

  ```js
  const server = http2.createSecureServer({ ... })
  server.on('secureConnection', socket => {
    socket.on('error', err => {
      console.log(err)
    })
  })
  ```

  PR-URL: https://github.com/nodejs-private/node-private/pull/750
  Backport-PR-URL: https://github.com/nodejs/node/pull/61044
  Fixes: https://github.com/nodejs/node/issues/44751
  Refs: https://hackerone.com/bugs?subject=nodejs&report_id=3262404
  Reviewed-By: Matteo Collina <matteo.collina@gmail.com>
  Reviewed-By: Anna Henningsen <anna@addaleax.net>
  CVE-ID: CVE-2025-59465
  Refs: https://github.com/nodejs/node/pull/57643
  4ef7a6c77e569735d4836df3319982f84d13ae32:lib: backport `_tls_common` and `_tls_wrap` refactors

  This is the same as the original change, minus the `process.emitWarning`
  calls and unit tests that expect the deprecation warnings, plus
  re-application of the fixes for CVE-2025-59465 and CVE-2026-21637.

  Original commit message:
      lib: deprecate _tls_common and _tls_wrap

      runtime deprecate the _tls_common and _tls_wrap
      modules, users should use nust node:tls insteal
      and internally internal/tls/commond and
      internal/tls/wrap should be used instead

  PR-URL: https://github.com/nodejs/node/pull/57643
  Backport-PR-URL: https://github.com/nodejs/node/pull/61044
  Co-authored-by: =?UTF-8?q?Micha=C3=ABl=20Zasso?= <targos@protonmail.com>
  Reviewed-By: Matteo Collina <matteo.collina@gmail.com>
  Reviewed-By: James M Snell <jasnell@gmail.com>
  Reviewed-By: Marco Ippolito <marcoippolito54@gmail.com>
  Reviewed-By: Yagiz Nizipli <yagiz@nizipli.com>
  Reviewed-By: Ruben Bridgewater <ruben@bridgewater.de>
  7d421c8f29a48a5fe601329ccaf5c16239b3a2bb:lib: add TLSSocket default error handler

  This prevents the server from crashing due to an unhandled rejection
  when a TLSSocket connection is abruptly destroyed during initialization
  and the user has not attached an error handler to the socket.
  e.g:

  ```js
  const server = http2.createSecureServer({ ... })
  server.on('secureConnection', socket => {
    socket.on('error', err => {
      console.log(err)
    })
  })
  ```

  PR-URL: https://github.com/nodejs-private/node-private/pull/750
  Fixes: https://github.com/nodejs/node/issues/44751
  Refs: https://hackerone.com/bugs?subject=nodejs&report_id=3262404
  Reviewed-By: Matteo Collina <matteo.collina@gmail.com>
  Reviewed-By: Anna Henningsen <anna@addaleax.net>
  CVE-ID: CVE-2025-59465
  6ea77ad552f9f9d8a61c44a82f158213c94b5daf:2026-01-13, Version 25.3.0 (Current)

  This is a security release.

  Notable changes:

  lib:
    * (CVE-2025-59465) add TLSSocket default error handler (RafaelGSS) https://github.com/nodejs-private/node-private/pull/750
  permission:
    * (CVE-2026-21636) add network check on pipe_wrap connect (RafaelGSS) https://github.com/nodejs-private/node-private/pull/784
    * (CVE-2025-55130) require full read and write to symlink APIs (RafaelGSS) https://github.com/nodejs-private/node-private/pull/760
    * (CVE-2025-55132) disable futimes when permission model is enabled (RafaelGSS) https://github.com/nodejs-private/node-private/pull/748
  src:
    * (CVE-2025-59466) rethrow stack overflow exceptions in async_hooks (Matteo Collina) https://github.com/nodejs-private/node-private/pull/773
  src,lib:
    * (CVE-2025-55131) refactor unsafe buffer creation to remove zero-fill toggle (Сковорода Никита Андреевич) https://github.com/nodejs-private/node-private/pull/759
  tls:
    * (CVE-2026-21637) route callback exceptions through error handlers (Matteo Collina) https://github.com/nodejs-private/node-private/pull/790

  PR-URL: https://github.com/nodejs-private/node-private/pull/793
  64022d9fccc9624813a311444e87f2b2985acb22:2026-01-13, Version 24.13.0 'Krypton' (LTS)

  This is a security release.

  Notable changes:

  lib:
    * (CVE-2025-59465) add TLSSocket default error handler (RafaelGSS) <https://github.com/nodejs-private/node-private/pull/797>
    * (CVE-2025-55132) disable futimes when permission model is enabled (RafaelGSS) <https://github.com/nodejs-private/node-private/pull/748>
  lib,permission:
    * (CVE-2025-55130) require full read and write to symlink APIs (RafaelGSS) <https://github.com/nodejs-private/node-private/pull/760>
  src:
    * (CVE-2025-59466) rethrow stack overflow exceptions in async\_hooks (Matteo Collina) <https://github.com/nodejs-private/node-private/pull/773>
  src,lib:
    * (CVE-2025-55131) refactor unsafe buffer creation to remove zero-fill toggle (Сковорода Никита Андреевич) <https://github.com/nodejs-private/node-private/pull/759>
  tls:
    * (CVE-2026-21637) route callback exceptions through error handlers (Matteo Collina) <https://github.com/nodejs-private/node-private/pull/796>

  PR-URL: https://github.com/nodejs-private/node-private/pull/800
  1f49cd1d86977deca14aae108d8a98e470019baa:2026-01-13, Version 22.22.0 'Jod' (LTS)

  This is a security release.

  Notable changes:

  lib:
    * (CVE-2025-59465) add TLSSocket default error handler
    * (CVE-2025-55132) disable futimes when permission model is enabled
  lib,permission:
    * (CVE-2025-55130) require full read and write to symlink APIs
  src:
    * (CVE-2025-59466) rethrow stack overflow exceptions in async_hooks
  src,lib:
    * (CVE-2025-55131) refactor unsafe buffer creation to remove zero-fill toggle
  tls:
    * (CVE-2026-21637) route callback exceptions through error handlers

  PR-URL: https://github.com/nodejs-private/node-private/pull/801
  4443a11bef5688f0696adec08daf842a7069c5d1:2026-01-13, Version 20.20.0 'Iron' (LTS)

  This is a security release.

  Notable changes:

  lib:
    * (CVE-2025-55132) disable futimes when permission model is enabled (RafaelGSS) https://github.com/nodejs-private/node-private/pull/802
    * (CVE-2025-59465) add TLSSocket default error handler (RafaelGSS) https://github.com/nodejs-private/node-private/pull/797
  lib,permission:
    * (CVE-2025-55130) require full read and write to symlink APIs (RafaelGSS) https://github.com/nodejs-private/node-private/pull/760
  src:
    * (CVE-2025-59466) rethrow stack overflow exceptions in async_hooks (Matteo Collina) https://github.com/nodejs-private/node-private/pull/773
  src,lib:
    * (CVE-2025-55131) refactor unsafe buffer creation to remove zero-fill toggle (Сковорода Никита Андреевич) https://github.com/nodejs-private/node-private/pull/799
  tls:
    * (CVE-2026-21637) route callback exceptions through error handlers (Matteo Collina) https://github.com/nodejs-private/node-private/pull/796

  PR-URL: https://github.com/nodejs-private/node-private/pull/804
  00d6cd83927d6d5c8fe9d0cdd101daa6df4b1a15:2026-01-13, Version 25.3.0 (Current)

  This is a security release.

  Notable changes:

  lib:
    * (CVE-2025-59465) add TLSSocket default error handler (RafaelGSS) https://github.com/nodejs-private/node-private/pull/750
  permission:
    * (CVE-2026-21636) add network check on pipe_wrap connect (RafaelGSS) https://github.com/nodejs-private/node-private/pull/784
    * (CVE-2025-55130) require full read and write to symlink APIs (RafaelGSS) https://github.com/nodejs-private/node-private/pull/760
    * (CVE-2025-55132) disable futimes when permission model is enabled (RafaelGSS) https://github.com/nodejs-private/node-private/pull/748
  src:
    * (CVE-2025-59466) rethrow stack overflow exceptions in async_hooks (Matteo Collina) https://github.com/nodejs-private/node-private/pull/773
  src,lib:
    * (CVE-2025-55131) refactor unsafe buffer creation to remove zero-fill toggle (Сковорода Никита Андреевич) https://github.com/nodejs-private/node-private/pull/759
  tls:
    * (CVE-2026-21637) route callback exceptions through error handlers (Matteo Collina) https://github.com/nodejs-private/node-private/pull/790

  PR-URL: https://github.com/nodejs-private/node-private/pull/793
  def0bdf8abee441cfcbf793a8dc24a6f3b899573:2026-01-13, Version 24.13.0 'Krypton' (LTS)

  This is a security release.

  Notable changes:

  lib:
    * (CVE-2025-59465) add TLSSocket default error handler (RafaelGSS) <https://github.com/nodejs-private/node-private/pull/797>
    * (CVE-2025-55132) disable futimes when permission model is enabled (RafaelGSS) <https://github.com/nodejs-private/node-private/pull/748>
  lib,permission:
    * (CVE-2025-55130) require full read and write to symlink APIs (RafaelGSS) <https://github.com/nodejs-private/node-private/pull/760>
  src:
    * (CVE-2025-59466) rethrow stack overflow exceptions in async\_hooks (Matteo Collina) <https://github.com/nodejs-private/node-private/pull/773>
  src,lib:
    * (CVE-2025-55131) refactor unsafe buffer creation to remove zero-fill toggle (Сковорода Никита Андреевич) <https://github.com/nodejs-private/node-private/pull/759>
  tls:
    * (CVE-2026-21637) route callback exceptions through error handlers (Matteo Collina) <https://github.com/nodejs-private/node-private/pull/796>

  PR-URL: https://github.com/nodejs-private/node-private/pull/800
  4ba536a5a6c37810ba83490222655a71b370834f:lib: add TLSSocket default error handler

  This prevents the server from crashing due to an unhandled rejection
  when a TLSSocket connection is abruptly destroyed during initialization
  and the user has not attached an error handler to the socket.
  e.g:

  ```js
  const server = http2.createSecureServer({ ... })
  server.on('secureConnection', socket => {
    socket.on('error', err => {
      console.log(err)
    })
  })
  ```

  PR-URL: https://github.com/nodejs-private/node-private/pull/797
  Fixes: https://github.com/nodejs/node/issues/44751
  Refs: https://hackerone.com/bugs?subject=nodejs&report_id=3262404
  Reviewed-By: Matteo Collina <matteo.collina@gmail.com>
  Reviewed-By: Anna Henningsen <anna@addaleax.net>
  CVE-ID: CVE-2025-59465
  1f7186e1e01d279022cab6acdecb119e472bb409:2026-01-13, Version 20.20.0 'Iron' (LTS)

  This is a security release.

  Notable changes:

  lib:
    * (CVE-2025-55132) disable futimes when permission model is enabled (RafaelGSS) https://github.com/nodejs-private/node-private/pull/802
    * (CVE-2025-59465) add TLSSocket default error handler (RafaelGSS) https://github.com/nodejs-private/node-private/pull/797
  lib,permission:
    * (CVE-2025-55130) require full read and write to symlink APIs (RafaelGSS) https://github.com/nodejs-private/node-private/pull/760
  src:
    * (CVE-2025-59466) rethrow stack overflow exceptions in async_hooks (Matteo Collina) https://github.com/nodejs-private/node-private/pull/773
  src,lib:
    * (CVE-2025-55131) refactor unsafe buffer creation to remove zero-fill toggle (Сковорода Никита Андреевич) https://github.com/nodejs-private/node-private/pull/799
  tls:
    * (CVE-2026-21637) route callback exceptions through error handlers (Matteo Collina) https://github.com/nodejs-private/node-private/pull/796

  PR-URL: https://github.com/nodejs-private/node-private/pull/804
  6add85e4c46b8be383c8b637102d6b6fd206adce:2026-01-13, Version 22.22.0 'Jod' (LTS)

  This is a security release.

  Notable changes:

  lib:
    * (CVE-2025-59465) add TLSSocket default error handler
    * (CVE-2025-55132) disable futimes when permission model is enabled
  lib,permission:
    * (CVE-2025-55130) require full read and write to symlink APIs
  src:
    * (CVE-2025-59466) rethrow stack overflow exceptions in async_hooks
  src,lib:
    * (CVE-2025-55131) refactor unsafe buffer creation to remove zero-fill toggle
  tls:
    * (CVE-2026-21637) route callback exceptions through error handlers

  PR-URL: https://github.com/nodejs-private/node-private/pull/801
  1febc48d5b0bcf9070085589d9cc586d74053f9c:lib: add TLSSocket default error handler

  This prevents the server from crashing due to an unhandled rejection
  when a TLSSocket connection is abruptly destroyed during initialization
  and the user has not attached an error handler to the socket.
  e.g:

  ```js
  const server = http2.createSecureServer({ ... })
  server.on('secureConnection', socket => {
    socket.on('error', err => {
      console.log(err)
    })
  })
  ```

  PR-URL: https://github.com/nodejs-private/node-private/pull/797
  Fixes: https://github.com/nodejs/node/issues/44751
  Refs: https://hackerone.com/bugs?subject=nodejs&report_id=3262404
  Reviewed-By: Matteo Collina <matteo.collina@gmail.com>
  Reviewed-By: Anna Henningsen <anna@addaleax.net>
  CVE-ID: CVE-2025-59465
  eb8e41f8dbe6de127fb11baca725e1b469612434:lib: add TLSSocket default error handler

  This prevents the server from crashing due to an unhandled rejection
  when a TLSSocket connection is abruptly destroyed during initialization
  and the user has not attached an error handler to the socket.
  e.g:

  ```js
  const server = http2.createSecureServer({ ... })
  server.on('secureConnection', socket => {
    socket.on('error', err => {
      console.log(err)
    })
  })
  ```

  PR-URL: https://github.com/nodejs-private/node-private/pull/797
  Fixes: https://github.com/nodejs/node/issues/44751
  Refs: https://hackerone.com/bugs?subject=nodejs&report_id=3262404
  Reviewed-By: Matteo Collina <matteo.collina@gmail.com>
  Reviewed-By: Anna Henningsen <anna@addaleax.net>
  CVE-ID: CVE-2025-59465
  f0a8916887168383a15ac9536a082d313a8d9bb2:lib: add TLSSocket default error handler

  This prevents the server from crashing due to an unhandled rejection
  when a TLSSocket connection is abruptly destroyed during initialization
  and the user has not attached an error handler to the socket.
  e.g:

  ```js
  const server = http2.createSecureServer({ ... })
  server.on('secureConnection', socket => {
    socket.on('error', err => {
      console.log(err)
    })
  })
  ```

  PR-URL: https://github.com/nodejs-private/node-private/pull/750
  Fixes: https://github.com/nodejs/node/issues/44751
  Refs: https://hackerone.com/bugs?subject=nodejs&report_id=3262404
  Reviewed-By: Matteo Collina <matteo.collina@gmail.com>
  Reviewed-By: Anna Henningsen <anna@addaleax.net>
  CVE-ID: CVE-2025-59465
impacted_packages:
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: def0bdf8abee441cfcbf793a8dc24a6f3b899573
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 64022d9fccc9624813a311444e87f2b2985acb22
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 1f49cd1d86977deca14aae108d8a98e470019baa
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 00d6cd83927d6d5c8fe9d0cdd101daa6df4b1a15
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 1f7186e1e01d279022cab6acdecb119e472bb409
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 1febc48d5b0bcf9070085589d9cc586d74053f9c
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 7d421c8f29a48a5fe601329ccaf5c16239b3a2bb
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: f0a8916887168383a15ac9536a082d313a8d9bb2
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 4ba536a5a6c37810ba83490222655a71b370834f
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 4ef7a6c77e569735d4836df3319982f84d13ae32
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 32b03d0604d362ca3e7d30077f2440fe7fd4133c
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: eb8e41f8dbe6de127fb11baca725e1b469612434
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 6add85e4c46b8be383c8b637102d6b6fd206adce
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 6ea77ad552f9f9d8a61c44a82f158213c94b5daf
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 4443a11bef5688f0696adec08daf842a7069c5d1
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/nodejs/node/tree/00d6cd83927d6d5c8fe9d0cdd101daa6df4b1a15
    reference_type: commit
    reference_id: 00d6cd83927d6d5c8fe9d0cdd101daa6df4b1a15
  - url: https://github.com/nodejs/node/tree/1f49cd1d86977deca14aae108d8a98e470019baa
    reference_type: commit
    reference_id: 1f49cd1d86977deca14aae108d8a98e470019baa
  - url: https://github.com/nodejs/node/tree/1f7186e1e01d279022cab6acdecb119e472bb409
    reference_type: commit
    reference_id: 1f7186e1e01d279022cab6acdecb119e472bb409
  - url: https://github.com/nodejs/node/tree/1febc48d5b0bcf9070085589d9cc586d74053f9c
    reference_type: commit
    reference_id: 1febc48d5b0bcf9070085589d9cc586d74053f9c
  - url: https://github.com/nodejs/node/tree/32b03d0604d362ca3e7d30077f2440fe7fd4133c
    reference_type: commit
    reference_id: 32b03d0604d362ca3e7d30077f2440fe7fd4133c
  - url: https://github.com/nodejs/node/tree/4443a11bef5688f0696adec08daf842a7069c5d1
    reference_type: commit
    reference_id: 4443a11bef5688f0696adec08daf842a7069c5d1
  - url: https://github.com/nodejs/node/tree/4ba536a5a6c37810ba83490222655a71b370834f
    reference_type: commit
    reference_id: 4ba536a5a6c37810ba83490222655a71b370834f
  - url: https://github.com/nodejs/node/tree/4ef7a6c77e569735d4836df3319982f84d13ae32
    reference_type: commit
    reference_id: 4ef7a6c77e569735d4836df3319982f84d13ae32
  - url: https://github.com/nodejs/node/tree/64022d9fccc9624813a311444e87f2b2985acb22
    reference_type: commit
    reference_id: 64022d9fccc9624813a311444e87f2b2985acb22
  - url: https://github.com/nodejs/node/tree/6add85e4c46b8be383c8b637102d6b6fd206adce
    reference_type: commit
    reference_id: 6add85e4c46b8be383c8b637102d6b6fd206adce
  - url: https://github.com/nodejs/node/tree/6ea77ad552f9f9d8a61c44a82f158213c94b5daf
    reference_type: commit
    reference_id: 6ea77ad552f9f9d8a61c44a82f158213c94b5daf
  - url: https://github.com/nodejs/node/tree/7d421c8f29a48a5fe601329ccaf5c16239b3a2bb
    reference_type: commit
    reference_id: 7d421c8f29a48a5fe601329ccaf5c16239b3a2bb
  - url: https://github.com/nodejs/node/tree/def0bdf8abee441cfcbf793a8dc24a6f3b899573
    reference_type: commit
    reference_id: def0bdf8abee441cfcbf793a8dc24a6f3b899573
  - url: https://github.com/nodejs/node/tree/eb8e41f8dbe6de127fb11baca725e1b469612434
    reference_type: commit
    reference_id: eb8e41f8dbe6de127fb11baca725e1b469612434
  - url: https://github.com/nodejs/node/tree/f0a8916887168383a15ac9536a082d313a8d9bb2
    reference_type: commit
    reference_id: f0a8916887168383a15ac9536a082d313a8d9bb2
