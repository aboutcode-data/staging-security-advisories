advisory_id: CVE-2024-22018
datasource_id: collect_node_js_fix_commits/CVE-2024-22018
datasource_url: https://github.com/nodejs/node
aliases: []
summary: |
  b9289a6e29e54beeaa3f781bde1195e48df0da75:lib,permission: support fs.lstat

  PR-URL: https://github.com/nodejs-private/node-private/pull/486/
  Fixes: https://hackerone.com/bugs?subject=nodejs&report_id=2145862
  Reviewed-By: Yagiz Nizipli <yagiz.nizipli@sentry.io>
  Reviewed-By: Moshe Atlow <moshe@atlow.co.il>
  CVE-ID: CVE-2024-22018
  4fe0f826a80365ce2512b8193ceaa9466c288aa5:2024-07-08, Version 22.4.1 (Current)

  This is a security release.

  Notable changes:

  * CVE-2024-36138 - Bypass incomplete fix of CVE-2024-27980 (High)
  * CVE-2024-22020 - Bypass network import restriction via data URL (Medium)
  * CVE-2024-22018 - fs.lstat bypasses permission model (Low)
  * CVE-2024-36137 - fs.fchown/fchmod bypasses permission model (Low)
  * CVE-2024-37372 - Permission model improperly processes UNC paths (Low)

  PR-URL: https://github.com/nodejs-private/node-private/pull/617
  0881c1f01ac90006315cae5b9c38cfbf44d37e59:2024-07-08, Version 20.15.1 'Iron' (LTS)

  This is a security release.

  Notable changes:

  * CVE-2024-36138 - Bypass incomplete fix of CVE-2024-27980 (High)
  * CVE-2024-22020 - Bypass network import restriction via data URL (Medium)
  * CVE-2024-22018 - fs.lstat bypasses permission model (Low)
  * CVE-2024-36137 - fs.fchown/fchmod bypasses permission model (Low)
  * CVE-2024-37372 - Permission model improperly processes UNC paths (Low)

  PR-URL: https://github.com/nodejs-private/node-private/pull/608
  8512434d2beea2ca2fcb85d13175fa30a95ecf77:2024-07-08, Version 22.4.1 (Current)

  This is a security release.

  Notable changes:

  * CVE-2024-36138 - Bypass incomplete fix of CVE-2024-27980 (High)
  * CVE-2024-22020 - Bypass network import restriction via data URL (Medium)
  * CVE-2024-22018 - fs.lstat bypasses permission model (Low)
  * CVE-2024-36137 - fs.fchown/fchmod bypasses permission model (Low)
  * CVE-2024-37372 - Permission model improperly processes UNC paths (Low)

  PR-URL: https://github.com/nodejs-private/node-private/pull/617
  0a0de3d491150083afd294e3a8c2ef8073a890af:lib,permission: support fs.lstat

  PR-URL: https://github.com/nodejs-private/node-private/pull/486/
  Fixes: https://hackerone.com/bugs?subject=nodejs&report_id=2145862
  Reviewed-By: Yagiz Nizipli <yagiz.nizipli@sentry.io>
  Reviewed-By: Moshe Atlow <moshe@atlow.co.il>
  CVE-ID: CVE-2024-22018
  a407d1f0b3669cc82c755700f0d500fb27cc39ea:2024-07-08, Version 20.15.1 'Iron' (LTS)

  This is a security release.

  Notable changes:

  * CVE-2024-36138 - Bypass incomplete fix of CVE-2024-27980 (High)
  * CVE-2024-22020 - Bypass network import restriction via data URL (Medium)
  * CVE-2024-22018 - fs.lstat bypasses permission model (Low)
  * CVE-2024-36137 - fs.fchown/fchmod bypasses permission model (Low)
  * CVE-2024-37372 - Permission model improperly processes UNC paths (Low)

  PR-URL: https://github.com/nodejs-private/node-private/pull/608
  025cbd6936ce3df5375c2ec75d933eb7cb035f7b:lib,permission: support fs.lstat

  PR-URL: https://github.com/nodejs-private/node-private/pull/486
  Backport-PR-URL: https://github.com/nodejs-private/node-private/pull/604
  CVE-ID: CVE-2024-22018
impacted_packages:
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: b9289a6e29e54beeaa3f781bde1195e48df0da75
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 025cbd6936ce3df5375c2ec75d933eb7cb035f7b
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: a407d1f0b3669cc82c755700f0d500fb27cc39ea
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 0881c1f01ac90006315cae5b9c38cfbf44d37e59
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 0a0de3d491150083afd294e3a8c2ef8073a890af
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 8512434d2beea2ca2fcb85d13175fa30a95ecf77
    introduced_in_commits: []
  - purl: pkg:github/nodejs/node
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nodejs/node
        commit: 4fe0f826a80365ce2512b8193ceaa9466c288aa5
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/nodejs/node/tree/025cbd6936ce3df5375c2ec75d933eb7cb035f7b
    reference_type: commit
    reference_id: 025cbd6936ce3df5375c2ec75d933eb7cb035f7b
  - url: https://github.com/nodejs/node/tree/0881c1f01ac90006315cae5b9c38cfbf44d37e59
    reference_type: commit
    reference_id: 0881c1f01ac90006315cae5b9c38cfbf44d37e59
  - url: https://github.com/nodejs/node/tree/0a0de3d491150083afd294e3a8c2ef8073a890af
    reference_type: commit
    reference_id: 0a0de3d491150083afd294e3a8c2ef8073a890af
  - url: https://github.com/nodejs/node/tree/4fe0f826a80365ce2512b8193ceaa9466c288aa5
    reference_type: commit
    reference_id: 4fe0f826a80365ce2512b8193ceaa9466c288aa5
  - url: https://github.com/nodejs/node/tree/8512434d2beea2ca2fcb85d13175fa30a95ecf77
    reference_type: commit
    reference_id: 8512434d2beea2ca2fcb85d13175fa30a95ecf77
  - url: https://github.com/nodejs/node/tree/a407d1f0b3669cc82c755700f0d500fb27cc39ea
    reference_type: commit
    reference_id: a407d1f0b3669cc82c755700f0d500fb27cc39ea
  - url: https://github.com/nodejs/node/tree/b9289a6e29e54beeaa3f781bde1195e48df0da75
    reference_type: commit
    reference_id: b9289a6e29e54beeaa3f781bde1195e48df0da75
