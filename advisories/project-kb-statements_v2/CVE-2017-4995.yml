advisory_id: CVE-2017-4995
datasource_id: project-kb-statements_v2/CVE-2017-4995
datasource_url: https://github.com/SAP/project-kb/blob/vulnerability-data/statements/CVE-2017-4995/statement.yaml
aliases: []
summary: 'An issue was discovered in Pivotal Spring Security 4.2.0.RELEASE through 4.2.2.RELEASE,
  and Spring Security 5.0.0.M1. When configured to enable default typing, Jackson contained
  a deserialization vulnerability that could lead to arbitrary code execution. Jackson fixed
  this vulnerability by blacklisting known "deserialization gadgets." Spring Security configures
  Jackson with global default typing enabled, which means that (through the previous exploit)
  arbitrary code could be executed if all of the following is true: (1) Spring Security''s Jackson
  support is being leveraged by invoking SecurityJackson2Modules.getModules(ClassLoader) or
  SecurityJackson2Modules.enableDefaultTyping(ObjectMapper); (2) Jackson is used to deserialize
  data that is not trusted (Spring Security does not perform deserialization using Jackson,
  so this is an explicit choice of the user); and (3) there is an unknown (Jackson is not blacklisting
  it already) "deserialization gadget" that allows code execution present on the classpath.
  Jackson provides a blacklisting approach to protecting against this type of attack, but Spring
  Security should be proactive against blocking unknown "deserialization gadgets" when Spring
  Security enables default typing.'
impacted_packages:
  - purl: pkg:github/spring-projects/spring-security
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/spring-projects/spring-security
        commit: 5dee8534cd1b92952d10cc56335b5d5856f48f3b
    introduced_in_commits: []
  - purl: pkg:github/spring-projects/spring-security
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/spring-projects/spring-security
        commit: 947d11f433b78294942cb5ea56e8aa5c3a0ca43
    introduced_in_commits: []
  - purl: pkg:maven/org.springframework.security/spring-security-core
    affected_versions: vers:maven/4.2.1.RELEASE|4.2.2.RELEASE
    fixed_versions: vers:maven/3.0.7.RELEASE|3.1.1.RELEASE|3.1.2.RELEASE|3.2.0.RELEASE|3.2.3.RELEASE|3.2.4.RELEASE|3.2.5.RELEASE|3.2.6.RELEASE|3.2.7.RELEASE|3.2.8.RELEASE|3.2.9.RELEASE|3.2.10.RELEASE|4.0.0.RELEASE|4.0.2.RELEASE|4.0.3.RELEASE|4.0.4.RELEASE|4.1.0.RELEASE|4.1.1.RELEASE|4.1.2.RELEASE|4.1.3.RELEASE|4.1.4.RELEASE|4.1.5.RELEASE|4.2.3.RELEASE|4.2.4.RELEASE|4.2.4.RELEASE|4.2.5.RELEASE|4.2.6.RELEASE|4.2.7.RELEASE|4.2.8.RELEASE|4.2.8.RELEASE|4.2.9.RELEASE|4.2.10.RELEASE|4.2.11.RELEASE|4.2.12.RELEASE|4.2.13.RELEASE|4.2.14.RELEASE|4.2.15.RELEASE|4.2.16.RELEASE|4.2.17.RELEASE|4.2.18.RELEASE|4.2.19.RELEASE|4.2.20.RELEASE|5.0.0.RELEASE|5.0.3.RELEASE|5.0.4.RELEASE|5.0.5.RELEASE|5.0.6.RELEASE|5.0.7.RELEASE|5.0.8.RELEASE|5.0.9.RELEASE|5.0.10.RELEASE|5.0.11.RELEASE|5.0.12.RELEASE|5.0.12.RELEASE|5.0.13.RELEASE|5.0.15.RELEASE|5.0.16.RELEASE|5.0.19.RELEASE|5.1.0.RELEASE|5.1.1.RELEASE|5.1.2.RELEASE|5.1.3.RELEASE|5.1.4.RELEASE|5.1.5.RELEASE|5.1.6.RELEASE|5.1.7.RELEASE|5.1.8.RELEASE|5.1.9.RELEASE|5.1.10.RELEASE|5.1.11.RELEASE|5.1.12.RELEASE|5.1.13.RELEASE|5.2.0.RELEASE|5.2.1.RELEASE|5.2.2.RELEASE|5.2.3.RELEASE|5.2.4.RELEASE|5.2.5.RELEASE|5.2.6.RELEASE|5.2.7.RELEASE|5.2.8.RELEASE|5.3.0.RELEASE|5.3.1.RELEASE|5.3.2.RELEASE|5.3.3.RELEASE|5.3.4.RELEASE|5.3.5.RELEASE|5.3.6.RELEASE
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.apache.servicemix.bundles/org.apache.servicemix.bundles.spring-security-core
    affected_versions:
    fixed_versions: vers:maven/4.2.4.RELEASE_1
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://pivotal.io/security/cve-2017-4995
    reference_type:
    reference_id:
