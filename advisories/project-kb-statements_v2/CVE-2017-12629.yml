advisory_id: CVE-2017-12629
datasource_id: project-kb-statements_v2/CVE-2017-12629
datasource_url: https://github.com/SAP/project-kb/blob/vulnerability-data/statements/CVE-2017-12629/statement.yaml
aliases: []
summary: Remote code execution occurs in Apache Solr before 7.1 with Apache Lucene before 7.1
  by exploiting XXE in conjunction with use of a Config API add-listener command to reach the
  RunExecutableListener class. Elasticsearch, although it uses Lucene, is NOT vulnerable to
  this. Note that the XML external entity expansion vulnerability occurs in the XML Query Parser
  which is available, by default, for any query request with parameters deftype=xmlparser and
  can be exploited to upload malicious data to the /upload request handler or as Blind XXE using
  ftp wrapper in order to read arbitrary local files from the Solr server. Note also that the
  second vulnerability relates to remote code execution using the RunExecutableListener available
  on all affected versions of Solr.
impacted_packages:
  - purl: pkg:github/apache/lucene-solr
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/apache/lucene-solr
        commit: 926cc4d65b6d2cc40ff07f76d50ddeda947e3cc
    introduced_in_commits: []
  - purl: pkg:github/apache/lucene-solr
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/apache/lucene-solr
        commit: d28baa3fc5566b47f1ca7cc2ba1aba658dc634a
    introduced_in_commits: []
  - purl: pkg:github/apache/lucene-solr
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/apache/lucene-solr
        commit: d8000beebfb13ba0b6e754f84c760e11592d8d1
    introduced_in_commits: []
  - purl: pkg:github/apache/lucene-solr
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/apache/lucene-solr
        commit: f9fd6e9e26224f26f1542224ce187e04c27b268
    introduced_in_commits: []
  - purl: pkg:github/apache/lucene-solr
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/apache/lucene-solr
        commit: 3bba91131b5257e64b9d0a2193e1e32a145b2a2
    introduced_in_commits: []
  - purl: pkg:maven/org.apache.lucene/lucene-queryparser
    affected_versions: vers:maven/4.0.0|4.5.1|4.6.1|4.7.2|4.10.2|4.10.3|4.10.4|5.2.1|5.3.2|5.4.1|5.5.0|5.5.2|5.5.4|6.1.0|6.2.0|6.2.1|6.3.0|6.4.1|6.4.2|6.6.0|6.6.1|7.0.1
    fixed_versions: vers:maven/5.5.5|6.6.2|6.6.5|7.1.0|7.2.1|7.3.0|7.4.0|7.5.0|7.7.0|7.7.1|7.7.2|8.0.0|8.1.1|8.2.0|8.3.0|8.4.0|8.5.1|8.6.0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.apache.solr/solr-core
    affected_versions:
    fixed_versions: vers:maven/7.7.1|8.0.0|8.2.0|8.3.0|8.4.0|8.5.1
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:maven/org.infinispan/infinispan-embedded-query
    affected_versions:
    fixed_versions: vers:maven/9.1.7.Final
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references: []
