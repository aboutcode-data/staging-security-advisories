advisory_id: CVE-2018-11786
datasource_id: project-kb-statements_v2/CVE-2018-11786
datasource_url: https://github.com/SAP/project-kb/blob/vulnerability-data/statements/CVE-2018-11786/statement.yaml
aliases: []
summary: In Apache Karaf prior to 4.2.0 release, if the sshd service in Karaf is left on so
  an administrator can manage the running instance, any user with rights to the Karaf console
  can pivot and read/write any file on the file system to which the Karaf process user has access.
  This can be locked down a bit by using chroot to change the root directory to protect files
  outside of the Karaf install directory; it can be further locked down by defining a security
  manager policy that limits file system access to those directories beneath the Karaf home
  that are necessary for the system to run. However, this still allows anyone with ssh access
  to the Karaf process to read and write a large number of files as the Karaf process user.
impacted_packages:
  - purl: pkg:github/apache/karaf
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/apache/karaf
        commit: 24fb477ea886e8f294dedbad98d2a2c4cb2a44f9
    introduced_in_commits: []
  - purl: pkg:maven/org.apache.karaf.shell/org.apache.karaf.shell.core
    affected_versions: vers:maven/4.0.3|4.0.9
    fixed_versions: vers:maven/4.2.0.M2|4.2.1|4.2.3|4.2.6|4.2.7|4.2.8
    fixed_in_commits: []
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://issues.apache.org/jira/browse/KARAF-5427
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread.html/5b7ac762c6bbe77ac5d9389f093fc6dbf196c36d788e3d7629e6c1d9@%3Cdev.karaf.apache.org%3E
    reference_type:
    reference_id:
  - url: https://snyk.io/vuln/SNYK-JAVA-ORGAPACHEKARAFSHELL-72392
    reference_type:
    reference_id:
