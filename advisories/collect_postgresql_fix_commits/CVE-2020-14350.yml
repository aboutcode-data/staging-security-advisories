advisory_id: CVE-2020-14350
datasource_id: collect_postgresql_fix_commits/CVE-2020-14350
datasource_url: https://github.com/postgres/postgres
aliases: []
summary: |
  2e0358752da35d9c3496a5b448983d0ebd0ed9d9:Last-minute updates for release notes.

  Security: CVE-2020-14349, CVE-2020-14350
  a7e51a407658c65b3c3458bbbbff6c46a3c182b2:Last-minute updates for release notes.

  Security: CVE-2020-14349, CVE-2020-14350
  d3aa1d4f48a49533cd3ea1dc845aefad89b60065:Last-minute updates for release notes.

  Security: CVE-2020-14349, CVE-2020-14350
  6f57b9bf39283b89808c45da360c748ab29535c6:Last-minute updates for release notes.

  Security: CVE-2020-14349, CVE-2020-14350
  f9ddc36ed676eb008f7392608fe250387968685e:Last-minute updates for release notes.

  Security: CVE-2020-14349, CVE-2020-14350
  6b11a46878523c5ebbc2dbd0428f11b8188791d5:Make contrib modules' installation scripts more secure.

  Hostile objects located within the installation-time search_path could
  capture references in an extension's installation or upgrade script.
  If the extension is being installed with superuser privileges, this
  opens the door to privilege escalation.  While such hazards have existed
  all along, their urgency increases with the v13 "trusted extensions"
  feature, because that lets a non-superuser control the installation path
  for a superuser-privileged script.  Therefore, make a number of changes
  to make such situations more secure:

  * Tweak the construction of the installation-time search_path to ensure
  that references to objects in pg_catalog can't be subverted; and
  explicitly add pg_temp to the end of the path to prevent attacks using
  temporary objects.

  * Disable check_function_bodies within installation/upgrade scripts,
  so that any security gaps in SQL-language or PL-language function bodies
  cannot create a risk of unwanted installation-time code execution.

  * Adjust lookup of type input/receive functions and join estimator
  functions to complain if there are multiple candidate functions.  This
  prevents capture of references to functions whose signature is not the
  first one checked; and it's arguably more user-friendly anyway.

  * Modify various contrib upgrade scripts to ensure that catalog
  modification queries are executed with secure search paths.  (These
  are in-place modifications with no extension version changes, since
  it is the update process itself that is at issue, not the end result.)

  Extensions that depend on other extensions cannot be made fully secure
  by these methods alone; therefore, revert the "trusted" marking that
  commit eb67623c9 applied to earthdistance and hstore_plperl, pending
  some better solution to that set of issues.

  Also add documentation around these issues, to help extension authors
  write secure installation scripts.

  Patch by me, following an observation by Andres Freund; thanks
  to Noah Misch for review.

  Security: CVE-2020-14350
  2ea8a60fc4d9576c75930f09948a71bddd266d52:Make contrib modules' installation scripts more secure.

  Hostile objects located within the installation-time search_path could
  capture references in an extension's installation or upgrade script.
  If the extension is being installed with superuser privileges, this
  opens the door to privilege escalation.  While such hazards have existed
  all along, their urgency increases with the v13 "trusted extensions"
  feature, because that lets a non-superuser control the installation path
  for a superuser-privileged script.  Therefore, make a number of changes
  to make such situations more secure:

  * Tweak the construction of the installation-time search_path to ensure
  that references to objects in pg_catalog can't be subverted; and
  explicitly add pg_temp to the end of the path to prevent attacks using
  temporary objects.

  * Disable check_function_bodies within installation/upgrade scripts,
  so that any security gaps in SQL-language or PL-language function bodies
  cannot create a risk of unwanted installation-time code execution.

  * Adjust lookup of type input/receive functions and join estimator
  functions to complain if there are multiple candidate functions.  This
  prevents capture of references to functions whose signature is not the
  first one checked; and it's arguably more user-friendly anyway.

  * Modify various contrib upgrade scripts to ensure that catalog
  modification queries are executed with secure search paths.  (These
  are in-place modifications with no extension version changes, since
  it is the update process itself that is at issue, not the end result.)

  Extensions that depend on other extensions cannot be made fully secure
  by these methods alone; therefore, revert the "trusted" marking that
  commit eb67623c9 applied to earthdistance and hstore_plperl, pending
  some better solution to that set of issues.

  Also add documentation around these issues, to help extension authors
  write secure installation scripts.

  Patch by me, following an observation by Andres Freund; thanks
  to Noah Misch for review.

  Security: CVE-2020-14350
  96cbfe92d7f0ab5961c75af4d8e71d2f2aecba17:Make contrib modules' installation scripts more secure.

  Hostile objects located within the installation-time search_path could
  capture references in an extension's installation or upgrade script.
  If the extension is being installed with superuser privileges, this
  opens the door to privilege escalation.  While such hazards have existed
  all along, their urgency increases with the v13 "trusted extensions"
  feature, because that lets a non-superuser control the installation path
  for a superuser-privileged script.  Therefore, make a number of changes
  to make such situations more secure:

  * Tweak the construction of the installation-time search_path to ensure
  that references to objects in pg_catalog can't be subverted; and
  explicitly add pg_temp to the end of the path to prevent attacks using
  temporary objects.

  * Disable check_function_bodies within installation/upgrade scripts,
  so that any security gaps in SQL-language or PL-language function bodies
  cannot create a risk of unwanted installation-time code execution.

  * Adjust lookup of type input/receive functions and join estimator
  functions to complain if there are multiple candidate functions.  This
  prevents capture of references to functions whose signature is not the
  first one checked; and it's arguably more user-friendly anyway.

  * Modify various contrib upgrade scripts to ensure that catalog
  modification queries are executed with secure search paths.  (These
  are in-place modifications with no extension version changes, since
  it is the update process itself that is at issue, not the end result.)

  Extensions that depend on other extensions cannot be made fully secure
  by these methods alone; therefore, revert the "trusted" marking that
  commit eb67623c9 applied to earthdistance and hstore_plperl, pending
  some better solution to that set of issues.

  Also add documentation around these issues, to help extension authors
  write secure installation scripts.

  Patch by me, following an observation by Andres Freund; thanks
  to Noah Misch for review.

  Security: CVE-2020-14350
  afa358786bde70d9cccc0e32f6fad45afe62c3e5:Make contrib modules' installation scripts more secure.

  Hostile objects located within the installation-time search_path could
  capture references in an extension's installation or upgrade script.
  If the extension is being installed with superuser privileges, this
  opens the door to privilege escalation.  While such hazards have existed
  all along, their urgency increases with the v13 "trusted extensions"
  feature, because that lets a non-superuser control the installation path
  for a superuser-privileged script.  Therefore, make a number of changes
  to make such situations more secure:

  * Tweak the construction of the installation-time search_path to ensure
  that references to objects in pg_catalog can't be subverted; and
  explicitly add pg_temp to the end of the path to prevent attacks using
  temporary objects.

  * Disable check_function_bodies within installation/upgrade scripts,
  so that any security gaps in SQL-language or PL-language function bodies
  cannot create a risk of unwanted installation-time code execution.

  * Adjust lookup of type input/receive functions and join estimator
  functions to complain if there are multiple candidate functions.  This
  prevents capture of references to functions whose signature is not the
  first one checked; and it's arguably more user-friendly anyway.

  * Modify various contrib upgrade scripts to ensure that catalog
  modification queries are executed with secure search paths.  (These
  are in-place modifications with no extension version changes, since
  it is the update process itself that is at issue, not the end result.)

  Extensions that depend on other extensions cannot be made fully secure
  by these methods alone; therefore, revert the "trusted" marking that
  commit eb67623c9 applied to earthdistance and hstore_plperl, pending
  some better solution to that set of issues.

  Also add documentation around these issues, to help extension authors
  write secure installation scripts.

  Patch by me, following an observation by Andres Freund; thanks
  to Noah Misch for review.

  Security: CVE-2020-14350
  98ca64899cec6a4bf3099481aff43b8777319c41:Make contrib modules' installation scripts more secure.

  Hostile objects located within the installation-time search_path could
  capture references in an extension's installation or upgrade script.
  If the extension is being installed with superuser privileges, this
  opens the door to privilege escalation.  While such hazards have existed
  all along, their urgency increases with the v13 "trusted extensions"
  feature, because that lets a non-superuser control the installation path
  for a superuser-privileged script.  Therefore, make a number of changes
  to make such situations more secure:

  * Tweak the construction of the installation-time search_path to ensure
  that references to objects in pg_catalog can't be subverted; and
  explicitly add pg_temp to the end of the path to prevent attacks using
  temporary objects.

  * Disable check_function_bodies within installation/upgrade scripts,
  so that any security gaps in SQL-language or PL-language function bodies
  cannot create a risk of unwanted installation-time code execution.

  * Adjust lookup of type input/receive functions and join estimator
  functions to complain if there are multiple candidate functions.  This
  prevents capture of references to functions whose signature is not the
  first one checked; and it's arguably more user-friendly anyway.

  * Modify various contrib upgrade scripts to ensure that catalog
  modification queries are executed with secure search paths.  (These
  are in-place modifications with no extension version changes, since
  it is the update process itself that is at issue, not the end result.)

  Extensions that depend on other extensions cannot be made fully secure
  by these methods alone; therefore, revert the "trusted" marking that
  commit eb67623c9 applied to earthdistance and hstore_plperl, pending
  some better solution to that set of issues.

  Also add documentation around these issues, to help extension authors
  write secure installation scripts.

  Patch by me, following an observation by Andres Freund; thanks
  to Noah Misch for review.

  Security: CVE-2020-14350
  3ba96708470a2c55c018fcb9ba2cb0f4c51a6d55:Make contrib modules' installation scripts more secure.

  Hostile objects located within the installation-time search_path could
  capture references in an extension's installation or upgrade script.
  If the extension is being installed with superuser privileges, this
  opens the door to privilege escalation.  While such hazards have existed
  all along, their urgency increases with the v13 "trusted extensions"
  feature, because that lets a non-superuser control the installation path
  for a superuser-privileged script.  Therefore, make a number of changes
  to make such situations more secure:

  * Tweak the construction of the installation-time search_path to ensure
  that references to objects in pg_catalog can't be subverted; and
  explicitly add pg_temp to the end of the path to prevent attacks using
  temporary objects.

  * Disable check_function_bodies within installation/upgrade scripts,
  so that any security gaps in SQL-language or PL-language function bodies
  cannot create a risk of unwanted installation-time code execution.

  * Adjust lookup of type input/receive functions and join estimator
  functions to complain if there are multiple candidate functions.  This
  prevents capture of references to functions whose signature is not the
  first one checked; and it's arguably more user-friendly anyway.

  * Modify various contrib upgrade scripts to ensure that catalog
  modification queries are executed with secure search paths.  (These
  are in-place modifications with no extension version changes, since
  it is the update process itself that is at issue, not the end result.)

  Extensions that depend on other extensions cannot be made fully secure
  by these methods alone; therefore, revert the "trusted" marking that
  commit eb67623c9 applied to earthdistance and hstore_plperl, pending
  some better solution to that set of issues.

  Also add documentation around these issues, to help extension authors
  write secure installation scripts.

  Patch by me, following an observation by Andres Freund; thanks
  to Noah Misch for review.

  Security: CVE-2020-14350
  7eeb1d9861b0a3f453f8b31c7648396cdd7f1e59:Make contrib modules' installation scripts more secure.

  Hostile objects located within the installation-time search_path could
  capture references in an extension's installation or upgrade script.
  If the extension is being installed with superuser privileges, this
  opens the door to privilege escalation.  While such hazards have existed
  all along, their urgency increases with the v13 "trusted extensions"
  feature, because that lets a non-superuser control the installation path
  for a superuser-privileged script.  Therefore, make a number of changes
  to make such situations more secure:

  * Tweak the construction of the installation-time search_path to ensure
  that references to objects in pg_catalog can't be subverted; and
  explicitly add pg_temp to the end of the path to prevent attacks using
  temporary objects.

  * Disable check_function_bodies within installation/upgrade scripts,
  so that any security gaps in SQL-language or PL-language function bodies
  cannot create a risk of unwanted installation-time code execution.

  * Adjust lookup of type input/receive functions and join estimator
  functions to complain if there are multiple candidate functions.  This
  prevents capture of references to functions whose signature is not the
  first one checked; and it's arguably more user-friendly anyway.

  * Modify various contrib upgrade scripts to ensure that catalog
  modification queries are executed with secure search paths.  (These
  are in-place modifications with no extension version changes, since
  it is the update process itself that is at issue, not the end result.)

  Extensions that depend on other extensions cannot be made fully secure
  by these methods alone; therefore, revert the "trusted" marking that
  commit eb67623c9 applied to earthdistance and hstore_plperl, pending
  some better solution to that set of issues.

  Also add documentation around these issues, to help extension authors
  write secure installation scripts.

  Patch by me, following an observation by Andres Freund; thanks
  to Noah Misch for review.

  Security: CVE-2020-14350
impacted_packages:
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 2e0358752da35d9c3496a5b448983d0ebd0ed9d9
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: d3aa1d4f48a49533cd3ea1dc845aefad89b60065
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: a7e51a407658c65b3c3458bbbbff6c46a3c182b2
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 6b11a46878523c5ebbc2dbd0428f11b8188791d5
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 96cbfe92d7f0ab5961c75af4d8e71d2f2aecba17
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 6f57b9bf39283b89808c45da360c748ab29535c6
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 3ba96708470a2c55c018fcb9ba2cb0f4c51a6d55
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 2ea8a60fc4d9576c75930f09948a71bddd266d52
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 98ca64899cec6a4bf3099481aff43b8777319c41
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 7eeb1d9861b0a3f453f8b31c7648396cdd7f1e59
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: f9ddc36ed676eb008f7392608fe250387968685e
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: afa358786bde70d9cccc0e32f6fad45afe62c3e5
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/postgres/postgres/tree/2e0358752da35d9c3496a5b448983d0ebd0ed9d9
    reference_type: commit
    reference_id: 2e0358752da35d9c3496a5b448983d0ebd0ed9d9
  - url: https://github.com/postgres/postgres/tree/2ea8a60fc4d9576c75930f09948a71bddd266d52
    reference_type: commit
    reference_id: 2ea8a60fc4d9576c75930f09948a71bddd266d52
  - url: https://github.com/postgres/postgres/tree/3ba96708470a2c55c018fcb9ba2cb0f4c51a6d55
    reference_type: commit
    reference_id: 3ba96708470a2c55c018fcb9ba2cb0f4c51a6d55
  - url: https://github.com/postgres/postgres/tree/6b11a46878523c5ebbc2dbd0428f11b8188791d5
    reference_type: commit
    reference_id: 6b11a46878523c5ebbc2dbd0428f11b8188791d5
  - url: https://github.com/postgres/postgres/tree/6f57b9bf39283b89808c45da360c748ab29535c6
    reference_type: commit
    reference_id: 6f57b9bf39283b89808c45da360c748ab29535c6
  - url: https://github.com/postgres/postgres/tree/7eeb1d9861b0a3f453f8b31c7648396cdd7f1e59
    reference_type: commit
    reference_id: 7eeb1d9861b0a3f453f8b31c7648396cdd7f1e59
  - url: https://github.com/postgres/postgres/tree/96cbfe92d7f0ab5961c75af4d8e71d2f2aecba17
    reference_type: commit
    reference_id: 96cbfe92d7f0ab5961c75af4d8e71d2f2aecba17
  - url: https://github.com/postgres/postgres/tree/98ca64899cec6a4bf3099481aff43b8777319c41
    reference_type: commit
    reference_id: 98ca64899cec6a4bf3099481aff43b8777319c41
  - url: https://github.com/postgres/postgres/tree/a7e51a407658c65b3c3458bbbbff6c46a3c182b2
    reference_type: commit
    reference_id: a7e51a407658c65b3c3458bbbbff6c46a3c182b2
  - url: https://github.com/postgres/postgres/tree/afa358786bde70d9cccc0e32f6fad45afe62c3e5
    reference_type: commit
    reference_id: afa358786bde70d9cccc0e32f6fad45afe62c3e5
  - url: https://github.com/postgres/postgres/tree/d3aa1d4f48a49533cd3ea1dc845aefad89b60065
    reference_type: commit
    reference_id: d3aa1d4f48a49533cd3ea1dc845aefad89b60065
  - url: https://github.com/postgres/postgres/tree/f9ddc36ed676eb008f7392608fe250387968685e
    reference_type: commit
    reference_id: f9ddc36ed676eb008f7392608fe250387968685e
