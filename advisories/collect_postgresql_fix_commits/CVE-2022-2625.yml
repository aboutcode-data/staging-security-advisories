advisory_id: CVE-2022-2625
datasource_id: collect_postgresql_fix_commits/CVE-2022-2625
datasource_url: https://github.com/postgres/postgres
aliases: []
summary: |
  2d7d8f4397c5855e9159c05a2afb131c34282a8f:Stabilize output of new regression test.

  Per buildfarm, the output order of \dx+ isn't consistent across
  locales.  Apply NO_LOCALE to force C locale.  There might be a
  more localized way, but I'm not seeing it offhand, and anyway
  there is nothing in this test module that particularly cares
  about locales.

  Security: CVE-2022-2625
  4c1dd680267f0bc56de8fb2a138aa556054f9886:Stabilize output of new regression test.

  Per buildfarm, the output order of \dx+ isn't consistent across
  locales.  Apply NO_LOCALE to force C locale.  There might be a
  more localized way, but I'm not seeing it offhand, and anyway
  there is nothing in this test module that particularly cares
  about locales.

  Security: CVE-2022-2625
  dfab37100de1127595b4f1f6949137bfea355c22:Stabilize output of new regression test.

  Per buildfarm, the output order of \dx+ isn't consistent across
  locales.  Apply NO_LOCALE to force C locale.  There might be a
  more localized way, but I'm not seeing it offhand, and anyway
  there is nothing in this test module that particularly cares
  about locales.

  Security: CVE-2022-2625
  22b205cbbd978e69f08bd2b980adae29a6ca1979:Stabilize output of new regression test.

  Per buildfarm, the output order of \dx+ isn't consistent across
  locales.  Apply NO_LOCALE to force C locale.  There might be a
  more localized way, but I'm not seeing it offhand, and anyway
  there is nothing in this test module that particularly cares
  about locales.

  Security: CVE-2022-2625
  c0d5d52a780fb575d8f93d0b1a8ef8cb43851a84:Stabilize output of new regression test.

  Per buildfarm, the output order of \dx+ isn't consistent across
  locales.  Apply NO_LOCALE to force C locale.  There might be a
  more localized way, but I'm not seeing it offhand, and anyway
  there is nothing in this test module that particularly cares
  about locales.

  Security: CVE-2022-2625
  2a4d82aadf8c3c2cf7f586c6ba2766f9bd2ba657:Stabilize output of new regression test.

  Per buildfarm, the output order of \dx+ isn't consistent across
  locales.  Apply NO_LOCALE to force C locale.  There might be a
  more localized way, but I'm not seeing it offhand, and anyway
  there is nothing in this test module that particularly cares
  about locales.

  Security: CVE-2022-2625
  71cac850d02f2ad46aca00d3852574bd48fb581a:Stabilize output of new regression test.

  Per buildfarm, the output order of \dx+ isn't consistent across
  locales.  Apply NO_LOCALE to force C locale.  There might be a
  more localized way, but I'm not seeing it offhand, and anyway
  there is nothing in this test module that particularly cares
  about locales.

  Security: CVE-2022-2625
  cd1aef2972ed0b4aafc18c58495cc7e62eebc4c8:Last-minute updates for release notes.

  Security: CVE-2022-2625
  197671018875d278db7075f604eca02b42a33c3e:Last-minute updates for release notes.

  Security: CVE-2022-2625
  a2398bf8b6413338faeb75cbb40a347be0741972:Last-minute updates for release notes.

  Security: CVE-2022-2625
  30523c0ca1186476674d2874754cf218627e9de2:Last-minute updates for release notes.

  Security: CVE-2022-2625
  ea2917ca905b7a669cc9d90c3b0e4539667a15a4:Last-minute updates for release notes.

  Security: CVE-2022-2625
  cc7e0feba51b4aeb0adf9bdac659f83e9986b90d:In extensions, don't replace objects not belonging to the extension.

  Previously, if an extension script did CREATE OR REPLACE and there was
  an existing object not belonging to the extension, it would overwrite
  the object and adopt it into the extension.  This is problematic, first
  because the overwrite is probably unintentional, and second because we
  didn't change the object's ownership.  Thus a hostile user could create
  an object in advance of an expected CREATE EXTENSION command, and would
  then have ownership rights on an extension object, which could be
  modified for trojan-horse-type attacks.

  Hence, forbid CREATE OR REPLACE of an existing object unless it already
  belongs to the extension.  (Note that we've always forbidden replacing
  an object that belongs to some other extension; only the behavior for
  previously-free-standing objects changes here.)

  For the same reason, also fail CREATE IF NOT EXISTS when there is
  an existing object that doesn't belong to the extension.

  Our thanks to Sven Klemm for reporting this problem.

  Security: CVE-2022-2625
  b9b21acc766db54d8c337d508d0fe2f5bf2daab0:In extensions, don't replace objects not belonging to the extension.

  Previously, if an extension script did CREATE OR REPLACE and there was
  an existing object not belonging to the extension, it would overwrite
  the object and adopt it into the extension.  This is problematic, first
  because the overwrite is probably unintentional, and second because we
  didn't change the object's ownership.  Thus a hostile user could create
  an object in advance of an expected CREATE EXTENSION command, and would
  then have ownership rights on an extension object, which could be
  modified for trojan-horse-type attacks.

  Hence, forbid CREATE OR REPLACE of an existing object unless it already
  belongs to the extension.  (Note that we've always forbidden replacing
  an object that belongs to some other extension; only the behavior for
  previously-free-standing objects changes here.)

  For the same reason, also fail CREATE IF NOT EXISTS when there is
  an existing object that doesn't belong to the extension.

  Our thanks to Sven Klemm for reporting this problem.

  Security: CVE-2022-2625
  5919bb5a5989cda232ac3d1f8b9d90f337be2077:In extensions, don't replace objects not belonging to the extension.

  Previously, if an extension script did CREATE OR REPLACE and there was
  an existing object not belonging to the extension, it would overwrite
  the object and adopt it into the extension.  This is problematic, first
  because the overwrite is probably unintentional, and second because we
  didn't change the object's ownership.  Thus a hostile user could create
  an object in advance of an expected CREATE EXTENSION command, and would
  then have ownership rights on an extension object, which could be
  modified for trojan-horse-type attacks.

  Hence, forbid CREATE OR REPLACE of an existing object unless it already
  belongs to the extension.  (Note that we've always forbidden replacing
  an object that belongs to some other extension; only the behavior for
  previously-free-standing objects changes here.)

  For the same reason, also fail CREATE IF NOT EXISTS when there is
  an existing object that doesn't belong to the extension.

  Our thanks to Sven Klemm for reporting this problem.

  Security: CVE-2022-2625
  f52d2fbd8c62f667191b61228acf9d8aa53607b9:In extensions, don't replace objects not belonging to the extension.

  Previously, if an extension script did CREATE OR REPLACE and there was
  an existing object not belonging to the extension, it would overwrite
  the object and adopt it into the extension.  This is problematic, first
  because the overwrite is probably unintentional, and second because we
  didn't change the object's ownership.  Thus a hostile user could create
  an object in advance of an expected CREATE EXTENSION command, and would
  then have ownership rights on an extension object, which could be
  modified for trojan-horse-type attacks.

  Hence, forbid CREATE OR REPLACE of an existing object unless it already
  belongs to the extension.  (Note that we've always forbidden replacing
  an object that belongs to some other extension; only the behavior for
  previously-free-standing objects changes here.)

  For the same reason, also fail CREATE IF NOT EXISTS when there is
  an existing object that doesn't belong to the extension.

  Our thanks to Sven Klemm for reporting this problem.

  Security: CVE-2022-2625
  5579726bd60a6e7afb04a3548bced348cd5ffd89:In extensions, don't replace objects not belonging to the extension.

  Previously, if an extension script did CREATE OR REPLACE and there was
  an existing object not belonging to the extension, it would overwrite
  the object and adopt it into the extension.  This is problematic, first
  because the overwrite is probably unintentional, and second because we
  didn't change the object's ownership.  Thus a hostile user could create
  an object in advance of an expected CREATE EXTENSION command, and would
  then have ownership rights on an extension object, which could be
  modified for trojan-horse-type attacks.

  Hence, forbid CREATE OR REPLACE of an existing object unless it already
  belongs to the extension.  (Note that we've always forbidden replacing
  an object that belongs to some other extension; only the behavior for
  previously-free-standing objects changes here.)

  For the same reason, also fail CREATE IF NOT EXISTS when there is
  an existing object that doesn't belong to the extension.

  Our thanks to Sven Klemm for reporting this problem.

  Security: CVE-2022-2625
  7e92f78abe80e4b30e648a40073abb59057e21f8:In extensions, don't replace objects not belonging to the extension.

  Previously, if an extension script did CREATE OR REPLACE and there was
  an existing object not belonging to the extension, it would overwrite
  the object and adopt it into the extension.  This is problematic, first
  because the overwrite is probably unintentional, and second because we
  didn't change the object's ownership.  Thus a hostile user could create
  an object in advance of an expected CREATE EXTENSION command, and would
  then have ownership rights on an extension object, which could be
  modified for trojan-horse-type attacks.

  Hence, forbid CREATE OR REPLACE of an existing object unless it already
  belongs to the extension.  (Note that we've always forbidden replacing
  an object that belongs to some other extension; only the behavior for
  previously-free-standing objects changes here.)

  For the same reason, also fail CREATE IF NOT EXISTS when there is
  an existing object that doesn't belong to the extension.

  Our thanks to Sven Klemm for reporting this problem.

  Security: CVE-2022-2625
  5721da7e41e7a280587bda29cd1674c7da3317f8:In extensions, don't replace objects not belonging to the extension.

  Previously, if an extension script did CREATE OR REPLACE and there was
  an existing object not belonging to the extension, it would overwrite
  the object and adopt it into the extension.  This is problematic, first
  because the overwrite is probably unintentional, and second because we
  didn't change the object's ownership.  Thus a hostile user could create
  an object in advance of an expected CREATE EXTENSION command, and would
  then have ownership rights on an extension object, which could be
  modified for trojan-horse-type attacks.

  Hence, forbid CREATE OR REPLACE of an existing object unless it already
  belongs to the extension.  (Note that we've always forbidden replacing
  an object that belongs to some other extension; only the behavior for
  previously-free-standing objects changes here.)

  For the same reason, also fail CREATE IF NOT EXISTS when there is
  an existing object that doesn't belong to the extension.

  Our thanks to Sven Klemm for reporting this problem.

  Security: CVE-2022-2625
impacted_packages:
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 22b205cbbd978e69f08bd2b980adae29a6ca1979
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: f52d2fbd8c62f667191b61228acf9d8aa53607b9
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 5579726bd60a6e7afb04a3548bced348cd5ffd89
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 5721da7e41e7a280587bda29cd1674c7da3317f8
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: a2398bf8b6413338faeb75cbb40a347be0741972
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: cd1aef2972ed0b4aafc18c58495cc7e62eebc4c8
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: '197671018875d278db7075f604eca02b42a33c3e'
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: b9b21acc766db54d8c337d508d0fe2f5bf2daab0
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 7e92f78abe80e4b30e648a40073abb59057e21f8
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 5919bb5a5989cda232ac3d1f8b9d90f337be2077
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 30523c0ca1186476674d2874754cf218627e9de2
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 4c1dd680267f0bc56de8fb2a138aa556054f9886
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: c0d5d52a780fb575d8f93d0b1a8ef8cb43851a84
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: dfab37100de1127595b4f1f6949137bfea355c22
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: ea2917ca905b7a669cc9d90c3b0e4539667a15a4
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 2a4d82aadf8c3c2cf7f586c6ba2766f9bd2ba657
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: cc7e0feba51b4aeb0adf9bdac659f83e9986b90d
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 2d7d8f4397c5855e9159c05a2afb131c34282a8f
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 71cac850d02f2ad46aca00d3852574bd48fb581a
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/postgres/postgres/tree/197671018875d278db7075f604eca02b42a33c3e
    reference_type: commit
    reference_id: '197671018875d278db7075f604eca02b42a33c3e'
  - url: https://github.com/postgres/postgres/tree/22b205cbbd978e69f08bd2b980adae29a6ca1979
    reference_type: commit
    reference_id: 22b205cbbd978e69f08bd2b980adae29a6ca1979
  - url: https://github.com/postgres/postgres/tree/2a4d82aadf8c3c2cf7f586c6ba2766f9bd2ba657
    reference_type: commit
    reference_id: 2a4d82aadf8c3c2cf7f586c6ba2766f9bd2ba657
  - url: https://github.com/postgres/postgres/tree/2d7d8f4397c5855e9159c05a2afb131c34282a8f
    reference_type: commit
    reference_id: 2d7d8f4397c5855e9159c05a2afb131c34282a8f
  - url: https://github.com/postgres/postgres/tree/30523c0ca1186476674d2874754cf218627e9de2
    reference_type: commit
    reference_id: 30523c0ca1186476674d2874754cf218627e9de2
  - url: https://github.com/postgres/postgres/tree/4c1dd680267f0bc56de8fb2a138aa556054f9886
    reference_type: commit
    reference_id: 4c1dd680267f0bc56de8fb2a138aa556054f9886
  - url: https://github.com/postgres/postgres/tree/5579726bd60a6e7afb04a3548bced348cd5ffd89
    reference_type: commit
    reference_id: 5579726bd60a6e7afb04a3548bced348cd5ffd89
  - url: https://github.com/postgres/postgres/tree/5721da7e41e7a280587bda29cd1674c7da3317f8
    reference_type: commit
    reference_id: 5721da7e41e7a280587bda29cd1674c7da3317f8
  - url: https://github.com/postgres/postgres/tree/5919bb5a5989cda232ac3d1f8b9d90f337be2077
    reference_type: commit
    reference_id: 5919bb5a5989cda232ac3d1f8b9d90f337be2077
  - url: https://github.com/postgres/postgres/tree/71cac850d02f2ad46aca00d3852574bd48fb581a
    reference_type: commit
    reference_id: 71cac850d02f2ad46aca00d3852574bd48fb581a
  - url: https://github.com/postgres/postgres/tree/7e92f78abe80e4b30e648a40073abb59057e21f8
    reference_type: commit
    reference_id: 7e92f78abe80e4b30e648a40073abb59057e21f8
  - url: https://github.com/postgres/postgres/tree/a2398bf8b6413338faeb75cbb40a347be0741972
    reference_type: commit
    reference_id: a2398bf8b6413338faeb75cbb40a347be0741972
  - url: https://github.com/postgres/postgres/tree/b9b21acc766db54d8c337d508d0fe2f5bf2daab0
    reference_type: commit
    reference_id: b9b21acc766db54d8c337d508d0fe2f5bf2daab0
  - url: https://github.com/postgres/postgres/tree/c0d5d52a780fb575d8f93d0b1a8ef8cb43851a84
    reference_type: commit
    reference_id: c0d5d52a780fb575d8f93d0b1a8ef8cb43851a84
  - url: https://github.com/postgres/postgres/tree/cc7e0feba51b4aeb0adf9bdac659f83e9986b90d
    reference_type: commit
    reference_id: cc7e0feba51b4aeb0adf9bdac659f83e9986b90d
  - url: https://github.com/postgres/postgres/tree/cd1aef2972ed0b4aafc18c58495cc7e62eebc4c8
    reference_type: commit
    reference_id: cd1aef2972ed0b4aafc18c58495cc7e62eebc4c8
  - url: https://github.com/postgres/postgres/tree/dfab37100de1127595b4f1f6949137bfea355c22
    reference_type: commit
    reference_id: dfab37100de1127595b4f1f6949137bfea355c22
  - url: https://github.com/postgres/postgres/tree/ea2917ca905b7a669cc9d90c3b0e4539667a15a4
    reference_type: commit
    reference_id: ea2917ca905b7a669cc9d90c3b0e4539667a15a4
  - url: https://github.com/postgres/postgres/tree/f52d2fbd8c62f667191b61228acf9d8aa53607b9
    reference_type: commit
    reference_id: f52d2fbd8c62f667191b61228acf9d8aa53607b9
