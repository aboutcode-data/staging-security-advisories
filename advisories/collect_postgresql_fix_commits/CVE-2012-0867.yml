advisory_id: CVE-2012-0867
datasource_id: collect_postgresql_fix_commits/CVE-2012-0867
datasource_url: https://github.com/postgres/postgres
aliases: []
summary: |
  ecabae5af98d2b238e82cb59b4fd9b00aad1e63d:Last-minute release note updates.

  Security: CVE-2012-0866, CVE-2012-0867, CVE-2012-0868
  44909f44d99a7511ae7e2d7f106d09676b4026be:Last-minute release note updates.

  Security: CVE-2012-0866, CVE-2012-0867, CVE-2012-0868
  09189cb6059f28aea59cca4f419c535123f499b8:Last-minute release note updates.

  Security: CVE-2012-0866, CVE-2012-0867, CVE-2012-0868
  22795f096b521e975800cd2fff222f958500ef19:Last-minute release note updates.

  Security: CVE-2012-0866, CVE-2012-0867, CVE-2012-0868
  b2ce60703ab431a1d6c10f50587ea5f5e984af2e:Last-minute release note updates.

  Security: CVE-2012-0866, CVE-2012-0867, CVE-2012-0868
  4ee9db0cd94a1ecfce4f76de29fa213ddc892c6e:Remove arbitrary limitation on length of common name in SSL certificates.

  Both libpq and the backend would truncate a common name extracted from a
  certificate at 32 bytes.  Replace that fixed-size buffer with dynamically
  allocated string so that there is no hard limit.  While at it, remove the
  code for extracting peer_dn, which we weren't using for anything; and
  don't bother to store peer_cn longer than we need it in libpq.

  This limit was not so terribly unreasonable when the code was written,
  because we weren't using the result for anything critical, just logging it.
  But now that there are options for checking the common name against the
  server host name (in libpq) or using it as the user's name (in the server),
  this could result in undesirable failures.  In the worst case it even seems
  possible to spoof a server name or user name, if the correct name is
  exactly 32 bytes and the attacker can persuade a trusted CA to issue a
  certificate in which that string is a prefix of the certificate's common
  name.  (To exploit this for a server name, he'd also have to send the
  connection astray via phony DNS data or some such.)  The case that this is
  a realistic security threat is a bit thin, but nonetheless we'll treat it
  as one.

  Back-patch to 8.4.  Older releases contain the faulty code, but it's not
  a security problem because the common name wasn't used for anything
  interesting.

  Reported and patched by Heikki Linnakangas

  Security: CVE-2012-0867
  850d341ff72b2be53ecea7e05a0bdf9a88ade154:Remove arbitrary limitation on length of common name in SSL certificates.

  Both libpq and the backend would truncate a common name extracted from a
  certificate at 32 bytes.  Replace that fixed-size buffer with dynamically
  allocated string so that there is no hard limit.  While at it, remove the
  code for extracting peer_dn, which we weren't using for anything; and
  don't bother to store peer_cn longer than we need it in libpq.

  This limit was not so terribly unreasonable when the code was written,
  because we weren't using the result for anything critical, just logging it.
  But now that there are options for checking the common name against the
  server host name (in libpq) or using it as the user's name (in the server),
  this could result in undesirable failures.  In the worst case it even seems
  possible to spoof a server name or user name, if the correct name is
  exactly 32 bytes and the attacker can persuade a trusted CA to issue a
  certificate in which that string is a prefix of the certificate's common
  name.  (To exploit this for a server name, he'd also have to send the
  connection astray via phony DNS data or some such.)  The case that this is
  a realistic security threat is a bit thin, but nonetheless we'll treat it
  as one.

  Back-patch to 8.4.  Older releases contain the faulty code, but it's not
  a security problem because the common name wasn't used for anything
  interesting.

  Reported and patched by Heikki Linnakangas

  Security: CVE-2012-0867
  e6fcb03dc0de1771f7d408b5df1738272e6f98e5:Remove arbitrary limitation on length of common name in SSL certificates.

  Both libpq and the backend would truncate a common name extracted from a
  certificate at 32 bytes.  Replace that fixed-size buffer with dynamically
  allocated string so that there is no hard limit.  While at it, remove the
  code for extracting peer_dn, which we weren't using for anything; and
  don't bother to store peer_cn longer than we need it in libpq.

  This limit was not so terribly unreasonable when the code was written,
  because we weren't using the result for anything critical, just logging it.
  But now that there are options for checking the common name against the
  server host name (in libpq) or using it as the user's name (in the server),
  this could result in undesirable failures.  In the worst case it even seems
  possible to spoof a server name or user name, if the correct name is
  exactly 32 bytes and the attacker can persuade a trusted CA to issue a
  certificate in which that string is a prefix of the certificate's common
  name.  (To exploit this for a server name, he'd also have to send the
  connection astray via phony DNS data or some such.)  The case that this is
  a realistic security threat is a bit thin, but nonetheless we'll treat it
  as one.

  Back-patch to 8.4.  Older releases contain the faulty code, but it's not
  a security problem because the common name wasn't used for anything
  interesting.

  Reported and patched by Heikki Linnakangas

  Security: CVE-2012-0867
  077711c2e3e86384d19d833233bd35e05b921cfc:Remove arbitrary limitation on length of common name in SSL certificates.

  Both libpq and the backend would truncate a common name extracted from a
  certificate at 32 bytes.  Replace that fixed-size buffer with dynamically
  allocated string so that there is no hard limit.  While at it, remove the
  code for extracting peer_dn, which we weren't using for anything; and
  don't bother to store peer_cn longer than we need it in libpq.

  This limit was not so terribly unreasonable when the code was written,
  because we weren't using the result for anything critical, just logging it.
  But now that there are options for checking the common name against the
  server host name (in libpq) or using it as the user's name (in the server),
  this could result in undesirable failures.  In the worst case it even seems
  possible to spoof a server name or user name, if the correct name is
  exactly 32 bytes and the attacker can persuade a trusted CA to issue a
  certificate in which that string is a prefix of the certificate's common
  name.  (To exploit this for a server name, he'd also have to send the
  connection astray via phony DNS data or some such.)  The case that this is
  a realistic security threat is a bit thin, but nonetheless we'll treat it
  as one.

  Back-patch to 8.4.  Older releases contain the faulty code, but it's not
  a security problem because the common name wasn't used for anything
  interesting.

  Reported and patched by Heikki Linnakangas

  Security: CVE-2012-0867
impacted_packages:
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 850d341ff72b2be53ecea7e05a0bdf9a88ade154
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 09189cb6059f28aea59cca4f419c535123f499b8
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: b2ce60703ab431a1d6c10f50587ea5f5e984af2e
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: e6fcb03dc0de1771f7d408b5df1738272e6f98e5
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 4ee9db0cd94a1ecfce4f76de29fa213ddc892c6e
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 22795f096b521e975800cd2fff222f958500ef19
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 077711c2e3e86384d19d833233bd35e05b921cfc
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: ecabae5af98d2b238e82cb59b4fd9b00aad1e63d
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 44909f44d99a7511ae7e2d7f106d09676b4026be
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/postgres/postgres/tree/077711c2e3e86384d19d833233bd35e05b921cfc
    reference_type: commit
    reference_id: 077711c2e3e86384d19d833233bd35e05b921cfc
  - url: https://github.com/postgres/postgres/tree/09189cb6059f28aea59cca4f419c535123f499b8
    reference_type: commit
    reference_id: 09189cb6059f28aea59cca4f419c535123f499b8
  - url: https://github.com/postgres/postgres/tree/22795f096b521e975800cd2fff222f958500ef19
    reference_type: commit
    reference_id: 22795f096b521e975800cd2fff222f958500ef19
  - url: https://github.com/postgres/postgres/tree/44909f44d99a7511ae7e2d7f106d09676b4026be
    reference_type: commit
    reference_id: 44909f44d99a7511ae7e2d7f106d09676b4026be
  - url: https://github.com/postgres/postgres/tree/4ee9db0cd94a1ecfce4f76de29fa213ddc892c6e
    reference_type: commit
    reference_id: 4ee9db0cd94a1ecfce4f76de29fa213ddc892c6e
  - url: https://github.com/postgres/postgres/tree/850d341ff72b2be53ecea7e05a0bdf9a88ade154
    reference_type: commit
    reference_id: 850d341ff72b2be53ecea7e05a0bdf9a88ade154
  - url: https://github.com/postgres/postgres/tree/b2ce60703ab431a1d6c10f50587ea5f5e984af2e
    reference_type: commit
    reference_id: b2ce60703ab431a1d6c10f50587ea5f5e984af2e
  - url: https://github.com/postgres/postgres/tree/e6fcb03dc0de1771f7d408b5df1738272e6f98e5
    reference_type: commit
    reference_id: e6fcb03dc0de1771f7d408b5df1738272e6f98e5
  - url: https://github.com/postgres/postgres/tree/ecabae5af98d2b238e82cb59b4fd9b00aad1e63d
    reference_type: commit
    reference_id: ecabae5af98d2b238e82cb59b4fd9b00aad1e63d
