advisory_id: CVE-2012-2143
datasource_id: collect_postgresql_fix_commits/CVE-2012-2143
datasource_url: https://github.com/postgres/postgres
aliases: []
summary: |
  dd957a5bb90b05269f61db7bd3d9785afd5eb0e5:Fix incorrect password transformation in contrib/pgcrypto's DES crypt().

  Overly tight coding caused the password transformation loop to stop
  examining input once it had processed a byte equal to 0x80.  Thus, if the
  given password string contained such a byte (which is possible though not
  highly likely in UTF8, and perhaps also in other non-ASCII encodings), all
  subsequent characters would not contribute to the hash, making the password
  much weaker than it appears on the surface.

  This would only affect cases where applications used DES crypt() to encode
  passwords before storing them in the database.  If a weak password has been
  created in this fashion, the hash will stop matching after this update has
  been applied, so it will be easy to tell if any passwords were unexpectedly
  weak.  Changing to a different password would be a good idea in such a case.
  (Since DES has been considered inadequately secure for some time, changing
  to a different encryption algorithm can also be recommended.)

  This code, and the bug, are shared with at least PHP, FreeBSD, and OpenBSD.
  Since the other projects have already published their fixes, there is no
  point in trying to keep this commit private.

  This bug has been assigned CVE-2012-2143, and credit for its discovery goes
  to Rubin Xu and Joseph Bonneau.
  4c95cdabce4993c7c016b664dac73c5c7ed9770b:Fix incorrect password transformation in contrib/pgcrypto's DES crypt().

  Overly tight coding caused the password transformation loop to stop
  examining input once it had processed a byte equal to 0x80.  Thus, if the
  given password string contained such a byte (which is possible though not
  highly likely in UTF8, and perhaps also in other non-ASCII encodings), all
  subsequent characters would not contribute to the hash, making the password
  much weaker than it appears on the surface.

  This would only affect cases where applications used DES crypt() to encode
  passwords before storing them in the database.  If a weak password has been
  created in this fashion, the hash will stop matching after this update has
  been applied, so it will be easy to tell if any passwords were unexpectedly
  weak.  Changing to a different password would be a good idea in such a case.
  (Since DES has been considered inadequately secure for some time, changing
  to a different encryption algorithm can also be recommended.)

  This code, and the bug, are shared with at least PHP, FreeBSD, and OpenBSD.
  Since the other projects have already published their fixes, there is no
  point in trying to keep this commit private.

  This bug has been assigned CVE-2012-2143, and credit for its discovery goes
  to Rubin Xu and Joseph Bonneau.
  b1d01f9a8984f21865e3d9cc9830900db8f91a06:Fix incorrect password transformation in contrib/pgcrypto's DES crypt().

  Overly tight coding caused the password transformation loop to stop
  examining input once it had processed a byte equal to 0x80.  Thus, if the
  given password string contained such a byte (which is possible though not
  highly likely in UTF8, and perhaps also in other non-ASCII encodings), all
  subsequent characters would not contribute to the hash, making the password
  much weaker than it appears on the surface.

  This would only affect cases where applications used DES crypt() to encode
  passwords before storing them in the database.  If a weak password has been
  created in this fashion, the hash will stop matching after this update has
  been applied, so it will be easy to tell if any passwords were unexpectedly
  weak.  Changing to a different password would be a good idea in such a case.
  (Since DES has been considered inadequately secure for some time, changing
  to a different encryption algorithm can also be recommended.)

  This code, and the bug, are shared with at least PHP, FreeBSD, and OpenBSD.
  Since the other projects have already published their fixes, there is no
  point in trying to keep this commit private.

  This bug has been assigned CVE-2012-2143, and credit for its discovery goes
  to Rubin Xu and Joseph Bonneau.
  8db2e820c96a0ce33d3c15f476aa78bebce2c732:Fix incorrect password transformation in contrib/pgcrypto's DES crypt().

  Overly tight coding caused the password transformation loop to stop
  examining input once it had processed a byte equal to 0x80.  Thus, if the
  given password string contained such a byte (which is possible though not
  highly likely in UTF8, and perhaps also in other non-ASCII encodings), all
  subsequent characters would not contribute to the hash, making the password
  much weaker than it appears on the surface.

  This would only affect cases where applications used DES crypt() to encode
  passwords before storing them in the database.  If a weak password has been
  created in this fashion, the hash will stop matching after this update has
  been applied, so it will be easy to tell if any passwords were unexpectedly
  weak.  Changing to a different password would be a good idea in such a case.
  (Since DES has been considered inadequately secure for some time, changing
  to a different encryption algorithm can also be recommended.)

  This code, and the bug, are shared with at least PHP, FreeBSD, and OpenBSD.
  Since the other projects have already published their fixes, there is no
  point in trying to keep this commit private.

  This bug has been assigned CVE-2012-2143, and credit for its discovery goes
  to Rubin Xu and Joseph Bonneau.
  932ded2ed51e8333852e370c7a6dad75d9f236f9:Fix incorrect password transformation in contrib/pgcrypto's DES crypt().

  Overly tight coding caused the password transformation loop to stop
  examining input once it had processed a byte equal to 0x80.  Thus, if the
  given password string contained such a byte (which is possible though not
  highly likely in UTF8, and perhaps also in other non-ASCII encodings), all
  subsequent characters would not contribute to the hash, making the password
  much weaker than it appears on the surface.

  This would only affect cases where applications used DES crypt() to encode
  passwords before storing them in the database.  If a weak password has been
  created in this fashion, the hash will stop matching after this update has
  been applied, so it will be easy to tell if any passwords were unexpectedly
  weak.  Changing to a different password would be a good idea in such a case.
  (Since DES has been considered inadequately secure for some time, changing
  to a different encryption algorithm can also be recommended.)

  This code, and the bug, are shared with at least PHP, FreeBSD, and OpenBSD.
  Since the other projects have already published their fixes, there is no
  point in trying to keep this commit private.

  This bug has been assigned CVE-2012-2143, and credit for its discovery goes
  to Rubin Xu and Joseph Bonneau.
impacted_packages:
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 4c95cdabce4993c7c016b664dac73c5c7ed9770b
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: dd957a5bb90b05269f61db7bd3d9785afd5eb0e5
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 932ded2ed51e8333852e370c7a6dad75d9f236f9
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 8db2e820c96a0ce33d3c15f476aa78bebce2c732
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: b1d01f9a8984f21865e3d9cc9830900db8f91a06
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/postgres/postgres/tree/4c95cdabce4993c7c016b664dac73c5c7ed9770b
    reference_type: commit
    reference_id: 4c95cdabce4993c7c016b664dac73c5c7ed9770b
  - url: https://github.com/postgres/postgres/tree/8db2e820c96a0ce33d3c15f476aa78bebce2c732
    reference_type: commit
    reference_id: 8db2e820c96a0ce33d3c15f476aa78bebce2c732
  - url: https://github.com/postgres/postgres/tree/932ded2ed51e8333852e370c7a6dad75d9f236f9
    reference_type: commit
    reference_id: 932ded2ed51e8333852e370c7a6dad75d9f236f9
  - url: https://github.com/postgres/postgres/tree/b1d01f9a8984f21865e3d9cc9830900db8f91a06
    reference_type: commit
    reference_id: b1d01f9a8984f21865e3d9cc9830900db8f91a06
  - url: https://github.com/postgres/postgres/tree/dd957a5bb90b05269f61db7bd3d9785afd5eb0e5
    reference_type: commit
    reference_id: dd957a5bb90b05269f61db7bd3d9785afd5eb0e5
