advisory_id: CVE-2019-10164
datasource_id: collect_postgresql_fix_commits/CVE-2019-10164
datasource_url: https://github.com/postgres/postgres
aliases: []
summary: |
  7dc3e28173b6d7527a24bb8a4e324137c7cfe9d2:Last-minute updates for release notes.

  Security: CVE-2019-10164
  8339895d8f797d8d1ccbd555937ed8cc727ea279:Last-minute updates for release notes.

  Security: CVE-2019-10164
  a4e4418c3f68986607d7b588389e026108c79d71:Last-minute updates for release notes.

  Security: CVE-2019-10164
  d72a7e4da1001b29a661a4b1a52cb5c4d708bab0:Fix buffer overflow when processing SCRAM final message in libpq

  When a client connects to a rogue server sending specifically-crafted
  messages, this can suffice to execute arbitrary code as the operating
  system account used by the client.

  While on it, fix one error handling when decoding an incorrect salt
  included in the first message received from server.

  Author: Michael Paquier
  Reviewed-by: Jonathan Katz, Heikki Linnakangas
  Security: CVE-2019-10164
  Backpatch-through: 10
  27c464e42a9e3cb3779d1ea63b835a3e191682d6:Fix buffer overflow when processing SCRAM final message in libpq

  When a client connects to a rogue server sending specifically-crafted
  messages, this can suffice to execute arbitrary code as the operating
  system account used by the client.

  While on it, fix one error handling when decoding an incorrect salt
  included in the first message received from server.

  Author: Michael Paquier
  Reviewed-by: Jonathan Katz, Heikki Linnakangas
  Security: CVE-2019-10164
  Backpatch-through: 10
  b67421178880f9df337dc19b8601b54b99efbc78:Fix buffer overflow when processing SCRAM final message in libpq

  When a client connects to a rogue server sending specifically-crafted
  messages, this can suffice to execute arbitrary code as the operating
  system account used by the client.

  While on it, fix one error handling when decoding an incorrect salt
  included in the first message received from server.

  Author: Michael Paquier
  Reviewed-by: Jonathan Katz, Heikki Linnakangas
  Security: CVE-2019-10164
  Backpatch-through: 10
  90adc16ea13750a6b6f704c6cf65dc0f1bdb845c:Fix buffer overflow when parsing SCRAM verifiers in backend

  Any authenticated user can overflow a stack-based buffer by changing the
  user's own password to a purpose-crafted value.  This often suffices to
  execute arbitrary code as the PostgreSQL operating system account.

  This fix is contributed by multiple folks, based on an initial analysis
  from Tom Lane.  This issue has been introduced by 68e61ee, so it was
  possible to make use of it at authentication time.  It became more
  easily to trigger after ccae190 which has made the SCRAM parsing more
  strict when changing a password, in the case where the client passes
  down a verifier already hashed using SCRAM.  Back-patch to v10 where
  SCRAM has been introduced.

  Reported-by: Alexander Lakhin
  Author: Jonathan Katz, Heikki Linnakangas, Michael Paquier
  Security: CVE-2019-10164
  Backpatch-through: 10
  4c779ce324a15ffa0171160c52579130f25fcd3f:Fix buffer overflow when parsing SCRAM verifiers in backend

  Any authenticated user can overflow a stack-based buffer by changing the
  user's own password to a purpose-crafted value.  This often suffices to
  execute arbitrary code as the PostgreSQL operating system account.

  This fix is contributed by multiple folks, based on an initial analysis
  from Tom Lane.  This issue has been introduced by 68e61ee, so it was
  possible to make use of it at authentication time.  It became more
  easily to trigger after ccae190 which has made the SCRAM parsing more
  strict when changing a password, in the case where the client passes
  down a verifier already hashed using SCRAM.  Back-patch to v10 where
  SCRAM has been introduced.

  Reported-by: Alexander Lakhin
  Author: Jonathan Katz, Heikki Linnakangas, Michael Paquier
  Security: CVE-2019-10164
  Backpatch-through: 10
  09ec55b933091cb5b0af99978718cb3d289c71b6:Fix buffer overflow when parsing SCRAM verifiers in backend

  Any authenticated user can overflow a stack-based buffer by changing the
  user's own password to a purpose-crafted value.  This often suffices to
  execute arbitrary code as the PostgreSQL operating system account.

  This fix is contributed by multiple folks, based on an initial analysis
  from Tom Lane.  This issue has been introduced by 68e61ee, so it was
  possible to make use of it at authentication time.  It became more
  easily to trigger after ccae190 which has made the SCRAM parsing more
  strict when changing a password, in the case where the client passes
  down a verifier already hashed using SCRAM.  Back-patch to v10 where
  SCRAM has been introduced.

  Reported-by: Alexander Lakhin
  Author: Jonathan Katz, Heikki Linnakangas, Michael Paquier
  Security: CVE-2019-10164
  Backpatch-through: 10
impacted_packages:
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 4c779ce324a15ffa0171160c52579130f25fcd3f
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 8339895d8f797d8d1ccbd555937ed8cc727ea279
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 27c464e42a9e3cb3779d1ea63b835a3e191682d6
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 7dc3e28173b6d7527a24bb8a4e324137c7cfe9d2
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: b67421178880f9df337dc19b8601b54b99efbc78
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 90adc16ea13750a6b6f704c6cf65dc0f1bdb845c
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 09ec55b933091cb5b0af99978718cb3d289c71b6
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: a4e4418c3f68986607d7b588389e026108c79d71
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: d72a7e4da1001b29a661a4b1a52cb5c4d708bab0
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/postgres/postgres/tree/09ec55b933091cb5b0af99978718cb3d289c71b6
    reference_type: commit
    reference_id: 09ec55b933091cb5b0af99978718cb3d289c71b6
  - url: https://github.com/postgres/postgres/tree/27c464e42a9e3cb3779d1ea63b835a3e191682d6
    reference_type: commit
    reference_id: 27c464e42a9e3cb3779d1ea63b835a3e191682d6
  - url: https://github.com/postgres/postgres/tree/4c779ce324a15ffa0171160c52579130f25fcd3f
    reference_type: commit
    reference_id: 4c779ce324a15ffa0171160c52579130f25fcd3f
  - url: https://github.com/postgres/postgres/tree/7dc3e28173b6d7527a24bb8a4e324137c7cfe9d2
    reference_type: commit
    reference_id: 7dc3e28173b6d7527a24bb8a4e324137c7cfe9d2
  - url: https://github.com/postgres/postgres/tree/8339895d8f797d8d1ccbd555937ed8cc727ea279
    reference_type: commit
    reference_id: 8339895d8f797d8d1ccbd555937ed8cc727ea279
  - url: https://github.com/postgres/postgres/tree/90adc16ea13750a6b6f704c6cf65dc0f1bdb845c
    reference_type: commit
    reference_id: 90adc16ea13750a6b6f704c6cf65dc0f1bdb845c
  - url: https://github.com/postgres/postgres/tree/a4e4418c3f68986607d7b588389e026108c79d71
    reference_type: commit
    reference_id: a4e4418c3f68986607d7b588389e026108c79d71
  - url: https://github.com/postgres/postgres/tree/b67421178880f9df337dc19b8601b54b99efbc78
    reference_type: commit
    reference_id: b67421178880f9df337dc19b8601b54b99efbc78
  - url: https://github.com/postgres/postgres/tree/d72a7e4da1001b29a661a4b1a52cb5c4d708bab0
    reference_type: commit
    reference_id: d72a7e4da1001b29a661a4b1a52cb5c4d708bab0
