advisory_id: CVE-2023-5868
datasource_id: collect_postgresql_fix_commits/CVE-2023-5868
datasource_url: https://github.com/postgres/postgres
aliases: []
summary: |
  3dbb3dd2d641af0da92e0a25b490b5bc38490e58:Last-minute updates for release notes.

  Security: CVE-2023-5868, CVE-2023-5869, CVE-2023-5870
  8ff28255b6cd93b2fc3e12b12b05ed5430e48c4c:Last-minute updates for release notes.

  Security: CVE-2023-5868, CVE-2023-5869, CVE-2023-5870
  04b66eb417dd9fd1a4a7e2298e840a4b63c0d478:Last-minute updates for release notes.

  Security: CVE-2023-5868, CVE-2023-5869, CVE-2023-5870
  ef2950f5700220b9f8a5647c2a9711fc9b1716aa:Last-minute updates for release notes.

  Security: CVE-2023-5868, CVE-2023-5869, CVE-2023-5870
  95c96ba1d073afeadf193c7a9681a2c665dddead:Last-minute updates for release notes.

  Security: CVE-2023-5868, CVE-2023-5869, CVE-2023-5870
  639a8063ca7da421b34b7a49b2773c3cb2436df1:Last-minute updates for release notes.

  Security: CVE-2023-5868, CVE-2023-5869, CVE-2023-5870
  3b0776fde56763c549df35ce9750f3399bc710b2:Compute aggregate argument types correctly in transformAggregateCall().

  transformAggregateCall() captures the datatypes of the aggregate's
  arguments immediately to construct the Aggref.aggargtypes list.
  This seems reasonable because the arguments have already been
  transformed --- but there is an edge case where they haven't been.
  Specifically, if we have an unknown-type literal in an ANY argument
  position, nothing will have been done with it earlier.  But if we
  also have DISTINCT, then addTargetToGroupList() converts the literal
  to "text" type, resulting in the aggargtypes list not matching the
  actual runtime type of the argument.  The end result is that the
  aggregate tries to interpret a "text" value as being of type
  "unknown", that is a zero-terminated C string.  If the text value
  contains no zero bytes, this could result in disclosure of server
  memory following the text literal value.

  To fix, move the collection of the aggargtypes list to the end
  of transformAggregateCall(), after DISTINCT has been handled.
  This requires slightly more code, but not a great deal.

  Our thanks to Jingzhou Fu for reporting this problem.

  Security: CVE-2023-5868
  8c6633f4deb6ace445fc3d72d54585c373187d2d:Compute aggregate argument types correctly in transformAggregateCall().

  transformAggregateCall() captures the datatypes of the aggregate's
  arguments immediately to construct the Aggref.aggargtypes list.
  This seems reasonable because the arguments have already been
  transformed --- but there is an edge case where they haven't been.
  Specifically, if we have an unknown-type literal in an ANY argument
  position, nothing will have been done with it earlier.  But if we
  also have DISTINCT, then addTargetToGroupList() converts the literal
  to "text" type, resulting in the aggargtypes list not matching the
  actual runtime type of the argument.  The end result is that the
  aggregate tries to interpret a "text" value as being of type
  "unknown", that is a zero-terminated C string.  If the text value
  contains no zero bytes, this could result in disclosure of server
  memory following the text literal value.

  To fix, move the collection of the aggargtypes list to the end
  of transformAggregateCall(), after DISTINCT has been handled.
  This requires slightly more code, but not a great deal.

  Our thanks to Jingzhou Fu for reporting this problem.

  Security: CVE-2023-5868
  e911afd092c179563bef39839118acb6702066f4:Compute aggregate argument types correctly in transformAggregateCall().

  transformAggregateCall() captures the datatypes of the aggregate's
  arguments immediately to construct the Aggref.aggargtypes list.
  This seems reasonable because the arguments have already been
  transformed --- but there is an edge case where they haven't been.
  Specifically, if we have an unknown-type literal in an ANY argument
  position, nothing will have been done with it earlier.  But if we
  also have DISTINCT, then addTargetToGroupList() converts the literal
  to "text" type, resulting in the aggargtypes list not matching the
  actual runtime type of the argument.  The end result is that the
  aggregate tries to interpret a "text" value as being of type
  "unknown", that is a zero-terminated C string.  If the text value
  contains no zero bytes, this could result in disclosure of server
  memory following the text literal value.

  To fix, move the collection of the aggargtypes list to the end
  of transformAggregateCall(), after DISTINCT has been handled.
  This requires slightly more code, but not a great deal.

  Our thanks to Jingzhou Fu for reporting this problem.

  Security: CVE-2023-5868
  d3de70fdb76520610583221c38d0c7eaa6573503:Compute aggregate argument types correctly in transformAggregateCall().

  transformAggregateCall() captures the datatypes of the aggregate's
  arguments immediately to construct the Aggref.aggargtypes list.
  This seems reasonable because the arguments have already been
  transformed --- but there is an edge case where they haven't been.
  Specifically, if we have an unknown-type literal in an ANY argument
  position, nothing will have been done with it earlier.  But if we
  also have DISTINCT, then addTargetToGroupList() converts the literal
  to "text" type, resulting in the aggargtypes list not matching the
  actual runtime type of the argument.  The end result is that the
  aggregate tries to interpret a "text" value as being of type
  "unknown", that is a zero-terminated C string.  If the text value
  contains no zero bytes, this could result in disclosure of server
  memory following the text literal value.

  To fix, move the collection of the aggargtypes list to the end
  of transformAggregateCall(), after DISTINCT has been handled.
  This requires slightly more code, but not a great deal.

  Our thanks to Jingzhou Fu for reporting this problem.

  Security: CVE-2023-5868
  9146d0d65073eeb6738db7c21626d8672fda29f9:Compute aggregate argument types correctly in transformAggregateCall().

  transformAggregateCall() captures the datatypes of the aggregate's
  arguments immediately to construct the Aggref.aggargtypes list.
  This seems reasonable because the arguments have already been
  transformed --- but there is an edge case where they haven't been.
  Specifically, if we have an unknown-type literal in an ANY argument
  position, nothing will have been done with it earlier.  But if we
  also have DISTINCT, then addTargetToGroupList() converts the literal
  to "text" type, resulting in the aggargtypes list not matching the
  actual runtime type of the argument.  The end result is that the
  aggregate tries to interpret a "text" value as being of type
  "unknown", that is a zero-terminated C string.  If the text value
  contains no zero bytes, this could result in disclosure of server
  memory following the text literal value.

  To fix, move the collection of the aggargtypes list to the end
  of transformAggregateCall(), after DISTINCT has been handled.
  This requires slightly more code, but not a great deal.

  Our thanks to Jingzhou Fu for reporting this problem.

  Security: CVE-2023-5868
  4f4a422fbb15e49ff5e9dc410cd8713d63fdda24:Compute aggregate argument types correctly in transformAggregateCall().

  transformAggregateCall() captures the datatypes of the aggregate's
  arguments immediately to construct the Aggref.aggargtypes list.
  This seems reasonable because the arguments have already been
  transformed --- but there is an edge case where they haven't been.
  Specifically, if we have an unknown-type literal in an ANY argument
  position, nothing will have been done with it earlier.  But if we
  also have DISTINCT, then addTargetToGroupList() converts the literal
  to "text" type, resulting in the aggargtypes list not matching the
  actual runtime type of the argument.  The end result is that the
  aggregate tries to interpret a "text" value as being of type
  "unknown", that is a zero-terminated C string.  If the text value
  contains no zero bytes, this could result in disclosure of server
  memory following the text literal value.

  To fix, move the collection of the aggargtypes list to the end
  of transformAggregateCall(), after DISTINCT has been handled.
  This requires slightly more code, but not a great deal.

  Our thanks to Jingzhou Fu for reporting this problem.

  Security: CVE-2023-5868
  d3d1e25097db05edd0e6b44321516e1dce144047:Compute aggregate argument types correctly in transformAggregateCall().

  transformAggregateCall() captures the datatypes of the aggregate's
  arguments immediately to construct the Aggref.aggargtypes list.
  This seems reasonable because the arguments have already been
  transformed --- but there is an edge case where they haven't been.
  Specifically, if we have an unknown-type literal in an ANY argument
  position, nothing will have been done with it earlier.  But if we
  also have DISTINCT, then addTargetToGroupList() converts the literal
  to "text" type, resulting in the aggargtypes list not matching the
  actual runtime type of the argument.  The end result is that the
  aggregate tries to interpret a "text" value as being of type
  "unknown", that is a zero-terminated C string.  If the text value
  contains no zero bytes, this could result in disclosure of server
  memory following the text literal value.

  To fix, move the collection of the aggargtypes list to the end
  of transformAggregateCall(), after DISTINCT has been handled.
  This requires slightly more code, but not a great deal.

  Our thanks to Jingzhou Fu for reporting this problem.

  Security: CVE-2023-5868
impacted_packages:
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 8ff28255b6cd93b2fc3e12b12b05ed5430e48c4c
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 04b66eb417dd9fd1a4a7e2298e840a4b63c0d478
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 9146d0d65073eeb6738db7c21626d8672fda29f9
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: e911afd092c179563bef39839118acb6702066f4
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: d3d1e25097db05edd0e6b44321516e1dce144047
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 3b0776fde56763c549df35ce9750f3399bc710b2
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 639a8063ca7da421b34b7a49b2773c3cb2436df1
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 3dbb3dd2d641af0da92e0a25b490b5bc38490e58
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 8c6633f4deb6ace445fc3d72d54585c373187d2d
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 4f4a422fbb15e49ff5e9dc410cd8713d63fdda24
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: ef2950f5700220b9f8a5647c2a9711fc9b1716aa
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: d3de70fdb76520610583221c38d0c7eaa6573503
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 95c96ba1d073afeadf193c7a9681a2c665dddead
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/postgres/postgres/tree/04b66eb417dd9fd1a4a7e2298e840a4b63c0d478
    reference_type: commit
    reference_id: 04b66eb417dd9fd1a4a7e2298e840a4b63c0d478
  - url: https://github.com/postgres/postgres/tree/3b0776fde56763c549df35ce9750f3399bc710b2
    reference_type: commit
    reference_id: 3b0776fde56763c549df35ce9750f3399bc710b2
  - url: https://github.com/postgres/postgres/tree/3dbb3dd2d641af0da92e0a25b490b5bc38490e58
    reference_type: commit
    reference_id: 3dbb3dd2d641af0da92e0a25b490b5bc38490e58
  - url: https://github.com/postgres/postgres/tree/4f4a422fbb15e49ff5e9dc410cd8713d63fdda24
    reference_type: commit
    reference_id: 4f4a422fbb15e49ff5e9dc410cd8713d63fdda24
  - url: https://github.com/postgres/postgres/tree/639a8063ca7da421b34b7a49b2773c3cb2436df1
    reference_type: commit
    reference_id: 639a8063ca7da421b34b7a49b2773c3cb2436df1
  - url: https://github.com/postgres/postgres/tree/8c6633f4deb6ace445fc3d72d54585c373187d2d
    reference_type: commit
    reference_id: 8c6633f4deb6ace445fc3d72d54585c373187d2d
  - url: https://github.com/postgres/postgres/tree/8ff28255b6cd93b2fc3e12b12b05ed5430e48c4c
    reference_type: commit
    reference_id: 8ff28255b6cd93b2fc3e12b12b05ed5430e48c4c
  - url: https://github.com/postgres/postgres/tree/9146d0d65073eeb6738db7c21626d8672fda29f9
    reference_type: commit
    reference_id: 9146d0d65073eeb6738db7c21626d8672fda29f9
  - url: https://github.com/postgres/postgres/tree/95c96ba1d073afeadf193c7a9681a2c665dddead
    reference_type: commit
    reference_id: 95c96ba1d073afeadf193c7a9681a2c665dddead
  - url: https://github.com/postgres/postgres/tree/d3d1e25097db05edd0e6b44321516e1dce144047
    reference_type: commit
    reference_id: d3d1e25097db05edd0e6b44321516e1dce144047
  - url: https://github.com/postgres/postgres/tree/d3de70fdb76520610583221c38d0c7eaa6573503
    reference_type: commit
    reference_id: d3de70fdb76520610583221c38d0c7eaa6573503
  - url: https://github.com/postgres/postgres/tree/e911afd092c179563bef39839118acb6702066f4
    reference_type: commit
    reference_id: e911afd092c179563bef39839118acb6702066f4
  - url: https://github.com/postgres/postgres/tree/ef2950f5700220b9f8a5647c2a9711fc9b1716aa
    reference_type: commit
    reference_id: ef2950f5700220b9f8a5647c2a9711fc9b1716aa
