advisory_id: CVE-2015-3166
datasource_id: collect_postgresql_fix_commits/CVE-2015-3166
datasource_url: https://github.com/postgres/postgres
aliases: []
summary: |
  760e7ad47959acc3908d3824a20e784f6aed9001:Last-minute updates for release notes.

  Revise description of CVE-2015-3166, in line with scaled-back patch.
  Change release date.

  Security: CVE-2015-3166
  760e7ad47959acc3908d3824a20e784f6aed9001:Last-minute updates for release notes.

  Revise description of CVE-2015-3166, in line with scaled-back patch.
  Change release date.

  Security: CVE-2015-3166
  5b461f239eae2ad67f268e31ada7d79331b89652:Last-minute updates for release notes.

  Revise description of CVE-2015-3166, in line with scaled-back patch.
  Change release date.

  Security: CVE-2015-3166
  5b461f239eae2ad67f268e31ada7d79331b89652:Last-minute updates for release notes.

  Revise description of CVE-2015-3166, in line with scaled-back patch.
  Change release date.

  Security: CVE-2015-3166
  baf379bf22a9b4fd9caa4cf95de397cac480cceb:Last-minute updates for release notes.

  Revise description of CVE-2015-3166, in line with scaled-back patch.
  Change release date.

  Security: CVE-2015-3166
  baf379bf22a9b4fd9caa4cf95de397cac480cceb:Last-minute updates for release notes.

  Revise description of CVE-2015-3166, in line with scaled-back patch.
  Change release date.

  Security: CVE-2015-3166
  70f2e3e20ff7dd10d2b405764f4818b11f167925:Last-minute updates for release notes.

  Revise description of CVE-2015-3166, in line with scaled-back patch.
  Change release date.

  Security: CVE-2015-3166
  70f2e3e20ff7dd10d2b405764f4818b11f167925:Last-minute updates for release notes.

  Revise description of CVE-2015-3166, in line with scaled-back patch.
  Change release date.

  Security: CVE-2015-3166
  bd9c6dc9ab9de8f07647015af65d6d2cec0057e3:Last-minute updates for release notes.

  Revise description of CVE-2015-3166, in line with scaled-back patch.
  Change release date.

  Security: CVE-2015-3166
  bd9c6dc9ab9de8f07647015af65d6d2cec0057e3:Last-minute updates for release notes.

  Revise description of CVE-2015-3166, in line with scaled-back patch.
  Change release date.

  Security: CVE-2015-3166
  5cb8519ceb62516636362a7e8e06b99b3e1bf138:Last-minute updates for release notes.

  Revise description of CVE-2015-3166, in line with scaled-back patch.
  Change release date.

  Security: CVE-2015-3166
  5cb8519ceb62516636362a7e8e06b99b3e1bf138:Last-minute updates for release notes.

  Revise description of CVE-2015-3166, in line with scaled-back patch.
  Change release date.

  Security: CVE-2015-3166
  0c071936e94c6859afb2ec8d2c8dddf7bcdab7ee:Revert error-throwing wrappers for the printf family of functions.

  This reverts commit 16304a013432931e61e623c8d85e9fe24709d9ba, except
  for its changes in src/port/snprintf.c; as well as commit
  cac18a76bb6b08f1ecc2a85e46c9d2ab82dd9d23 which is no longer needed.

  Fujii Masao reported that the previous commit caused failures in psql on
  OS X, since if one exits the pager program early while viewing a query
  result, psql sees an EPIPE error from fprintf --- and the wrapper function
  thought that was reason to panic.  (It's a bit surprising that the same
  does not happen on Linux.)  Further discussion among the security list
  concluded that the risk of other such failures was far too great, and
  that the one-size-fits-all approach to error handling embodied in the
  previous patch is unlikely to be workable.

  This leaves us again exposed to the possibility of the type of failure
  envisioned in CVE-2015-3166.  However, that failure mode is strictly
  hypothetical at this point: there is no concrete reason to believe that
  an attacker could trigger information disclosure through the supposed
  mechanism.  In the first place, the attack surface is fairly limited,
  since so much of what the backend does with format strings goes through
  stringinfo.c or psprintf(), and those already had adequate defenses.
  In the second place, even granting that an unprivileged attacker could
  control the occurrence of ENOMEM with some precision, it's a stretch to
  believe that he could induce it just where the target buffer contains some
  valuable information.  So we concluded that the risk of non-hypothetical
  problems induced by the patch greatly outweighs the security risks.
  We will therefore revert, and instead undertake closer analysis to
  identify specific calls that may need hardening, rather than attempt a
  universal solution.

  We have kept the portion of the previous patch that improved snprintf.c's
  handling of errors when it calls the platform's sprintf().  That seems to
  be an unalloyed improvement.

  Security: CVE-2015-3166
  0c071936e94c6859afb2ec8d2c8dddf7bcdab7ee:Revert error-throwing wrappers for the printf family of functions.

  This reverts commit 16304a013432931e61e623c8d85e9fe24709d9ba, except
  for its changes in src/port/snprintf.c; as well as commit
  cac18a76bb6b08f1ecc2a85e46c9d2ab82dd9d23 which is no longer needed.

  Fujii Masao reported that the previous commit caused failures in psql on
  OS X, since if one exits the pager program early while viewing a query
  result, psql sees an EPIPE error from fprintf --- and the wrapper function
  thought that was reason to panic.  (It's a bit surprising that the same
  does not happen on Linux.)  Further discussion among the security list
  concluded that the risk of other such failures was far too great, and
  that the one-size-fits-all approach to error handling embodied in the
  previous patch is unlikely to be workable.

  This leaves us again exposed to the possibility of the type of failure
  envisioned in CVE-2015-3166.  However, that failure mode is strictly
  hypothetical at this point: there is no concrete reason to believe that
  an attacker could trigger information disclosure through the supposed
  mechanism.  In the first place, the attack surface is fairly limited,
  since so much of what the backend does with format strings goes through
  stringinfo.c or psprintf(), and those already had adequate defenses.
  In the second place, even granting that an unprivileged attacker could
  control the occurrence of ENOMEM with some precision, it's a stretch to
  believe that he could induce it just where the target buffer contains some
  valuable information.  So we concluded that the risk of non-hypothetical
  problems induced by the patch greatly outweighs the security risks.
  We will therefore revert, and instead undertake closer analysis to
  identify specific calls that may need hardening, rather than attempt a
  universal solution.

  We have kept the portion of the previous patch that improved snprintf.c's
  handling of errors when it calls the platform's sprintf().  That seems to
  be an unalloyed improvement.

  Security: CVE-2015-3166
  cf893530aff6d3acb893e0fbd80fd9d814605b74:Revert error-throwing wrappers for the printf family of functions.

  This reverts commit 16304a013432931e61e623c8d85e9fe24709d9ba, except
  for its changes in src/port/snprintf.c; as well as commit
  cac18a76bb6b08f1ecc2a85e46c9d2ab82dd9d23 which is no longer needed.

  Fujii Masao reported that the previous commit caused failures in psql on
  OS X, since if one exits the pager program early while viewing a query
  result, psql sees an EPIPE error from fprintf --- and the wrapper function
  thought that was reason to panic.  (It's a bit surprising that the same
  does not happen on Linux.)  Further discussion among the security list
  concluded that the risk of other such failures was far too great, and
  that the one-size-fits-all approach to error handling embodied in the
  previous patch is unlikely to be workable.

  This leaves us again exposed to the possibility of the type of failure
  envisioned in CVE-2015-3166.  However, that failure mode is strictly
  hypothetical at this point: there is no concrete reason to believe that
  an attacker could trigger information disclosure through the supposed
  mechanism.  In the first place, the attack surface is fairly limited,
  since so much of what the backend does with format strings goes through
  stringinfo.c or psprintf(), and those already had adequate defenses.
  In the second place, even granting that an unprivileged attacker could
  control the occurrence of ENOMEM with some precision, it's a stretch to
  believe that he could induce it just where the target buffer contains some
  valuable information.  So we concluded that the risk of non-hypothetical
  problems induced by the patch greatly outweighs the security risks.
  We will therefore revert, and instead undertake closer analysis to
  identify specific calls that may need hardening, rather than attempt a
  universal solution.

  We have kept the portion of the previous patch that improved snprintf.c's
  handling of errors when it calls the platform's sprintf().  That seems to
  be an unalloyed improvement.

  Security: CVE-2015-3166
  cf893530aff6d3acb893e0fbd80fd9d814605b74:Revert error-throwing wrappers for the printf family of functions.

  This reverts commit 16304a013432931e61e623c8d85e9fe24709d9ba, except
  for its changes in src/port/snprintf.c; as well as commit
  cac18a76bb6b08f1ecc2a85e46c9d2ab82dd9d23 which is no longer needed.

  Fujii Masao reported that the previous commit caused failures in psql on
  OS X, since if one exits the pager program early while viewing a query
  result, psql sees an EPIPE error from fprintf --- and the wrapper function
  thought that was reason to panic.  (It's a bit surprising that the same
  does not happen on Linux.)  Further discussion among the security list
  concluded that the risk of other such failures was far too great, and
  that the one-size-fits-all approach to error handling embodied in the
  previous patch is unlikely to be workable.

  This leaves us again exposed to the possibility of the type of failure
  envisioned in CVE-2015-3166.  However, that failure mode is strictly
  hypothetical at this point: there is no concrete reason to believe that
  an attacker could trigger information disclosure through the supposed
  mechanism.  In the first place, the attack surface is fairly limited,
  since so much of what the backend does with format strings goes through
  stringinfo.c or psprintf(), and those already had adequate defenses.
  In the second place, even granting that an unprivileged attacker could
  control the occurrence of ENOMEM with some precision, it's a stretch to
  believe that he could induce it just where the target buffer contains some
  valuable information.  So we concluded that the risk of non-hypothetical
  problems induced by the patch greatly outweighs the security risks.
  We will therefore revert, and instead undertake closer analysis to
  identify specific calls that may need hardening, rather than attempt a
  universal solution.

  We have kept the portion of the previous patch that improved snprintf.c's
  handling of errors when it calls the platform's sprintf().  That seems to
  be an unalloyed improvement.

  Security: CVE-2015-3166
  0510cff6e8018882a578512b52120989ea164681:Revert error-throwing wrappers for the printf family of functions.

  This reverts commit 16304a013432931e61e623c8d85e9fe24709d9ba, except
  for its changes in src/port/snprintf.c; as well as commit
  cac18a76bb6b08f1ecc2a85e46c9d2ab82dd9d23 which is no longer needed.

  Fujii Masao reported that the previous commit caused failures in psql on
  OS X, since if one exits the pager program early while viewing a query
  result, psql sees an EPIPE error from fprintf --- and the wrapper function
  thought that was reason to panic.  (It's a bit surprising that the same
  does not happen on Linux.)  Further discussion among the security list
  concluded that the risk of other such failures was far too great, and
  that the one-size-fits-all approach to error handling embodied in the
  previous patch is unlikely to be workable.

  This leaves us again exposed to the possibility of the type of failure
  envisioned in CVE-2015-3166.  However, that failure mode is strictly
  hypothetical at this point: there is no concrete reason to believe that
  an attacker could trigger information disclosure through the supposed
  mechanism.  In the first place, the attack surface is fairly limited,
  since so much of what the backend does with format strings goes through
  stringinfo.c or psprintf(), and those already had adequate defenses.
  In the second place, even granting that an unprivileged attacker could
  control the occurrence of ENOMEM with some precision, it's a stretch to
  believe that he could induce it just where the target buffer contains some
  valuable information.  So we concluded that the risk of non-hypothetical
  problems induced by the patch greatly outweighs the security risks.
  We will therefore revert, and instead undertake closer analysis to
  identify specific calls that may need hardening, rather than attempt a
  universal solution.

  We have kept the portion of the previous patch that improved snprintf.c's
  handling of errors when it calls the platform's sprintf().  That seems to
  be an unalloyed improvement.

  Security: CVE-2015-3166
  0510cff6e8018882a578512b52120989ea164681:Revert error-throwing wrappers for the printf family of functions.

  This reverts commit 16304a013432931e61e623c8d85e9fe24709d9ba, except
  for its changes in src/port/snprintf.c; as well as commit
  cac18a76bb6b08f1ecc2a85e46c9d2ab82dd9d23 which is no longer needed.

  Fujii Masao reported that the previous commit caused failures in psql on
  OS X, since if one exits the pager program early while viewing a query
  result, psql sees an EPIPE error from fprintf --- and the wrapper function
  thought that was reason to panic.  (It's a bit surprising that the same
  does not happen on Linux.)  Further discussion among the security list
  concluded that the risk of other such failures was far too great, and
  that the one-size-fits-all approach to error handling embodied in the
  previous patch is unlikely to be workable.

  This leaves us again exposed to the possibility of the type of failure
  envisioned in CVE-2015-3166.  However, that failure mode is strictly
  hypothetical at this point: there is no concrete reason to believe that
  an attacker could trigger information disclosure through the supposed
  mechanism.  In the first place, the attack surface is fairly limited,
  since so much of what the backend does with format strings goes through
  stringinfo.c or psprintf(), and those already had adequate defenses.
  In the second place, even granting that an unprivileged attacker could
  control the occurrence of ENOMEM with some precision, it's a stretch to
  believe that he could induce it just where the target buffer contains some
  valuable information.  So we concluded that the risk of non-hypothetical
  problems induced by the patch greatly outweighs the security risks.
  We will therefore revert, and instead undertake closer analysis to
  identify specific calls that may need hardening, rather than attempt a
  universal solution.

  We have kept the portion of the previous patch that improved snprintf.c's
  handling of errors when it calls the platform's sprintf().  That seems to
  be an unalloyed improvement.

  Security: CVE-2015-3166
  221f7a9494d28b938de8a72ead5f6dae39da03da:Revert error-throwing wrappers for the printf family of functions.

  This reverts commit 16304a013432931e61e623c8d85e9fe24709d9ba, except
  for its changes in src/port/snprintf.c; as well as commit
  cac18a76bb6b08f1ecc2a85e46c9d2ab82dd9d23 which is no longer needed.

  Fujii Masao reported that the previous commit caused failures in psql on
  OS X, since if one exits the pager program early while viewing a query
  result, psql sees an EPIPE error from fprintf --- and the wrapper function
  thought that was reason to panic.  (It's a bit surprising that the same
  does not happen on Linux.)  Further discussion among the security list
  concluded that the risk of other such failures was far too great, and
  that the one-size-fits-all approach to error handling embodied in the
  previous patch is unlikely to be workable.

  This leaves us again exposed to the possibility of the type of failure
  envisioned in CVE-2015-3166.  However, that failure mode is strictly
  hypothetical at this point: there is no concrete reason to believe that
  an attacker could trigger information disclosure through the supposed
  mechanism.  In the first place, the attack surface is fairly limited,
  since so much of what the backend does with format strings goes through
  stringinfo.c or psprintf(), and those already had adequate defenses.
  In the second place, even granting that an unprivileged attacker could
  control the occurrence of ENOMEM with some precision, it's a stretch to
  believe that he could induce it just where the target buffer contains some
  valuable information.  So we concluded that the risk of non-hypothetical
  problems induced by the patch greatly outweighs the security risks.
  We will therefore revert, and instead undertake closer analysis to
  identify specific calls that may need hardening, rather than attempt a
  universal solution.

  We have kept the portion of the previous patch that improved snprintf.c's
  handling of errors when it calls the platform's sprintf().  That seems to
  be an unalloyed improvement.

  Security: CVE-2015-3166
  221f7a9494d28b938de8a72ead5f6dae39da03da:Revert error-throwing wrappers for the printf family of functions.

  This reverts commit 16304a013432931e61e623c8d85e9fe24709d9ba, except
  for its changes in src/port/snprintf.c; as well as commit
  cac18a76bb6b08f1ecc2a85e46c9d2ab82dd9d23 which is no longer needed.

  Fujii Masao reported that the previous commit caused failures in psql on
  OS X, since if one exits the pager program early while viewing a query
  result, psql sees an EPIPE error from fprintf --- and the wrapper function
  thought that was reason to panic.  (It's a bit surprising that the same
  does not happen on Linux.)  Further discussion among the security list
  concluded that the risk of other such failures was far too great, and
  that the one-size-fits-all approach to error handling embodied in the
  previous patch is unlikely to be workable.

  This leaves us again exposed to the possibility of the type of failure
  envisioned in CVE-2015-3166.  However, that failure mode is strictly
  hypothetical at this point: there is no concrete reason to believe that
  an attacker could trigger information disclosure through the supposed
  mechanism.  In the first place, the attack surface is fairly limited,
  since so much of what the backend does with format strings goes through
  stringinfo.c or psprintf(), and those already had adequate defenses.
  In the second place, even granting that an unprivileged attacker could
  control the occurrence of ENOMEM with some precision, it's a stretch to
  believe that he could induce it just where the target buffer contains some
  valuable information.  So we concluded that the risk of non-hypothetical
  problems induced by the patch greatly outweighs the security risks.
  We will therefore revert, and instead undertake closer analysis to
  identify specific calls that may need hardening, rather than attempt a
  universal solution.

  We have kept the portion of the previous patch that improved snprintf.c's
  handling of errors when it calls the platform's sprintf().  That seems to
  be an unalloyed improvement.

  Security: CVE-2015-3166
  13341276ec57fe21956239fa733ed69e1c1938fd:Revert error-throwing wrappers for the printf family of functions.

  This reverts commit 16304a013432931e61e623c8d85e9fe24709d9ba, except
  for its changes in src/port/snprintf.c; as well as commit
  cac18a76bb6b08f1ecc2a85e46c9d2ab82dd9d23 which is no longer needed.

  Fujii Masao reported that the previous commit caused failures in psql on
  OS X, since if one exits the pager program early while viewing a query
  result, psql sees an EPIPE error from fprintf --- and the wrapper function
  thought that was reason to panic.  (It's a bit surprising that the same
  does not happen on Linux.)  Further discussion among the security list
  concluded that the risk of other such failures was far too great, and
  that the one-size-fits-all approach to error handling embodied in the
  previous patch is unlikely to be workable.

  This leaves us again exposed to the possibility of the type of failure
  envisioned in CVE-2015-3166.  However, that failure mode is strictly
  hypothetical at this point: there is no concrete reason to believe that
  an attacker could trigger information disclosure through the supposed
  mechanism.  In the first place, the attack surface is fairly limited,
  since so much of what the backend does with format strings goes through
  stringinfo.c or psprintf(), and those already had adequate defenses.
  In the second place, even granting that an unprivileged attacker could
  control the occurrence of ENOMEM with some precision, it's a stretch to
  believe that he could induce it just where the target buffer contains some
  valuable information.  So we concluded that the risk of non-hypothetical
  problems induced by the patch greatly outweighs the security risks.
  We will therefore revert, and instead undertake closer analysis to
  identify specific calls that may need hardening, rather than attempt a
  universal solution.

  We have kept the portion of the previous patch that improved snprintf.c's
  handling of errors when it calls the platform's sprintf().  That seems to
  be an unalloyed improvement.

  Security: CVE-2015-3166
  13341276ec57fe21956239fa733ed69e1c1938fd:Revert error-throwing wrappers for the printf family of functions.

  This reverts commit 16304a013432931e61e623c8d85e9fe24709d9ba, except
  for its changes in src/port/snprintf.c; as well as commit
  cac18a76bb6b08f1ecc2a85e46c9d2ab82dd9d23 which is no longer needed.

  Fujii Masao reported that the previous commit caused failures in psql on
  OS X, since if one exits the pager program early while viewing a query
  result, psql sees an EPIPE error from fprintf --- and the wrapper function
  thought that was reason to panic.  (It's a bit surprising that the same
  does not happen on Linux.)  Further discussion among the security list
  concluded that the risk of other such failures was far too great, and
  that the one-size-fits-all approach to error handling embodied in the
  previous patch is unlikely to be workable.

  This leaves us again exposed to the possibility of the type of failure
  envisioned in CVE-2015-3166.  However, that failure mode is strictly
  hypothetical at this point: there is no concrete reason to believe that
  an attacker could trigger information disclosure through the supposed
  mechanism.  In the first place, the attack surface is fairly limited,
  since so much of what the backend does with format strings goes through
  stringinfo.c or psprintf(), and those already had adequate defenses.
  In the second place, even granting that an unprivileged attacker could
  control the occurrence of ENOMEM with some precision, it's a stretch to
  believe that he could induce it just where the target buffer contains some
  valuable information.  So we concluded that the risk of non-hypothetical
  problems induced by the patch greatly outweighs the security risks.
  We will therefore revert, and instead undertake closer analysis to
  identify specific calls that may need hardening, rather than attempt a
  universal solution.

  We have kept the portion of the previous patch that improved snprintf.c's
  handling of errors when it calls the platform's sprintf().  That seems to
  be an unalloyed improvement.

  Security: CVE-2015-3166
  2eb2fcd56b76ff7aef03f7de772e7459997e61ad:Revert error-throwing wrappers for the printf family of functions.

  This reverts commit 16304a013432931e61e623c8d85e9fe24709d9ba, except
  for its changes in src/port/snprintf.c; as well as commit
  cac18a76bb6b08f1ecc2a85e46c9d2ab82dd9d23 which is no longer needed.

  Fujii Masao reported that the previous commit caused failures in psql on
  OS X, since if one exits the pager program early while viewing a query
  result, psql sees an EPIPE error from fprintf --- and the wrapper function
  thought that was reason to panic.  (It's a bit surprising that the same
  does not happen on Linux.)  Further discussion among the security list
  concluded that the risk of other such failures was far too great, and
  that the one-size-fits-all approach to error handling embodied in the
  previous patch is unlikely to be workable.

  This leaves us again exposed to the possibility of the type of failure
  envisioned in CVE-2015-3166.  However, that failure mode is strictly
  hypothetical at this point: there is no concrete reason to believe that
  an attacker could trigger information disclosure through the supposed
  mechanism.  In the first place, the attack surface is fairly limited,
  since so much of what the backend does with format strings goes through
  stringinfo.c or psprintf(), and those already had adequate defenses.
  In the second place, even granting that an unprivileged attacker could
  control the occurrence of ENOMEM with some precision, it's a stretch to
  believe that he could induce it just where the target buffer contains some
  valuable information.  So we concluded that the risk of non-hypothetical
  problems induced by the patch greatly outweighs the security risks.
  We will therefore revert, and instead undertake closer analysis to
  identify specific calls that may need hardening, rather than attempt a
  universal solution.

  We have kept the portion of the previous patch that improved snprintf.c's
  handling of errors when it calls the platform's sprintf().  That seems to
  be an unalloyed improvement.

  Security: CVE-2015-3166
  2eb2fcd56b76ff7aef03f7de772e7459997e61ad:Revert error-throwing wrappers for the printf family of functions.

  This reverts commit 16304a013432931e61e623c8d85e9fe24709d9ba, except
  for its changes in src/port/snprintf.c; as well as commit
  cac18a76bb6b08f1ecc2a85e46c9d2ab82dd9d23 which is no longer needed.

  Fujii Masao reported that the previous commit caused failures in psql on
  OS X, since if one exits the pager program early while viewing a query
  result, psql sees an EPIPE error from fprintf --- and the wrapper function
  thought that was reason to panic.  (It's a bit surprising that the same
  does not happen on Linux.)  Further discussion among the security list
  concluded that the risk of other such failures was far too great, and
  that the one-size-fits-all approach to error handling embodied in the
  previous patch is unlikely to be workable.

  This leaves us again exposed to the possibility of the type of failure
  envisioned in CVE-2015-3166.  However, that failure mode is strictly
  hypothetical at this point: there is no concrete reason to believe that
  an attacker could trigger information disclosure through the supposed
  mechanism.  In the first place, the attack surface is fairly limited,
  since so much of what the backend does with format strings goes through
  stringinfo.c or psprintf(), and those already had adequate defenses.
  In the second place, even granting that an unprivileged attacker could
  control the occurrence of ENOMEM with some precision, it's a stretch to
  believe that he could induce it just where the target buffer contains some
  valuable information.  So we concluded that the risk of non-hypothetical
  problems induced by the patch greatly outweighs the security risks.
  We will therefore revert, and instead undertake closer analysis to
  identify specific calls that may need hardening, rather than attempt a
  universal solution.

  We have kept the portion of the previous patch that improved snprintf.c's
  handling of errors when it calls the platform's sprintf().  That seems to
  be an unalloyed improvement.

  Security: CVE-2015-3166
  9b5e831e342d14caeebece6c705616f10880b00d:Check return values of sensitive system library calls.

  PostgreSQL already checked the vast majority of these, missing this
  handful that nearly cannot fail.  If putenv() failed with ENOMEM in
  pg_GSS_recvauth(), authentication would proceed with the wrong keytab
  file.  If strftime() returned zero in cache_locale_time(), using the
  unspecified buffer contents could lead to information exposure or a
  crash.  Back-patch to 9.0 (all supported versions).

  Other unchecked calls to these functions, especially those in frontend
  code, pose negligible security concern.  This patch does not address
  them.  Nonetheless, it is always better to check return values whose
  specification provides for indicating an error.

  In passing, fix an off-by-one error in strftime_win32()'s invocation of
  WideCharToMultiByte().  Upon retrieving a value of exactly MAX_L10N_DATA
  bytes, strftime_win32() would overrun the caller's buffer by one byte.
  MAX_L10N_DATA is chosen to exceed the length of every possible value, so
  the vulnerable scenario probably does not arise.

  Security: CVE-2015-3166
  2cb9f2cabe3071f1cbd25ab8fe3cbc0b8d1a83d3:Check return values of sensitive system library calls.

  PostgreSQL already checked the vast majority of these, missing this
  handful that nearly cannot fail.  If putenv() failed with ENOMEM in
  pg_GSS_recvauth(), authentication would proceed with the wrong keytab
  file.  If strftime() returned zero in cache_locale_time(), using the
  unspecified buffer contents could lead to information exposure or a
  crash.  Back-patch to 9.0 (all supported versions).

  Other unchecked calls to these functions, especially those in frontend
  code, pose negligible security concern.  This patch does not address
  them.  Nonetheless, it is always better to check return values whose
  specification provides for indicating an error.

  In passing, fix an off-by-one error in strftime_win32()'s invocation of
  WideCharToMultiByte().  Upon retrieving a value of exactly MAX_L10N_DATA
  bytes, strftime_win32() would overrun the caller's buffer by one byte.
  MAX_L10N_DATA is chosen to exceed the length of every possible value, so
  the vulnerable scenario probably does not arise.

  Security: CVE-2015-3166
  b08c7aff708b403298f8e006cce0e1e82349e88e:Add error-throwing wrappers for the printf family of functions.

  All known standard library implementations of these functions can fail
  with ENOMEM.  A caller neglecting to check for failure would experience
  missing output, information exposure, or a crash.  Check return values
  within wrappers and code, currently just snprintf.c, that bypasses the
  wrappers.  The wrappers do not return after an error, so their callers
  need not check.  Back-patch to 9.0 (all supported versions).

  Popular free software standard library implementations do take pains to
  bypass malloc() in simple cases, but they risk ENOMEM for floating point
  numbers, positional arguments, large field widths, and large precisions.
  No specification demands such caution, so this commit regards every call
  to a printf family function as a potential threat.

  Injecting the wrappers implicitly is a compromise between patch scope
  and design goals.  I would prefer to edit each call site to name a
  wrapper explicitly.  libpq and the ECPG libraries would, ideally, convey
  errors to the caller rather than abort().  All that would be painfully
  invasive for a back-patched security fix, hence this compromise.

  Security: CVE-2015-3166
  e58f042d9a2cfcf47e2b3734eb9fd0e6d9a6bfb0:Add error-throwing wrappers for the printf family of functions.

  All known standard library implementations of these functions can fail
  with ENOMEM.  A caller neglecting to check for failure would experience
  missing output, information exposure, or a crash.  Check return values
  within wrappers and code, currently just snprintf.c, that bypasses the
  wrappers.  The wrappers do not return after an error, so their callers
  need not check.  Back-patch to 9.0 (all supported versions).

  Popular free software standard library implementations do take pains to
  bypass malloc() in simple cases, but they risk ENOMEM for floating point
  numbers, positional arguments, large field widths, and large precisions.
  No specification demands such caution, so this commit regards every call
  to a printf family function as a potential threat.

  Injecting the wrappers implicitly is a compromise between patch scope
  and design goals.  I would prefer to edit each call site to name a
  wrapper explicitly.  libpq and the ECPG libraries would, ideally, convey
  errors to the caller rather than abort().  All that would be painfully
  invasive for a back-patched security fix, hence this compromise.

  Security: CVE-2015-3166
  01272d95a979efb913819fb2823d3eaf3f8ad29e:Check return values of sensitive system library calls.

  PostgreSQL already checked the vast majority of these, missing this
  handful that nearly cannot fail.  If putenv() failed with ENOMEM in
  pg_GSS_recvauth(), authentication would proceed with the wrong keytab
  file.  If strftime() returned zero in cache_locale_time(), using the
  unspecified buffer contents could lead to information exposure or a
  crash.  Back-patch to 9.0 (all supported versions).

  Other unchecked calls to these functions, especially those in frontend
  code, pose negligible security concern.  This patch does not address
  them.  Nonetheless, it is always better to check return values whose
  specification provides for indicating an error.

  In passing, fix an off-by-one error in strftime_win32()'s invocation of
  WideCharToMultiByte().  Upon retrieving a value of exactly MAX_L10N_DATA
  bytes, strftime_win32() would overrun the caller's buffer by one byte.
  MAX_L10N_DATA is chosen to exceed the length of every possible value, so
  the vulnerable scenario probably does not arise.

  Security: CVE-2015-3166
  c669915fd978c5667ce209a827635befb52819c7:Check return values of sensitive system library calls.

  PostgreSQL already checked the vast majority of these, missing this
  handful that nearly cannot fail.  If putenv() failed with ENOMEM in
  pg_GSS_recvauth(), authentication would proceed with the wrong keytab
  file.  If strftime() returned zero in cache_locale_time(), using the
  unspecified buffer contents could lead to information exposure or a
  crash.  Back-patch to 9.0 (all supported versions).

  Other unchecked calls to these functions, especially those in frontend
  code, pose negligible security concern.  This patch does not address
  them.  Nonetheless, it is always better to check return values whose
  specification provides for indicating an error.

  In passing, fix an off-by-one error in strftime_win32()'s invocation of
  WideCharToMultiByte().  Upon retrieving a value of exactly MAX_L10N_DATA
  bytes, strftime_win32() would overrun the caller's buffer by one byte.
  MAX_L10N_DATA is chosen to exceed the length of every possible value, so
  the vulnerable scenario probably does not arise.

  Security: CVE-2015-3166
  82b7393eb46482fbfc901a18aaf2d388c2d16d2e:Add error-throwing wrappers for the printf family of functions.

  All known standard library implementations of these functions can fail
  with ENOMEM.  A caller neglecting to check for failure would experience
  missing output, information exposure, or a crash.  Check return values
  within wrappers and code, currently just snprintf.c, that bypasses the
  wrappers.  The wrappers do not return after an error, so their callers
  need not check.  Back-patch to 9.0 (all supported versions).

  Popular free software standard library implementations do take pains to
  bypass malloc() in simple cases, but they risk ENOMEM for floating point
  numbers, positional arguments, large field widths, and large precisions.
  No specification demands such caution, so this commit regards every call
  to a printf family function as a potential threat.

  Injecting the wrappers implicitly is a compromise between patch scope
  and design goals.  I would prefer to edit each call site to name a
  wrapper explicitly.  libpq and the ECPG libraries would, ideally, convey
  errors to the caller rather than abort().  All that would be painfully
  invasive for a back-patched security fix, hence this compromise.

  Security: CVE-2015-3166
  34d21e77081c6a3d1fb7d8b76d6a2dcef9874efe:Add error-throwing wrappers for the printf family of functions.

  All known standard library implementations of these functions can fail
  with ENOMEM.  A caller neglecting to check for failure would experience
  missing output, information exposure, or a crash.  Check return values
  within wrappers and code, currently just snprintf.c, that bypasses the
  wrappers.  The wrappers do not return after an error, so their callers
  need not check.  Back-patch to 9.0 (all supported versions).

  Popular free software standard library implementations do take pains to
  bypass malloc() in simple cases, but they risk ENOMEM for floating point
  numbers, positional arguments, large field widths, and large precisions.
  No specification demands such caution, so this commit regards every call
  to a printf family function as a potential threat.

  Injecting the wrappers implicitly is a compromise between patch scope
  and design goals.  I would prefer to edit each call site to name a
  wrapper explicitly.  libpq and the ECPG libraries would, ideally, convey
  errors to the caller rather than abort().  All that would be painfully
  invasive for a back-patched security fix, hence this compromise.

  Security: CVE-2015-3166
  ca325941d54b537e7921dbe6615bae083651dffd:Check return values of sensitive system library calls.

  PostgreSQL already checked the vast majority of these, missing this
  handful that nearly cannot fail.  If putenv() failed with ENOMEM in
  pg_GSS_recvauth(), authentication would proceed with the wrong keytab
  file.  If strftime() returned zero in cache_locale_time(), using the
  unspecified buffer contents could lead to information exposure or a
  crash.  Back-patch to 9.0 (all supported versions).

  Other unchecked calls to these functions, especially those in frontend
  code, pose negligible security concern.  This patch does not address
  them.  Nonetheless, it is always better to check return values whose
  specification provides for indicating an error.

  In passing, fix an off-by-one error in strftime_win32()'s invocation of
  WideCharToMultiByte().  Upon retrieving a value of exactly MAX_L10N_DATA
  bytes, strftime_win32() would overrun the caller's buffer by one byte.
  MAX_L10N_DATA is chosen to exceed the length of every possible value, so
  the vulnerable scenario probably does not arise.

  Security: CVE-2015-3166
  2e3bd06654217adcf41878ba3517f31f0adf0ea6:Add error-throwing wrappers for the printf family of functions.

  All known standard library implementations of these functions can fail
  with ENOMEM.  A caller neglecting to check for failure would experience
  missing output, information exposure, or a crash.  Check return values
  within wrappers and code, currently just snprintf.c, that bypasses the
  wrappers.  The wrappers do not return after an error, so their callers
  need not check.  Back-patch to 9.0 (all supported versions).

  Popular free software standard library implementations do take pains to
  bypass malloc() in simple cases, but they risk ENOMEM for floating point
  numbers, positional arguments, large field widths, and large precisions.
  No specification demands such caution, so this commit regards every call
  to a printf family function as a potential threat.

  Injecting the wrappers implicitly is a compromise between patch scope
  and design goals.  I would prefer to edit each call site to name a
  wrapper explicitly.  libpq and the ECPG libraries would, ideally, convey
  errors to the caller rather than abort().  All that would be painfully
  invasive for a back-patched security fix, hence this compromise.

  Security: CVE-2015-3166
  fd97bd411d1da45b79e63c2124741f8e82cc5a5c:Check return values of sensitive system library calls.

  PostgreSQL already checked the vast majority of these, missing this
  handful that nearly cannot fail.  If putenv() failed with ENOMEM in
  pg_GSS_recvauth(), authentication would proceed with the wrong keytab
  file.  If strftime() returned zero in cache_locale_time(), using the
  unspecified buffer contents could lead to information exposure or a
  crash.  Back-patch to 9.0 (all supported versions).

  Other unchecked calls to these functions, especially those in frontend
  code, pose negligible security concern.  This patch does not address
  them.  Nonetheless, it is always better to check return values whose
  specification provides for indicating an error.

  In passing, fix an off-by-one error in strftime_win32()'s invocation of
  WideCharToMultiByte().  Upon retrieving a value of exactly MAX_L10N_DATA
  bytes, strftime_win32() would overrun the caller's buffer by one byte.
  MAX_L10N_DATA is chosen to exceed the length of every possible value, so
  the vulnerable scenario probably does not arise.

  Security: CVE-2015-3166
  16304a013432931e61e623c8d85e9fe24709d9ba:Add error-throwing wrappers for the printf family of functions.

  All known standard library implementations of these functions can fail
  with ENOMEM.  A caller neglecting to check for failure would experience
  missing output, information exposure, or a crash.  Check return values
  within wrappers and code, currently just snprintf.c, that bypasses the
  wrappers.  The wrappers do not return after an error, so their callers
  need not check.  Back-patch to 9.0 (all supported versions).

  Popular free software standard library implementations do take pains to
  bypass malloc() in simple cases, but they risk ENOMEM for floating point
  numbers, positional arguments, large field widths, and large precisions.
  No specification demands such caution, so this commit regards every call
  to a printf family function as a potential threat.

  Injecting the wrappers implicitly is a compromise between patch scope
  and design goals.  I would prefer to edit each call site to name a
  wrapper explicitly.  libpq and the ECPG libraries would, ideally, convey
  errors to the caller rather than abort().  All that would be painfully
  invasive for a back-patched security fix, hence this compromise.

  Security: CVE-2015-3166
impacted_packages:
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 5cb8519ceb62516636362a7e8e06b99b3e1bf138
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: b08c7aff708b403298f8e006cce0e1e82349e88e
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 01272d95a979efb913819fb2823d3eaf3f8ad29e
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 2eb2fcd56b76ff7aef03f7de772e7459997e61ad
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 2e3bd06654217adcf41878ba3517f31f0adf0ea6
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: cf893530aff6d3acb893e0fbd80fd9d814605b74
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 9b5e831e342d14caeebece6c705616f10880b00d
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: fd97bd411d1da45b79e63c2124741f8e82cc5a5c
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 221f7a9494d28b938de8a72ead5f6dae39da03da
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 0510cff6e8018882a578512b52120989ea164681
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: bd9c6dc9ab9de8f07647015af65d6d2cec0057e3
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: baf379bf22a9b4fd9caa4cf95de397cac480cceb
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: c669915fd978c5667ce209a827635befb52819c7
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 16304a013432931e61e623c8d85e9fe24709d9ba
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 82b7393eb46482fbfc901a18aaf2d388c2d16d2e
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 2cb9f2cabe3071f1cbd25ab8fe3cbc0b8d1a83d3
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 70f2e3e20ff7dd10d2b405764f4818b11f167925
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 0c071936e94c6859afb2ec8d2c8dddf7bcdab7ee
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 760e7ad47959acc3908d3824a20e784f6aed9001
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 34d21e77081c6a3d1fb7d8b76d6a2dcef9874efe
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 13341276ec57fe21956239fa733ed69e1c1938fd
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: ca325941d54b537e7921dbe6615bae083651dffd
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 5b461f239eae2ad67f268e31ada7d79331b89652
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: e58f042d9a2cfcf47e2b3734eb9fd0e6d9a6bfb0
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/postgres/postgres/tree/01272d95a979efb913819fb2823d3eaf3f8ad29e
    reference_type: commit
    reference_id: 01272d95a979efb913819fb2823d3eaf3f8ad29e
  - url: https://github.com/postgres/postgres/tree/0510cff6e8018882a578512b52120989ea164681
    reference_type: commit
    reference_id: 0510cff6e8018882a578512b52120989ea164681
  - url: https://github.com/postgres/postgres/tree/0c071936e94c6859afb2ec8d2c8dddf7bcdab7ee
    reference_type: commit
    reference_id: 0c071936e94c6859afb2ec8d2c8dddf7bcdab7ee
  - url: https://github.com/postgres/postgres/tree/13341276ec57fe21956239fa733ed69e1c1938fd
    reference_type: commit
    reference_id: 13341276ec57fe21956239fa733ed69e1c1938fd
  - url: https://github.com/postgres/postgres/tree/16304a013432931e61e623c8d85e9fe24709d9ba
    reference_type: commit
    reference_id: 16304a013432931e61e623c8d85e9fe24709d9ba
  - url: https://github.com/postgres/postgres/tree/221f7a9494d28b938de8a72ead5f6dae39da03da
    reference_type: commit
    reference_id: 221f7a9494d28b938de8a72ead5f6dae39da03da
  - url: https://github.com/postgres/postgres/tree/2cb9f2cabe3071f1cbd25ab8fe3cbc0b8d1a83d3
    reference_type: commit
    reference_id: 2cb9f2cabe3071f1cbd25ab8fe3cbc0b8d1a83d3
  - url: https://github.com/postgres/postgres/tree/2e3bd06654217adcf41878ba3517f31f0adf0ea6
    reference_type: commit
    reference_id: 2e3bd06654217adcf41878ba3517f31f0adf0ea6
  - url: https://github.com/postgres/postgres/tree/2eb2fcd56b76ff7aef03f7de772e7459997e61ad
    reference_type: commit
    reference_id: 2eb2fcd56b76ff7aef03f7de772e7459997e61ad
  - url: https://github.com/postgres/postgres/tree/34d21e77081c6a3d1fb7d8b76d6a2dcef9874efe
    reference_type: commit
    reference_id: 34d21e77081c6a3d1fb7d8b76d6a2dcef9874efe
  - url: https://github.com/postgres/postgres/tree/5b461f239eae2ad67f268e31ada7d79331b89652
    reference_type: commit
    reference_id: 5b461f239eae2ad67f268e31ada7d79331b89652
  - url: https://github.com/postgres/postgres/tree/5cb8519ceb62516636362a7e8e06b99b3e1bf138
    reference_type: commit
    reference_id: 5cb8519ceb62516636362a7e8e06b99b3e1bf138
  - url: https://github.com/postgres/postgres/tree/70f2e3e20ff7dd10d2b405764f4818b11f167925
    reference_type: commit
    reference_id: 70f2e3e20ff7dd10d2b405764f4818b11f167925
  - url: https://github.com/postgres/postgres/tree/760e7ad47959acc3908d3824a20e784f6aed9001
    reference_type: commit
    reference_id: 760e7ad47959acc3908d3824a20e784f6aed9001
  - url: https://github.com/postgres/postgres/tree/82b7393eb46482fbfc901a18aaf2d388c2d16d2e
    reference_type: commit
    reference_id: 82b7393eb46482fbfc901a18aaf2d388c2d16d2e
  - url: https://github.com/postgres/postgres/tree/9b5e831e342d14caeebece6c705616f10880b00d
    reference_type: commit
    reference_id: 9b5e831e342d14caeebece6c705616f10880b00d
  - url: https://github.com/postgres/postgres/tree/b08c7aff708b403298f8e006cce0e1e82349e88e
    reference_type: commit
    reference_id: b08c7aff708b403298f8e006cce0e1e82349e88e
  - url: https://github.com/postgres/postgres/tree/baf379bf22a9b4fd9caa4cf95de397cac480cceb
    reference_type: commit
    reference_id: baf379bf22a9b4fd9caa4cf95de397cac480cceb
  - url: https://github.com/postgres/postgres/tree/bd9c6dc9ab9de8f07647015af65d6d2cec0057e3
    reference_type: commit
    reference_id: bd9c6dc9ab9de8f07647015af65d6d2cec0057e3
  - url: https://github.com/postgres/postgres/tree/c669915fd978c5667ce209a827635befb52819c7
    reference_type: commit
    reference_id: c669915fd978c5667ce209a827635befb52819c7
  - url: https://github.com/postgres/postgres/tree/ca325941d54b537e7921dbe6615bae083651dffd
    reference_type: commit
    reference_id: ca325941d54b537e7921dbe6615bae083651dffd
  - url: https://github.com/postgres/postgres/tree/cf893530aff6d3acb893e0fbd80fd9d814605b74
    reference_type: commit
    reference_id: cf893530aff6d3acb893e0fbd80fd9d814605b74
  - url: https://github.com/postgres/postgres/tree/e58f042d9a2cfcf47e2b3734eb9fd0e6d9a6bfb0
    reference_type: commit
    reference_id: e58f042d9a2cfcf47e2b3734eb9fd0e6d9a6bfb0
  - url: https://github.com/postgres/postgres/tree/fd97bd411d1da45b79e63c2124741f8e82cc5a5c
    reference_type: commit
    reference_id: fd97bd411d1da45b79e63c2124741f8e82cc5a5c
