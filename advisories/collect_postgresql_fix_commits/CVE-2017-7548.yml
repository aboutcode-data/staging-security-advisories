advisory_id: CVE-2017-7548
datasource_id: collect_postgresql_fix_commits/CVE-2017-7548
datasource_url: https://github.com/postgres/postgres
aliases: []
summary: |
  ae20b23a9e7029f31ee902da08a464d968319f56:Refactor permissions checks for large objects.

  Up to now, ACL checks for large objects happened at the level of
  the SQL-callable functions, which led to CVE-2017-7548 because of a
  missing check.  Push them down to be enforced in inv_api.c as much
  as possible, in hopes of preventing future bugs.  This does have the
  effect of moving read and write permission errors to happen at lo_open
  time not loread or lowrite time, but that seems acceptable.

  Michael Paquier and Tom Lane

  Discussion: https://postgr.es/m/CAB7nPqRHmNOYbETnc_2EjsuzSM00Z+BWKv9sy6tnvSd5gWT_JA@mail.gmail.com
  a8b37ebe407f1916c5df22452cdbb1d00e2a409d:Last-minute updates for release notes.

  Security: CVE-2017-7546, CVE-2017-7547, CVE-2017-7548
  e28b2b094319e007b53ba384bb114c3f0b775a05:Last-minute updates for release notes.

  Security: CVE-2017-7546, CVE-2017-7547, CVE-2017-7548
  d64440f5fb7483faeb5fc1c9822e1ad2e0b555e2:Last-minute updates for release notes.

  Security: CVE-2017-7546, CVE-2017-7547, CVE-2017-7548
  5bb8162e45e3604a0f29825f792594f6ab2a7973:Last-minute updates for release notes.

  Security: CVE-2017-7546, CVE-2017-7547, CVE-2017-7548
  16f4297d1dc892eb55b384eb0a11543287138de3:Last-minute updates for release notes.

  Security: CVE-2017-7546, CVE-2017-7547, CVE-2017-7548
  57b995a9a4650cd294e1017946af54aabbbfe146:Last-minute updates for release notes.

  Security: CVE-2017-7546, CVE-2017-7547, CVE-2017-7548
  f1cda6d6cbb2b551331802cab57957fa5307cf2c:Require update permission for the large object written by lo_put().

  lo_put() surely should require UPDATE permission, the same as lowrite(),
  but it failed to check for that, as reported by Chapman Flack.  Oversight
  in commit c50b7c09d; backpatch to 9.4 where that was introduced.

  Tom Lane and Michael Paquier

  Security: CVE-2017-7548
  873741c6821d4fe8245b97e2adf1e8142c8b7531:Require update permission for the large object written by lo_put().

  lo_put() surely should require UPDATE permission, the same as lowrite(),
  but it failed to check for that, as reported by Chapman Flack.  Oversight
  in commit c50b7c09d; backpatch to 9.4 where that was introduced.

  Tom Lane and Michael Paquier

  Security: CVE-2017-7548
  52a414387e192a89f5fec19d9876159d03cf112b:Require update permission for the large object written by lo_put().

  lo_put() surely should require UPDATE permission, the same as lowrite(),
  but it failed to check for that, as reported by Chapman Flack.  Oversight
  in commit c50b7c09d; backpatch to 9.4 where that was introduced.

  Tom Lane and Michael Paquier

  Security: CVE-2017-7548
  8d9881911f0d30e0783a6bb1363b94a2c817433d:Require update permission for the large object written by lo_put().

  lo_put() surely should require UPDATE permission, the same as lowrite(),
  but it failed to check for that, as reported by Chapman Flack.  Oversight
  in commit c50b7c09d; backpatch to 9.4 where that was introduced.

  Tom Lane and Michael Paquier

  Security: CVE-2017-7548
impacted_packages:
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: d64440f5fb7483faeb5fc1c9822e1ad2e0b555e2
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 5bb8162e45e3604a0f29825f792594f6ab2a7973
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: e28b2b094319e007b53ba384bb114c3f0b775a05
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 16f4297d1dc892eb55b384eb0a11543287138de3
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 52a414387e192a89f5fec19d9876159d03cf112b
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 8d9881911f0d30e0783a6bb1363b94a2c817433d
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: ae20b23a9e7029f31ee902da08a464d968319f56
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 873741c6821d4fe8245b97e2adf1e8142c8b7531
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 57b995a9a4650cd294e1017946af54aabbbfe146
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: a8b37ebe407f1916c5df22452cdbb1d00e2a409d
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: f1cda6d6cbb2b551331802cab57957fa5307cf2c
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/postgres/postgres/tree/16f4297d1dc892eb55b384eb0a11543287138de3
    reference_type: commit
    reference_id: 16f4297d1dc892eb55b384eb0a11543287138de3
  - url: https://github.com/postgres/postgres/tree/52a414387e192a89f5fec19d9876159d03cf112b
    reference_type: commit
    reference_id: 52a414387e192a89f5fec19d9876159d03cf112b
  - url: https://github.com/postgres/postgres/tree/57b995a9a4650cd294e1017946af54aabbbfe146
    reference_type: commit
    reference_id: 57b995a9a4650cd294e1017946af54aabbbfe146
  - url: https://github.com/postgres/postgres/tree/5bb8162e45e3604a0f29825f792594f6ab2a7973
    reference_type: commit
    reference_id: 5bb8162e45e3604a0f29825f792594f6ab2a7973
  - url: https://github.com/postgres/postgres/tree/873741c6821d4fe8245b97e2adf1e8142c8b7531
    reference_type: commit
    reference_id: 873741c6821d4fe8245b97e2adf1e8142c8b7531
  - url: https://github.com/postgres/postgres/tree/8d9881911f0d30e0783a6bb1363b94a2c817433d
    reference_type: commit
    reference_id: 8d9881911f0d30e0783a6bb1363b94a2c817433d
  - url: https://github.com/postgres/postgres/tree/a8b37ebe407f1916c5df22452cdbb1d00e2a409d
    reference_type: commit
    reference_id: a8b37ebe407f1916c5df22452cdbb1d00e2a409d
  - url: https://github.com/postgres/postgres/tree/ae20b23a9e7029f31ee902da08a464d968319f56
    reference_type: commit
    reference_id: ae20b23a9e7029f31ee902da08a464d968319f56
  - url: https://github.com/postgres/postgres/tree/d64440f5fb7483faeb5fc1c9822e1ad2e0b555e2
    reference_type: commit
    reference_id: d64440f5fb7483faeb5fc1c9822e1ad2e0b555e2
  - url: https://github.com/postgres/postgres/tree/e28b2b094319e007b53ba384bb114c3f0b775a05
    reference_type: commit
    reference_id: e28b2b094319e007b53ba384bb114c3f0b775a05
  - url: https://github.com/postgres/postgres/tree/f1cda6d6cbb2b551331802cab57957fa5307cf2c
    reference_type: commit
    reference_id: f1cda6d6cbb2b551331802cab57957fa5307cf2c
