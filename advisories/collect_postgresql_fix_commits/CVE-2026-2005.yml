advisory_id: CVE-2026-2005
datasource_id: collect_postgresql_fix_commits/CVE-2026-2005
datasource_url: https://github.com/postgres/postgres
aliases: []
summary: |
  8771763bd97607882dd47925dceea0859a59ce97:Last-minute updates for release notes.

  Security: CVE-2026-2003, CVE-2026-2004, CVE-2026-2005, CVE-2026-2006, CVE-2026-2007
  749e616b7693cec9baaaf8744d740d436693ac91:Last-minute updates for release notes.

  Security: CVE-2026-2003, CVE-2026-2004, CVE-2026-2005, CVE-2026-2006, CVE-2026-2007
  9889b3b64fe6bb52084159ae9bc5f2f5943fdd8a:Last-minute updates for release notes.

  Security: CVE-2026-2003, CVE-2026-2004, CVE-2026-2005, CVE-2026-2006, CVE-2026-2007
  a3acb409025a2f8e2cb93346bbc1d87281f861fc:Last-minute updates for release notes.

  Security: CVE-2026-2003, CVE-2026-2004, CVE-2026-2005, CVE-2026-2006, CVE-2026-2007
  30d2603f5c340133ca03e098fcaa9c242843d5e1:Last-minute updates for release notes.

  Security: CVE-2026-2003, CVE-2026-2004, CVE-2026-2005, CVE-2026-2006, CVE-2026-2007
  01de2e32df7b5b46720f64068a2674c3bd28ae3f:pgcrypto: Fix buffer overflow in pgp_pub_decrypt_bytea()

  pgp_pub_decrypt_bytea() was missing a safeguard for the session key
  length read from the message data, that can be given in input of
  pgp_pub_decrypt_bytea().  This can result in the possibility of a buffer
  overflow for the session key data, when the length specified is longer
  than PGP_MAX_KEY, which is the maximum size of the buffer where the
  session data is copied to.

  A script able to rebuild the message and key data that can trigger the
  overflow is included in this commit, based on some contents provided by
  the reporter, heavily editted by me.  A SQL test is added, based on the
  data generated by the script.

  Reported-by: Team Xint Code as part of zeroday.cloud
  Author: Michael Paquier <michael@paquier.xyz>
  Reviewed-by: Noah Misch <noah@leadboat.com>
  Security: CVE-2026-2005
  Backpatch-through: 14
  9a9982ec6d40cf13e223ed83de1e5729b6e15720:pgcrypto: Fix buffer overflow in pgp_pub_decrypt_bytea()

  pgp_pub_decrypt_bytea() was missing a safeguard for the session key
  length read from the message data, that can be given in input of
  pgp_pub_decrypt_bytea().  This can result in the possibility of a buffer
  overflow for the session key data, when the length specified is longer
  than PGP_MAX_KEY, which is the maximum size of the buffer where the
  session data is copied to.

  A script able to rebuild the message and key data that can trigger the
  overflow is included in this commit, based on some contents provided by
  the reporter, heavily editted by me.  A SQL test is added, based on the
  data generated by the script.

  Reported-by: Team Xint Code as part of zeroday.cloud
  Author: Michael Paquier <michael@paquier.xyz>
  Reviewed-by: Noah Misch <noah@leadboat.com>
  Security: CVE-2026-2005
  Backpatch-through: 14
  527b730f41b2f2fbcda92cfd1dbbc50c14c9a46f:pgcrypto: Fix buffer overflow in pgp_pub_decrypt_bytea()

  pgp_pub_decrypt_bytea() was missing a safeguard for the session key
  length read from the message data, that can be given in input of
  pgp_pub_decrypt_bytea().  This can result in the possibility of a buffer
  overflow for the session key data, when the length specified is longer
  than PGP_MAX_KEY, which is the maximum size of the buffer where the
  session data is copied to.

  A script able to rebuild the message and key data that can trigger the
  overflow is included in this commit, based on some contents provided by
  the reporter, heavily editted by me.  A SQL test is added, based on the
  data generated by the script.

  Reported-by: Team Xint Code as part of zeroday.cloud
  Author: Michael Paquier <michael@paquier.xyz>
  Reviewed-by: Noah Misch <noah@leadboat.com>
  Security: CVE-2026-2005
  Backpatch-through: 14
  7a7d9693c72e680af86298f01d850f95fef0988e:pgcrypto: Fix buffer overflow in pgp_pub_decrypt_bytea()

  pgp_pub_decrypt_bytea() was missing a safeguard for the session key
  length read from the message data, that can be given in input of
  pgp_pub_decrypt_bytea().  This can result in the possibility of a buffer
  overflow for the session key data, when the length specified is longer
  than PGP_MAX_KEY, which is the maximum size of the buffer where the
  session data is copied to.

  A script able to rebuild the message and key data that can trigger the
  overflow is included in this commit, based on some contents provided by
  the reporter, heavily editted by me.  A SQL test is added, based on the
  data generated by the script.

  Reported-by: Team Xint Code as part of zeroday.cloud
  Author: Michael Paquier <michael@paquier.xyz>
  Reviewed-by: Noah Misch <noah@leadboat.com>
  Security: CVE-2026-2005
  Backpatch-through: 14
  209f387b81660e478eea147db9130af1d1c861f2:pgcrypto: Fix buffer overflow in pgp_pub_decrypt_bytea()

  pgp_pub_decrypt_bytea() was missing a safeguard for the session key
  length read from the message data, that can be given in input of
  pgp_pub_decrypt_bytea().  This can result in the possibility of a buffer
  overflow for the session key data, when the length specified is longer
  than PGP_MAX_KEY, which is the maximum size of the buffer where the
  session data is copied to.

  A script able to rebuild the message and key data that can trigger the
  overflow is included in this commit, based on some contents provided by
  the reporter, heavily editted by me.  A SQL test is added, based on the
  data generated by the script.

  Reported-by: Team Xint Code as part of zeroday.cloud
  Author: Michael Paquier <michael@paquier.xyz>
  Reviewed-by: Noah Misch <noah@leadboat.com>
  Security: CVE-2026-2005
  Backpatch-through: 14
  379695d3cc70d040b547d912ce4842090d917ece:pgcrypto: Fix buffer overflow in pgp_pub_decrypt_bytea()

  pgp_pub_decrypt_bytea() was missing a safeguard for the session key
  length read from the message data, that can be given in input of
  pgp_pub_decrypt_bytea().  This can result in the possibility of a buffer
  overflow for the session key data, when the length specified is longer
  than PGP_MAX_KEY, which is the maximum size of the buffer where the
  session data is copied to.

  A script able to rebuild the message and key data that can trigger the
  overflow is included in this commit, based on some contents provided by
  the reporter, heavily editted by me.  A SQL test is added, based on the
  data generated by the script.

  Reported-by: Team Xint Code as part of zeroday.cloud
  Author: Michael Paquier <michael@paquier.xyz>
  Reviewed-by: Noah Misch <noah@leadboat.com>
  Security: CVE-2026-2005
  Backpatch-through: 14
impacted_packages:
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: a3acb409025a2f8e2cb93346bbc1d87281f861fc
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 379695d3cc70d040b547d912ce4842090d917ece
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 9a9982ec6d40cf13e223ed83de1e5729b6e15720
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 527b730f41b2f2fbcda92cfd1dbbc50c14c9a46f
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 8771763bd97607882dd47925dceea0859a59ce97
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 30d2603f5c340133ca03e098fcaa9c242843d5e1
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 01de2e32df7b5b46720f64068a2674c3bd28ae3f
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 749e616b7693cec9baaaf8744d740d436693ac91
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 209f387b81660e478eea147db9130af1d1c861f2
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 7a7d9693c72e680af86298f01d850f95fef0988e
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 9889b3b64fe6bb52084159ae9bc5f2f5943fdd8a
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/postgres/postgres/tree/01de2e32df7b5b46720f64068a2674c3bd28ae3f
    reference_type: commit
    reference_id: 01de2e32df7b5b46720f64068a2674c3bd28ae3f
  - url: https://github.com/postgres/postgres/tree/209f387b81660e478eea147db9130af1d1c861f2
    reference_type: commit
    reference_id: 209f387b81660e478eea147db9130af1d1c861f2
  - url: https://github.com/postgres/postgres/tree/30d2603f5c340133ca03e098fcaa9c242843d5e1
    reference_type: commit
    reference_id: 30d2603f5c340133ca03e098fcaa9c242843d5e1
  - url: https://github.com/postgres/postgres/tree/379695d3cc70d040b547d912ce4842090d917ece
    reference_type: commit
    reference_id: 379695d3cc70d040b547d912ce4842090d917ece
  - url: https://github.com/postgres/postgres/tree/527b730f41b2f2fbcda92cfd1dbbc50c14c9a46f
    reference_type: commit
    reference_id: 527b730f41b2f2fbcda92cfd1dbbc50c14c9a46f
  - url: https://github.com/postgres/postgres/tree/749e616b7693cec9baaaf8744d740d436693ac91
    reference_type: commit
    reference_id: 749e616b7693cec9baaaf8744d740d436693ac91
  - url: https://github.com/postgres/postgres/tree/7a7d9693c72e680af86298f01d850f95fef0988e
    reference_type: commit
    reference_id: 7a7d9693c72e680af86298f01d850f95fef0988e
  - url: https://github.com/postgres/postgres/tree/8771763bd97607882dd47925dceea0859a59ce97
    reference_type: commit
    reference_id: 8771763bd97607882dd47925dceea0859a59ce97
  - url: https://github.com/postgres/postgres/tree/9889b3b64fe6bb52084159ae9bc5f2f5943fdd8a
    reference_type: commit
    reference_id: 9889b3b64fe6bb52084159ae9bc5f2f5943fdd8a
  - url: https://github.com/postgres/postgres/tree/9a9982ec6d40cf13e223ed83de1e5729b6e15720
    reference_type: commit
    reference_id: 9a9982ec6d40cf13e223ed83de1e5729b6e15720
  - url: https://github.com/postgres/postgres/tree/a3acb409025a2f8e2cb93346bbc1d87281f861fc
    reference_type: commit
    reference_id: a3acb409025a2f8e2cb93346bbc1d87281f861fc
