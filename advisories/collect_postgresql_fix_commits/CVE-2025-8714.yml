advisory_id: CVE-2025-8714
datasource_id: collect_postgresql_fix_commits/CVE-2025-8714
datasource_url: https://github.com/postgres/postgres
aliases: []
summary: |
  17d41fc70d5b87a1fc1b41d045a9634da120a74f:Last-minute updates for release notes.

  Security: CVE-2025-8713, CVE-2025-8714, CVE-2025-8715
  2e19ad79e1a14e5dacd0ad3a3ec959fff928ca17:Last-minute updates for release notes.

  Security: CVE-2025-8713, CVE-2025-8714, CVE-2025-8715
  4eb9733b2b76aeaca84e450be8c7653012ab215a:Last-minute updates for release notes.

  Security: CVE-2025-8713, CVE-2025-8714, CVE-2025-8715
  18d01671ef2576f7f950c2797a467370bc1a654d:Last-minute updates for release notes.

  Security: CVE-2025-8713, CVE-2025-8714, CVE-2025-8715
  86ad5a84c76b0ed1cf9ddb1d88f7204a9a076051:Last-minute updates for release notes.

  Security: CVE-2025-8713, CVE-2025-8714, CVE-2025-8715
  27d3dee6807484395a3d6e268c61097f03b36815:Fix MSVC pg_upgrade test.

  In the back-branch versions of commit 71ea0d6795, I missed updating
  this test to use --restrict-key so that the generated dump output
  is comparable.

  Per buildfarm member hamerkop.

  Reviewed-by: Tom Lane <tgl@sss.pgh.pa.us>
  Security: CVE-2025-8714
  Backpatch-through: 13-14
  8967c33c67b85a33fee5ffb9bf16a67b640bacb8:Fix MSVC pg_upgrade test.

  In the back-branch versions of commit 71ea0d6795, I missed updating
  this test to use --restrict-key so that the generated dump output
  is comparable.

  Per buildfarm member hamerkop.

  Reviewed-by: Tom Lane <tgl@sss.pgh.pa.us>
  Security: CVE-2025-8714
  Backpatch-through: 13-14
  67a2fbb8f9e9f75df08208e75da412c43a814688:Restrict psql meta-commands in plain-text dumps.

  A malicious server could inject psql meta-commands into plain-text
  dump output (i.e., scripts created with pg_dump --format=plain,
  pg_dumpall, or pg_restore --file) that are run at restore time on
  the machine running psql.  To fix, introduce a new "restricted"
  mode in psql that blocks all meta-commands (except for \unrestrict
  to exit the mode), and teach pg_dump, pg_dumpall, and pg_restore to
  use this mode in plain-text dumps.

  While at it, encourage users to only restore dumps generated from
  trusted servers or to inspect it beforehand, since restoring causes
  the destination to execute arbitrary code of the source superusers'
  choice.  However, the client running the dump and restore needn't
  trust the source or destination superusers.

  Reported-by: Martin Rakhmanov
  Reported-by: Matthieu Denais <litezeraw@gmail.com>
  Reported-by: RyotaK <ryotak.mail@gmail.com>
  Suggested-by: Tom Lane <tgl@sss.pgh.pa.us>
  Reviewed-by: Noah Misch <noah@leadboat.com>
  Reviewed-by: Michael Paquier <michael@paquier.xyz>
  Reviewed-by: Peter Eisentraut <peter@eisentraut.org>
  Security: CVE-2025-8714
  Backpatch-through: 13
  42404050685de4047a7b57b13f8ec4959666328a:Restrict psql meta-commands in plain-text dumps.

  A malicious server could inject psql meta-commands into plain-text
  dump output (i.e., scripts created with pg_dump --format=plain,
  pg_dumpall, or pg_restore --file) that are run at restore time on
  the machine running psql.  To fix, introduce a new "restricted"
  mode in psql that blocks all meta-commands (except for \unrestrict
  to exit the mode), and teach pg_dump, pg_dumpall, and pg_restore to
  use this mode in plain-text dumps.

  While at it, encourage users to only restore dumps generated from
  trusted servers or to inspect it beforehand, since restoring causes
  the destination to execute arbitrary code of the source superusers'
  choice.  However, the client running the dump and restore needn't
  trust the source or destination superusers.

  Reported-by: Martin Rakhmanov
  Reported-by: Matthieu Denais <litezeraw@gmail.com>
  Reported-by: RyotaK <ryotak.mail@gmail.com>
  Suggested-by: Tom Lane <tgl@sss.pgh.pa.us>
  Reviewed-by: Noah Misch <noah@leadboat.com>
  Reviewed-by: Michael Paquier <michael@paquier.xyz>
  Reviewed-by: Peter Eisentraut <peter@eisentraut.org>
  Security: CVE-2025-8714
  Backpatch-through: 13
  7ad8e790988d3a49010ec00e0cec0dace4c7416f:Restrict psql meta-commands in plain-text dumps.

  A malicious server could inject psql meta-commands into plain-text
  dump output (i.e., scripts created with pg_dump --format=plain,
  pg_dumpall, or pg_restore --file) that are run at restore time on
  the machine running psql.  To fix, introduce a new "restricted"
  mode in psql that blocks all meta-commands (except for \unrestrict
  to exit the mode), and teach pg_dump, pg_dumpall, and pg_restore to
  use this mode in plain-text dumps.

  While at it, encourage users to only restore dumps generated from
  trusted servers or to inspect it beforehand, since restoring causes
  the destination to execute arbitrary code of the source superusers'
  choice.  However, the client running the dump and restore needn't
  trust the source or destination superusers.

  Reported-by: Martin Rakhmanov
  Reported-by: Matthieu Denais <litezeraw@gmail.com>
  Reported-by: RyotaK <ryotak.mail@gmail.com>
  Suggested-by: Tom Lane <tgl@sss.pgh.pa.us>
  Reviewed-by: Noah Misch <noah@leadboat.com>
  Reviewed-by: Michael Paquier <michael@paquier.xyz>
  Reviewed-by: Peter Eisentraut <peter@eisentraut.org>
  Security: CVE-2025-8714
  Backpatch-through: 13
  575f54d4cee8b141a91b3e5c3d7d65372c0f5219:Restrict psql meta-commands in plain-text dumps.

  A malicious server could inject psql meta-commands into plain-text
  dump output (i.e., scripts created with pg_dump --format=plain,
  pg_dumpall, or pg_restore --file) that are run at restore time on
  the machine running psql.  To fix, introduce a new "restricted"
  mode in psql that blocks all meta-commands (except for \unrestrict
  to exit the mode), and teach pg_dump, pg_dumpall, and pg_restore to
  use this mode in plain-text dumps.

  While at it, encourage users to only restore dumps generated from
  trusted servers or to inspect it beforehand, since restoring causes
  the destination to execute arbitrary code of the source superusers'
  choice.  However, the client running the dump and restore needn't
  trust the source or destination superusers.

  Reported-by: Martin Rakhmanov
  Reported-by: Matthieu Denais <litezeraw@gmail.com>
  Reported-by: RyotaK <ryotak.mail@gmail.com>
  Suggested-by: Tom Lane <tgl@sss.pgh.pa.us>
  Reviewed-by: Noah Misch <noah@leadboat.com>
  Reviewed-by: Michael Paquier <michael@paquier.xyz>
  Reviewed-by: Peter Eisentraut <peter@eisentraut.org>
  Security: CVE-2025-8714
  Backpatch-through: 13
  71ea0d6795438f95f4ee6e35867058c44b270d51:Restrict psql meta-commands in plain-text dumps.

  A malicious server could inject psql meta-commands into plain-text
  dump output (i.e., scripts created with pg_dump --format=plain,
  pg_dumpall, or pg_restore --file) that are run at restore time on
  the machine running psql.  To fix, introduce a new "restricted"
  mode in psql that blocks all meta-commands (except for \unrestrict
  to exit the mode), and teach pg_dump, pg_dumpall, and pg_restore to
  use this mode in plain-text dumps.

  While at it, encourage users to only restore dumps generated from
  trusted servers or to inspect it beforehand, since restoring causes
  the destination to execute arbitrary code of the source superusers'
  choice.  However, the client running the dump and restore needn't
  trust the source or destination superusers.

  Reported-by: Martin Rakhmanov
  Reported-by: Matthieu Denais <litezeraw@gmail.com>
  Reported-by: RyotaK <ryotak.mail@gmail.com>
  Suggested-by: Tom Lane <tgl@sss.pgh.pa.us>
  Reviewed-by: Noah Misch <noah@leadboat.com>
  Reviewed-by: Michael Paquier <michael@paquier.xyz>
  Reviewed-by: Peter Eisentraut <peter@eisentraut.org>
  Security: CVE-2025-8714
  Backpatch-through: 13
  c204bd39f7b57284363390f50e81abfc350a0fb9:Restrict psql meta-commands in plain-text dumps.

  A malicious server could inject psql meta-commands into plain-text
  dump output (i.e., scripts created with pg_dump --format=plain,
  pg_dumpall, or pg_restore --file) that are run at restore time on
  the machine running psql.  To fix, introduce a new "restricted"
  mode in psql that blocks all meta-commands (except for \unrestrict
  to exit the mode), and teach pg_dump, pg_dumpall, and pg_restore to
  use this mode in plain-text dumps.

  While at it, encourage users to only restore dumps generated from
  trusted servers or to inspect it beforehand, since restoring causes
  the destination to execute arbitrary code of the source superusers'
  choice.  However, the client running the dump and restore needn't
  trust the source or destination superusers.

  Reported-by: Martin Rakhmanov
  Reported-by: Matthieu Denais <litezeraw@gmail.com>
  Reported-by: RyotaK <ryotak.mail@gmail.com>
  Suggested-by: Tom Lane <tgl@sss.pgh.pa.us>
  Reviewed-by: Noah Misch <noah@leadboat.com>
  Reviewed-by: Michael Paquier <michael@paquier.xyz>
  Reviewed-by: Peter Eisentraut <peter@eisentraut.org>
  Security: CVE-2025-8714
  Backpatch-through: 13
  e4998d089d903da6114209ae36da747b195375ca:Restrict psql meta-commands in plain-text dumps.

  A malicious server could inject psql meta-commands into plain-text
  dump output (i.e., scripts created with pg_dump --format=plain,
  pg_dumpall, or pg_restore --file) that are run at restore time on
  the machine running psql.  To fix, introduce a new "restricted"
  mode in psql that blocks all meta-commands (except for \unrestrict
  to exit the mode), and teach pg_dump, pg_dumpall, and pg_restore to
  use this mode in plain-text dumps.

  While at it, encourage users to only restore dumps generated from
  trusted servers or to inspect it beforehand, since restoring causes
  the destination to execute arbitrary code of the source superusers'
  choice.  However, the client running the dump and restore needn't
  trust the source or destination superusers.

  Reported-by: Martin Rakhmanov
  Reported-by: Matthieu Denais <litezeraw@gmail.com>
  Reported-by: RyotaK <ryotak.mail@gmail.com>
  Suggested-by: Tom Lane <tgl@sss.pgh.pa.us>
  Reviewed-by: Noah Misch <noah@leadboat.com>
  Reviewed-by: Michael Paquier <michael@paquier.xyz>
  Reviewed-by: Peter Eisentraut <peter@eisentraut.org>
  Security: CVE-2025-8714
  Backpatch-through: 13
impacted_packages:
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 7ad8e790988d3a49010ec00e0cec0dace4c7416f
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 575f54d4cee8b141a91b3e5c3d7d65372c0f5219
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 27d3dee6807484395a3d6e268c61097f03b36815
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 8967c33c67b85a33fee5ffb9bf16a67b640bacb8
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 71ea0d6795438f95f4ee6e35867058c44b270d51
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 18d01671ef2576f7f950c2797a467370bc1a654d
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 67a2fbb8f9e9f75df08208e75da412c43a814688
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 86ad5a84c76b0ed1cf9ddb1d88f7204a9a076051
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: e4998d089d903da6114209ae36da747b195375ca
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: c204bd39f7b57284363390f50e81abfc350a0fb9
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 17d41fc70d5b87a1fc1b41d045a9634da120a74f
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 4eb9733b2b76aeaca84e450be8c7653012ab215a
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 42404050685de4047a7b57b13f8ec4959666328a
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 2e19ad79e1a14e5dacd0ad3a3ec959fff928ca17
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/postgres/postgres/tree/17d41fc70d5b87a1fc1b41d045a9634da120a74f
    reference_type: commit
    reference_id: 17d41fc70d5b87a1fc1b41d045a9634da120a74f
  - url: https://github.com/postgres/postgres/tree/18d01671ef2576f7f950c2797a467370bc1a654d
    reference_type: commit
    reference_id: 18d01671ef2576f7f950c2797a467370bc1a654d
  - url: https://github.com/postgres/postgres/tree/27d3dee6807484395a3d6e268c61097f03b36815
    reference_type: commit
    reference_id: 27d3dee6807484395a3d6e268c61097f03b36815
  - url: https://github.com/postgres/postgres/tree/2e19ad79e1a14e5dacd0ad3a3ec959fff928ca17
    reference_type: commit
    reference_id: 2e19ad79e1a14e5dacd0ad3a3ec959fff928ca17
  - url: https://github.com/postgres/postgres/tree/42404050685de4047a7b57b13f8ec4959666328a
    reference_type: commit
    reference_id: 42404050685de4047a7b57b13f8ec4959666328a
  - url: https://github.com/postgres/postgres/tree/4eb9733b2b76aeaca84e450be8c7653012ab215a
    reference_type: commit
    reference_id: 4eb9733b2b76aeaca84e450be8c7653012ab215a
  - url: https://github.com/postgres/postgres/tree/575f54d4cee8b141a91b3e5c3d7d65372c0f5219
    reference_type: commit
    reference_id: 575f54d4cee8b141a91b3e5c3d7d65372c0f5219
  - url: https://github.com/postgres/postgres/tree/67a2fbb8f9e9f75df08208e75da412c43a814688
    reference_type: commit
    reference_id: 67a2fbb8f9e9f75df08208e75da412c43a814688
  - url: https://github.com/postgres/postgres/tree/71ea0d6795438f95f4ee6e35867058c44b270d51
    reference_type: commit
    reference_id: 71ea0d6795438f95f4ee6e35867058c44b270d51
  - url: https://github.com/postgres/postgres/tree/7ad8e790988d3a49010ec00e0cec0dace4c7416f
    reference_type: commit
    reference_id: 7ad8e790988d3a49010ec00e0cec0dace4c7416f
  - url: https://github.com/postgres/postgres/tree/86ad5a84c76b0ed1cf9ddb1d88f7204a9a076051
    reference_type: commit
    reference_id: 86ad5a84c76b0ed1cf9ddb1d88f7204a9a076051
  - url: https://github.com/postgres/postgres/tree/8967c33c67b85a33fee5ffb9bf16a67b640bacb8
    reference_type: commit
    reference_id: 8967c33c67b85a33fee5ffb9bf16a67b640bacb8
  - url: https://github.com/postgres/postgres/tree/c204bd39f7b57284363390f50e81abfc350a0fb9
    reference_type: commit
    reference_id: c204bd39f7b57284363390f50e81abfc350a0fb9
  - url: https://github.com/postgres/postgres/tree/e4998d089d903da6114209ae36da747b195375ca
    reference_type: commit
    reference_id: e4998d089d903da6114209ae36da747b195375ca
