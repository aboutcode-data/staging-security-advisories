advisory_id: CVE-2007-2138
datasource_id: collect_postgresql_fix_commits/CVE-2007-2138
datasource_url: https://github.com/postgres/postgres
aliases: []
summary: |
  afb2cce743d4455f9ef88373cffcdadaf0600352:Fix StatisticsObjIsVisibleExt() for pg_temp.

  Neighbor get_statistics_object_oid() ignores objects in pg_temp, as has
  been the standard for non-relation, non-type namespace searches since
  CVE-2007-2138.  Hence, most operations that name a statistics object
  correctly decline to map an unqualified name to a statistics object in
  pg_temp.  StatisticsObjIsVisibleExt() did not.  Consequently,
  pg_statistics_obj_is_visible() wrongly returned true for such objects,
  psql \dX wrongly listed them, and getObjectDescription()-based ereport()
  and pg_describe_object() wrongly omitted namespace qualification.  Any
  malfunction beyond that would depend on how a human or application acts
  on those wrong indications.  Commit
  d99d58cdc8c0b5b50ee92995e8575c100b1a458a introduced this.  Back-patch to
  v13 (all supported versions).

  Reviewed-by: Nathan Bossart <nathandbossart@gmail.com>
  Discussion: https://postgr.es/m/20250920162116.2e.nmisch@google.com
  Backpatch-through: 13
  5816baa9bcf3db6cb98e689dabe06276aa8fb3f2:Fix StatisticsObjIsVisibleExt() for pg_temp.

  Neighbor get_statistics_object_oid() ignores objects in pg_temp, as has
  been the standard for non-relation, non-type namespace searches since
  CVE-2007-2138.  Hence, most operations that name a statistics object
  correctly decline to map an unqualified name to a statistics object in
  pg_temp.  StatisticsObjIsVisibleExt() did not.  Consequently,
  pg_statistics_obj_is_visible() wrongly returned true for such objects,
  psql \dX wrongly listed them, and getObjectDescription()-based ereport()
  and pg_describe_object() wrongly omitted namespace qualification.  Any
  malfunction beyond that would depend on how a human or application acts
  on those wrong indications.  Commit
  d99d58cdc8c0b5b50ee92995e8575c100b1a458a introduced this.  Back-patch to
  v13 (all supported versions).

  Reviewed-by: Nathan Bossart <nathandbossart@gmail.com>
  Discussion: https://postgr.es/m/20250920162116.2e.nmisch@google.com
  Backpatch-through: 13
  d202ec1fb29d5307ab7783f00eaa206bb1f1345d:Fix StatisticsObjIsVisibleExt() for pg_temp.

  Neighbor get_statistics_object_oid() ignores objects in pg_temp, as has
  been the standard for non-relation, non-type namespace searches since
  CVE-2007-2138.  Hence, most operations that name a statistics object
  correctly decline to map an unqualified name to a statistics object in
  pg_temp.  StatisticsObjIsVisibleExt() did not.  Consequently,
  pg_statistics_obj_is_visible() wrongly returned true for such objects,
  psql \dX wrongly listed them, and getObjectDescription()-based ereport()
  and pg_describe_object() wrongly omitted namespace qualification.  Any
  malfunction beyond that would depend on how a human or application acts
  on those wrong indications.  Commit
  d99d58cdc8c0b5b50ee92995e8575c100b1a458a introduced this.  Back-patch to
  v13 (all supported versions).

  Reviewed-by: Nathan Bossart <nathandbossart@gmail.com>
  Discussion: https://postgr.es/m/20250920162116.2e.nmisch@google.com
  Backpatch-through: 13
  ab16418ee0ecc9632436f085b09af73ed2444091:Fix StatisticsObjIsVisibleExt() for pg_temp.

  Neighbor get_statistics_object_oid() ignores objects in pg_temp, as has
  been the standard for non-relation, non-type namespace searches since
  CVE-2007-2138.  Hence, most operations that name a statistics object
  correctly decline to map an unqualified name to a statistics object in
  pg_temp.  StatisticsObjIsVisibleExt() did not.  Consequently,
  pg_statistics_obj_is_visible() wrongly returned true for such objects,
  psql \dX wrongly listed them, and getObjectDescription()-based ereport()
  and pg_describe_object() wrongly omitted namespace qualification.  Any
  malfunction beyond that would depend on how a human or application acts
  on those wrong indications.  Commit
  d99d58cdc8c0b5b50ee92995e8575c100b1a458a introduced this.  Back-patch to
  v13 (all supported versions).

  Reviewed-by: Nathan Bossart <nathandbossart@gmail.com>
  Discussion: https://postgr.es/m/20250920162116.2e.nmisch@google.com
  Backpatch-through: 13
  6778fbca63c9efffefee8086914cef8428c4ccad:Fix StatisticsObjIsVisibleExt() for pg_temp.

  Neighbor get_statistics_object_oid() ignores objects in pg_temp, as has
  been the standard for non-relation, non-type namespace searches since
  CVE-2007-2138.  Hence, most operations that name a statistics object
  correctly decline to map an unqualified name to a statistics object in
  pg_temp.  StatisticsObjIsVisibleExt() did not.  Consequently,
  pg_statistics_obj_is_visible() wrongly returned true for such objects,
  psql \dX wrongly listed them, and getObjectDescription()-based ereport()
  and pg_describe_object() wrongly omitted namespace qualification.  Any
  malfunction beyond that would depend on how a human or application acts
  on those wrong indications.  Commit
  d99d58cdc8c0b5b50ee92995e8575c100b1a458a introduced this.  Back-patch to
  v13 (all supported versions).

  Reviewed-by: Nathan Bossart <nathandbossart@gmail.com>
  Discussion: https://postgr.es/m/20250920162116.2e.nmisch@google.com
  Backpatch-through: 13
  d024160fffc8065b9b007c6be1b5f907eb2122c9:Fix StatisticsObjIsVisibleExt() for pg_temp.

  Neighbor get_statistics_object_oid() ignores objects in pg_temp, as has
  been the standard for non-relation, non-type namespace searches since
  CVE-2007-2138.  Hence, most operations that name a statistics object
  correctly decline to map an unqualified name to a statistics object in
  pg_temp.  StatisticsObjIsVisibleExt() did not.  Consequently,
  pg_statistics_obj_is_visible() wrongly returned true for such objects,
  psql \dX wrongly listed them, and getObjectDescription()-based ereport()
  and pg_describe_object() wrongly omitted namespace qualification.  Any
  malfunction beyond that would depend on how a human or application acts
  on those wrong indications.  Commit
  d99d58cdc8c0b5b50ee92995e8575c100b1a458a introduced this.  Back-patch to
  v13 (all supported versions).

  Reviewed-by: Nathan Bossart <nathandbossart@gmail.com>
  Discussion: https://postgr.es/m/20250920162116.2e.nmisch@google.com
  Backpatch-through: 13
  a95393ecdb23563bd47eeb2c943640c88592d82b:Fix StatisticsObjIsVisibleExt() for pg_temp.

  Neighbor get_statistics_object_oid() ignores objects in pg_temp, as has
  been the standard for non-relation, non-type namespace searches since
  CVE-2007-2138.  Hence, most operations that name a statistics object
  correctly decline to map an unqualified name to a statistics object in
  pg_temp.  StatisticsObjIsVisibleExt() did not.  Consequently,
  pg_statistics_obj_is_visible() wrongly returned true for such objects,
  psql \dX wrongly listed them, and getObjectDescription()-based ereport()
  and pg_describe_object() wrongly omitted namespace qualification.  Any
  malfunction beyond that would depend on how a human or application acts
  on those wrong indications.  Commit
  d99d58cdc8c0b5b50ee92995e8575c100b1a458a introduced this.  Back-patch to
  v13 (all supported versions).

  Reviewed-by: Nathan Bossart <nathandbossart@gmail.com>
  Discussion: https://postgr.es/m/20250920162116.2e.nmisch@google.com
  Backpatch-through: 13
  653f0f0b539d8023b222c3b1527c09bd1ffffab9:Fix markup.

  Security: CVE-2007-2138
  9903eaf7a17b9c2418ffd7af810d79d5a5f42cb3:Fix markup.

  Security: CVE-2007-2138
  cfe1b04c66078a604aba5073133830e7fd5ce7d0:Fix markup.

  Security: CVE-2007-2138
  d8f365365b6196b9ce6636032bf20b0f2ac06926:Fix markup.

  Security: CVE-2007-2138
  ce8a3e6c88bde941225b6c984da7d706f7840b3d:Fix markup.

  Security: CVE-2007-2138
  23c8b0ccc6e200643d1ee860cd71372d06d4a94b:Fix markup.

  Security: CVE-2007-2138
  a174b6fb6c99306ee57b488a418b31e6c9a95ee8:Fix markup.

  Security: CVE-2007-2138
  82942036372f93eade0ca8d974e7d979f366819e:Fix markup.

  Security: CVE-2007-2138
  a796aac46fd8e93ac5d5b328eb48460507d6a645:Support explicit placement of the temporary-table schema within search_path.
  This is needed to allow a security-definer function to set a truly secure
  value of search_path.  Without it, a malicious user can use temporary objects
  to execute code with the privileges of the security-definer function.  Even
  pushing the temp schema to the back of the search path is not quite good
  enough, because a function or operator at the back of the path might still
  capture control from one nearer the front due to having a more exact datatype
  match.  Hence, disable searching the temp schema altogether for functions and
  operators.

  Security: CVE-2007-2138
  eaabaa7e045874b8b5ec158368e2b5403f5fc69c:Support explicit placement of the temporary-table schema within search_path.
  This is needed to allow a security-definer function to set a truly secure
  value of search_path.  Without it, a malicious user can use temporary objects
  to execute code with the privileges of the security-definer function.  Even
  pushing the temp schema to the back of the search path is not quite good
  enough, because a function or operator at the back of the path might still
  capture control from one nearer the front due to having a more exact datatype
  match.  Hence, disable searching the temp schema altogether for functions and
  operators.

  Security: CVE-2007-2138
  566331a2e983cc6bf00baf11b4cfe9b906a2727d:Support explicit placement of the temporary-table schema within search_path.
  This is needed to allow a security-definer function to set a truly secure
  value of search_path.  Without it, a malicious user can use temporary objects
  to execute code with the privileges of the security-definer function.  Even
  pushing the temp schema to the back of the search path is not quite good
  enough, because a function or operator at the back of the path might still
  capture control from one nearer the front due to having a more exact datatype
  match.  Hence, disable searching the temp schema altogether for functions and
  operators.

  Security: CVE-2007-2138
  fc52d13ca68de10ab837ee4d9a13fd68f69ea33e:Support explicit placement of the temporary-table schema within search_path.
  This is needed to allow a security-definer function to set a truly secure
  value of search_path.  Without it, a malicious user can use temporary objects
  to execute code with the privileges of the security-definer function.  Even
  pushing the temp schema to the back of the search path is not quite good
  enough, because a function or operator at the back of the path might still
  capture control from one nearer the front due to having a more exact datatype
  match.  Hence, disable searching the temp schema altogether for functions and
  operators.

  Security: CVE-2007-2138
  d694bdd1c9a2f4042f74fbc1f5e4e82f99aa4aac:Support explicit placement of the temporary-table schema within search_path.
  This is needed to allow a security-definer function to set a truly secure
  value of search_path.  Without it, a malicious user can use temporary objects
  to execute code with the privileges of the security-definer function.  Even
  pushing the temp schema to the back of the search path is not quite good
  enough, because a function or operator at the back of the path might still
  capture control from one nearer the front due to having a more exact datatype
  match.  Hence, disable searching the temp schema altogether for functions and
  operators.

  Security: CVE-2007-2138
  aa27977fe21a7dfa4da4376ad66ae37cb8f0d0b5:Support explicit placement of the temporary-table schema within search_path.
  This is needed to allow a security-definer function to set a truly secure
  value of search_path.  Without it, a malicious user can use temporary objects
  to execute code with the privileges of the security-definer function.  Even
  pushing the temp schema to the back of the search path is not quite good
  enough, because a function or operator at the back of the path might still
  capture control from one nearer the front due to having a more exact datatype
  match.  Hence, disable searching the temp schema altogether for functions and
  operators.

  Security: CVE-2007-2138
impacted_packages:
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: afb2cce743d4455f9ef88373cffcdadaf0600352
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 6778fbca63c9efffefee8086914cef8428c4ccad
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 653f0f0b539d8023b222c3b1527c09bd1ffffab9
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: eaabaa7e045874b8b5ec158368e2b5403f5fc69c
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 566331a2e983cc6bf00baf11b4cfe9b906a2727d
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: fc52d13ca68de10ab837ee4d9a13fd68f69ea33e
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 82942036372f93eade0ca8d974e7d979f366819e
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: d694bdd1c9a2f4042f74fbc1f5e4e82f99aa4aac
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: a95393ecdb23563bd47eeb2c943640c88592d82b
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: d202ec1fb29d5307ab7783f00eaa206bb1f1345d
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 5816baa9bcf3db6cb98e689dabe06276aa8fb3f2
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: ce8a3e6c88bde941225b6c984da7d706f7840b3d
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 9903eaf7a17b9c2418ffd7af810d79d5a5f42cb3
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 23c8b0ccc6e200643d1ee860cd71372d06d4a94b
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: a796aac46fd8e93ac5d5b328eb48460507d6a645
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: d8f365365b6196b9ce6636032bf20b0f2ac06926
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: ab16418ee0ecc9632436f085b09af73ed2444091
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: a174b6fb6c99306ee57b488a418b31e6c9a95ee8
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: d024160fffc8065b9b007c6be1b5f907eb2122c9
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: cfe1b04c66078a604aba5073133830e7fd5ce7d0
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: aa27977fe21a7dfa4da4376ad66ae37cb8f0d0b5
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/postgres/postgres/tree/23c8b0ccc6e200643d1ee860cd71372d06d4a94b
    reference_type: commit
    reference_id: 23c8b0ccc6e200643d1ee860cd71372d06d4a94b
  - url: https://github.com/postgres/postgres/tree/566331a2e983cc6bf00baf11b4cfe9b906a2727d
    reference_type: commit
    reference_id: 566331a2e983cc6bf00baf11b4cfe9b906a2727d
  - url: https://github.com/postgres/postgres/tree/5816baa9bcf3db6cb98e689dabe06276aa8fb3f2
    reference_type: commit
    reference_id: 5816baa9bcf3db6cb98e689dabe06276aa8fb3f2
  - url: https://github.com/postgres/postgres/tree/653f0f0b539d8023b222c3b1527c09bd1ffffab9
    reference_type: commit
    reference_id: 653f0f0b539d8023b222c3b1527c09bd1ffffab9
  - url: https://github.com/postgres/postgres/tree/6778fbca63c9efffefee8086914cef8428c4ccad
    reference_type: commit
    reference_id: 6778fbca63c9efffefee8086914cef8428c4ccad
  - url: https://github.com/postgres/postgres/tree/82942036372f93eade0ca8d974e7d979f366819e
    reference_type: commit
    reference_id: 82942036372f93eade0ca8d974e7d979f366819e
  - url: https://github.com/postgres/postgres/tree/9903eaf7a17b9c2418ffd7af810d79d5a5f42cb3
    reference_type: commit
    reference_id: 9903eaf7a17b9c2418ffd7af810d79d5a5f42cb3
  - url: https://github.com/postgres/postgres/tree/a174b6fb6c99306ee57b488a418b31e6c9a95ee8
    reference_type: commit
    reference_id: a174b6fb6c99306ee57b488a418b31e6c9a95ee8
  - url: https://github.com/postgres/postgres/tree/a796aac46fd8e93ac5d5b328eb48460507d6a645
    reference_type: commit
    reference_id: a796aac46fd8e93ac5d5b328eb48460507d6a645
  - url: https://github.com/postgres/postgres/tree/a95393ecdb23563bd47eeb2c943640c88592d82b
    reference_type: commit
    reference_id: a95393ecdb23563bd47eeb2c943640c88592d82b
  - url: https://github.com/postgres/postgres/tree/aa27977fe21a7dfa4da4376ad66ae37cb8f0d0b5
    reference_type: commit
    reference_id: aa27977fe21a7dfa4da4376ad66ae37cb8f0d0b5
  - url: https://github.com/postgres/postgres/tree/ab16418ee0ecc9632436f085b09af73ed2444091
    reference_type: commit
    reference_id: ab16418ee0ecc9632436f085b09af73ed2444091
  - url: https://github.com/postgres/postgres/tree/afb2cce743d4455f9ef88373cffcdadaf0600352
    reference_type: commit
    reference_id: afb2cce743d4455f9ef88373cffcdadaf0600352
  - url: https://github.com/postgres/postgres/tree/ce8a3e6c88bde941225b6c984da7d706f7840b3d
    reference_type: commit
    reference_id: ce8a3e6c88bde941225b6c984da7d706f7840b3d
  - url: https://github.com/postgres/postgres/tree/cfe1b04c66078a604aba5073133830e7fd5ce7d0
    reference_type: commit
    reference_id: cfe1b04c66078a604aba5073133830e7fd5ce7d0
  - url: https://github.com/postgres/postgres/tree/d024160fffc8065b9b007c6be1b5f907eb2122c9
    reference_type: commit
    reference_id: d024160fffc8065b9b007c6be1b5f907eb2122c9
  - url: https://github.com/postgres/postgres/tree/d202ec1fb29d5307ab7783f00eaa206bb1f1345d
    reference_type: commit
    reference_id: d202ec1fb29d5307ab7783f00eaa206bb1f1345d
  - url: https://github.com/postgres/postgres/tree/d694bdd1c9a2f4042f74fbc1f5e4e82f99aa4aac
    reference_type: commit
    reference_id: d694bdd1c9a2f4042f74fbc1f5e4e82f99aa4aac
  - url: https://github.com/postgres/postgres/tree/d8f365365b6196b9ce6636032bf20b0f2ac06926
    reference_type: commit
    reference_id: d8f365365b6196b9ce6636032bf20b0f2ac06926
  - url: https://github.com/postgres/postgres/tree/eaabaa7e045874b8b5ec158368e2b5403f5fc69c
    reference_type: commit
    reference_id: eaabaa7e045874b8b5ec158368e2b5403f5fc69c
  - url: https://github.com/postgres/postgres/tree/fc52d13ca68de10ab837ee4d9a13fd68f69ea33e
    reference_type: commit
    reference_id: fc52d13ca68de10ab837ee4d9a13fd68f69ea33e
