advisory_id: CVE-2013-1899
datasource_id: collect_postgresql_fix_commits/CVE-2013-1899
datasource_url: https://github.com/postgres/postgres
aliases: []
summary: |
  bc0630bdd30027cd75254ed6e4dc4f31ff335de5:Update release notes for 9.2.4, 9.1.9, 9.0.13, 8.4.17.

  Security: CVE-2013-1899, CVE-2013-1901
  07918b41f485a86748375d5dadb3d2d2ef6f4155:Update release notes for 9.2.4, 9.1.9, 9.0.13, 8.4.17.

  Security: CVE-2013-1899, CVE-2013-1901
  5e3d2123a0c30f499ed1ba411e68007a11838723:Update release notes for 9.2.4, 9.1.9, 9.0.13, 8.4.17.

  Security: CVE-2013-1899, CVE-2013-1901
  0dfbad834ffe8f828cbb05d63f744be9cd7d0ab6:Update release notes for 9.2.4, 9.1.9, 9.0.13, 8.4.17.

  Security: CVE-2013-1899, CVE-2013-1901
  89b661bab99e8573fad271f68755ba286932dec2:Update release notes for 9.2.4, 9.1.9, 9.0.13, 8.4.17.

  Security: CVE-2013-1899, CVE-2013-1901
  3d21a0f3009ad0ba3236499e3851732352e35af6:Fix insecure parsing of server command-line switches.

  An oversight in commit e710b65c1c56ca7b91f662c63d37ff2e72862a94 allowed
  database names beginning with "-" to be treated as though they were secure
  command-line switches; and this switch processing occurs before client
  authentication, so that even an unprivileged remote attacker could exploit
  the bug, needing only connectivity to the postmaster's port.  Assorted
  exploits for this are possible, some requiring a valid database login,
  some not.  The worst known problem is that the "-r" switch can be invoked
  to redirect the process's stderr output, so that subsequent error messages
  will be appended to any file the server can write.  This can for example be
  used to corrupt the server's configuration files, so that it will fail when
  next restarted.  Complete destruction of database tables is also possible.

  Fix by keeping the database name extracted from a startup packet fully
  separate from command-line switches, as had already been done with the
  user name field.

  The Postgres project thanks Mitsumasa Kondo for discovering this bug,
  Kyotaro Horiguchi for drafting the fix, and Noah Misch for recognizing
  the full extent of the danger.

  Security: CVE-2013-1899
  ddf177228fb303e2fd855b399ab8098daa2d3376:Fix insecure parsing of server command-line switches.

  An oversight in commit e710b65c1c56ca7b91f662c63d37ff2e72862a94 allowed
  database names beginning with "-" to be treated as though they were secure
  command-line switches; and this switch processing occurs before client
  authentication, so that even an unprivileged remote attacker could exploit
  the bug, needing only connectivity to the postmaster's port.  Assorted
  exploits for this are possible, some requiring a valid database login,
  some not.  The worst known problem is that the "-r" switch can be invoked
  to redirect the process's stderr output, so that subsequent error messages
  will be appended to any file the server can write.  This can for example be
  used to corrupt the server's configuration files, so that it will fail when
  next restarted.  Complete destruction of database tables is also possible.

  Fix by keeping the database name extracted from a startup packet fully
  separate from command-line switches, as had already been done with the
  user name field.

  The Postgres project thanks Mitsumasa Kondo for discovering this bug,
  Kyotaro Horiguchi for drafting the fix, and Noah Misch for recognizing
  the full extent of the danger.

  Security: CVE-2013-1899
  a6e0cd7b76c04acc8c8f868a3bcd0f9ff13e16c8:Fix insecure parsing of server command-line switches.

  An oversight in commit e710b65c1c56ca7b91f662c63d37ff2e72862a94 allowed
  database names beginning with "-" to be treated as though they were secure
  command-line switches; and this switch processing occurs before client
  authentication, so that even an unprivileged remote attacker could exploit
  the bug, needing only connectivity to the postmaster's port.  Assorted
  exploits for this are possible, some requiring a valid database login,
  some not.  The worst known problem is that the "-r" switch can be invoked
  to redirect the process's stderr output, so that subsequent error messages
  will be appended to any file the server can write.  This can for example be
  used to corrupt the server's configuration files, so that it will fail when
  next restarted.  Complete destruction of database tables is also possible.

  Fix by keeping the database name extracted from a startup packet fully
  separate from command-line switches, as had already been done with the
  user name field.

  The Postgres project thanks Mitsumasa Kondo for discovering this bug,
  Kyotaro Horiguchi for drafting the fix, and Noah Misch for recognizing
  the full extent of the danger.

  Security: CVE-2013-1899
  17fe2793ea7fe269ed616cb305150b6cf38dbaa8:Fix insecure parsing of server command-line switches.

  An oversight in commit e710b65c1c56ca7b91f662c63d37ff2e72862a94 allowed
  database names beginning with "-" to be treated as though they were secure
  command-line switches; and this switch processing occurs before client
  authentication, so that even an unprivileged remote attacker could exploit
  the bug, needing only connectivity to the postmaster's port.  Assorted
  exploits for this are possible, some requiring a valid database login,
  some not.  The worst known problem is that the "-r" switch can be invoked
  to redirect the process's stderr output, so that subsequent error messages
  will be appended to any file the server can write.  This can for example be
  used to corrupt the server's configuration files, so that it will fail when
  next restarted.  Complete destruction of database tables is also possible.

  Fix by keeping the database name extracted from a startup packet fully
  separate from command-line switches, as had already been done with the
  user name field.

  The Postgres project thanks Mitsumasa Kondo for discovering this bug,
  Kyotaro Horiguchi for drafting the fix, and Noah Misch for recognizing
  the full extent of the danger.

  Security: CVE-2013-1899
impacted_packages:
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 3d21a0f3009ad0ba3236499e3851732352e35af6
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 5e3d2123a0c30f499ed1ba411e68007a11838723
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: bc0630bdd30027cd75254ed6e4dc4f31ff335de5
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 07918b41f485a86748375d5dadb3d2d2ef6f4155
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 0dfbad834ffe8f828cbb05d63f744be9cd7d0ab6
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: a6e0cd7b76c04acc8c8f868a3bcd0f9ff13e16c8
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: ddf177228fb303e2fd855b399ab8098daa2d3376
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 17fe2793ea7fe269ed616cb305150b6cf38dbaa8
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 89b661bab99e8573fad271f68755ba286932dec2
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/postgres/postgres/tree/07918b41f485a86748375d5dadb3d2d2ef6f4155
    reference_type: commit
    reference_id: 07918b41f485a86748375d5dadb3d2d2ef6f4155
  - url: https://github.com/postgres/postgres/tree/0dfbad834ffe8f828cbb05d63f744be9cd7d0ab6
    reference_type: commit
    reference_id: 0dfbad834ffe8f828cbb05d63f744be9cd7d0ab6
  - url: https://github.com/postgres/postgres/tree/17fe2793ea7fe269ed616cb305150b6cf38dbaa8
    reference_type: commit
    reference_id: 17fe2793ea7fe269ed616cb305150b6cf38dbaa8
  - url: https://github.com/postgres/postgres/tree/3d21a0f3009ad0ba3236499e3851732352e35af6
    reference_type: commit
    reference_id: 3d21a0f3009ad0ba3236499e3851732352e35af6
  - url: https://github.com/postgres/postgres/tree/5e3d2123a0c30f499ed1ba411e68007a11838723
    reference_type: commit
    reference_id: 5e3d2123a0c30f499ed1ba411e68007a11838723
  - url: https://github.com/postgres/postgres/tree/89b661bab99e8573fad271f68755ba286932dec2
    reference_type: commit
    reference_id: 89b661bab99e8573fad271f68755ba286932dec2
  - url: https://github.com/postgres/postgres/tree/a6e0cd7b76c04acc8c8f868a3bcd0f9ff13e16c8
    reference_type: commit
    reference_id: a6e0cd7b76c04acc8c8f868a3bcd0f9ff13e16c8
  - url: https://github.com/postgres/postgres/tree/bc0630bdd30027cd75254ed6e4dc4f31ff335de5
    reference_type: commit
    reference_id: bc0630bdd30027cd75254ed6e4dc4f31ff335de5
  - url: https://github.com/postgres/postgres/tree/ddf177228fb303e2fd855b399ab8098daa2d3376
    reference_type: commit
    reference_id: ddf177228fb303e2fd855b399ab8098daa2d3376
