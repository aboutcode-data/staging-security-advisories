advisory_id: CVE-2014-8161
datasource_id: collect_postgresql_fix_commits/CVE-2014-8161
datasource_url: https://github.com/postgres/postgres
aliases: []
summary: |
  3a20633694c1a1b1a260eed2aa4fa7ece46e07ca:Fix column-privilege leak in error-message paths

  While building error messages to return to the user,
  BuildIndexValueDescription and ri_ReportViolation would happily include
  the entire key or entire row in the result returned to the user, even if
  the user didn't have access to view all of the columns being included.

  Instead, include only those columns which the user is providing or which
  the user has select rights on.  If the user does not have any rights
  to view the table or any of the columns involved then no detail is
  provided and a NULL value is returned from BuildIndexValueDescription.
  Note that, for key cases, the user must have access to all of the
  columns for the key to be shown; a partial key will not be returned.

  Back-patch all the way, as column-level privileges are now in all
  supported versions.

  This has been assigned CVE-2014-8161, but since the issue and the patch
  have already been publicized on pgsql-hackers, there's no point in trying
  to hide this commit.
  9406884af19e2620a14059e64d4eb6ab430ab328:Fix column-privilege leak in error-message paths

  While building error messages to return to the user,
  BuildIndexValueDescription and ri_ReportViolation would happily include
  the entire key or entire row in the result returned to the user, even if
  the user didn't have access to view all of the columns being included.

  Instead, include only those columns which the user is providing or which
  the user has select rights on.  If the user does not have any rights
  to view the table or any of the columns involved then no detail is
  provided and a NULL value is returned from BuildIndexValueDescription.
  Note that, for key cases, the user must have access to all of the
  columns for the key to be shown; a partial key will not be returned.

  Back-patch all the way, as column-level privileges are now in all
  supported versions.

  This has been assigned CVE-2014-8161, but since the issue and the patch
  have already been publicized on pgsql-hackers, there's no point in trying
  to hide this commit.
  d49f84b084d82aac3ddc387f9f306c28240f62f7:Fix column-privilege leak in error-message paths

  While building error messages to return to the user,
  BuildIndexValueDescription, ExecBuildSlotValueDescription and
  ri_ReportViolation would happily include the entire key or entire row in
  the result returned to the user, even if the user didn't have access to
  view all of the columns being included.

  Instead, include only those columns which the user is providing or which
  the user has select rights on.  If the user does not have any rights
  to view the table or any of the columns involved then no detail is
  provided and a NULL value is returned from BuildIndexValueDescription
  and ExecBuildSlotValueDescription.  Note that, for key cases, the user
  must have access to all of the columns for the key to be shown; a
  partial key will not be returned.

  Back-patch all the way, as column-level privileges are now in all
  supported versions.

  This has been assigned CVE-2014-8161, but since the issue and the patch
  have already been publicized on pgsql-hackers, there's no point in trying
  to hide this commit.
  4b987421612131eb15e9cdb0c0363b2a9fb95325:Fix column-privilege leak in error-message paths

  While building error messages to return to the user,
  BuildIndexValueDescription, ExecBuildSlotValueDescription and
  ri_ReportViolation would happily include the entire key or entire row in
  the result returned to the user, even if the user didn't have access to
  view all of the columns being included.

  Instead, include only those columns which the user is providing or which
  the user has select rights on.  If the user does not have any rights
  to view the table or any of the columns involved then no detail is
  provided and a NULL value is returned from BuildIndexValueDescription
  and ExecBuildSlotValueDescription.  Note that, for key cases, the user
  must have access to all of the columns for the key to be shown; a
  partial key will not be returned.

  Back-patch all the way, as column-level privileges are now in all
  supported versions.

  This has been assigned CVE-2014-8161, but since the issue and the patch
  have already been publicized on pgsql-hackers, there's no point in trying
  to hide this commit.
  3cc74a3d61f26e6558ee662b6700f74962bd1d8b:Fix column-privilege leak in error-message paths

  While building error messages to return to the user,
  BuildIndexValueDescription, ExecBuildSlotValueDescription and
  ri_ReportViolation would happily include the entire key or entire row in
  the result returned to the user, even if the user didn't have access to
  view all of the columns being included.

  Instead, include only those columns which the user is providing or which
  the user has select rights on.  If the user does not have any rights
  to view the table or any of the columns involved then no detail is
  provided and a NULL value is returned from BuildIndexValueDescription
  and ExecBuildSlotValueDescription.  Note that, for key cases, the user
  must have access to all of the columns for the key to be shown; a
  partial key will not be returned.

  Back-patch all the way, as column-level privileges are now in all
  supported versions.

  This has been assigned CVE-2014-8161, but since the issue and the patch
  have already been publicized on pgsql-hackers, there's no point in trying
  to hide this commit.
  804b6b6db4dcfc590a468e7be390738f9f7755fb:Fix column-privilege leak in error-message paths

  While building error messages to return to the user,
  BuildIndexValueDescription, ExecBuildSlotValueDescription and
  ri_ReportViolation would happily include the entire key or entire row in
  the result returned to the user, even if the user didn't have access to
  view all of the columns being included.

  Instead, include only those columns which the user is providing or which
  the user has select rights on.  If the user does not have any rights
  to view the table or any of the columns involved then no detail is
  provided and a NULL value is returned from BuildIndexValueDescription
  and ExecBuildSlotValueDescription.  Note that, for key cases, the user
  must have access to all of the columns for the key to be shown; a
  partial key will not be returned.

  Further, in master only, do not return any data for cases where row
  security is enabled on the relation and row security should be applied
  for the user.  This required a bit of refactoring and moving of things
  around related to RLS- note the addition of utils/misc/rls.c.

  Back-patch all the way, as column-level privileges are now in all
  supported versions.

  This has been assigned CVE-2014-8161, but since the issue and the patch
  have already been publicized on pgsql-hackers, there's no point in trying
  to hide this commit.
impacted_packages:
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 3cc74a3d61f26e6558ee662b6700f74962bd1d8b
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 804b6b6db4dcfc590a468e7be390738f9f7755fb
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 9406884af19e2620a14059e64d4eb6ab430ab328
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 4b987421612131eb15e9cdb0c0363b2a9fb95325
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: d49f84b084d82aac3ddc387f9f306c28240f62f7
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 3a20633694c1a1b1a260eed2aa4fa7ece46e07ca
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/postgres/postgres/tree/3a20633694c1a1b1a260eed2aa4fa7ece46e07ca
    reference_type: commit
    reference_id: 3a20633694c1a1b1a260eed2aa4fa7ece46e07ca
  - url: https://github.com/postgres/postgres/tree/3cc74a3d61f26e6558ee662b6700f74962bd1d8b
    reference_type: commit
    reference_id: 3cc74a3d61f26e6558ee662b6700f74962bd1d8b
  - url: https://github.com/postgres/postgres/tree/4b987421612131eb15e9cdb0c0363b2a9fb95325
    reference_type: commit
    reference_id: 4b987421612131eb15e9cdb0c0363b2a9fb95325
  - url: https://github.com/postgres/postgres/tree/804b6b6db4dcfc590a468e7be390738f9f7755fb
    reference_type: commit
    reference_id: 804b6b6db4dcfc590a468e7be390738f9f7755fb
  - url: https://github.com/postgres/postgres/tree/9406884af19e2620a14059e64d4eb6ab430ab328
    reference_type: commit
    reference_id: 9406884af19e2620a14059e64d4eb6ab430ab328
  - url: https://github.com/postgres/postgres/tree/d49f84b084d82aac3ddc387f9f306c28240f62f7
    reference_type: commit
    reference_id: d49f84b084d82aac3ddc387f9f306c28240f62f7
