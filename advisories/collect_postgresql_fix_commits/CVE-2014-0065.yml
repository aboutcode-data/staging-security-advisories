advisory_id: CVE-2014-0065
datasource_id: collect_postgresql_fix_commits/CVE-2014-0065
datasource_url: https://github.com/postgres/postgres
aliases: []
summary: |
  69d2bc14ada1ab6dd9c0fdcdb0a6e9a7f5f8134d:Prevent potential overruns of fixed-size buffers.

  Coverity identified a number of places in which it couldn't prove that a
  string being copied into a fixed-size buffer would fit.  We believe that
  most, perhaps all of these are in fact safe, or are copying data that is
  coming from a trusted source so that any overrun is not really a security
  issue.  Nonetheless it seems prudent to forestall any risk by using
  strlcpy() and similar functions.

  Fixes by Peter Eisentraut and Jozef Mlich based on Coverity reports.

  In addition, fix a potential null-pointer-dereference crash in
  contrib/chkpass.  The crypt(3) function is defined to return NULL on
  failure, but chkpass.c didn't check for that before using the result.
  The main practical case in which this could be an issue is if libc is
  configured to refuse to execute unapproved hashing algorithms (e.g.,
  "FIPS mode").  This ideally should've been a separate commit, but
  since it touches code adjacent to one of the buffer overrun changes,
  I included it in this commit to avoid last-minute merge issues.
  This issue was reported by Honza Horak.

  Security: CVE-2014-0065 for buffer overruns, CVE-2014-0066 for crypt()
  45bf2404a2f586a35e8647890a7d5917b787a623:Prevent potential overruns of fixed-size buffers.

  Coverity identified a number of places in which it couldn't prove that a
  string being copied into a fixed-size buffer would fit.  We believe that
  most, perhaps all of these are in fact safe, or are copying data that is
  coming from a trusted source so that any overrun is not really a security
  issue.  Nonetheless it seems prudent to forestall any risk by using
  strlcpy() and similar functions.

  Fixes by Peter Eisentraut and Jozef Mlich based on Coverity reports.

  In addition, fix a potential null-pointer-dereference crash in
  contrib/chkpass.  The crypt(3) function is defined to return NULL on
  failure, but chkpass.c didn't check for that before using the result.
  The main practical case in which this could be an issue is if libc is
  configured to refuse to execute unapproved hashing algorithms (e.g.,
  "FIPS mode").  This ideally should've been a separate commit, but
  since it touches code adjacent to one of the buffer overrun changes,
  I included it in this commit to avoid last-minute merge issues.
  This issue was reported by Honza Horak.

  Security: CVE-2014-0065 for buffer overruns, CVE-2014-0066 for crypt()
  4741e316006b16d60a2ee1bc1703f0588f1200de:Prevent potential overruns of fixed-size buffers.

  Coverity identified a number of places in which it couldn't prove that a
  string being copied into a fixed-size buffer would fit.  We believe that
  most, perhaps all of these are in fact safe, or are copying data that is
  coming from a trusted source so that any overrun is not really a security
  issue.  Nonetheless it seems prudent to forestall any risk by using
  strlcpy() and similar functions.

  Fixes by Peter Eisentraut and Jozef Mlich based on Coverity reports.

  In addition, fix a potential null-pointer-dereference crash in
  contrib/chkpass.  The crypt(3) function is defined to return NULL on
  failure, but chkpass.c didn't check for that before using the result.
  The main practical case in which this could be an issue is if libc is
  configured to refuse to execute unapproved hashing algorithms (e.g.,
  "FIPS mode").  This ideally should've been a separate commit, but
  since it touches code adjacent to one of the buffer overrun changes,
  I included it in this commit to avoid last-minute merge issues.
  This issue was reported by Honza Horak.

  Security: CVE-2014-0065 for buffer overruns, CVE-2014-0066 for crypt()
  655b665f745e2e07cf6936c6063b0250f5caa98f:Prevent potential overruns of fixed-size buffers.

  Coverity identified a number of places in which it couldn't prove that a
  string being copied into a fixed-size buffer would fit.  We believe that
  most, perhaps all of these are in fact safe, or are copying data that is
  coming from a trusted source so that any overrun is not really a security
  issue.  Nonetheless it seems prudent to forestall any risk by using
  strlcpy() and similar functions.

  Fixes by Peter Eisentraut and Jozef Mlich based on Coverity reports.

  In addition, fix a potential null-pointer-dereference crash in
  contrib/chkpass.  The crypt(3) function is defined to return NULL on
  failure, but chkpass.c didn't check for that before using the result.
  The main practical case in which this could be an issue is if libc is
  configured to refuse to execute unapproved hashing algorithms (e.g.,
  "FIPS mode").  This ideally should've been a separate commit, but
  since it touches code adjacent to one of the buffer overrun changes,
  I included it in this commit to avoid last-minute merge issues.
  This issue was reported by Honza Horak.

  Security: CVE-2014-0065 for buffer overruns, CVE-2014-0066 for crypt()
  e3208fec32586076cd1a24cae19ded158a60e15a:Prevent potential overruns of fixed-size buffers.

  Coverity identified a number of places in which it couldn't prove that a
  string being copied into a fixed-size buffer would fit.  We believe that
  most, perhaps all of these are in fact safe, or are copying data that is
  coming from a trusted source so that any overrun is not really a security
  issue.  Nonetheless it seems prudent to forestall any risk by using
  strlcpy() and similar functions.

  Fixes by Peter Eisentraut and Jozef Mlich based on Coverity reports.

  In addition, fix a potential null-pointer-dereference crash in
  contrib/chkpass.  The crypt(3) function is defined to return NULL on
  failure, but chkpass.c didn't check for that before using the result.
  The main practical case in which this could be an issue is if libc is
  configured to refuse to execute unapproved hashing algorithms (e.g.,
  "FIPS mode").  This ideally should've been a separate commit, but
  since it touches code adjacent to one of the buffer overrun changes,
  I included it in this commit to avoid last-minute merge issues.
  This issue was reported by Honza Horak.

  Security: CVE-2014-0065 for buffer overruns, CVE-2014-0066 for crypt()
  01824385aead50e557ca1af28640460fa9877d51:Prevent potential overruns of fixed-size buffers.

  Coverity identified a number of places in which it couldn't prove that a
  string being copied into a fixed-size buffer would fit.  We believe that
  most, perhaps all of these are in fact safe, or are copying data that is
  coming from a trusted source so that any overrun is not really a security
  issue.  Nonetheless it seems prudent to forestall any risk by using
  strlcpy() and similar functions.

  Fixes by Peter Eisentraut and Jozef Mlich based on Coverity reports.

  In addition, fix a potential null-pointer-dereference crash in
  contrib/chkpass.  The crypt(3) function is defined to return NULL on
  failure, but chkpass.c didn't check for that before using the result.
  The main practical case in which this could be an issue is if libc is
  configured to refuse to execute unapproved hashing algorithms (e.g.,
  "FIPS mode").  This ideally should've been a separate commit, but
  since it touches code adjacent to one of the buffer overrun changes,
  I included it in this commit to avoid last-minute merge issues.
  This issue was reported by Honza Horak.

  Security: CVE-2014-0065 for buffer overruns, CVE-2014-0066 for crypt()
impacted_packages:
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: e3208fec32586076cd1a24cae19ded158a60e15a
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 69d2bc14ada1ab6dd9c0fdcdb0a6e9a7f5f8134d
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 655b665f745e2e07cf6936c6063b0250f5caa98f
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 45bf2404a2f586a35e8647890a7d5917b787a623
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 01824385aead50e557ca1af28640460fa9877d51
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 4741e316006b16d60a2ee1bc1703f0588f1200de
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/postgres/postgres/tree/01824385aead50e557ca1af28640460fa9877d51
    reference_type: commit
    reference_id: 01824385aead50e557ca1af28640460fa9877d51
  - url: https://github.com/postgres/postgres/tree/45bf2404a2f586a35e8647890a7d5917b787a623
    reference_type: commit
    reference_id: 45bf2404a2f586a35e8647890a7d5917b787a623
  - url: https://github.com/postgres/postgres/tree/4741e316006b16d60a2ee1bc1703f0588f1200de
    reference_type: commit
    reference_id: 4741e316006b16d60a2ee1bc1703f0588f1200de
  - url: https://github.com/postgres/postgres/tree/655b665f745e2e07cf6936c6063b0250f5caa98f
    reference_type: commit
    reference_id: 655b665f745e2e07cf6936c6063b0250f5caa98f
  - url: https://github.com/postgres/postgres/tree/69d2bc14ada1ab6dd9c0fdcdb0a6e9a7f5f8134d
    reference_type: commit
    reference_id: 69d2bc14ada1ab6dd9c0fdcdb0a6e9a7f5f8134d
  - url: https://github.com/postgres/postgres/tree/e3208fec32586076cd1a24cae19ded158a60e15a
    reference_type: commit
    reference_id: e3208fec32586076cd1a24cae19ded158a60e15a
