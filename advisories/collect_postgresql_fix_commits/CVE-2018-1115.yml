advisory_id: CVE-2018-1115
datasource_id: collect_postgresql_fix_commits/CVE-2018-1115
datasource_url: https://github.com/postgres/postgres
aliases: []
summary: |
  b56d5f230fae5fccf4fb9f255dfa78b01afed0d9:Last-minute updates for release notes.

  Security: CVE-2018-1115
  1950d5b7a2aa6570dfc170f2fef1e921271d0024:Last-minute updates for release notes.

  Security: CVE-2018-1115
  27a65851801c41c66d72d8c55ffab093419da793:Last-minute updates for release notes.

  Security: CVE-2018-1115
  53b79ab4fe722b1030b7e9a1580b283fca956e30:adminpack: Revoke EXECUTE on pg_logfile_rotate()

  In 9.6, we moved a number of functions over to using the GRANT system to
  control access instead of having hard-coded superuser checks.

  As it turns out, adminpack was creating another function in the catalog
  for one of those backend functions where the superuser check was
  removed, specifically pg_rotate_logfile(), but it didn't get the memo
  about having to REVOKE EXECUTE on the alternative-name function
  (pg_logfile_rotate()), meaning that in any installations with adminpack
  on 9.6 and higher, any user is able to run the pg_logfile_rotate()
  function, which then calls pg_rotate_logfile() and rotates the logfile.

  Fix by adding a new version of adminpack (1.1) which handles the REVOKE.
  As this function should have only been available to the superuser, this
  is a security issue, albeit a minor one.

  Security: CVE-2018-1115
  20f01fc45996238f7f1007ba704d30663955150a:adminpack: Revoke EXECUTE on pg_logfile_rotate()

  In 9.6, we moved a number of functions over to using the GRANT system to
  control access instead of having hard-coded superuser checks.

  As it turns out, adminpack was creating another function in the catalog
  for one of those backend functions where the superuser check was
  removed, specifically pg_rotate_logfile(), but it didn't get the memo
  about having to REVOKE EXECUTE on the alternative-name function
  (pg_logfile_rotate()), meaning that in any installations with adminpack
  on 9.6 and higher, any user is able to run the pg_logfile_rotate()
  function, which then calls pg_rotate_logfile() and rotates the logfile.

  Fix by adding a new version of adminpack (1.1) which handles the REVOKE.
  As this function should have only been available to the superuser, this
  is a security issue, albeit a minor one.

  Security: CVE-2018-1115
  7b347409fa2776fbaa4ec9c57365f48a2bbdb80c:adminpack: Revoke EXECUTE on pg_logfile_rotate()

  In 9.6, we moved a number of functions over to using the GRANT system to
  control access instead of having hard-coded superuser checks.

  As it turns out, adminpack was creating another function in the catalog
  for one of those backend functions where the superuser check was
  removed, specifically pg_rotate_logfile(), but it didn't get the memo
  about having to REVOKE EXECUTE on the alternative-name function
  (pg_logfile_rotate()), meaning that in any installations with adminpack
  on 9.6 and higher, any user is able to run the pg_logfile_rotate()
  function, which then calls pg_rotate_logfile() and rotates the logfile.

  Fix by adding a new version of adminpack (1.1) which handles the REVOKE.
  As this function should have only been available to the superuser, this
  is a security issue, albeit a minor one.

  In HEAD, move the changes implemented for adminpack up to be adminpack
  2.0 instead of 1.1.

  Security: CVE-2018-1115
impacted_packages:
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 27a65851801c41c66d72d8c55ffab093419da793
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 7b347409fa2776fbaa4ec9c57365f48a2bbdb80c
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: b56d5f230fae5fccf4fb9f255dfa78b01afed0d9
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: '1950d5b7a2aa6570dfc170f2fef1e921271d0024'
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 20f01fc45996238f7f1007ba704d30663955150a
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 53b79ab4fe722b1030b7e9a1580b283fca956e30
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/postgres/postgres/tree/1950d5b7a2aa6570dfc170f2fef1e921271d0024
    reference_type: commit
    reference_id: '1950d5b7a2aa6570dfc170f2fef1e921271d0024'
  - url: https://github.com/postgres/postgres/tree/20f01fc45996238f7f1007ba704d30663955150a
    reference_type: commit
    reference_id: 20f01fc45996238f7f1007ba704d30663955150a
  - url: https://github.com/postgres/postgres/tree/27a65851801c41c66d72d8c55ffab093419da793
    reference_type: commit
    reference_id: 27a65851801c41c66d72d8c55ffab093419da793
  - url: https://github.com/postgres/postgres/tree/53b79ab4fe722b1030b7e9a1580b283fca956e30
    reference_type: commit
    reference_id: 53b79ab4fe722b1030b7e9a1580b283fca956e30
  - url: https://github.com/postgres/postgres/tree/7b347409fa2776fbaa4ec9c57365f48a2bbdb80c
    reference_type: commit
    reference_id: 7b347409fa2776fbaa4ec9c57365f48a2bbdb80c
  - url: https://github.com/postgres/postgres/tree/b56d5f230fae5fccf4fb9f255dfa78b01afed0d9
    reference_type: commit
    reference_id: b56d5f230fae5fccf4fb9f255dfa78b01afed0d9
