advisory_id: CVE-2013-1900
datasource_id: collect_postgresql_fix_commits/CVE-2013-1900
datasource_url: https://github.com/postgres/postgres
aliases: []
summary: |
  a6bd75a12786e3383e8e0b8e873d0d4ca639f7d0:Reset OpenSSL randomness state in each postmaster child process.

  Previously, if the postmaster initialized OpenSSL's PRNG (which it will do
  when ssl=on in postgresql.conf), the same pseudo-random state would be
  inherited by each forked child process.  The problem is masked to a
  considerable extent if the incoming connection uses SSL encryption, but
  when it does not, identical pseudo-random state is made available to
  functions like contrib/pgcrypto.  The process's PID does get mixed into any
  requested random output, but on most systems that still only results in 32K
  or so distinct random sequences available across all Postgres sessions.
  This might allow an attacker who has database access to guess the results
  of "secure" operations happening in another session.

  To fix, forcibly reset the PRNG after fork().  Each child process that has
  need for random numbers from OpenSSL's generator will thereby be forced to
  go through OpenSSL's normal initialization sequence, which should provide
  much greater variability of the sequences.  There are other ways we might
  do this that would be slightly cheaper, but this approach seems the most
  future-proof against SSL-related code changes.

  This has been assigned CVE-2013-1900, but since the issue and the patch
  have already been publicized on pgsql-hackers, there's no point in trying
  to hide this commit.

  Back-patch to all supported branches.

  Marko Kreen
  6dd88dad8515332ea5dd4290afe47c6b02dd17ca:Reset OpenSSL randomness state in each postmaster child process.

  Previously, if the postmaster initialized OpenSSL's PRNG (which it will do
  when ssl=on in postgresql.conf), the same pseudo-random state would be
  inherited by each forked child process.  The problem is masked to a
  considerable extent if the incoming connection uses SSL encryption, but
  when it does not, identical pseudo-random state is made available to
  functions like contrib/pgcrypto.  The process's PID does get mixed into any
  requested random output, but on most systems that still only results in 32K
  or so distinct random sequences available across all Postgres sessions.
  This might allow an attacker who has database access to guess the results
  of "secure" operations happening in another session.

  To fix, forcibly reset the PRNG after fork().  Each child process that has
  need for random numbers from OpenSSL's generator will thereby be forced to
  go through OpenSSL's normal initialization sequence, which should provide
  much greater variability of the sequences.  There are other ways we might
  do this that would be slightly cheaper, but this approach seems the most
  future-proof against SSL-related code changes.

  This has been assigned CVE-2013-1900, but since the issue and the patch
  have already been publicized on pgsql-hackers, there's no point in trying
  to hide this commit.

  Back-patch to all supported branches.

  Marko Kreen
  915d8230cb066a44b0caf39adc0a5c2de5595b49:Reset OpenSSL randomness state in each postmaster child process.

  Previously, if the postmaster initialized OpenSSL's PRNG (which it will do
  when ssl=on in postgresql.conf), the same pseudo-random state would be
  inherited by each forked child process.  The problem is masked to a
  considerable extent if the incoming connection uses SSL encryption, but
  when it does not, identical pseudo-random state is made available to
  functions like contrib/pgcrypto.  The process's PID does get mixed into any
  requested random output, but on most systems that still only results in 32K
  or so distinct random sequences available across all Postgres sessions.
  This might allow an attacker who has database access to guess the results
  of "secure" operations happening in another session.

  To fix, forcibly reset the PRNG after fork().  Each child process that has
  need for random numbers from OpenSSL's generator will thereby be forced to
  go through OpenSSL's normal initialization sequence, which should provide
  much greater variability of the sequences.  There are other ways we might
  do this that would be slightly cheaper, but this approach seems the most
  future-proof against SSL-related code changes.

  This has been assigned CVE-2013-1900, but since the issue and the patch
  have already been publicized on pgsql-hackers, there's no point in trying
  to hide this commit.

  Back-patch to all supported branches.

  Marko Kreen
  21ce40c8eab4d0da110fb6e05e9d9ec20d73d8b3:Reset OpenSSL randomness state in each postmaster child process.

  Previously, if the postmaster initialized OpenSSL's PRNG (which it will do
  when ssl=on in postgresql.conf), the same pseudo-random state would be
  inherited by each forked child process.  The problem is masked to a
  considerable extent if the incoming connection uses SSL encryption, but
  when it does not, identical pseudo-random state is made available to
  functions like contrib/pgcrypto.  The process's PID does get mixed into any
  requested random output, but on most systems that still only results in 32K
  or so distinct random sequences available across all Postgres sessions.
  This might allow an attacker who has database access to guess the results
  of "secure" operations happening in another session.

  To fix, forcibly reset the PRNG after fork().  Each child process that has
  need for random numbers from OpenSSL's generator will thereby be forced to
  go through OpenSSL's normal initialization sequence, which should provide
  much greater variability of the sequences.  There are other ways we might
  do this that would be slightly cheaper, but this approach seems the most
  future-proof against SSL-related code changes.

  This has been assigned CVE-2013-1900, but since the issue and the patch
  have already been publicized on pgsql-hackers, there's no point in trying
  to hide this commit.

  Back-patch to all supported branches.

  Marko Kreen
  0d1ecd6300191a450978ca2fcd12bbbb7c5e65e6:Reset OpenSSL randomness state in each postmaster child process.

  Previously, if the postmaster initialized OpenSSL's PRNG (which it will do
  when ssl=on in postgresql.conf), the same pseudo-random state would be
  inherited by each forked child process.  The problem is masked to a
  considerable extent if the incoming connection uses SSL encryption, but
  when it does not, identical pseudo-random state is made available to
  functions like contrib/pgcrypto.  The process's PID does get mixed into any
  requested random output, but on most systems that still only results in 32K
  or so distinct random sequences available across all Postgres sessions.
  This might allow an attacker who has database access to guess the results
  of "secure" operations happening in another session.

  To fix, forcibly reset the PRNG after fork().  Each child process that has
  need for random numbers from OpenSSL's generator will thereby be forced to
  go through OpenSSL's normal initialization sequence, which should provide
  much greater variability of the sequences.  There are other ways we might
  do this that would be slightly cheaper, but this approach seems the most
  future-proof against SSL-related code changes.

  This has been assigned CVE-2013-1900, but since the issue and the patch
  have already been publicized on pgsql-hackers, there's no point in trying
  to hide this commit.

  Back-patch to all supported branches.

  Marko Kreen
impacted_packages:
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 21ce40c8eab4d0da110fb6e05e9d9ec20d73d8b3
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 915d8230cb066a44b0caf39adc0a5c2de5595b49
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 6dd88dad8515332ea5dd4290afe47c6b02dd17ca
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: a6bd75a12786e3383e8e0b8e873d0d4ca639f7d0
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 0d1ecd6300191a450978ca2fcd12bbbb7c5e65e6
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/postgres/postgres/tree/0d1ecd6300191a450978ca2fcd12bbbb7c5e65e6
    reference_type: commit
    reference_id: 0d1ecd6300191a450978ca2fcd12bbbb7c5e65e6
  - url: https://github.com/postgres/postgres/tree/21ce40c8eab4d0da110fb6e05e9d9ec20d73d8b3
    reference_type: commit
    reference_id: 21ce40c8eab4d0da110fb6e05e9d9ec20d73d8b3
  - url: https://github.com/postgres/postgres/tree/6dd88dad8515332ea5dd4290afe47c6b02dd17ca
    reference_type: commit
    reference_id: 6dd88dad8515332ea5dd4290afe47c6b02dd17ca
  - url: https://github.com/postgres/postgres/tree/915d8230cb066a44b0caf39adc0a5c2de5595b49
    reference_type: commit
    reference_id: 915d8230cb066a44b0caf39adc0a5c2de5595b49
  - url: https://github.com/postgres/postgres/tree/a6bd75a12786e3383e8e0b8e873d0d4ca639f7d0
    reference_type: commit
    reference_id: a6bd75a12786e3383e8e0b8e873d0d4ca639f7d0
