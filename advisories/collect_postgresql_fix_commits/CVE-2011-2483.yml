advisory_id: CVE-2011-2483
datasource_id: collect_postgresql_fix_commits/CVE-2011-2483
datasource_url: https://github.com/postgres/postgres
aliases: []
summary: |
  457c2d9158d35240ec54ea2052d89ff4f8fe19db:Apply upstream fix for blowfish signed-character bug (CVE-2011-2483).

  A password containing a character with the high bit set was misprocessed
  on machines where char is signed (which is most).  This could cause the
  preceding one to three characters to fail to affect the hashed result,
  thus weakening the password.  The result was also unportable, and failed
  to match some other blowfish implementations such as OpenBSD's.

  Since the fix changes the output for such passwords, upstream chose
  to provide a compatibility hack: password salts beginning with $2x$
  (instead of the usual $2a$ for blowfish) are intentionally processed
  "wrong" to give the same hash as before.  Stored password hashes can
  thus be modified if necessary to still match, though it'd be better
  to change any affected passwords.

  In passing, sync a couple other upstream changes that marginally improve
  performance and/or tighten error checking.

  Back-patch to all supported branches.  Since this issue is already
  public, no reason not to commit the fix ASAP.
  ca43ce9ebaa0f3af4da206ddc51f8c86de160297:Apply upstream fix for blowfish signed-character bug (CVE-2011-2483).

  A password containing a character with the high bit set was misprocessed
  on machines where char is signed (which is most).  This could cause the
  preceding one to three characters to fail to affect the hashed result,
  thus weakening the password.  The result was also unportable, and failed
  to match some other blowfish implementations such as OpenBSD's.

  Since the fix changes the output for such passwords, upstream chose
  to provide a compatibility hack: password salts beginning with $2x$
  (instead of the usual $2a$ for blowfish) are intentionally processed
  "wrong" to give the same hash as before.  Stored password hashes can
  thus be modified if necessary to still match, though it'd be better
  to change any affected passwords.

  In passing, sync a couple other upstream changes that marginally improve
  performance and/or tighten error checking.

  Back-patch to all supported branches.  Since this issue is already
  public, no reason not to commit the fix ASAP.
  4b09299e4723276c70c5b25de38578d642490179:Apply upstream fix for blowfish signed-character bug (CVE-2011-2483).

  A password containing a character with the high bit set was misprocessed
  on machines where char is signed (which is most).  This could cause the
  preceding one to three characters to fail to affect the hashed result,
  thus weakening the password.  The result was also unportable, and failed
  to match some other blowfish implementations such as OpenBSD's.

  Since the fix changes the output for such passwords, upstream chose
  to provide a compatibility hack: password salts beginning with $2x$
  (instead of the usual $2a$ for blowfish) are intentionally processed
  "wrong" to give the same hash as before.  Stored password hashes can
  thus be modified if necessary to still match, though it'd be better
  to change any affected passwords.

  In passing, sync a couple other upstream changes that marginally improve
  performance and/or tighten error checking.

  Back-patch to all supported branches.  Since this issue is already
  public, no reason not to commit the fix ASAP.
  3246a1791de01e6adbb1ee295dae65fa4fe12c6c:Apply upstream fix for blowfish signed-character bug (CVE-2011-2483).

  A password containing a character with the high bit set was misprocessed
  on machines where char is signed (which is most).  This could cause the
  preceding one to three characters to fail to affect the hashed result,
  thus weakening the password.  The result was also unportable, and failed
  to match some other blowfish implementations such as OpenBSD's.

  Since the fix changes the output for such passwords, upstream chose
  to provide a compatibility hack: password salts beginning with $2x$
  (instead of the usual $2a$ for blowfish) are intentionally processed
  "wrong" to give the same hash as before.  Stored password hashes can
  thus be modified if necessary to still match, though it'd be better
  to change any affected passwords.

  In passing, sync a couple other upstream changes that marginally improve
  performance and/or tighten error checking.

  Back-patch to all supported branches.  Since this issue is already
  public, no reason not to commit the fix ASAP.
  567049a76493c7c60eddd1c65c8aa946c6811ed3:Apply upstream fix for blowfish signed-character bug (CVE-2011-2483).

  A password containing a character with the high bit set was misprocessed
  on machines where char is signed (which is most).  This could cause the
  preceding one to three characters to fail to affect the hashed result,
  thus weakening the password.  The result was also unportable, and failed
  to match some other blowfish implementations such as OpenBSD's.

  Since the fix changes the output for such passwords, upstream chose
  to provide a compatibility hack: password salts beginning with $2x$
  (instead of the usual $2a$ for blowfish) are intentionally processed
  "wrong" to give the same hash as before.  Stored password hashes can
  thus be modified if necessary to still match, though it'd be better
  to change any affected passwords.

  In passing, sync a couple other upstream changes that marginally improve
  performance and/or tighten error checking.

  Back-patch to all supported branches.  Since this issue is already
  public, no reason not to commit the fix ASAP.
  ca59dfa6f727fe3bf3a01904ec30e87f7fa5a67e:Apply upstream fix for blowfish signed-character bug (CVE-2011-2483).

  A password containing a character with the high bit set was misprocessed
  on machines where char is signed (which is most).  This could cause the
  preceding one to three characters to fail to affect the hashed result,
  thus weakening the password.  The result was also unportable, and failed
  to match some other blowfish implementations such as OpenBSD's.

  Since the fix changes the output for such passwords, upstream chose
  to provide a compatibility hack: password salts beginning with $2x$
  (instead of the usual $2a$ for blowfish) are intentionally processed
  "wrong" to give the same hash as before.  Stored password hashes can
  thus be modified if necessary to still match, though it'd be better
  to change any affected passwords.

  In passing, sync a couple other upstream changes that marginally improve
  performance and/or tighten error checking.

  Back-patch to all supported branches.  Since this issue is already
  public, no reason not to commit the fix ASAP.
impacted_packages:
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: ca43ce9ebaa0f3af4da206ddc51f8c86de160297
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 457c2d9158d35240ec54ea2052d89ff4f8fe19db
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 4b09299e4723276c70c5b25de38578d642490179
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 567049a76493c7c60eddd1c65c8aa946c6811ed3
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: ca59dfa6f727fe3bf3a01904ec30e87f7fa5a67e
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 3246a1791de01e6adbb1ee295dae65fa4fe12c6c
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/postgres/postgres/tree/3246a1791de01e6adbb1ee295dae65fa4fe12c6c
    reference_type: commit
    reference_id: 3246a1791de01e6adbb1ee295dae65fa4fe12c6c
  - url: https://github.com/postgres/postgres/tree/457c2d9158d35240ec54ea2052d89ff4f8fe19db
    reference_type: commit
    reference_id: 457c2d9158d35240ec54ea2052d89ff4f8fe19db
  - url: https://github.com/postgres/postgres/tree/4b09299e4723276c70c5b25de38578d642490179
    reference_type: commit
    reference_id: 4b09299e4723276c70c5b25de38578d642490179
  - url: https://github.com/postgres/postgres/tree/567049a76493c7c60eddd1c65c8aa946c6811ed3
    reference_type: commit
    reference_id: 567049a76493c7c60eddd1c65c8aa946c6811ed3
  - url: https://github.com/postgres/postgres/tree/ca43ce9ebaa0f3af4da206ddc51f8c86de160297
    reference_type: commit
    reference_id: ca43ce9ebaa0f3af4da206ddc51f8c86de160297
  - url: https://github.com/postgres/postgres/tree/ca59dfa6f727fe3bf3a01904ec30e87f7fa5a67e
    reference_type: commit
    reference_id: ca59dfa6f727fe3bf3a01904ec30e87f7fa5a67e
