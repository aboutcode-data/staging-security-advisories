advisory_id: CVE-2024-10978
datasource_id: collect_postgresql_fix_commits/CVE-2024-10978
datasource_url: https://github.com/postgres/postgres
aliases: []
summary: |
  70d067ceccf02d9670cbe8ddd79c98f2b66989a9:Exclude parallel workers from connection privilege/limit checks.

  Cause parallel workers to not check datallowconn, rolcanlogin, and
  ACL_CONNECT privileges.  The leader already checked these things
  (except for rolcanlogin which might have been checked for a different
  role).  Re-checking can accomplish little except to induce unexpected
  failures in applications that might not even be aware that their query
  has been parallelized.  We already had the principle that parallel
  workers rely on their leader to pass a valid set of authorization
  information, so this change just extends that a bit further.

  Also, modify the ReservedConnections, datconnlimit and rolconnlimit
  logic so that these limits are only enforced against regular backends,
  and only regular backends are counted while checking if the limits
  were already reached.  Previously, background processes that had an
  assigned database or role were subject to these limits (with rather
  random exclusions for autovac workers and walsenders), and the set of
  existing processes that counted against each limit was quite haphazard
  as well.  The point of these limits, AFAICS, is to ensure the
  availability of PGPROC slots for regular backends.  Since all other
  types of processes have their own separate pools of PGPROC slots, it
  makes no sense either to enforce these limits against them or to count
  them while enforcing the limit.

  While edge-case failures of these sorts have been possible for a
  long time, the problem got a good deal worse with commit 5a2fed911
  (CVE-2024-10978), which caused parallel workers to make some of these
  checks using the leader's current role where before we had used its
  AuthenticatedUserId, thus allowing parallel queries to fail after
  SET ROLE.  The previous behavior was fairly accidental and I have
  no desire to return to it.

  This patch includes reverting 73c9f91a1, which was an emergency hack
  to suppress these same checks in some cases.  It wasn't complete,
  as shown by a recent bug report from Laurenz Albe.  We can also revert
  fd4d93d26 and 492217301, which hacked around the same problems in one
  regression test.

  In passing, remove the special case for autovac workers in
  CheckMyDatabase; it seems cleaner to have AutoVacWorkerMain pass
  the INIT_PG_OVERRIDE_ALLOW_CONNS flag, now that that does what's
  needed.

  Like 5a2fed911, back-patch to supported branches (which sadly no
  longer includes v12).

  Discussion: https://postgr.es/m/1808397.1735156190@sss.pgh.pa.us
  c58b0c43d36f606d6c1f8e7e45cc383df9d1dc74:Exclude parallel workers from connection privilege/limit checks.

  Cause parallel workers to not check datallowconn, rolcanlogin, and
  ACL_CONNECT privileges.  The leader already checked these things
  (except for rolcanlogin which might have been checked for a different
  role).  Re-checking can accomplish little except to induce unexpected
  failures in applications that might not even be aware that their query
  has been parallelized.  We already had the principle that parallel
  workers rely on their leader to pass a valid set of authorization
  information, so this change just extends that a bit further.

  Also, modify the ReservedConnections, datconnlimit and rolconnlimit
  logic so that these limits are only enforced against regular backends,
  and only regular backends are counted while checking if the limits
  were already reached.  Previously, background processes that had an
  assigned database or role were subject to these limits (with rather
  random exclusions for autovac workers and walsenders), and the set of
  existing processes that counted against each limit was quite haphazard
  as well.  The point of these limits, AFAICS, is to ensure the
  availability of PGPROC slots for regular backends.  Since all other
  types of processes have their own separate pools of PGPROC slots, it
  makes no sense either to enforce these limits against them or to count
  them while enforcing the limit.

  While edge-case failures of these sorts have been possible for a
  long time, the problem got a good deal worse with commit 5a2fed911
  (CVE-2024-10978), which caused parallel workers to make some of these
  checks using the leader's current role where before we had used its
  AuthenticatedUserId, thus allowing parallel queries to fail after
  SET ROLE.  The previous behavior was fairly accidental and I have
  no desire to return to it.

  This patch includes reverting 73c9f91a1, which was an emergency hack
  to suppress these same checks in some cases.  It wasn't complete,
  as shown by a recent bug report from Laurenz Albe.  We can also revert
  fd4d93d26 and 492217301, which hacked around the same problems in one
  regression test.

  In passing, remove the special case for autovac workers in
  CheckMyDatabase; it seems cleaner to have AutoVacWorkerMain pass
  the INIT_PG_OVERRIDE_ALLOW_CONNS flag, now that that does what's
  needed.

  Like 5a2fed911, back-patch to supported branches (which sadly no
  longer includes v12).

  Discussion: https://postgr.es/m/1808397.1735156190@sss.pgh.pa.us
  3d1ecc92a0d15eb299ea37c9842b3367eddc0081:Exclude parallel workers from connection privilege/limit checks.

  Cause parallel workers to not check datallowconn, rolcanlogin, and
  ACL_CONNECT privileges.  The leader already checked these things
  (except for rolcanlogin which might have been checked for a different
  role).  Re-checking can accomplish little except to induce unexpected
  failures in applications that might not even be aware that their query
  has been parallelized.  We already had the principle that parallel
  workers rely on their leader to pass a valid set of authorization
  information, so this change just extends that a bit further.

  Also, modify the ReservedConnections, datconnlimit and rolconnlimit
  logic so that these limits are only enforced against regular backends,
  and only regular backends are counted while checking if the limits
  were already reached.  Previously, background processes that had an
  assigned database or role were subject to these limits (with rather
  random exclusions for autovac workers and walsenders), and the set of
  existing processes that counted against each limit was quite haphazard
  as well.  The point of these limits, AFAICS, is to ensure the
  availability of PGPROC slots for regular backends.  Since all other
  types of processes have their own separate pools of PGPROC slots, it
  makes no sense either to enforce these limits against them or to count
  them while enforcing the limit.

  While edge-case failures of these sorts have been possible for a
  long time, the problem got a good deal worse with commit 5a2fed911
  (CVE-2024-10978), which caused parallel workers to make some of these
  checks using the leader's current role where before we had used its
  AuthenticatedUserId, thus allowing parallel queries to fail after
  SET ROLE.  The previous behavior was fairly accidental and I have
  no desire to return to it.

  This patch includes reverting 73c9f91a1, which was an emergency hack
  to suppress these same checks in some cases.  It wasn't complete,
  as shown by a recent bug report from Laurenz Albe.  We can also revert
  fd4d93d26 and 492217301, which hacked around the same problems in one
  regression test.

  In passing, remove the special case for autovac workers in
  CheckMyDatabase; it seems cleaner to have AutoVacWorkerMain pass
  the INIT_PG_OVERRIDE_ALLOW_CONNS flag, now that that does what's
  needed.

  Like 5a2fed911, back-patch to supported branches (which sadly no
  longer includes v12).

  Discussion: https://postgr.es/m/1808397.1735156190@sss.pgh.pa.us
  41a252c2ca68ba7239e73abd99fdbf28871f5f07:Exclude parallel workers from connection privilege/limit checks.

  Cause parallel workers to not check datallowconn, rolcanlogin, and
  ACL_CONNECT privileges.  The leader already checked these things
  (except for rolcanlogin which might have been checked for a different
  role).  Re-checking can accomplish little except to induce unexpected
  failures in applications that might not even be aware that their query
  has been parallelized.  We already had the principle that parallel
  workers rely on their leader to pass a valid set of authorization
  information, so this change just extends that a bit further.

  Also, modify the ReservedConnections, datconnlimit and rolconnlimit
  logic so that these limits are only enforced against regular backends,
  and only regular backends are counted while checking if the limits
  were already reached.  Previously, background processes that had an
  assigned database or role were subject to these limits (with rather
  random exclusions for autovac workers and walsenders), and the set of
  existing processes that counted against each limit was quite haphazard
  as well.  The point of these limits, AFAICS, is to ensure the
  availability of PGPROC slots for regular backends.  Since all other
  types of processes have their own separate pools of PGPROC slots, it
  makes no sense either to enforce these limits against them or to count
  them while enforcing the limit.

  While edge-case failures of these sorts have been possible for a
  long time, the problem got a good deal worse with commit 5a2fed911
  (CVE-2024-10978), which caused parallel workers to make some of these
  checks using the leader's current role where before we had used its
  AuthenticatedUserId, thus allowing parallel queries to fail after
  SET ROLE.  The previous behavior was fairly accidental and I have
  no desire to return to it.

  This patch includes reverting 73c9f91a1, which was an emergency hack
  to suppress these same checks in some cases.  It wasn't complete,
  as shown by a recent bug report from Laurenz Albe.  We can also revert
  fd4d93d26 and 492217301, which hacked around the same problems in one
  regression test.

  In passing, remove the special case for autovac workers in
  CheckMyDatabase; it seems cleaner to have AutoVacWorkerMain pass
  the INIT_PG_OVERRIDE_ALLOW_CONNS flag, now that that does what's
  needed.

  Like 5a2fed911, back-patch to supported branches (which sadly no
  longer includes v12).

  Discussion: https://postgr.es/m/1808397.1735156190@sss.pgh.pa.us
  15b4c46c328b25be9463db6d2960eeb16a784aad:Exclude parallel workers from connection privilege/limit checks.

  Cause parallel workers to not check datallowconn, rolcanlogin, and
  ACL_CONNECT privileges.  The leader already checked these things
  (except for rolcanlogin which might have been checked for a different
  role).  Re-checking can accomplish little except to induce unexpected
  failures in applications that might not even be aware that their query
  has been parallelized.  We already had the principle that parallel
  workers rely on their leader to pass a valid set of authorization
  information, so this change just extends that a bit further.

  Also, modify the ReservedConnections, datconnlimit and rolconnlimit
  logic so that these limits are only enforced against regular backends,
  and only regular backends are counted while checking if the limits
  were already reached.  Previously, background processes that had an
  assigned database or role were subject to these limits (with rather
  random exclusions for autovac workers and walsenders), and the set of
  existing processes that counted against each limit was quite haphazard
  as well.  The point of these limits, AFAICS, is to ensure the
  availability of PGPROC slots for regular backends.  Since all other
  types of processes have their own separate pools of PGPROC slots, it
  makes no sense either to enforce these limits against them or to count
  them while enforcing the limit.

  While edge-case failures of these sorts have been possible for a
  long time, the problem got a good deal worse with commit 5a2fed911
  (CVE-2024-10978), which caused parallel workers to make some of these
  checks using the leader's current role where before we had used its
  AuthenticatedUserId, thus allowing parallel queries to fail after
  SET ROLE.  The previous behavior was fairly accidental and I have
  no desire to return to it.

  This patch includes reverting 73c9f91a1, which was an emergency hack
  to suppress these same checks in some cases.  It wasn't complete,
  as shown by a recent bug report from Laurenz Albe.  We can also revert
  fd4d93d26 and 492217301, which hacked around the same problems in one
  regression test.

  In passing, remove the special case for autovac workers in
  CheckMyDatabase; it seems cleaner to have AutoVacWorkerMain pass
  the INIT_PG_OVERRIDE_ALLOW_CONNS flag, now that that does what's
  needed.

  Like 5a2fed911, back-patch to supported branches (which sadly no
  longer includes v12).

  Discussion: https://postgr.es/m/1808397.1735156190@sss.pgh.pa.us
  34486b6092e700089d22586df211c4e8b0412136:Exclude parallel workers from connection privilege/limit checks.

  Cause parallel workers to not check datallowconn, rolcanlogin, and
  ACL_CONNECT privileges.  The leader already checked these things
  (except for rolcanlogin which might have been checked for a different
  role).  Re-checking can accomplish little except to induce unexpected
  failures in applications that might not even be aware that their query
  has been parallelized.  We already had the principle that parallel
  workers rely on their leader to pass a valid set of authorization
  information, so this change just extends that a bit further.

  Also, modify the ReservedConnections, datconnlimit and rolconnlimit
  logic so that these limits are only enforced against regular backends,
  and only regular backends are counted while checking if the limits
  were already reached.  Previously, background processes that had an
  assigned database or role were subject to these limits (with rather
  random exclusions for autovac workers and walsenders), and the set of
  existing processes that counted against each limit was quite haphazard
  as well.  The point of these limits, AFAICS, is to ensure the
  availability of PGPROC slots for regular backends.  Since all other
  types of processes have their own separate pools of PGPROC slots, it
  makes no sense either to enforce these limits against them or to count
  them while enforcing the limit.

  While edge-case failures of these sorts have been possible for a
  long time, the problem got a good deal worse with commit 5a2fed911
  (CVE-2024-10978), which caused parallel workers to make some of these
  checks using the leader's current role where before we had used its
  AuthenticatedUserId, thus allowing parallel queries to fail after
  SET ROLE.  The previous behavior was fairly accidental and I have
  no desire to return to it.

  This patch includes reverting 73c9f91a1, which was an emergency hack
  to suppress these same checks in some cases.  It wasn't complete,
  as shown by a recent bug report from Laurenz Albe.  We can also revert
  fd4d93d26 and 492217301, which hacked around the same problems in one
  regression test.

  In passing, remove the special case for autovac workers in
  CheckMyDatabase; it seems cleaner to have AutoVacWorkerMain pass
  the INIT_PG_OVERRIDE_ALLOW_CONNS flag, now that that does what's
  needed.

  Like 5a2fed911, back-patch to supported branches (which sadly no
  longer includes v12).

  Discussion: https://postgr.es/m/1808397.1735156190@sss.pgh.pa.us
  c463338656ac47e5210fcf9fbf7d20efccce8de8:Fix per-session activation of ALTER {ROLE|DATABASE} SET role.

  After commit 5a2fed911a85ed6d8a015a6bafe3a0d9a69334ae, the catalog state
  resulting from these commands ceased to affect sessions.  Restore the
  longstanding behavior, which is like beginning the session with a SET
  ROLE command.  If cherry-picking the CVE-2024-10978 fixes, default to
  including this, too.  (This fixes an unintended side effect of fixing
  CVE-2024-10978.)  Back-patch to v12, like that commit.  The release team
  decided to include v12, despite the original intent to halt v12 commits
  earlier this week.

  Tom Lane and Noah Misch.  Reported by Etienne LAFARGE.

  Discussion: https://postgr.es/m/CADOZwSb0UsEr4_UTFXC5k7=fyyK8uKXekucd+-uuGjJsGBfxgw@mail.gmail.com
  c463338656ac47e5210fcf9fbf7d20efccce8de8:Fix per-session activation of ALTER {ROLE|DATABASE} SET role.

  After commit 5a2fed911a85ed6d8a015a6bafe3a0d9a69334ae, the catalog state
  resulting from these commands ceased to affect sessions.  Restore the
  longstanding behavior, which is like beginning the session with a SET
  ROLE command.  If cherry-picking the CVE-2024-10978 fixes, default to
  including this, too.  (This fixes an unintended side effect of fixing
  CVE-2024-10978.)  Back-patch to v12, like that commit.  The release team
  decided to include v12, despite the original intent to halt v12 commits
  earlier this week.

  Tom Lane and Noah Misch.  Reported by Etienne LAFARGE.

  Discussion: https://postgr.es/m/CADOZwSb0UsEr4_UTFXC5k7=fyyK8uKXekucd+-uuGjJsGBfxgw@mail.gmail.com
  07c6e0f613612ff060572a085c1c24aa44c8b2bb:Fix per-session activation of ALTER {ROLE|DATABASE} SET role.

  After commit 5a2fed911a85ed6d8a015a6bafe3a0d9a69334ae, the catalog state
  resulting from these commands ceased to affect sessions.  Restore the
  longstanding behavior, which is like beginning the session with a SET
  ROLE command.  If cherry-picking the CVE-2024-10978 fixes, default to
  including this, too.  (This fixes an unintended side effect of fixing
  CVE-2024-10978.)  Back-patch to v12, like that commit.  The release team
  decided to include v12, despite the original intent to halt v12 commits
  earlier this week.

  Tom Lane and Noah Misch.  Reported by Etienne LAFARGE.

  Discussion: https://postgr.es/m/CADOZwSb0UsEr4_UTFXC5k7=fyyK8uKXekucd+-uuGjJsGBfxgw@mail.gmail.com
  07c6e0f613612ff060572a085c1c24aa44c8b2bb:Fix per-session activation of ALTER {ROLE|DATABASE} SET role.

  After commit 5a2fed911a85ed6d8a015a6bafe3a0d9a69334ae, the catalog state
  resulting from these commands ceased to affect sessions.  Restore the
  longstanding behavior, which is like beginning the session with a SET
  ROLE command.  If cherry-picking the CVE-2024-10978 fixes, default to
  including this, too.  (This fixes an unintended side effect of fixing
  CVE-2024-10978.)  Back-patch to v12, like that commit.  The release team
  decided to include v12, despite the original intent to halt v12 commits
  earlier this week.

  Tom Lane and Noah Misch.  Reported by Etienne LAFARGE.

  Discussion: https://postgr.es/m/CADOZwSb0UsEr4_UTFXC5k7=fyyK8uKXekucd+-uuGjJsGBfxgw@mail.gmail.com
  be062bfa54d780c07a3b36c4123da2c960c8e97d:Fix per-session activation of ALTER {ROLE|DATABASE} SET role.

  After commit 5a2fed911a85ed6d8a015a6bafe3a0d9a69334ae, the catalog state
  resulting from these commands ceased to affect sessions.  Restore the
  longstanding behavior, which is like beginning the session with a SET
  ROLE command.  If cherry-picking the CVE-2024-10978 fixes, default to
  including this, too.  (This fixes an unintended side effect of fixing
  CVE-2024-10978.)  Back-patch to v12, like that commit.  The release team
  decided to include v12, despite the original intent to halt v12 commits
  earlier this week.

  Tom Lane and Noah Misch.  Reported by Etienne LAFARGE.

  Discussion: https://postgr.es/m/CADOZwSb0UsEr4_UTFXC5k7=fyyK8uKXekucd+-uuGjJsGBfxgw@mail.gmail.com
  be062bfa54d780c07a3b36c4123da2c960c8e97d:Fix per-session activation of ALTER {ROLE|DATABASE} SET role.

  After commit 5a2fed911a85ed6d8a015a6bafe3a0d9a69334ae, the catalog state
  resulting from these commands ceased to affect sessions.  Restore the
  longstanding behavior, which is like beginning the session with a SET
  ROLE command.  If cherry-picking the CVE-2024-10978 fixes, default to
  including this, too.  (This fixes an unintended side effect of fixing
  CVE-2024-10978.)  Back-patch to v12, like that commit.  The release team
  decided to include v12, despite the original intent to halt v12 commits
  earlier this week.

  Tom Lane and Noah Misch.  Reported by Etienne LAFARGE.

  Discussion: https://postgr.es/m/CADOZwSb0UsEr4_UTFXC5k7=fyyK8uKXekucd+-uuGjJsGBfxgw@mail.gmail.com
  b0918c1286d316f6ffa93995452270afd4fc4335:Fix per-session activation of ALTER {ROLE|DATABASE} SET role.

  After commit 5a2fed911a85ed6d8a015a6bafe3a0d9a69334ae, the catalog state
  resulting from these commands ceased to affect sessions.  Restore the
  longstanding behavior, which is like beginning the session with a SET
  ROLE command.  If cherry-picking the CVE-2024-10978 fixes, default to
  including this, too.  (This fixes an unintended side effect of fixing
  CVE-2024-10978.)  Back-patch to v12, like that commit.  The release team
  decided to include v12, despite the original intent to halt v12 commits
  earlier this week.

  Tom Lane and Noah Misch.  Reported by Etienne LAFARGE.

  Discussion: https://postgr.es/m/CADOZwSb0UsEr4_UTFXC5k7=fyyK8uKXekucd+-uuGjJsGBfxgw@mail.gmail.com
  b0918c1286d316f6ffa93995452270afd4fc4335:Fix per-session activation of ALTER {ROLE|DATABASE} SET role.

  After commit 5a2fed911a85ed6d8a015a6bafe3a0d9a69334ae, the catalog state
  resulting from these commands ceased to affect sessions.  Restore the
  longstanding behavior, which is like beginning the session with a SET
  ROLE command.  If cherry-picking the CVE-2024-10978 fixes, default to
  including this, too.  (This fixes an unintended side effect of fixing
  CVE-2024-10978.)  Back-patch to v12, like that commit.  The release team
  decided to include v12, despite the original intent to halt v12 commits
  earlier this week.

  Tom Lane and Noah Misch.  Reported by Etienne LAFARGE.

  Discussion: https://postgr.es/m/CADOZwSb0UsEr4_UTFXC5k7=fyyK8uKXekucd+-uuGjJsGBfxgw@mail.gmail.com
  1c05004a895308da10ec000ba6b92f72f4f5b8e2:Fix per-session activation of ALTER {ROLE|DATABASE} SET role.

  After commit 5a2fed911a85ed6d8a015a6bafe3a0d9a69334ae, the catalog state
  resulting from these commands ceased to affect sessions.  Restore the
  longstanding behavior, which is like beginning the session with a SET
  ROLE command.  If cherry-picking the CVE-2024-10978 fixes, default to
  including this, too.  (This fixes an unintended side effect of fixing
  CVE-2024-10978.)  Back-patch to v12, like that commit.  The release team
  decided to include v12, despite the original intent to halt v12 commits
  earlier this week.

  Tom Lane and Noah Misch.  Reported by Etienne LAFARGE.

  Discussion: https://postgr.es/m/CADOZwSb0UsEr4_UTFXC5k7=fyyK8uKXekucd+-uuGjJsGBfxgw@mail.gmail.com
  1c05004a895308da10ec000ba6b92f72f4f5b8e2:Fix per-session activation of ALTER {ROLE|DATABASE} SET role.

  After commit 5a2fed911a85ed6d8a015a6bafe3a0d9a69334ae, the catalog state
  resulting from these commands ceased to affect sessions.  Restore the
  longstanding behavior, which is like beginning the session with a SET
  ROLE command.  If cherry-picking the CVE-2024-10978 fixes, default to
  including this, too.  (This fixes an unintended side effect of fixing
  CVE-2024-10978.)  Back-patch to v12, like that commit.  The release team
  decided to include v12, despite the original intent to halt v12 commits
  earlier this week.

  Tom Lane and Noah Misch.  Reported by Etienne LAFARGE.

  Discussion: https://postgr.es/m/CADOZwSb0UsEr4_UTFXC5k7=fyyK8uKXekucd+-uuGjJsGBfxgw@mail.gmail.com
  edf80895f6bda824403f843df91cbc83890e4b6c:Fix per-session activation of ALTER {ROLE|DATABASE} SET role.

  After commit 5a2fed911a85ed6d8a015a6bafe3a0d9a69334ae, the catalog state
  resulting from these commands ceased to affect sessions.  Restore the
  longstanding behavior, which is like beginning the session with a SET
  ROLE command.  If cherry-picking the CVE-2024-10978 fixes, default to
  including this, too.  (This fixes an unintended side effect of fixing
  CVE-2024-10978.)  Back-patch to v12, like that commit.  The release team
  decided to include v12, despite the original intent to halt v12 commits
  earlier this week.

  Tom Lane and Noah Misch.  Reported by Etienne LAFARGE.

  Discussion: https://postgr.es/m/CADOZwSb0UsEr4_UTFXC5k7=fyyK8uKXekucd+-uuGjJsGBfxgw@mail.gmail.com
  edf80895f6bda824403f843df91cbc83890e4b6c:Fix per-session activation of ALTER {ROLE|DATABASE} SET role.

  After commit 5a2fed911a85ed6d8a015a6bafe3a0d9a69334ae, the catalog state
  resulting from these commands ceased to affect sessions.  Restore the
  longstanding behavior, which is like beginning the session with a SET
  ROLE command.  If cherry-picking the CVE-2024-10978 fixes, default to
  including this, too.  (This fixes an unintended side effect of fixing
  CVE-2024-10978.)  Back-patch to v12, like that commit.  The release team
  decided to include v12, despite the original intent to halt v12 commits
  earlier this week.

  Tom Lane and Noah Misch.  Reported by Etienne LAFARGE.

  Discussion: https://postgr.es/m/CADOZwSb0UsEr4_UTFXC5k7=fyyK8uKXekucd+-uuGjJsGBfxgw@mail.gmail.com
  7b88529f4363994450bd4cd3c172006a8a77e222:Fix per-session activation of ALTER {ROLE|DATABASE} SET role.

  After commit 5a2fed911a85ed6d8a015a6bafe3a0d9a69334ae, the catalog state
  resulting from these commands ceased to affect sessions.  Restore the
  longstanding behavior, which is like beginning the session with a SET
  ROLE command.  If cherry-picking the CVE-2024-10978 fixes, default to
  including this, too.  (This fixes an unintended side effect of fixing
  CVE-2024-10978.)  Back-patch to v12, like that commit.  The release team
  decided to include v12, despite the original intent to halt v12 commits
  earlier this week.

  Tom Lane and Noah Misch.  Reported by Etienne LAFARGE.

  Discussion: https://postgr.es/m/CADOZwSb0UsEr4_UTFXC5k7=fyyK8uKXekucd+-uuGjJsGBfxgw@mail.gmail.com
  7b88529f4363994450bd4cd3c172006a8a77e222:Fix per-session activation of ALTER {ROLE|DATABASE} SET role.

  After commit 5a2fed911a85ed6d8a015a6bafe3a0d9a69334ae, the catalog state
  resulting from these commands ceased to affect sessions.  Restore the
  longstanding behavior, which is like beginning the session with a SET
  ROLE command.  If cherry-picking the CVE-2024-10978 fixes, default to
  including this, too.  (This fixes an unintended side effect of fixing
  CVE-2024-10978.)  Back-patch to v12, like that commit.  The release team
  decided to include v12, despite the original intent to halt v12 commits
  earlier this week.

  Tom Lane and Noah Misch.  Reported by Etienne LAFARGE.

  Discussion: https://postgr.es/m/CADOZwSb0UsEr4_UTFXC5k7=fyyK8uKXekucd+-uuGjJsGBfxgw@mail.gmail.com
  aee114bf1c84368db9e50ba4e7340ce632f89e19:Last-minute updates for release notes.

  Security: CVE-2024-10976, CVE-2024-10977, CVE-2024-10978, CVE-2024-10979
  b3db5fdb05b6ca499f75d0ecf290dbd057bfb075:Last-minute updates for release notes.

  Security: CVE-2024-10976, CVE-2024-10977, CVE-2024-10978, CVE-2024-10979
  575d673fe78f76e396ea7eb8160c30d96ccfea0f:Last-minute updates for release notes.

  Security: CVE-2024-10976, CVE-2024-10977, CVE-2024-10978, CVE-2024-10979
  b83b358b1bac61ca46af995a3da83cc515a434c6:Last-minute updates for release notes.

  Security: CVE-2024-10976, CVE-2024-10977, CVE-2024-10978, CVE-2024-10979
  03dc78ff644ca0c090cb4cdbf8fba64230e54238:Last-minute updates for release notes.

  Security: CVE-2024-10976, CVE-2024-10977, CVE-2024-10978, CVE-2024-10979
  052aa02971f2dd476c14689033727a0b8563d5d2:Last-minute updates for release notes.

  Security: CVE-2024-10976, CVE-2024-10977, CVE-2024-10978, CVE-2024-10979
  73c9f91a1b6d3753451993c5f06ba4b5ccc1f127:Parallel workers use AuthenticatedUserId for connection privilege checks.

  Commit 5a2fed911 had an unexpected side-effect: the parallel worker
  launched for the new test case would fail if it couldn't use a
  superuser-reserved connection slot.  The reason that test failed
  while all our pre-existing ones worked is that the connection
  privilege tests in InitPostgres had been based on the superuserness
  of the leader's AuthenticatedUserId, but after the rearrangements
  of 5a2fed911 we were testing the superuserness of CurrentUserId,
  which the new test case deliberately made to be a non-superuser.

  This all seems very accidental and probably not the behavior we really
  want, but a security patch is no time to be redesigning things.
  Pending some discussion about desirable semantics, hack it so that
  InitPostgres continues to pay attention to the superuserness of
  AuthenticatedUserId when starting a parallel worker.

  Nathan Bossart and Tom Lane, per buildfarm member sawshark.

  Security: CVE-2024-10978
  0edad8654848affe0786c798aea9e1a43dde54bc:Parallel workers use AuthenticatedUserId for connection privilege checks.

  Commit 5a2fed911 had an unexpected side-effect: the parallel worker
  launched for the new test case would fail if it couldn't use a
  superuser-reserved connection slot.  The reason that test failed
  while all our pre-existing ones worked is that the connection
  privilege tests in InitPostgres had been based on the superuserness
  of the leader's AuthenticatedUserId, but after the rearrangements
  of 5a2fed911 we were testing the superuserness of CurrentUserId,
  which the new test case deliberately made to be a non-superuser.

  This all seems very accidental and probably not the behavior we really
  want, but a security patch is no time to be redesigning things.
  Pending some discussion about desirable semantics, hack it so that
  InitPostgres continues to pay attention to the superuserness of
  AuthenticatedUserId when starting a parallel worker.

  Nathan Bossart and Tom Lane, per buildfarm member sawshark.

  Security: CVE-2024-10978
  dc7378793add3c3d9a40ec2118d92bd719acab97:Parallel workers use AuthenticatedUserId for connection privilege checks.

  Commit 5a2fed911 had an unexpected side-effect: the parallel worker
  launched for the new test case would fail if it couldn't use a
  superuser-reserved connection slot.  The reason that test failed
  while all our pre-existing ones worked is that the connection
  privilege tests in InitPostgres had been based on the superuserness
  of the leader's AuthenticatedUserId, but after the rearrangements
  of 5a2fed911 we were testing the superuserness of CurrentUserId,
  which the new test case deliberately made to be a non-superuser.

  This all seems very accidental and probably not the behavior we really
  want, but a security patch is no time to be redesigning things.
  Pending some discussion about desirable semantics, hack it so that
  InitPostgres continues to pay attention to the superuserness of
  AuthenticatedUserId when starting a parallel worker.

  Nathan Bossart and Tom Lane, per buildfarm member sawshark.

  Security: CVE-2024-10978
  00b94e8e2f99a8ed1d7f854838234ce37f582da0:Parallel workers use AuthenticatedUserId for connection privilege checks.

  Commit 5a2fed911 had an unexpected side-effect: the parallel worker
  launched for the new test case would fail if it couldn't use a
  superuser-reserved connection slot.  The reason that test failed
  while all our pre-existing ones worked is that the connection
  privilege tests in InitPostgres had been based on the superuserness
  of the leader's AuthenticatedUserId, but after the rearrangements
  of 5a2fed911 we were testing the superuserness of CurrentUserId,
  which the new test case deliberately made to be a non-superuser.

  This all seems very accidental and probably not the behavior we really
  want, but a security patch is no time to be redesigning things.
  Pending some discussion about desirable semantics, hack it so that
  InitPostgres continues to pay attention to the superuserness of
  AuthenticatedUserId when starting a parallel worker.

  Nathan Bossart and Tom Lane, per buildfarm member sawshark.

  Security: CVE-2024-10978
  109a323807d752f66699a9ce0762244f536e784f:Parallel workers use AuthenticatedUserId for connection privilege checks.

  Commit 5a2fed911 had an unexpected side-effect: the parallel worker
  launched for the new test case would fail if it couldn't use a
  superuser-reserved connection slot.  The reason that test failed
  while all our pre-existing ones worked is that the connection
  privilege tests in InitPostgres had been based on the superuserness
  of the leader's AuthenticatedUserId, but after the rearrangements
  of 5a2fed911 we were testing the superuserness of CurrentUserId,
  which the new test case deliberately made to be a non-superuser.

  This all seems very accidental and probably not the behavior we really
  want, but a security patch is no time to be redesigning things.
  Pending some discussion about desirable semantics, hack it so that
  InitPostgres continues to pay attention to the superuserness of
  AuthenticatedUserId when starting a parallel worker.

  Nathan Bossart and Tom Lane, per buildfarm member sawshark.

  Security: CVE-2024-10978
  95f5a523729f6814c8757860d9a2264148b7b0df:Parallel workers use AuthenticatedUserId for connection privilege checks.

  Commit 5a2fed911 had an unexpected side-effect: the parallel worker
  launched for the new test case would fail if it couldn't use a
  superuser-reserved connection slot.  The reason that test failed
  while all our pre-existing ones worked is that the connection
  privilege tests in InitPostgres had been based on the superuserness
  of the leader's AuthenticatedUserId, but after the rearrangements
  of 5a2fed911 we were testing the superuserness of CurrentUserId,
  which the new test case deliberately made to be a non-superuser.

  This all seems very accidental and probably not the behavior we really
  want, but a security patch is no time to be redesigning things.
  Pending some discussion about desirable semantics, hack it so that
  InitPostgres continues to pay attention to the superuserness of
  AuthenticatedUserId when starting a parallel worker.

  Nathan Bossart and Tom Lane, per buildfarm member sawshark.

  Security: CVE-2024-10978
  f4f5d27d87247da1ec7e5a6e7990a22ffba9f63a:Parallel workers use AuthenticatedUserId for connection privilege checks.

  Commit 5a2fed911 had an unexpected side-effect: the parallel worker
  launched for the new test case would fail if it couldn't use a
  superuser-reserved connection slot.  The reason that test failed
  while all our pre-existing ones worked is that the connection
  privilege tests in InitPostgres had been based on the superuserness
  of the leader's AuthenticatedUserId, but after the rearrangements
  of 5a2fed911 we were testing the superuserness of CurrentUserId,
  which the new test case deliberately made to be a non-superuser.

  This all seems very accidental and probably not the behavior we really
  want, but a security patch is no time to be redesigning things.
  Pending some discussion about desirable semantics, hack it so that
  InitPostgres continues to pay attention to the superuserness of
  AuthenticatedUserId when starting a parallel worker.

  Nathan Bossart and Tom Lane, per buildfarm member sawshark.

  Security: CVE-2024-10978
  a5d2e6205f716c79ecfb15eb1aae75bae3f8daa9:Fix improper interactions between session_authorization and role.

  The SQL spec mandates that SET SESSION AUTHORIZATION implies
  SET ROLE NONE.  We tried to implement that within the lowest-level
  functions that manipulate these settings, but that was a bad idea.
  In particular, guc.c assumes that it doesn't matter in what order
  it applies GUC variable updates, but that was not the case for these
  two variables.  This problem, compounded by some hackish attempts to
  work around it, led to some security-grade issues:

  * Rolling back a transaction that had done SET SESSION AUTHORIZATION
  would revert to SET ROLE NONE, even if that had not been the previous
  state, so that the effective user ID might now be different from what
  it had been.

  * The same for SET SESSION AUTHORIZATION in a function SET clause.

  * If a parallel worker inspected current_setting('role'), it saw
  "none" even when it should see something else.

  Also, although the parallel worker startup code intended to cope
  with the current role's pg_authid row having disappeared, its
  implementation of that was incomplete so it would still fail.

  Fix by fully separating the miscinit.c functions that assign
  session_authorization from those that assign role.  To implement the
  spec's requirement, teach set_config_option itself to perform "SET
  ROLE NONE" when it sets session_authorization.  (This is undoubtedly
  ugly, but the alternatives seem worse.  In particular, there's no way
  to do it within assign_session_authorization without incompatible
  changes in the API for GUC assign hooks.)  Also, improve
  ParallelWorkerMain to directly set all the relevant user-ID variables
  instead of relying on some of them to get set indirectly.  That
  allows us to survive not finding the pg_authid row during worker
  startup.

  In v16 and earlier, this includes back-patching 9987a7bf3 which
  fixed a violation of GUC coding rules: SetSessionAuthorization
  is not an appropriate place to be throwing errors from.

  Security: CVE-2024-10978
  5a2fed911a85ed6d8a015a6bafe3a0d9a69334ae:Fix improper interactions between session_authorization and role.

  The SQL spec mandates that SET SESSION AUTHORIZATION implies
  SET ROLE NONE.  We tried to implement that within the lowest-level
  functions that manipulate these settings, but that was a bad idea.
  In particular, guc.c assumes that it doesn't matter in what order
  it applies GUC variable updates, but that was not the case for these
  two variables.  This problem, compounded by some hackish attempts to
  work around it, led to some security-grade issues:

  * Rolling back a transaction that had done SET SESSION AUTHORIZATION
  would revert to SET ROLE NONE, even if that had not been the previous
  state, so that the effective user ID might now be different from what
  it had been.

  * The same for SET SESSION AUTHORIZATION in a function SET clause.

  * If a parallel worker inspected current_setting('role'), it saw
  "none" even when it should see something else.

  Also, although the parallel worker startup code intended to cope
  with the current role's pg_authid row having disappeared, its
  implementation of that was incomplete so it would still fail.

  Fix by fully separating the miscinit.c functions that assign
  session_authorization from those that assign role.  To implement the
  spec's requirement, teach set_config_option itself to perform "SET
  ROLE NONE" when it sets session_authorization.  (This is undoubtedly
  ugly, but the alternatives seem worse.  In particular, there's no way
  to do it within assign_session_authorization without incompatible
  changes in the API for GUC assign hooks.)  Also, improve
  ParallelWorkerMain to directly set all the relevant user-ID variables
  instead of relying on some of them to get set indirectly.  That
  allows us to survive not finding the pg_authid row during worker
  startup.

  In v16 and earlier, this includes back-patching 9987a7bf3 which
  fixed a violation of GUC coding rules: SetSessionAuthorization
  is not an appropriate place to be throwing errors from.

  Security: CVE-2024-10978
  cd82afdda5e9d3269706a142e9093ba83f484185:Fix improper interactions between session_authorization and role.

  The SQL spec mandates that SET SESSION AUTHORIZATION implies
  SET ROLE NONE.  We tried to implement that within the lowest-level
  functions that manipulate these settings, but that was a bad idea.
  In particular, guc.c assumes that it doesn't matter in what order
  it applies GUC variable updates, but that was not the case for these
  two variables.  This problem, compounded by some hackish attempts to
  work around it, led to some security-grade issues:

  * Rolling back a transaction that had done SET SESSION AUTHORIZATION
  would revert to SET ROLE NONE, even if that had not been the previous
  state, so that the effective user ID might now be different from what
  it had been.

  * The same for SET SESSION AUTHORIZATION in a function SET clause.

  * If a parallel worker inspected current_setting('role'), it saw
  "none" even when it should see something else.

  Also, although the parallel worker startup code intended to cope
  with the current role's pg_authid row having disappeared, its
  implementation of that was incomplete so it would still fail.

  Fix by fully separating the miscinit.c functions that assign
  session_authorization from those that assign role.  To implement the
  spec's requirement, teach set_config_option itself to perform "SET
  ROLE NONE" when it sets session_authorization.  (This is undoubtedly
  ugly, but the alternatives seem worse.  In particular, there's no way
  to do it within assign_session_authorization without incompatible
  changes in the API for GUC assign hooks.)  Also, improve
  ParallelWorkerMain to directly set all the relevant user-ID variables
  instead of relying on some of them to get set indirectly.  That
  allows us to survive not finding the pg_authid row during worker
  startup.

  In v16 and earlier, this includes back-patching 9987a7bf3 which
  fixed a violation of GUC coding rules: SetSessionAuthorization
  is not an appropriate place to be throwing errors from.

  Security: CVE-2024-10978
  ae340d0318521ae7234ed3b7221a1f65f39a52c0:Fix improper interactions between session_authorization and role.

  The SQL spec mandates that SET SESSION AUTHORIZATION implies
  SET ROLE NONE.  We tried to implement that within the lowest-level
  functions that manipulate these settings, but that was a bad idea.
  In particular, guc.c assumes that it doesn't matter in what order
  it applies GUC variable updates, but that was not the case for these
  two variables.  This problem, compounded by some hackish attempts to
  work around it, led to some security-grade issues:

  * Rolling back a transaction that had done SET SESSION AUTHORIZATION
  would revert to SET ROLE NONE, even if that had not been the previous
  state, so that the effective user ID might now be different from what
  it had been.

  * The same for SET SESSION AUTHORIZATION in a function SET clause.

  * If a parallel worker inspected current_setting('role'), it saw
  "none" even when it should see something else.

  Also, although the parallel worker startup code intended to cope
  with the current role's pg_authid row having disappeared, its
  implementation of that was incomplete so it would still fail.

  Fix by fully separating the miscinit.c functions that assign
  session_authorization from those that assign role.  To implement the
  spec's requirement, teach set_config_option itself to perform "SET
  ROLE NONE" when it sets session_authorization.  (This is undoubtedly
  ugly, but the alternatives seem worse.  In particular, there's no way
  to do it within assign_session_authorization without incompatible
  changes in the API for GUC assign hooks.)  Also, improve
  ParallelWorkerMain to directly set all the relevant user-ID variables
  instead of relying on some of them to get set indirectly.  That
  allows us to survive not finding the pg_authid row during worker
  startup.

  In v16 and earlier, this includes back-patching 9987a7bf3 which
  fixed a violation of GUC coding rules: SetSessionAuthorization
  is not an appropriate place to be throwing errors from.

  Security: CVE-2024-10978
  4c9d96f74ba4e7d01c086ca54f217e242dd65fae:Fix improper interactions between session_authorization and role.

  The SQL spec mandates that SET SESSION AUTHORIZATION implies
  SET ROLE NONE.  We tried to implement that within the lowest-level
  functions that manipulate these settings, but that was a bad idea.
  In particular, guc.c assumes that it doesn't matter in what order
  it applies GUC variable updates, but that was not the case for these
  two variables.  This problem, compounded by some hackish attempts to
  work around it, led to some security-grade issues:

  * Rolling back a transaction that had done SET SESSION AUTHORIZATION
  would revert to SET ROLE NONE, even if that had not been the previous
  state, so that the effective user ID might now be different from what
  it had been.

  * The same for SET SESSION AUTHORIZATION in a function SET clause.

  * If a parallel worker inspected current_setting('role'), it saw
  "none" even when it should see something else.

  Also, although the parallel worker startup code intended to cope
  with the current role's pg_authid row having disappeared, its
  implementation of that was incomplete so it would still fail.

  Fix by fully separating the miscinit.c functions that assign
  session_authorization from those that assign role.  To implement the
  spec's requirement, teach set_config_option itself to perform "SET
  ROLE NONE" when it sets session_authorization.  (This is undoubtedly
  ugly, but the alternatives seem worse.  In particular, there's no way
  to do it within assign_session_authorization without incompatible
  changes in the API for GUC assign hooks.)  Also, improve
  ParallelWorkerMain to directly set all the relevant user-ID variables
  instead of relying on some of them to get set indirectly.  That
  allows us to survive not finding the pg_authid row during worker
  startup.

  In v16 and earlier, this includes back-patching 9987a7bf3 which
  fixed a violation of GUC coding rules: SetSessionAuthorization
  is not an appropriate place to be throwing errors from.

  Security: CVE-2024-10978
  76123ded6e9b3624e380ac326645bd026aacd2f5:Fix improper interactions between session_authorization and role.

  The SQL spec mandates that SET SESSION AUTHORIZATION implies
  SET ROLE NONE.  We tried to implement that within the lowest-level
  functions that manipulate these settings, but that was a bad idea.
  In particular, guc.c assumes that it doesn't matter in what order
  it applies GUC variable updates, but that was not the case for these
  two variables.  This problem, compounded by some hackish attempts to
  work around it, led to some security-grade issues:

  * Rolling back a transaction that had done SET SESSION AUTHORIZATION
  would revert to SET ROLE NONE, even if that had not been the previous
  state, so that the effective user ID might now be different from what
  it had been.

  * The same for SET SESSION AUTHORIZATION in a function SET clause.

  * If a parallel worker inspected current_setting('role'), it saw
  "none" even when it should see something else.

  Also, although the parallel worker startup code intended to cope
  with the current role's pg_authid row having disappeared, its
  implementation of that was incomplete so it would still fail.

  Fix by fully separating the miscinit.c functions that assign
  session_authorization from those that assign role.  To implement the
  spec's requirement, teach set_config_option itself to perform "SET
  ROLE NONE" when it sets session_authorization.  (This is undoubtedly
  ugly, but the alternatives seem worse.  In particular, there's no way
  to do it within assign_session_authorization without incompatible
  changes in the API for GUC assign hooks.)  Also, improve
  ParallelWorkerMain to directly set all the relevant user-ID variables
  instead of relying on some of them to get set indirectly.  That
  allows us to survive not finding the pg_authid row during worker
  startup.

  In v16 and earlier, this includes back-patching 9987a7bf3 which
  fixed a violation of GUC coding rules: SetSessionAuthorization
  is not an appropriate place to be throwing errors from.

  Security: CVE-2024-10978
  2a68808e241bf667ff72c31ea9d0c4eb0b893982:Fix improper interactions between session_authorization and role.

  The SQL spec mandates that SET SESSION AUTHORIZATION implies
  SET ROLE NONE.  We tried to implement that within the lowest-level
  functions that manipulate these settings, but that was a bad idea.
  In particular, guc.c assumes that it doesn't matter in what order
  it applies GUC variable updates, but that was not the case for these
  two variables.  This problem, compounded by some hackish attempts to
  work around it, led to some security-grade issues:

  * Rolling back a transaction that had done SET SESSION AUTHORIZATION
  would revert to SET ROLE NONE, even if that had not been the previous
  state, so that the effective user ID might now be different from what
  it had been.

  * The same for SET SESSION AUTHORIZATION in a function SET clause.

  * If a parallel worker inspected current_setting('role'), it saw
  "none" even when it should see something else.

  Also, although the parallel worker startup code intended to cope
  with the current role's pg_authid row having disappeared, its
  implementation of that was incomplete so it would still fail.

  Fix by fully separating the miscinit.c functions that assign
  session_authorization from those that assign role.  To implement the
  spec's requirement, teach set_config_option itself to perform "SET
  ROLE NONE" when it sets session_authorization.  (This is undoubtedly
  ugly, but the alternatives seem worse.  In particular, there's no way
  to do it within assign_session_authorization without incompatible
  changes in the API for GUC assign hooks.)  Also, improve
  ParallelWorkerMain to directly set all the relevant user-ID variables
  instead of relying on some of them to get set indirectly.  That
  allows us to survive not finding the pg_authid row during worker
  startup.

  In v16 and earlier, this includes back-patching 9987a7bf3 which
  fixed a violation of GUC coding rules: SetSessionAuthorization
  is not an appropriate place to be throwing errors from.

  Security: CVE-2024-10978
impacted_packages:
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 052aa02971f2dd476c14689033727a0b8563d5d2
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 70d067ceccf02d9670cbe8ddd79c98f2b66989a9
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 7b88529f4363994450bd4cd3c172006a8a77e222
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 41a252c2ca68ba7239e73abd99fdbf28871f5f07
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: ae340d0318521ae7234ed3b7221a1f65f39a52c0
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: b83b358b1bac61ca46af995a3da83cc515a434c6
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 2a68808e241bf667ff72c31ea9d0c4eb0b893982
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 03dc78ff644ca0c090cb4cdbf8fba64230e54238
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 5a2fed911a85ed6d8a015a6bafe3a0d9a69334ae
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 15b4c46c328b25be9463db6d2960eeb16a784aad
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 34486b6092e700089d22586df211c4e8b0412136
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: b0918c1286d316f6ffa93995452270afd4fc4335
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: edf80895f6bda824403f843df91cbc83890e4b6c
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: b3db5fdb05b6ca499f75d0ecf290dbd057bfb075
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: dc7378793add3c3d9a40ec2118d92bd719acab97
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 1c05004a895308da10ec000ba6b92f72f4f5b8e2
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: aee114bf1c84368db9e50ba4e7340ce632f89e19
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 76123ded6e9b3624e380ac326645bd026aacd2f5
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 00b94e8e2f99a8ed1d7f854838234ce37f582da0
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 109a323807d752f66699a9ce0762244f536e784f
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: c463338656ac47e5210fcf9fbf7d20efccce8de8
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 575d673fe78f76e396ea7eb8160c30d96ccfea0f
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 95f5a523729f6814c8757860d9a2264148b7b0df
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 4c9d96f74ba4e7d01c086ca54f217e242dd65fae
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: a5d2e6205f716c79ecfb15eb1aae75bae3f8daa9
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: cd82afdda5e9d3269706a142e9093ba83f484185
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 3d1ecc92a0d15eb299ea37c9842b3367eddc0081
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: c58b0c43d36f606d6c1f8e7e45cc383df9d1dc74
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 07c6e0f613612ff060572a085c1c24aa44c8b2bb
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: be062bfa54d780c07a3b36c4123da2c960c8e97d
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 0edad8654848affe0786c798aea9e1a43dde54bc
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 73c9f91a1b6d3753451993c5f06ba4b5ccc1f127
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: f4f5d27d87247da1ec7e5a6e7990a22ffba9f63a
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/postgres/postgres/tree/00b94e8e2f99a8ed1d7f854838234ce37f582da0
    reference_type: commit
    reference_id: 00b94e8e2f99a8ed1d7f854838234ce37f582da0
  - url: https://github.com/postgres/postgres/tree/03dc78ff644ca0c090cb4cdbf8fba64230e54238
    reference_type: commit
    reference_id: 03dc78ff644ca0c090cb4cdbf8fba64230e54238
  - url: https://github.com/postgres/postgres/tree/052aa02971f2dd476c14689033727a0b8563d5d2
    reference_type: commit
    reference_id: 052aa02971f2dd476c14689033727a0b8563d5d2
  - url: https://github.com/postgres/postgres/tree/07c6e0f613612ff060572a085c1c24aa44c8b2bb
    reference_type: commit
    reference_id: 07c6e0f613612ff060572a085c1c24aa44c8b2bb
  - url: https://github.com/postgres/postgres/tree/0edad8654848affe0786c798aea9e1a43dde54bc
    reference_type: commit
    reference_id: 0edad8654848affe0786c798aea9e1a43dde54bc
  - url: https://github.com/postgres/postgres/tree/109a323807d752f66699a9ce0762244f536e784f
    reference_type: commit
    reference_id: 109a323807d752f66699a9ce0762244f536e784f
  - url: https://github.com/postgres/postgres/tree/15b4c46c328b25be9463db6d2960eeb16a784aad
    reference_type: commit
    reference_id: 15b4c46c328b25be9463db6d2960eeb16a784aad
  - url: https://github.com/postgres/postgres/tree/1c05004a895308da10ec000ba6b92f72f4f5b8e2
    reference_type: commit
    reference_id: 1c05004a895308da10ec000ba6b92f72f4f5b8e2
  - url: https://github.com/postgres/postgres/tree/2a68808e241bf667ff72c31ea9d0c4eb0b893982
    reference_type: commit
    reference_id: 2a68808e241bf667ff72c31ea9d0c4eb0b893982
  - url: https://github.com/postgres/postgres/tree/34486b6092e700089d22586df211c4e8b0412136
    reference_type: commit
    reference_id: 34486b6092e700089d22586df211c4e8b0412136
  - url: https://github.com/postgres/postgres/tree/3d1ecc92a0d15eb299ea37c9842b3367eddc0081
    reference_type: commit
    reference_id: 3d1ecc92a0d15eb299ea37c9842b3367eddc0081
  - url: https://github.com/postgres/postgres/tree/41a252c2ca68ba7239e73abd99fdbf28871f5f07
    reference_type: commit
    reference_id: 41a252c2ca68ba7239e73abd99fdbf28871f5f07
  - url: https://github.com/postgres/postgres/tree/4c9d96f74ba4e7d01c086ca54f217e242dd65fae
    reference_type: commit
    reference_id: 4c9d96f74ba4e7d01c086ca54f217e242dd65fae
  - url: https://github.com/postgres/postgres/tree/575d673fe78f76e396ea7eb8160c30d96ccfea0f
    reference_type: commit
    reference_id: 575d673fe78f76e396ea7eb8160c30d96ccfea0f
  - url: https://github.com/postgres/postgres/tree/5a2fed911a85ed6d8a015a6bafe3a0d9a69334ae
    reference_type: commit
    reference_id: 5a2fed911a85ed6d8a015a6bafe3a0d9a69334ae
  - url: https://github.com/postgres/postgres/tree/70d067ceccf02d9670cbe8ddd79c98f2b66989a9
    reference_type: commit
    reference_id: 70d067ceccf02d9670cbe8ddd79c98f2b66989a9
  - url: https://github.com/postgres/postgres/tree/73c9f91a1b6d3753451993c5f06ba4b5ccc1f127
    reference_type: commit
    reference_id: 73c9f91a1b6d3753451993c5f06ba4b5ccc1f127
  - url: https://github.com/postgres/postgres/tree/76123ded6e9b3624e380ac326645bd026aacd2f5
    reference_type: commit
    reference_id: 76123ded6e9b3624e380ac326645bd026aacd2f5
  - url: https://github.com/postgres/postgres/tree/7b88529f4363994450bd4cd3c172006a8a77e222
    reference_type: commit
    reference_id: 7b88529f4363994450bd4cd3c172006a8a77e222
  - url: https://github.com/postgres/postgres/tree/95f5a523729f6814c8757860d9a2264148b7b0df
    reference_type: commit
    reference_id: 95f5a523729f6814c8757860d9a2264148b7b0df
  - url: https://github.com/postgres/postgres/tree/a5d2e6205f716c79ecfb15eb1aae75bae3f8daa9
    reference_type: commit
    reference_id: a5d2e6205f716c79ecfb15eb1aae75bae3f8daa9
  - url: https://github.com/postgres/postgres/tree/ae340d0318521ae7234ed3b7221a1f65f39a52c0
    reference_type: commit
    reference_id: ae340d0318521ae7234ed3b7221a1f65f39a52c0
  - url: https://github.com/postgres/postgres/tree/aee114bf1c84368db9e50ba4e7340ce632f89e19
    reference_type: commit
    reference_id: aee114bf1c84368db9e50ba4e7340ce632f89e19
  - url: https://github.com/postgres/postgres/tree/b0918c1286d316f6ffa93995452270afd4fc4335
    reference_type: commit
    reference_id: b0918c1286d316f6ffa93995452270afd4fc4335
  - url: https://github.com/postgres/postgres/tree/b3db5fdb05b6ca499f75d0ecf290dbd057bfb075
    reference_type: commit
    reference_id: b3db5fdb05b6ca499f75d0ecf290dbd057bfb075
  - url: https://github.com/postgres/postgres/tree/b83b358b1bac61ca46af995a3da83cc515a434c6
    reference_type: commit
    reference_id: b83b358b1bac61ca46af995a3da83cc515a434c6
  - url: https://github.com/postgres/postgres/tree/be062bfa54d780c07a3b36c4123da2c960c8e97d
    reference_type: commit
    reference_id: be062bfa54d780c07a3b36c4123da2c960c8e97d
  - url: https://github.com/postgres/postgres/tree/c463338656ac47e5210fcf9fbf7d20efccce8de8
    reference_type: commit
    reference_id: c463338656ac47e5210fcf9fbf7d20efccce8de8
  - url: https://github.com/postgres/postgres/tree/c58b0c43d36f606d6c1f8e7e45cc383df9d1dc74
    reference_type: commit
    reference_id: c58b0c43d36f606d6c1f8e7e45cc383df9d1dc74
  - url: https://github.com/postgres/postgres/tree/cd82afdda5e9d3269706a142e9093ba83f484185
    reference_type: commit
    reference_id: cd82afdda5e9d3269706a142e9093ba83f484185
  - url: https://github.com/postgres/postgres/tree/dc7378793add3c3d9a40ec2118d92bd719acab97
    reference_type: commit
    reference_id: dc7378793add3c3d9a40ec2118d92bd719acab97
  - url: https://github.com/postgres/postgres/tree/edf80895f6bda824403f843df91cbc83890e4b6c
    reference_type: commit
    reference_id: edf80895f6bda824403f843df91cbc83890e4b6c
  - url: https://github.com/postgres/postgres/tree/f4f5d27d87247da1ec7e5a6e7990a22ffba9f63a
    reference_type: commit
    reference_id: f4f5d27d87247da1ec7e5a6e7990a22ffba9f63a
