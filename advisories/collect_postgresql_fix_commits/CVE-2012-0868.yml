advisory_id: CVE-2012-0868
datasource_id: collect_postgresql_fix_commits/CVE-2012-0868
datasource_url: https://github.com/postgres/postgres
aliases: []
summary: |
  2179e6005ec9500d5e130f53f7d3ed7c8d4439a9:Convert newlines to spaces in names written in v11+ pg_dump comments.

  Maliciously-crafted object names could achieve SQL injection during
  restore.  CVE-2012-0868 fixed this class of problem at the time, but
  later work reintroduced three cases.  Commit
  bc8cd50fefd369b217f80078585c486505aafb62 (back-patched to v11+ in
  2023-05 releases) introduced the pg_dump case.  Commit
  6cbdbd9e8d8f2986fde44f2431ed8d0c8fce7f5d (v12+) introduced the two
  pg_dumpall cases.  Move sanitize_line(), unchanged, to dumputils.c so
  pg_dumpall has access to it in all supported versions.  Back-patch to
  v13 (all supported versions).

  Reviewed-by: Robert Haas <robertmhaas@gmail.com>
  Reviewed-by: Nathan Bossart <nathandbossart@gmail.com>
  Backpatch-through: 13
  Security: CVE-2025-8715
  9751f934aa80f855f742425e16f669c44f6d0b9b:Convert newlines to spaces in names written in v11+ pg_dump comments.

  Maliciously-crafted object names could achieve SQL injection during
  restore.  CVE-2012-0868 fixed this class of problem at the time, but
  later work reintroduced three cases.  Commit
  bc8cd50fefd369b217f80078585c486505aafb62 (back-patched to v11+ in
  2023-05 releases) introduced the pg_dump case.  Commit
  6cbdbd9e8d8f2986fde44f2431ed8d0c8fce7f5d (v12+) introduced the two
  pg_dumpall cases.  Move sanitize_line(), unchanged, to dumputils.c so
  pg_dumpall has access to it in all supported versions.  Back-patch to
  v13 (all supported versions).

  Reviewed-by: Robert Haas <robertmhaas@gmail.com>
  Reviewed-by: Nathan Bossart <nathandbossart@gmail.com>
  Backpatch-through: 13
  Security: CVE-2025-8715
  0f583843840638d5a8ee13e1b6e20e38723cc5d9:Convert newlines to spaces in names written in v11+ pg_dump comments.

  Maliciously-crafted object names could achieve SQL injection during
  restore.  CVE-2012-0868 fixed this class of problem at the time, but
  later work reintroduced three cases.  Commit
  bc8cd50fefd369b217f80078585c486505aafb62 (back-patched to v11+ in
  2023-05 releases) introduced the pg_dump case.  Commit
  6cbdbd9e8d8f2986fde44f2431ed8d0c8fce7f5d (v12+) introduced the two
  pg_dumpall cases.  Move sanitize_line(), unchanged, to dumputils.c so
  pg_dumpall has access to it in all supported versions.  Back-patch to
  v13 (all supported versions).

  Reviewed-by: Robert Haas <robertmhaas@gmail.com>
  Reviewed-by: Nathan Bossart <nathandbossart@gmail.com>
  Backpatch-through: 13
  Security: CVE-2025-8715
  13a67ce6034ed674a4e797c6f1545831189be02e:Convert newlines to spaces in names written in v11+ pg_dump comments.

  Maliciously-crafted object names could achieve SQL injection during
  restore.  CVE-2012-0868 fixed this class of problem at the time, but
  later work reintroduced three cases.  Commit
  bc8cd50fefd369b217f80078585c486505aafb62 (back-patched to v11+ in
  2023-05 releases) introduced the pg_dump case.  Commit
  6cbdbd9e8d8f2986fde44f2431ed8d0c8fce7f5d (v12+) introduced the two
  pg_dumpall cases.  Move sanitize_line(), unchanged, to dumputils.c so
  pg_dumpall has access to it in all supported versions.  Back-patch to
  v13 (all supported versions).

  Reviewed-by: Robert Haas <robertmhaas@gmail.com>
  Reviewed-by: Nathan Bossart <nathandbossart@gmail.com>
  Backpatch-through: 13
  Security: CVE-2025-8715
  850caae60c49c15ed021f8051dc39c6e24f2a380:Convert newlines to spaces in names written in v11+ pg_dump comments.

  Maliciously-crafted object names could achieve SQL injection during
  restore.  CVE-2012-0868 fixed this class of problem at the time, but
  later work reintroduced three cases.  Commit
  bc8cd50fefd369b217f80078585c486505aafb62 (back-patched to v11+ in
  2023-05 releases) introduced the pg_dump case.  Commit
  6cbdbd9e8d8f2986fde44f2431ed8d0c8fce7f5d (v12+) introduced the two
  pg_dumpall cases.  Move sanitize_line(), unchanged, to dumputils.c so
  pg_dumpall has access to it in all supported versions.  Back-patch to
  v13 (all supported versions).

  Reviewed-by: Robert Haas <robertmhaas@gmail.com>
  Reviewed-by: Nathan Bossart <nathandbossart@gmail.com>
  Backpatch-through: 13
  Security: CVE-2025-8715
  9b92f115bdf9f21e9a8c4dcd80207c0723e81c3b:Convert newlines to spaces in names written in v11+ pg_dump comments.

  Maliciously-crafted object names could achieve SQL injection during
  restore.  CVE-2012-0868 fixed this class of problem at the time, but
  later work reintroduced three cases.  Commit
  bc8cd50fefd369b217f80078585c486505aafb62 (back-patched to v11+ in
  2023-05 releases) introduced the pg_dump case.  Commit
  6cbdbd9e8d8f2986fde44f2431ed8d0c8fce7f5d (v12+) introduced the two
  pg_dumpall cases.  Move sanitize_line(), unchanged, to dumputils.c so
  pg_dumpall has access to it in all supported versions.  Back-patch to
  v13 (all supported versions).

  Reviewed-by: Robert Haas <robertmhaas@gmail.com>
  Reviewed-by: Nathan Bossart <nathandbossart@gmail.com>
  Backpatch-through: 13
  Security: CVE-2025-8715
  70693c645f6e490b9ed450e8611e94ab7af3aad2:Convert newlines to spaces in names written in v11+ pg_dump comments.

  Maliciously-crafted object names could achieve SQL injection during
  restore.  CVE-2012-0868 fixed this class of problem at the time, but
  later work reintroduced three cases.  Commit
  bc8cd50fefd369b217f80078585c486505aafb62 (back-patched to v11+ in
  2023-05 releases) introduced the pg_dump case.  Commit
  6cbdbd9e8d8f2986fde44f2431ed8d0c8fce7f5d (v12+) introduced the two
  pg_dumpall cases.  Move sanitize_line(), unchanged, to dumputils.c so
  pg_dumpall has access to it in all supported versions.  Back-patch to
  v13 (all supported versions).

  Reviewed-by: Robert Haas <robertmhaas@gmail.com>
  Reviewed-by: Nathan Bossart <nathandbossart@gmail.com>
  Backpatch-through: 13
  Security: CVE-2025-8715
  ecabae5af98d2b238e82cb59b4fd9b00aad1e63d:Last-minute release note updates.

  Security: CVE-2012-0866, CVE-2012-0867, CVE-2012-0868
  44909f44d99a7511ae7e2d7f106d09676b4026be:Last-minute release note updates.

  Security: CVE-2012-0866, CVE-2012-0867, CVE-2012-0868
  09189cb6059f28aea59cca4f419c535123f499b8:Last-minute release note updates.

  Security: CVE-2012-0866, CVE-2012-0867, CVE-2012-0868
  22795f096b521e975800cd2fff222f958500ef19:Last-minute release note updates.

  Security: CVE-2012-0866, CVE-2012-0867, CVE-2012-0868
  b2ce60703ab431a1d6c10f50587ea5f5e984af2e:Last-minute release note updates.

  Security: CVE-2012-0866, CVE-2012-0867, CVE-2012-0868
  a7f6cb85486b1f3eacd86155af2fdc20a1dc2bec:Convert newlines to spaces in names written in pg_dump comments.

  pg_dump was incautious about sanitizing object names that are emitted
  within SQL comments in its output script.  A name containing a newline
  would at least render the script syntactically incorrect.  Maliciously
  crafted object names could present a SQL injection risk when the script
  is reloaded.

  Reported by Heikki Linnakangas, patch by Robert Haas

  Security: CVE-2012-0868
  d975e166052e5992e1d082273f5680e85239b935:Convert newlines to spaces in names written in pg_dump comments.

  pg_dump was incautious about sanitizing object names that are emitted
  within SQL comments in its output script.  A name containing a newline
  would at least render the script syntactically incorrect.  Maliciously
  crafted object names could present a SQL injection risk when the script
  is reloaded.

  Reported by Heikki Linnakangas, patch by Robert Haas

  Security: CVE-2012-0868
  02f013ee0228337626071d71abaf2dcb143614a4:Convert newlines to spaces in names written in pg_dump comments.

  pg_dump was incautious about sanitizing object names that are emitted
  within SQL comments in its output script.  A name containing a newline
  would at least render the script syntactically incorrect.  Maliciously
  crafted object names could present a SQL injection risk when the script
  is reloaded.

  Reported by Heikki Linnakangas, patch by Robert Haas

  Security: CVE-2012-0868
  2d2f63ddccc6a557e7eb35252483fea7fe4a688a:Convert newlines to spaces in names written in pg_dump comments.

  pg_dump was incautious about sanitizing object names that are emitted
  within SQL comments in its output script.  A name containing a newline
  would at least render the script syntactically incorrect.  Maliciously
  crafted object names could present a SQL injection risk when the script
  is reloaded.

  Reported by Heikki Linnakangas, patch by Robert Haas

  Security: CVE-2012-0868
  89e0bac86dbca40dfc321926205f2a90d3da5437:Convert newlines to spaces in names written in pg_dump comments.

  pg_dump was incautious about sanitizing object names that are emitted
  within SQL comments in its output script.  A name containing a newline
  would at least render the script syntactically incorrect.  Maliciously
  crafted object names could present a SQL injection risk when the script
  is reloaded.

  Reported by Heikki Linnakangas, patch by Robert Haas

  Security: CVE-2012-0868
impacted_packages:
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: d975e166052e5992e1d082273f5680e85239b935
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 70693c645f6e490b9ed450e8611e94ab7af3aad2
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 0f583843840638d5a8ee13e1b6e20e38723cc5d9
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 09189cb6059f28aea59cca4f419c535123f499b8
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: b2ce60703ab431a1d6c10f50587ea5f5e984af2e
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 89e0bac86dbca40dfc321926205f2a90d3da5437
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 2d2f63ddccc6a557e7eb35252483fea7fe4a688a
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 02f013ee0228337626071d71abaf2dcb143614a4
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 13a67ce6034ed674a4e797c6f1545831189be02e
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 22795f096b521e975800cd2fff222f958500ef19
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 2179e6005ec9500d5e130f53f7d3ed7c8d4439a9
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 44909f44d99a7511ae7e2d7f106d09676b4026be
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 850caae60c49c15ed021f8051dc39c6e24f2a380
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 9751f934aa80f855f742425e16f669c44f6d0b9b
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: a7f6cb85486b1f3eacd86155af2fdc20a1dc2bec
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: ecabae5af98d2b238e82cb59b4fd9b00aad1e63d
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 9b92f115bdf9f21e9a8c4dcd80207c0723e81c3b
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/postgres/postgres/tree/02f013ee0228337626071d71abaf2dcb143614a4
    reference_type: commit
    reference_id: 02f013ee0228337626071d71abaf2dcb143614a4
  - url: https://github.com/postgres/postgres/tree/09189cb6059f28aea59cca4f419c535123f499b8
    reference_type: commit
    reference_id: 09189cb6059f28aea59cca4f419c535123f499b8
  - url: https://github.com/postgres/postgres/tree/0f583843840638d5a8ee13e1b6e20e38723cc5d9
    reference_type: commit
    reference_id: 0f583843840638d5a8ee13e1b6e20e38723cc5d9
  - url: https://github.com/postgres/postgres/tree/13a67ce6034ed674a4e797c6f1545831189be02e
    reference_type: commit
    reference_id: 13a67ce6034ed674a4e797c6f1545831189be02e
  - url: https://github.com/postgres/postgres/tree/2179e6005ec9500d5e130f53f7d3ed7c8d4439a9
    reference_type: commit
    reference_id: 2179e6005ec9500d5e130f53f7d3ed7c8d4439a9
  - url: https://github.com/postgres/postgres/tree/22795f096b521e975800cd2fff222f958500ef19
    reference_type: commit
    reference_id: 22795f096b521e975800cd2fff222f958500ef19
  - url: https://github.com/postgres/postgres/tree/2d2f63ddccc6a557e7eb35252483fea7fe4a688a
    reference_type: commit
    reference_id: 2d2f63ddccc6a557e7eb35252483fea7fe4a688a
  - url: https://github.com/postgres/postgres/tree/44909f44d99a7511ae7e2d7f106d09676b4026be
    reference_type: commit
    reference_id: 44909f44d99a7511ae7e2d7f106d09676b4026be
  - url: https://github.com/postgres/postgres/tree/70693c645f6e490b9ed450e8611e94ab7af3aad2
    reference_type: commit
    reference_id: 70693c645f6e490b9ed450e8611e94ab7af3aad2
  - url: https://github.com/postgres/postgres/tree/850caae60c49c15ed021f8051dc39c6e24f2a380
    reference_type: commit
    reference_id: 850caae60c49c15ed021f8051dc39c6e24f2a380
  - url: https://github.com/postgres/postgres/tree/89e0bac86dbca40dfc321926205f2a90d3da5437
    reference_type: commit
    reference_id: 89e0bac86dbca40dfc321926205f2a90d3da5437
  - url: https://github.com/postgres/postgres/tree/9751f934aa80f855f742425e16f669c44f6d0b9b
    reference_type: commit
    reference_id: 9751f934aa80f855f742425e16f669c44f6d0b9b
  - url: https://github.com/postgres/postgres/tree/9b92f115bdf9f21e9a8c4dcd80207c0723e81c3b
    reference_type: commit
    reference_id: 9b92f115bdf9f21e9a8c4dcd80207c0723e81c3b
  - url: https://github.com/postgres/postgres/tree/a7f6cb85486b1f3eacd86155af2fdc20a1dc2bec
    reference_type: commit
    reference_id: a7f6cb85486b1f3eacd86155af2fdc20a1dc2bec
  - url: https://github.com/postgres/postgres/tree/b2ce60703ab431a1d6c10f50587ea5f5e984af2e
    reference_type: commit
    reference_id: b2ce60703ab431a1d6c10f50587ea5f5e984af2e
  - url: https://github.com/postgres/postgres/tree/d975e166052e5992e1d082273f5680e85239b935
    reference_type: commit
    reference_id: d975e166052e5992e1d082273f5680e85239b935
  - url: https://github.com/postgres/postgres/tree/ecabae5af98d2b238e82cb59b4fd9b00aad1e63d
    reference_type: commit
    reference_id: ecabae5af98d2b238e82cb59b4fd9b00aad1e63d
