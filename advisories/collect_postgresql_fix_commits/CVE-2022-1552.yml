advisory_id: CVE-2022-1552
datasource_id: collect_postgresql_fix_commits/CVE-2022-1552
datasource_url: https://github.com/postgres/postgres
aliases: []
summary: |
  db034c2e2e45216439c14e2b7bb99260914d610f:Last-minute updates for release notes.

  Security: CVE-2022-1552
  b5576e1b701c8d690ed1ea8d3c17d5df49de3d7c:Last-minute updates for release notes.

  Security: CVE-2022-1552
  b4516b1aea7ac98bc21b47a66ad384f50c2bd2b7:Last-minute updates for release notes.

  Security: CVE-2022-1552
  0c8215c7b6bdf528edab88943438f0db9afad49b:Last-minute updates for release notes.

  Security: CVE-2022-1552
  0ae1d09575bbadd2e7a9ada5721a88c8ee0b6be3:Last-minute updates for release notes.

  Security: CVE-2022-1552
  f26d5702857a9c027f84850af48b0eea0f3aa15c:In REFRESH MATERIALIZED VIEW, set user ID before running user code.

  It intended to, but did not, achieve this.  Adopt the new standard of
  setting user ID just after locking the relation.  Back-patch to v10 (all
  supported versions).

  Reviewed by Simon Riggs.  Reported by Alvaro Herrera.

  Security: CVE-2022-1552
  34ff15660b4f752e3941d661c3896fd96b1571f9:In REFRESH MATERIALIZED VIEW, set user ID before running user code.

  It intended to, but did not, achieve this.  Adopt the new standard of
  setting user ID just after locking the relation.  Back-patch to v10 (all
  supported versions).

  Reviewed by Simon Riggs.  Reported by Alvaro Herrera.

  Security: CVE-2022-1552
  ef792f7856dea2576dcd9cab92b2b05fe955696b:Make relation-enumerating operations be security-restricted operations.

  When a feature enumerates relations and runs functions associated with
  all found relations, the feature's user shall not need to trust every
  user having permission to create objects.  BRIN-specific functionality
  in autovacuum neglected to account for this, as did pg_amcheck and
  CLUSTER.  An attacker having permission to create non-temp objects in at
  least one schema could execute arbitrary SQL functions under the
  identity of the bootstrap superuser.  CREATE INDEX (not a
  relation-enumerating operation) and REINDEX protected themselves too
  late.  This change extends to the non-enumerating amcheck interface.
  Back-patch to v10 (all supported versions).

  Sergey Shinderuk, reviewed (in earlier versions) by Alexander Lakhin.
  Reported by Alexander Lakhin.

  Security: CVE-2022-1552
  48ca2904c11d4293ec0bed1625259b2e4ef550cc:Make relation-enumerating operations be security-restricted operations.

  When a feature enumerates relations and runs functions associated with
  all found relations, the feature's user shall not need to trust every
  user having permission to create objects.  BRIN-specific functionality
  in autovacuum neglected to account for this, as did pg_amcheck and
  CLUSTER.  An attacker having permission to create non-temp objects in at
  least one schema could execute arbitrary SQL functions under the
  identity of the bootstrap superuser.  CREATE INDEX (not a
  relation-enumerating operation) and REINDEX protected themselves too
  late.  This change extends to the non-enumerating amcheck interface.
  Back-patch to v10 (all supported versions).

  Sergey Shinderuk, reviewed (in earlier versions) by Alexander Lakhin.
  Reported by Alexander Lakhin.

  Security: CVE-2022-1552
  880511cb0bdfd75a29ada6b80bf6e4efe6bc27b4:In REFRESH MATERIALIZED VIEW, set user ID before running user code.

  It intended to, but did not, achieve this.  Adopt the new standard of
  setting user ID just after locking the relation.  Back-patch to v10 (all
  supported versions).

  Reviewed by Simon Riggs.  Reported by Alvaro Herrera.

  Security: CVE-2022-1552
  88743d581e1bdedc13e4ca33c5a6597a5d2dbdc4:In REFRESH MATERIALIZED VIEW, set user ID before running user code.

  It intended to, but did not, achieve this.  Adopt the new standard of
  setting user ID just after locking the relation.  Back-patch to v10 (all
  supported versions).

  Reviewed by Simon Riggs.  Reported by Alvaro Herrera.

  Security: CVE-2022-1552
  677a494789062ca88e0142a17bedd5415f6ab0aa:In REFRESH MATERIALIZED VIEW, set user ID before running user code.

  It intended to, but did not, achieve this.  Adopt the new standard of
  setting user ID just after locking the relation.  Back-patch to v10 (all
  supported versions).

  Reviewed by Simon Riggs.  Reported by Alvaro Herrera.

  Security: CVE-2022-1552
  7f098f7b53edfe8340c6e031bf497308a2e65e2e:Make relation-enumerating operations be security-restricted operations.

  When a feature enumerates relations and runs functions associated with
  all found relations, the feature's user shall not need to trust every
  user having permission to create objects.  BRIN-specific functionality
  in autovacuum neglected to account for this, as did pg_amcheck and
  CLUSTER.  An attacker having permission to create non-temp objects in at
  least one schema could execute arbitrary SQL functions under the
  identity of the bootstrap superuser.  CREATE INDEX (not a
  relation-enumerating operation) and REINDEX protected themselves too
  late.  This change extends to the non-enumerating amcheck interface.
  Back-patch to v10 (all supported versions).

  Sergey Shinderuk, reviewed (in earlier versions) by Alexander Lakhin.
  Reported by Alexander Lakhin.

  Security: CVE-2022-1552
  35edcc0cee7bf7d4746e3e5b7966b1f0ec509560:Make relation-enumerating operations be security-restricted operations.

  When a feature enumerates relations and runs functions associated with
  all found relations, the feature's user shall not need to trust every
  user having permission to create objects.  BRIN-specific functionality
  in autovacuum neglected to account for this, as did pg_amcheck and
  CLUSTER.  An attacker having permission to create non-temp objects in at
  least one schema could execute arbitrary SQL functions under the
  identity of the bootstrap superuser.  CREATE INDEX (not a
  relation-enumerating operation) and REINDEX protected themselves too
  late.  This change extends to the non-enumerating amcheck interface.
  Back-patch to v10 (all supported versions).

  Sergey Shinderuk, reviewed (in earlier versions) by Alexander Lakhin.
  Reported by Alexander Lakhin.

  Security: CVE-2022-1552
  ab49ce7c3414ac19e4afb386d7843ce2d2fb8bda:Make relation-enumerating operations be security-restricted operations.

  When a feature enumerates relations and runs functions associated with
  all found relations, the feature's user shall not need to trust every
  user having permission to create objects.  BRIN-specific functionality
  in autovacuum neglected to account for this, as did pg_amcheck and
  CLUSTER.  An attacker having permission to create non-temp objects in at
  least one schema could execute arbitrary SQL functions under the
  identity of the bootstrap superuser.  CREATE INDEX (not a
  relation-enumerating operation) and REINDEX protected themselves too
  late.  This change extends to the non-enumerating amcheck interface.
  Back-patch to v10 (all supported versions).

  Sergey Shinderuk, reviewed (in earlier versions) by Alexander Lakhin.
  Reported by Alexander Lakhin.

  Security: CVE-2022-1552
  0abc1a059e27c5a71a1a186c97d9c0af407469cc:In REFRESH MATERIALIZED VIEW, set user ID before running user code.

  It intended to, but did not, achieve this.  Adopt the new standard of
  setting user ID just after locking the relation.  Back-patch to v10 (all
  supported versions).

  Reviewed by Simon Riggs.  Reported by Alvaro Herrera.

  Security: CVE-2022-1552
  a117cebd638dd02e5c2e791c25e43745f233111b:Make relation-enumerating operations be security-restricted operations.

  When a feature enumerates relations and runs functions associated with
  all found relations, the feature's user shall not need to trust every
  user having permission to create objects.  BRIN-specific functionality
  in autovacuum neglected to account for this, as did pg_amcheck and
  CLUSTER.  An attacker having permission to create non-temp objects in at
  least one schema could execute arbitrary SQL functions under the
  identity of the bootstrap superuser.  CREATE INDEX (not a
  relation-enumerating operation) and REINDEX protected themselves too
  late.  This change extends to the non-enumerating amcheck interface.
  Back-patch to v10 (all supported versions).

  Sergey Shinderuk, reviewed (in earlier versions) by Alexander Lakhin.
  Reported by Alexander Lakhin.

  Security: CVE-2022-1552
impacted_packages:
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: f26d5702857a9c027f84850af48b0eea0f3aa15c
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: a117cebd638dd02e5c2e791c25e43745f233111b
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: b4516b1aea7ac98bc21b47a66ad384f50c2bd2b7
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 0abc1a059e27c5a71a1a186c97d9c0af407469cc
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: db034c2e2e45216439c14e2b7bb99260914d610f
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 88743d581e1bdedc13e4ca33c5a6597a5d2dbdc4
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 677a494789062ca88e0142a17bedd5415f6ab0aa
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 34ff15660b4f752e3941d661c3896fd96b1571f9
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 7f098f7b53edfe8340c6e031bf497308a2e65e2e
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: b5576e1b701c8d690ed1ea8d3c17d5df49de3d7c
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 0c8215c7b6bdf528edab88943438f0db9afad49b
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: ab49ce7c3414ac19e4afb386d7843ce2d2fb8bda
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 35edcc0cee7bf7d4746e3e5b7966b1f0ec509560
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: ef792f7856dea2576dcd9cab92b2b05fe955696b
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 48ca2904c11d4293ec0bed1625259b2e4ef550cc
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 0ae1d09575bbadd2e7a9ada5721a88c8ee0b6be3
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 880511cb0bdfd75a29ada6b80bf6e4efe6bc27b4
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/postgres/postgres/tree/0abc1a059e27c5a71a1a186c97d9c0af407469cc
    reference_type: commit
    reference_id: 0abc1a059e27c5a71a1a186c97d9c0af407469cc
  - url: https://github.com/postgres/postgres/tree/0ae1d09575bbadd2e7a9ada5721a88c8ee0b6be3
    reference_type: commit
    reference_id: 0ae1d09575bbadd2e7a9ada5721a88c8ee0b6be3
  - url: https://github.com/postgres/postgres/tree/0c8215c7b6bdf528edab88943438f0db9afad49b
    reference_type: commit
    reference_id: 0c8215c7b6bdf528edab88943438f0db9afad49b
  - url: https://github.com/postgres/postgres/tree/34ff15660b4f752e3941d661c3896fd96b1571f9
    reference_type: commit
    reference_id: 34ff15660b4f752e3941d661c3896fd96b1571f9
  - url: https://github.com/postgres/postgres/tree/35edcc0cee7bf7d4746e3e5b7966b1f0ec509560
    reference_type: commit
    reference_id: 35edcc0cee7bf7d4746e3e5b7966b1f0ec509560
  - url: https://github.com/postgres/postgres/tree/48ca2904c11d4293ec0bed1625259b2e4ef550cc
    reference_type: commit
    reference_id: 48ca2904c11d4293ec0bed1625259b2e4ef550cc
  - url: https://github.com/postgres/postgres/tree/677a494789062ca88e0142a17bedd5415f6ab0aa
    reference_type: commit
    reference_id: 677a494789062ca88e0142a17bedd5415f6ab0aa
  - url: https://github.com/postgres/postgres/tree/7f098f7b53edfe8340c6e031bf497308a2e65e2e
    reference_type: commit
    reference_id: 7f098f7b53edfe8340c6e031bf497308a2e65e2e
  - url: https://github.com/postgres/postgres/tree/880511cb0bdfd75a29ada6b80bf6e4efe6bc27b4
    reference_type: commit
    reference_id: 880511cb0bdfd75a29ada6b80bf6e4efe6bc27b4
  - url: https://github.com/postgres/postgres/tree/88743d581e1bdedc13e4ca33c5a6597a5d2dbdc4
    reference_type: commit
    reference_id: 88743d581e1bdedc13e4ca33c5a6597a5d2dbdc4
  - url: https://github.com/postgres/postgres/tree/a117cebd638dd02e5c2e791c25e43745f233111b
    reference_type: commit
    reference_id: a117cebd638dd02e5c2e791c25e43745f233111b
  - url: https://github.com/postgres/postgres/tree/ab49ce7c3414ac19e4afb386d7843ce2d2fb8bda
    reference_type: commit
    reference_id: ab49ce7c3414ac19e4afb386d7843ce2d2fb8bda
  - url: https://github.com/postgres/postgres/tree/b4516b1aea7ac98bc21b47a66ad384f50c2bd2b7
    reference_type: commit
    reference_id: b4516b1aea7ac98bc21b47a66ad384f50c2bd2b7
  - url: https://github.com/postgres/postgres/tree/b5576e1b701c8d690ed1ea8d3c17d5df49de3d7c
    reference_type: commit
    reference_id: b5576e1b701c8d690ed1ea8d3c17d5df49de3d7c
  - url: https://github.com/postgres/postgres/tree/db034c2e2e45216439c14e2b7bb99260914d610f
    reference_type: commit
    reference_id: db034c2e2e45216439c14e2b7bb99260914d610f
  - url: https://github.com/postgres/postgres/tree/ef792f7856dea2576dcd9cab92b2b05fe955696b
    reference_type: commit
    reference_id: ef792f7856dea2576dcd9cab92b2b05fe955696b
  - url: https://github.com/postgres/postgres/tree/f26d5702857a9c027f84850af48b0eea0f3aa15c
    reference_type: commit
    reference_id: f26d5702857a9c027f84850af48b0eea0f3aa15c
