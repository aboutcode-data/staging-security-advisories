advisory_id: CVE-2022-41862
datasource_id: collect_postgresql_fix_commits/CVE-2022-41862
datasource_url: https://github.com/postgres/postgres
aliases: []
summary: |
  bd46d1b5413d52af224db982de79f429a0cf12de:Last-minute updates for release notes.

  Security: CVE-2022-41862
  6926350d6b90181193e776d3313c49226cbca2ea:Last-minute updates for release notes.

  Security: CVE-2022-41862
  dfb5ad7cf0d83ac3bb78f0177721f68a6ba60486:Last-minute updates for release notes.

  Security: CVE-2022-41862
  6788a55898053ba513753f9bc4ba7d3731676cdb:Last-minute updates for release notes.

  Security: CVE-2022-41862
  3f7342671341a7a137f2d8b06ab3461cdb0e1d88:Properly NULL-terminate GSS receive buffer on error packet reception

  pqsecure_open_gss() includes a code path handling error messages with
  v2-style protocol messages coming from the server.  The client-side
  buffer holding the error message does not force a NULL-termination, with
  the data of the server getting copied to the errorMessage of the
  connection.  Hence, it would be possible for a server to send an
  unterminated string and copy arbitrary bytes in the buffer receiving the
  error message in the client, opening the door to a crash or even data
  exposure.

  As at this stage of the authentication process the exchange has not been
  completed yet, this could be abused by an attacker without Kerberos
  credentials.  Clients that have a valid kerberos cache are vulnerable as
  libpq opportunistically requests for it except if gssencmode is
  disabled.

  Author: Jacob Champion
  Backpatch-through: 12
  Security: CVE-2022-41862
  45a945ee97b8b55a45d2ff5d4f4944b1e2dcacb8:Properly NULL-terminate GSS receive buffer on error packet reception

  pqsecure_open_gss() includes a code path handling error messages with
  v2-style protocol messages coming from the server.  The client-side
  buffer holding the error message does not force a NULL-termination, with
  the data of the server getting copied to the errorMessage of the
  connection.  Hence, it would be possible for a server to send an
  unterminated string and copy arbitrary bytes in the buffer receiving the
  error message in the client, opening the door to a crash or even data
  exposure.

  As at this stage of the authentication process the exchange has not been
  completed yet, this could be abused by an attacker without Kerberos
  credentials.  Clients that have a valid kerberos cache are vulnerable as
  libpq opportunistically requests for it except if gssencmode is
  disabled.

  Author: Jacob Champion
  Backpatch-through: 12
  Security: CVE-2022-41862
  626f2c1d6b85a6a0780460c7acc306bc2c326266:Properly NULL-terminate GSS receive buffer on error packet reception

  pqsecure_open_gss() includes a code path handling error messages with
  v2-style protocol messages coming from the server.  The client-side
  buffer holding the error message does not force a NULL-termination, with
  the data of the server getting copied to the errorMessage of the
  connection.  Hence, it would be possible for a server to send an
  unterminated string and copy arbitrary bytes in the buffer receiving the
  error message in the client, opening the door to a crash or even data
  exposure.

  As at this stage of the authentication process the exchange has not been
  completed yet, this could be abused by an attacker without Kerberos
  credentials.  Clients that have a valid kerberos cache are vulnerable as
  libpq opportunistically requests for it except if gssencmode is
  disabled.

  Author: Jacob Champion
  Backpatch-through: 12
  Security: CVE-2022-41862
  715c345dd9a5594758be9a7aa41e898ead96e2a6:Properly NULL-terminate GSS receive buffer on error packet reception

  pqsecure_open_gss() includes a code path handling error messages with
  v2-style protocol messages coming from the server.  The client-side
  buffer holding the error message does not force a NULL-termination, with
  the data of the server getting copied to the errorMessage of the
  connection.  Hence, it would be possible for a server to send an
  unterminated string and copy arbitrary bytes in the buffer receiving the
  error message in the client, opening the door to a crash or even data
  exposure.

  As at this stage of the authentication process the exchange has not been
  completed yet, this could be abused by an attacker without Kerberos
  credentials.  Clients that have a valid kerberos cache are vulnerable as
  libpq opportunistically requests for it except if gssencmode is
  disabled.

  Author: Jacob Champion
  Backpatch-through: 12
  Security: CVE-2022-41862
  71c37797d7bd78266146a5829ab62b3687c47295:Properly NULL-terminate GSS receive buffer on error packet reception

  pqsecure_open_gss() includes a code path handling error messages with
  v2-style protocol messages coming from the server.  The client-side
  buffer holding the error message does not force a NULL-termination, with
  the data of the server getting copied to the errorMessage of the
  connection.  Hence, it would be possible for a server to send an
  unterminated string and copy arbitrary bytes in the buffer receiving the
  error message in the client, opening the door to a crash or even data
  exposure.

  As at this stage of the authentication process the exchange has not been
  completed yet, this could be abused by an attacker without Kerberos
  credentials.  Clients that have a valid kerberos cache are vulnerable as
  libpq opportunistically requests for it except if gssencmode is
  disabled.

  Author: Jacob Champion
  Backpatch-through: 12
  Security: CVE-2022-41862
impacted_packages:
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 6926350d6b90181193e776d3313c49226cbca2ea
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 626f2c1d6b85a6a0780460c7acc306bc2c326266
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 6788a55898053ba513753f9bc4ba7d3731676cdb
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: bd46d1b5413d52af224db982de79f429a0cf12de
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 3f7342671341a7a137f2d8b06ab3461cdb0e1d88
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 71c37797d7bd78266146a5829ab62b3687c47295
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 715c345dd9a5594758be9a7aa41e898ead96e2a6
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 45a945ee97b8b55a45d2ff5d4f4944b1e2dcacb8
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: dfb5ad7cf0d83ac3bb78f0177721f68a6ba60486
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/postgres/postgres/tree/3f7342671341a7a137f2d8b06ab3461cdb0e1d88
    reference_type: commit
    reference_id: 3f7342671341a7a137f2d8b06ab3461cdb0e1d88
  - url: https://github.com/postgres/postgres/tree/45a945ee97b8b55a45d2ff5d4f4944b1e2dcacb8
    reference_type: commit
    reference_id: 45a945ee97b8b55a45d2ff5d4f4944b1e2dcacb8
  - url: https://github.com/postgres/postgres/tree/626f2c1d6b85a6a0780460c7acc306bc2c326266
    reference_type: commit
    reference_id: 626f2c1d6b85a6a0780460c7acc306bc2c326266
  - url: https://github.com/postgres/postgres/tree/6788a55898053ba513753f9bc4ba7d3731676cdb
    reference_type: commit
    reference_id: 6788a55898053ba513753f9bc4ba7d3731676cdb
  - url: https://github.com/postgres/postgres/tree/6926350d6b90181193e776d3313c49226cbca2ea
    reference_type: commit
    reference_id: 6926350d6b90181193e776d3313c49226cbca2ea
  - url: https://github.com/postgres/postgres/tree/715c345dd9a5594758be9a7aa41e898ead96e2a6
    reference_type: commit
    reference_id: 715c345dd9a5594758be9a7aa41e898ead96e2a6
  - url: https://github.com/postgres/postgres/tree/71c37797d7bd78266146a5829ab62b3687c47295
    reference_type: commit
    reference_id: 71c37797d7bd78266146a5829ab62b3687c47295
  - url: https://github.com/postgres/postgres/tree/bd46d1b5413d52af224db982de79f429a0cf12de
    reference_type: commit
    reference_id: bd46d1b5413d52af224db982de79f429a0cf12de
  - url: https://github.com/postgres/postgres/tree/dfb5ad7cf0d83ac3bb78f0177721f68a6ba60486
    reference_type: commit
    reference_id: dfb5ad7cf0d83ac3bb78f0177721f68a6ba60486
