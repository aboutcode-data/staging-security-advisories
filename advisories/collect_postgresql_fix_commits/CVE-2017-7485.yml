advisory_id: CVE-2017-7485
datasource_id: collect_postgresql_fix_commits/CVE-2017-7485
datasource_url: https://github.com/postgres/postgres
aliases: []
summary: |
  89cd44cc50d3d82dc6f001ac357bedd96b8387d8:Last-minute updates for release notes.

  Security: CVE-2017-7484, CVE-2017-7485, CVE-2017-7486
  73b1aee886a211b0438aa3fe4bcded7fd671c1e4:Last-minute updates for release notes.

  Security: CVE-2017-7484, CVE-2017-7485, CVE-2017-7486
  abba57b9af951242054bd9cc5ca84764c18649e6:Last-minute updates for release notes.

  Security: CVE-2017-7484, CVE-2017-7485, CVE-2017-7486
  7603952e751a3b27adae16192b59ab09f0d0ba72:Last-minute updates for release notes.

  Security: CVE-2017-7484, CVE-2017-7485, CVE-2017-7486
  2d5e7b4a912d55d90c01732d318b94e4ae47027b:Last-minute updates for release notes.

  Security: CVE-2017-7484, CVE-2017-7485, CVE-2017-7486
  c89d2d0204f25e556e94dabd0fd5174cf6963b1d:Last-minute updates for release notes.

  Security: CVE-2017-7484, CVE-2017-7485, CVE-2017-7486
  3eab8112754c484c192248afe64055d40a231f7b:Restore PGREQUIRESSL recognition in libpq.

  Commit 65c3bf19fd3e1f6a591618e92eb4c54d0b217564 moved handling of the,
  already then, deprecated requiressl parameter into conninfo_storeval().
  The default PGREQUIRESSL environment variable was however lost in the
  change resulting in a potentially silent accept of a non-SSL connection
  even when set.  Its documentation remained.  Restore its implementation.
  Also amend the documentation to mark PGREQUIRESSL as deprecated for
  those not following the link to requiressl.  Back-patch to 9.3, where
  commit 65c3bf1 first appeared.

  Behavior has been more complex when the user provides both deprecated
  and non-deprecated settings.  Before commit 65c3bf1, libpq operated
  according to the first of these found:

    requiressl=1
    PGREQUIRESSL=1
    sslmode=*
    PGSSLMODE=*

  (Note requiressl=0 didn't override sslmode=*; it would only suppress
  PGREQUIRESSL=1 or a previous requiressl=1.  PGREQUIRESSL=0 had no effect
  whatsoever.)  Starting with commit 65c3bf1, libpq ignored PGREQUIRESSL,
  and order of precedence changed to this:

    last of requiressl=* or sslmode=*
    PGSSLMODE=*

  Starting now, adopt the following order of precedence:

    last of requiressl=* or sslmode=*
    PGSSLMODE=*
    PGREQUIRESSL=1

  This retains the 65c3bf1 behavior for connection strings that contain
  both requiressl=* and sslmode=*.  It retains the 65c3bf1 change that
  either connection string option overrides both environment variables.
  For the first time, PGSSLMODE has precedence over PGREQUIRESSL; this
  avoids reducing security of "PGREQUIRESSL=1 PGSSLMODE=verify-full"
  configurations originating under v9.3 and later.

  Daniel Gustafsson

  Security: CVE-2017-7485
  ed36c1fe172aec866d92d6e5071150a0ec901f8b:Restore PGREQUIRESSL recognition in libpq.

  Commit 65c3bf19fd3e1f6a591618e92eb4c54d0b217564 moved handling of the,
  already then, deprecated requiressl parameter into conninfo_storeval().
  The default PGREQUIRESSL environment variable was however lost in the
  change resulting in a potentially silent accept of a non-SSL connection
  even when set.  Its documentation remained.  Restore its implementation.
  Also amend the documentation to mark PGREQUIRESSL as deprecated for
  those not following the link to requiressl.  Back-patch to 9.3, where
  commit 65c3bf1 first appeared.

  Behavior has been more complex when the user provides both deprecated
  and non-deprecated settings.  Before commit 65c3bf1, libpq operated
  according to the first of these found:

    requiressl=1
    PGREQUIRESSL=1
    sslmode=*
    PGSSLMODE=*

  (Note requiressl=0 didn't override sslmode=*; it would only suppress
  PGREQUIRESSL=1 or a previous requiressl=1.  PGREQUIRESSL=0 had no effect
  whatsoever.)  Starting with commit 65c3bf1, libpq ignored PGREQUIRESSL,
  and order of precedence changed to this:

    last of requiressl=* or sslmode=*
    PGSSLMODE=*

  Starting now, adopt the following order of precedence:

    last of requiressl=* or sslmode=*
    PGSSLMODE=*
    PGREQUIRESSL=1

  This retains the 65c3bf1 behavior for connection strings that contain
  both requiressl=* and sslmode=*.  It retains the 65c3bf1 change that
  either connection string option overrides both environment variables.
  For the first time, PGSSLMODE has precedence over PGREQUIRESSL; this
  avoids reducing security of "PGREQUIRESSL=1 PGSSLMODE=verify-full"
  configurations originating under v9.3 and later.

  Daniel Gustafsson

  Security: CVE-2017-7485
  96d7454920e28447a1127497bba624cdf0f315c1:Restore PGREQUIRESSL recognition in libpq.

  Commit 65c3bf19fd3e1f6a591618e92eb4c54d0b217564 moved handling of the,
  already then, deprecated requiressl parameter into conninfo_storeval().
  The default PGREQUIRESSL environment variable was however lost in the
  change resulting in a potentially silent accept of a non-SSL connection
  even when set.  Its documentation remained.  Restore its implementation.
  Also amend the documentation to mark PGREQUIRESSL as deprecated for
  those not following the link to requiressl.  Back-patch to 9.3, where
  commit 65c3bf1 first appeared.

  Behavior has been more complex when the user provides both deprecated
  and non-deprecated settings.  Before commit 65c3bf1, libpq operated
  according to the first of these found:

    requiressl=1
    PGREQUIRESSL=1
    sslmode=*
    PGSSLMODE=*

  (Note requiressl=0 didn't override sslmode=*; it would only suppress
  PGREQUIRESSL=1 or a previous requiressl=1.  PGREQUIRESSL=0 had no effect
  whatsoever.)  Starting with commit 65c3bf1, libpq ignored PGREQUIRESSL,
  and order of precedence changed to this:

    last of requiressl=* or sslmode=*
    PGSSLMODE=*

  Starting now, adopt the following order of precedence:

    last of requiressl=* or sslmode=*
    PGSSLMODE=*
    PGREQUIRESSL=1

  This retains the 65c3bf1 behavior for connection strings that contain
  both requiressl=* and sslmode=*.  It retains the 65c3bf1 change that
  either connection string option overrides both environment variables.
  For the first time, PGSSLMODE has precedence over PGREQUIRESSL; this
  avoids reducing security of "PGREQUIRESSL=1 PGSSLMODE=verify-full"
  configurations originating under v9.3 and later.

  Daniel Gustafsson

  Security: CVE-2017-7485
  aafbd1df969135c185947c596c46608fc9f4a67c:Restore PGREQUIRESSL recognition in libpq.

  Commit 65c3bf19fd3e1f6a591618e92eb4c54d0b217564 moved handling of the,
  already then, deprecated requiressl parameter into conninfo_storeval().
  The default PGREQUIRESSL environment variable was however lost in the
  change resulting in a potentially silent accept of a non-SSL connection
  even when set.  Its documentation remained.  Restore its implementation.
  Also amend the documentation to mark PGREQUIRESSL as deprecated for
  those not following the link to requiressl.  Back-patch to 9.3, where
  commit 65c3bf1 first appeared.

  Behavior has been more complex when the user provides both deprecated
  and non-deprecated settings.  Before commit 65c3bf1, libpq operated
  according to the first of these found:

    requiressl=1
    PGREQUIRESSL=1
    sslmode=*
    PGSSLMODE=*

  (Note requiressl=0 didn't override sslmode=*; it would only suppress
  PGREQUIRESSL=1 or a previous requiressl=1.  PGREQUIRESSL=0 had no effect
  whatsoever.)  Starting with commit 65c3bf1, libpq ignored PGREQUIRESSL,
  and order of precedence changed to this:

    last of requiressl=* or sslmode=*
    PGSSLMODE=*

  Starting now, adopt the following order of precedence:

    last of requiressl=* or sslmode=*
    PGSSLMODE=*
    PGREQUIRESSL=1

  This retains the 65c3bf1 behavior for connection strings that contain
  both requiressl=* and sslmode=*.  It retains the 65c3bf1 change that
  either connection string option overrides both environment variables.
  For the first time, PGSSLMODE has precedence over PGREQUIRESSL; this
  avoids reducing security of "PGREQUIRESSL=1 PGSSLMODE=verify-full"
  configurations originating under v9.3 and later.

  Daniel Gustafsson

  Security: CVE-2017-7485
  0170b10dff04e0f50f5522c377a4d10d4424155c:Restore PGREQUIRESSL recognition in libpq.

  Commit 65c3bf19fd3e1f6a591618e92eb4c54d0b217564 moved handling of the,
  already then, deprecated requiressl parameter into conninfo_storeval().
  The default PGREQUIRESSL environment variable was however lost in the
  change resulting in a potentially silent accept of a non-SSL connection
  even when set.  Its documentation remained.  Restore its implementation.
  Also amend the documentation to mark PGREQUIRESSL as deprecated for
  those not following the link to requiressl.  Back-patch to 9.3, where
  commit 65c3bf1 first appeared.

  Behavior has been more complex when the user provides both deprecated
  and non-deprecated settings.  Before commit 65c3bf1, libpq operated
  according to the first of these found:

    requiressl=1
    PGREQUIRESSL=1
    sslmode=*
    PGSSLMODE=*

  (Note requiressl=0 didn't override sslmode=*; it would only suppress
  PGREQUIRESSL=1 or a previous requiressl=1.  PGREQUIRESSL=0 had no effect
  whatsoever.)  Starting with commit 65c3bf1, libpq ignored PGREQUIRESSL,
  and order of precedence changed to this:

    last of requiressl=* or sslmode=*
    PGSSLMODE=*

  Starting now, adopt the following order of precedence:

    last of requiressl=* or sslmode=*
    PGSSLMODE=*
    PGREQUIRESSL=1

  This retains the 65c3bf1 behavior for connection strings that contain
  both requiressl=* and sslmode=*.  It retains the 65c3bf1 change that
  either connection string option overrides both environment variables.
  For the first time, PGSSLMODE has precedence over PGREQUIRESSL; this
  avoids reducing security of "PGREQUIRESSL=1 PGSSLMODE=verify-full"
  configurations originating under v9.3 and later.

  Daniel Gustafsson

  Security: CVE-2017-7485
impacted_packages:
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 3eab8112754c484c192248afe64055d40a231f7b
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: abba57b9af951242054bd9cc5ca84764c18649e6
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 0170b10dff04e0f50f5522c377a4d10d4424155c
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: c89d2d0204f25e556e94dabd0fd5174cf6963b1d
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: aafbd1df969135c185947c596c46608fc9f4a67c
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 89cd44cc50d3d82dc6f001ac357bedd96b8387d8
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 2d5e7b4a912d55d90c01732d318b94e4ae47027b
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 96d7454920e28447a1127497bba624cdf0f315c1
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: ed36c1fe172aec866d92d6e5071150a0ec901f8b
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 7603952e751a3b27adae16192b59ab09f0d0ba72
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 73b1aee886a211b0438aa3fe4bcded7fd671c1e4
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/postgres/postgres/tree/0170b10dff04e0f50f5522c377a4d10d4424155c
    reference_type: commit
    reference_id: 0170b10dff04e0f50f5522c377a4d10d4424155c
  - url: https://github.com/postgres/postgres/tree/2d5e7b4a912d55d90c01732d318b94e4ae47027b
    reference_type: commit
    reference_id: 2d5e7b4a912d55d90c01732d318b94e4ae47027b
  - url: https://github.com/postgres/postgres/tree/3eab8112754c484c192248afe64055d40a231f7b
    reference_type: commit
    reference_id: 3eab8112754c484c192248afe64055d40a231f7b
  - url: https://github.com/postgres/postgres/tree/73b1aee886a211b0438aa3fe4bcded7fd671c1e4
    reference_type: commit
    reference_id: 73b1aee886a211b0438aa3fe4bcded7fd671c1e4
  - url: https://github.com/postgres/postgres/tree/7603952e751a3b27adae16192b59ab09f0d0ba72
    reference_type: commit
    reference_id: 7603952e751a3b27adae16192b59ab09f0d0ba72
  - url: https://github.com/postgres/postgres/tree/89cd44cc50d3d82dc6f001ac357bedd96b8387d8
    reference_type: commit
    reference_id: 89cd44cc50d3d82dc6f001ac357bedd96b8387d8
  - url: https://github.com/postgres/postgres/tree/96d7454920e28447a1127497bba624cdf0f315c1
    reference_type: commit
    reference_id: 96d7454920e28447a1127497bba624cdf0f315c1
  - url: https://github.com/postgres/postgres/tree/aafbd1df969135c185947c596c46608fc9f4a67c
    reference_type: commit
    reference_id: aafbd1df969135c185947c596c46608fc9f4a67c
  - url: https://github.com/postgres/postgres/tree/abba57b9af951242054bd9cc5ca84764c18649e6
    reference_type: commit
    reference_id: abba57b9af951242054bd9cc5ca84764c18649e6
  - url: https://github.com/postgres/postgres/tree/c89d2d0204f25e556e94dabd0fd5174cf6963b1d
    reference_type: commit
    reference_id: c89d2d0204f25e556e94dabd0fd5174cf6963b1d
  - url: https://github.com/postgres/postgres/tree/ed36c1fe172aec866d92d6e5071150a0ec901f8b
    reference_type: commit
    reference_id: ed36c1fe172aec866d92d6e5071150a0ec901f8b
