advisory_id: CVE-2010-3433
datasource_id: collect_postgresql_fix_commits/CVE-2010-3433
datasource_url: https://github.com/postgres/postgres
aliases: []
summary: |
  b68319c25bb40dd0245cf176273c741fdba064ec:Use a separate interpreter for each calling SQL userid in plperl and pltcl.

  There are numerous methods by which a Perl or Tcl function can subvert
  the behavior of another such function executed later; for example, by
  redefining standard functions or operators called by the target function.
  If the target function is SECURITY DEFINER, or is called by such a
  function, this means that any ordinary SQL user with Perl or Tcl language
  usage rights can do essentially anything with the privileges of the target
  function's owner.

  To close this security hole, create a separate Perl or Tcl interpreter for
  each SQL userid under which plperl or pltcl functions are executed within
  a session.  However, all plperlu or pltclu functions run within a session
  still share a single interpreter, since they all execute at the trust
  level of a database superuser anyway.

  Note: this change results in a functionality loss when libperl has been
  built without the "multiplicity" option: it's no longer possible to call
  plperl functions under different userids in one session, since such a
  libperl can't support multiple interpreters in one process.  However, such
  a libperl already failed to support concurrent use of plperl and plperlu,
  so it's likely that few people use such versions with Postgres.

  Security: CVE-2010-3433
  8d7694b0d484382e67d3db0f41cc8ffefe4c9e1e:Use a separate interpreter for each calling SQL userid in plperl and pltcl.

  There are numerous methods by which a Perl or Tcl function can subvert
  the behavior of another such function executed later; for example, by
  redefining standard functions or operators called by the target function.
  If the target function is SECURITY DEFINER, or is called by such a
  function, this means that any ordinary SQL user with Perl or Tcl language
  usage rights can do essentially anything with the privileges of the target
  function's owner.

  To close this security hole, create a separate Perl or Tcl interpreter for
  each SQL userid under which plperl or pltcl functions are executed within
  a session.  However, all plperlu or pltclu functions run within a session
  still share a single interpreter, since they all execute at the trust
  level of a database superuser anyway.

  Note: this change results in a functionality loss when libperl has been
  built without the "multiplicity" option: it's no longer possible to call
  plperl functions under different userids in one session, since such a
  libperl can't support multiple interpreters in one process.  However, such
  a libperl already failed to support concurrent use of plperl and plperlu,
  so it's likely that few people use such versions with Postgres.

  Security: CVE-2010-3433
  329d7554a6406e382ef7fe7940dd1b131540a00b:Use a separate interpreter for each calling SQL userid in plperl and pltcl.

  There are numerous methods by which a Perl or Tcl function can subvert
  the behavior of another such function executed later; for example, by
  redefining standard functions or operators called by the target function.
  If the target function is SECURITY DEFINER, or is called by such a
  function, this means that any ordinary SQL user with Perl or Tcl language
  usage rights can do essentially anything with the privileges of the target
  function's owner.

  To close this security hole, create a separate Perl or Tcl interpreter for
  each SQL userid under which plperl or pltcl functions are executed within
  a session.  However, all plperlu or pltclu functions run within a session
  still share a single interpreter, since they all execute at the trust
  level of a database superuser anyway.

  Note: this change results in a functionality loss when libperl has been
  built without the "multiplicity" option: it's no longer possible to call
  plperl functions under different userids in one session, since such a
  libperl can't support multiple interpreters in one process.  However, such
  a libperl already failed to support concurrent use of plperl and plperlu,
  so it's likely that few people use such versions with Postgres.

  Security: CVE-2010-3433
  7203065dc90e3919c4a0d625e79928a813190146:Use a separate interpreter for each calling SQL userid in plperl and pltcl.

  There are numerous methods by which a Perl or Tcl function can subvert
  the behavior of another such function executed later; for example, by
  redefining standard functions or operators called by the target function.
  If the target function is SECURITY DEFINER, or is called by such a
  function, this means that any ordinary SQL user with Perl or Tcl language
  usage rights can do essentially anything with the privileges of the target
  function's owner.

  To close this security hole, create a separate Perl or Tcl interpreter for
  each SQL userid under which plperl or pltcl functions are executed within
  a session.  However, all plperlu or pltclu functions run within a session
  still share a single interpreter, since they all execute at the trust
  level of a database superuser anyway.

  Note: this change results in a functionality loss when libperl has been
  built without the "multiplicity" option: it's no longer possible to call
  plperl functions under different userids in one session, since such a
  libperl can't support multiple interpreters in one process.  However, such
  a libperl already failed to support concurrent use of plperl and plperlu,
  so it's likely that few people use such versions with Postgres.

  Security: CVE-2010-3433
  3b4c327ca8c70a4aef1e128f676c7eb16963466b:Use a separate interpreter for each calling SQL userid in plperl and pltcl.

  There are numerous methods by which a Perl or Tcl function can subvert
  the behavior of another such function executed later; for example, by
  redefining standard functions or operators called by the target function.
  If the target function is SECURITY DEFINER, or is called by such a
  function, this means that any ordinary SQL user with Perl or Tcl language
  usage rights can do essentially anything with the privileges of the target
  function's owner.

  To close this security hole, create a separate Perl or Tcl interpreter for
  each SQL userid under which plperl or pltcl functions are executed within
  a session.  However, all plperlu or pltclu functions run within a session
  still share a single interpreter, since they all execute at the trust
  level of a database superuser anyway.

  Note: this change results in a functionality loss when libperl has been
  built without the "multiplicity" option: it's no longer possible to call
  plperl functions under different userids in one session, since such a
  libperl can't support multiple interpreters in one process.  However, such
  a libperl already failed to support concurrent use of plperl and plperlu,
  so it's likely that few people use such versions with Postgres.

  Security: CVE-2010-3433
  b805be2587972c153dbc047dc2cc74edef92a36d:Use a separate interpreter for each calling SQL userid in plperl and pltcl.

  There are numerous methods by which a Perl or Tcl function can subvert
  the behavior of another such function executed later; for example, by
  redefining standard functions or operators called by the target function.
  If the target function is SECURITY DEFINER, or is called by such a
  function, this means that any ordinary SQL user with Perl or Tcl language
  usage rights can do essentially anything with the privileges of the target
  function's owner.

  To close this security hole, create a separate Perl or Tcl interpreter for
  each SQL userid under which plperl or pltcl functions are executed within
  a session.  However, all plperlu or pltclu functions run within a session
  still share a single interpreter, since they all execute at the trust
  level of a database superuser anyway.

  Note: this change results in a functionality loss when libperl has been
  built without the "multiplicity" option: it's no longer possible to call
  plperl functions under different userids in one session, since such a
  libperl can't support multiple interpreters in one process.  However, such
  a libperl already failed to support concurrent use of plperl and plperlu,
  so it's likely that few people use such versions with Postgres.

  Security: CVE-2010-3433
  0d1f3d7bb2303268a00223f22134bc874bdac1d9:Use a separate interpreter for each calling SQL userid in plperl and pltcl.

  There are numerous methods by which a Perl or Tcl function can subvert
  the behavior of another such function executed later; for example, by
  redefining standard functions or operators called by the target function.
  If the target function is SECURITY DEFINER, or is called by such a
  function, this means that any ordinary SQL user with Perl or Tcl language
  usage rights can do essentially anything with the privileges of the target
  function's owner.

  To close this security hole, create a separate Perl or Tcl interpreter for
  each SQL userid under which plperl or pltcl functions are executed within
  a session.  However, all plperlu or pltclu functions run within a session
  still share a single interpreter, since they all execute at the trust
  level of a database superuser anyway.

  Note: this change results in a functionality loss when libperl has been
  built without the "multiplicity" option: it's no longer possible to call
  plperl functions under different userids in one session, since such a
  libperl can't support multiple interpreters in one process.  However, such
  a libperl already failed to support concurrent use of plperl and plperlu,
  so it's likely that few people use such versions with Postgres.

  Security: CVE-2010-3433
  50595b5fce2e15b5ef26b057799b4a4cdd1c10e8:Use a separate interpreter for each calling SQL userid in plperl and pltcl.

  There are numerous methods by which a Perl or Tcl function can subvert
  the behavior of another such function executed later; for example, by
  redefining standard functions or operators called by the target function.
  If the target function is SECURITY DEFINER, or is called by such a
  function, this means that any ordinary SQL user with Perl or Tcl language
  usage rights can do essentially anything with the privileges of the target
  function's owner.

  To close this security hole, create a separate Perl or Tcl interpreter for
  each SQL userid under which plperl or pltcl functions are executed within
  a session.  However, all plperlu or pltclu functions run within a session
  still share a single interpreter, since they all execute at the trust
  level of a database superuser anyway.

  Note: this change results in a functionality loss when libperl has been
  built without the "multiplicity" option: it's no longer possible to call
  plperl functions under different userids in one session, since such a
  libperl can't support multiple interpreters in one process.  However, such
  a libperl already failed to support concurrent use of plperl and plperlu,
  so it's likely that few people use such versions with Postgres.

  Security: CVE-2010-3433
impacted_packages:
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 0d1f3d7bb2303268a00223f22134bc874bdac1d9
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: b68319c25bb40dd0245cf176273c741fdba064ec
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 329d7554a6406e382ef7fe7940dd1b131540a00b
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 8d7694b0d484382e67d3db0f41cc8ffefe4c9e1e
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 7203065dc90e3919c4a0d625e79928a813190146
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: b805be2587972c153dbc047dc2cc74edef92a36d
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 50595b5fce2e15b5ef26b057799b4a4cdd1c10e8
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 3b4c327ca8c70a4aef1e128f676c7eb16963466b
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/postgres/postgres/tree/0d1f3d7bb2303268a00223f22134bc874bdac1d9
    reference_type: commit
    reference_id: 0d1f3d7bb2303268a00223f22134bc874bdac1d9
  - url: https://github.com/postgres/postgres/tree/329d7554a6406e382ef7fe7940dd1b131540a00b
    reference_type: commit
    reference_id: 329d7554a6406e382ef7fe7940dd1b131540a00b
  - url: https://github.com/postgres/postgres/tree/3b4c327ca8c70a4aef1e128f676c7eb16963466b
    reference_type: commit
    reference_id: 3b4c327ca8c70a4aef1e128f676c7eb16963466b
  - url: https://github.com/postgres/postgres/tree/50595b5fce2e15b5ef26b057799b4a4cdd1c10e8
    reference_type: commit
    reference_id: 50595b5fce2e15b5ef26b057799b4a4cdd1c10e8
  - url: https://github.com/postgres/postgres/tree/7203065dc90e3919c4a0d625e79928a813190146
    reference_type: commit
    reference_id: 7203065dc90e3919c4a0d625e79928a813190146
  - url: https://github.com/postgres/postgres/tree/8d7694b0d484382e67d3db0f41cc8ffefe4c9e1e
    reference_type: commit
    reference_id: 8d7694b0d484382e67d3db0f41cc8ffefe4c9e1e
  - url: https://github.com/postgres/postgres/tree/b68319c25bb40dd0245cf176273c741fdba064ec
    reference_type: commit
    reference_id: b68319c25bb40dd0245cf176273c741fdba064ec
  - url: https://github.com/postgres/postgres/tree/b805be2587972c153dbc047dc2cc74edef92a36d
    reference_type: commit
    reference_id: b805be2587972c153dbc047dc2cc74edef92a36d
