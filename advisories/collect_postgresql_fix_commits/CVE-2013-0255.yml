advisory_id: CVE-2013-0255
datasource_id: collect_postgresql_fix_commits/CVE-2013-0255
datasource_url: https://github.com/postgres/postgres
aliases: []
summary: |
  71627f3d1964ef9831ea7997d2f4ac5617c718cc:Fix CVE-2013-0255 properly.

  Revert commit ab0f7b6089fd215f6ce6081e2e222c38d643a526 (in HEAD only)
  in favor of the proper solution, which is to declare enum_recv() correctly
  in the system catalogs.  It should be declared to take type "internal"
  not "cstring".

  Also improve the type_sanity regression test, which should have caught
  this typo, so that it actually would.  Most of the relevant checks on
  the signature of type I/O functions should not have been restricted to
  basetypes/pseudotypes, as they should apply to any type's I/O functions.
  aa27464b34051d5e4f9888f6217283e0e41e01e9:Prevent execution of enum_recv() from SQL.

  This function was misdeclared to take cstring when it should take internal.
  This at least allows crashing the server, and in principle an attacker
  might be able to use the function to examine the contents of server memory.

  The correct fix is to adjust the system catalog contents (and fix the
  regression tests that should have caught this but failed to).  However,
  asking users to correct the catalog contents in existing installations
  is a pain, so as a band-aid fix for the back branches, install a check
  in enum_recv() to make it throw error if called with a cstring argument.
  We will later revert this in HEAD in favor of correcting the catalogs.

  Our thanks to Sumit Soni (via Secunia SVCRP) for reporting this issue.

  Security: CVE-2013-0255
  308ba8702caad0a9ba22875c43c1dfa4577ce857:Prevent execution of enum_recv() from SQL.

  This function was misdeclared to take cstring when it should take internal.
  This at least allows crashing the server, and in principle an attacker
  might be able to use the function to examine the contents of server memory.

  The correct fix is to adjust the system catalog contents (and fix the
  regression tests that should have caught this but failed to).  However,
  asking users to correct the catalog contents in existing installations
  is a pain, so as a band-aid fix for the back branches, install a check
  in enum_recv() to make it throw error if called with a cstring argument.
  We will later revert this in HEAD in favor of correcting the catalogs.

  Our thanks to Sumit Soni (via Secunia SVCRP) for reporting this issue.

  Security: CVE-2013-0255
  16d10970cb61843b937c84bf1a2d102ed54834c1:Prevent execution of enum_recv() from SQL.

  This function was misdeclared to take cstring when it should take internal.
  This at least allows crashing the server, and in principle an attacker
  might be able to use the function to examine the contents of server memory.

  The correct fix is to adjust the system catalog contents (and fix the
  regression tests that should have caught this but failed to).  However,
  asking users to correct the catalog contents in existing installations
  is a pain, so as a band-aid fix for the back branches, install a check
  in enum_recv() to make it throw error if called with a cstring argument.
  We will later revert this in HEAD in favor of correcting the catalogs.

  Our thanks to Sumit Soni (via Secunia SVCRP) for reporting this issue.

  Security: CVE-2013-0255
  1881634820603e8212983ebd4825d4f4b4988789:Prevent execution of enum_recv() from SQL.

  This function was misdeclared to take cstring when it should take internal.
  This at least allows crashing the server, and in principle an attacker
  might be able to use the function to examine the contents of server memory.

  The correct fix is to adjust the system catalog contents (and fix the
  regression tests that should have caught this but failed to).  However,
  asking users to correct the catalog contents in existing installations
  is a pain, so as a band-aid fix for the back branches, install a check
  in enum_recv() to make it throw error if called with a cstring argument.
  We will later revert this in HEAD in favor of correcting the catalogs.

  Our thanks to Sumit Soni (via Secunia SVCRP) for reporting this issue.

  Security: CVE-2013-0255
  1180844f176bdff4b63b4a33824f6cd786deed59:Prevent execution of enum_recv() from SQL.

  This function was misdeclared to take cstring when it should take internal.
  This at least allows crashing the server, and in principle an attacker
  might be able to use the function to examine the contents of server memory.

  The correct fix is to adjust the system catalog contents (and fix the
  regression tests that should have caught this but failed to).  However,
  asking users to correct the catalog contents in existing installations
  is a pain, so as a band-aid fix for the back branches, install a check
  in enum_recv() to make it throw error if called with a cstring argument.
  We will later revert this in HEAD in favor of correcting the catalogs.

  Our thanks to Sumit Soni (via Secunia SVCRP) for reporting this issue.

  Security: CVE-2013-0255
  ab0f7b6089fd215f6ce6081e2e222c38d643a526:Prevent execution of enum_recv() from SQL.

  This function was misdeclared to take cstring when it should take internal.
  This at least allows crashing the server, and in principle an attacker
  might be able to use the function to examine the contents of server memory.

  The correct fix is to adjust the system catalog contents (and fix the
  regression tests that should have caught this but failed to).  However,
  asking users to correct the catalog contents in existing installations
  is a pain, so as a band-aid fix for the back branches, install a check
  in enum_recv() to make it throw error if called with a cstring argument.
  We will later revert this in HEAD in favor of correcting the catalogs.

  Our thanks to Sumit Soni (via Secunia SVCRP) for reporting this issue.

  Security: CVE-2013-0255
impacted_packages:
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: aa27464b34051d5e4f9888f6217283e0e41e01e9
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 308ba8702caad0a9ba22875c43c1dfa4577ce857
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 16d10970cb61843b937c84bf1a2d102ed54834c1
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 1180844f176bdff4b63b4a33824f6cd786deed59
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 71627f3d1964ef9831ea7997d2f4ac5617c718cc
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: ab0f7b6089fd215f6ce6081e2e222c38d643a526
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 1881634820603e8212983ebd4825d4f4b4988789
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/postgres/postgres/tree/1180844f176bdff4b63b4a33824f6cd786deed59
    reference_type: commit
    reference_id: 1180844f176bdff4b63b4a33824f6cd786deed59
  - url: https://github.com/postgres/postgres/tree/16d10970cb61843b937c84bf1a2d102ed54834c1
    reference_type: commit
    reference_id: 16d10970cb61843b937c84bf1a2d102ed54834c1
  - url: https://github.com/postgres/postgres/tree/1881634820603e8212983ebd4825d4f4b4988789
    reference_type: commit
    reference_id: 1881634820603e8212983ebd4825d4f4b4988789
  - url: https://github.com/postgres/postgres/tree/308ba8702caad0a9ba22875c43c1dfa4577ce857
    reference_type: commit
    reference_id: 308ba8702caad0a9ba22875c43c1dfa4577ce857
  - url: https://github.com/postgres/postgres/tree/71627f3d1964ef9831ea7997d2f4ac5617c718cc
    reference_type: commit
    reference_id: 71627f3d1964ef9831ea7997d2f4ac5617c718cc
  - url: https://github.com/postgres/postgres/tree/aa27464b34051d5e4f9888f6217283e0e41e01e9
    reference_type: commit
    reference_id: aa27464b34051d5e4f9888f6217283e0e41e01e9
  - url: https://github.com/postgres/postgres/tree/ab0f7b6089fd215f6ce6081e2e222c38d643a526
    reference_type: commit
    reference_id: ab0f7b6089fd215f6ce6081e2e222c38d643a526
