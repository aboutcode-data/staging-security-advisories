advisory_id: CVE-2009-4034
datasource_id: collect_postgresql_fix_commits/CVE-2009-4034
datasource_url: https://github.com/postgres/postgres
aliases: []
summary: |
  1ac3651be28f556253dbcdca8aaf889df36fe2ba:Reject certificates with embedded NULLs in the commonName field. This stops
  attacks where an attacker would put <attack>\0<propername> in the field and
  trick the validation code that the certificate was for <attack>.

  This is a very low risk attack since it reuqires the attacker to trick the
  CA into issuing a certificate with an incorrect field, and the common
  PostgreSQL deployments are with private CAs, and not external ones. Also,
  default mode in 8.4 does not do any name validation, and is thus also not
  vulnerable - but the higher security modes are.

  Backpatch all the way. Even though versions 8.3.x and before didn't have
  certificate name validation support, they still exposed this field for
  the user to perform the validation in the application code, and there
  is no way to detect this problem through that API.

  Security: CVE-2009-4034
  d724237551b2b43c9c6f217de44bf210b0f50fdd:Reject certificates with embedded NULLs in the commonName field. This stops
  attacks where an attacker would put <attack>\0<propername> in the field and
  trick the validation code that the certificate was for <attack>.

  This is a very low risk attack since it reuqires the attacker to trick the
  CA into issuing a certificate with an incorrect field, and the common
  PostgreSQL deployments are with private CAs, and not external ones. Also,
  default mode in 8.4 does not do any name validation, and is thus also not
  vulnerable - but the higher security modes are.

  Backpatch all the way. Even though versions 8.3.x and before didn't have
  certificate name validation support, they still exposed this field for
  the user to perform the validation in the application code, and there
  is no way to detect this problem through that API.

  Security: CVE-2009-4034
  0a699bf3aa11a714033043b0f62643e401f7de56:Reject certificates with embedded NULLs in the commonName field. This stops
  attacks where an attacker would put <attack>\0<propername> in the field and
  trick the validation code that the certificate was for <attack>.

  This is a very low risk attack since it reuqires the attacker to trick the
  CA into issuing a certificate with an incorrect field, and the common
  PostgreSQL deployments are with private CAs, and not external ones. Also,
  default mode in 8.4 does not do any name validation, and is thus also not
  vulnerable - but the higher security modes are.

  Backpatch all the way. Even though versions 8.3.x and before didn't have
  certificate name validation support, they still exposed this field for
  the user to perform the validation in the application code, and there
  is no way to detect this problem through that API.

  Security: CVE-2009-4034
  d585483ab9bf933f0dd9c24eb8c89a008f46865f:Reject certificates with embedded NULLs in the commonName field. This stops
  attacks where an attacker would put <attack>\0<propername> in the field and
  trick the validation code that the certificate was for <attack>.

  This is a very low risk attack since it reuqires the attacker to trick the
  CA into issuing a certificate with an incorrect field, and the common
  PostgreSQL deployments are with private CAs, and not external ones. Also,
  default mode in 8.4 does not do any name validation, and is thus also not
  vulnerable - but the higher security modes are.

  Backpatch all the way. Even though versions 8.3.x and before didn't have
  certificate name validation support, they still exposed this field for
  the user to perform the validation in the application code, and there
  is no way to detect this problem through that API.

  Security: CVE-2009-4034
  e27495f3c9ac38b28a004177174039f0621980bf:Reject certificates with embedded NULLs in the commonName field. This stops
  attacks where an attacker would put <attack>\0<propername> in the field and
  trick the validation code that the certificate was for <attack>.

  This is a very low risk attack since it reuqires the attacker to trick the
  CA into issuing a certificate with an incorrect field, and the common
  PostgreSQL deployments are with private CAs, and not external ones. Also,
  default mode in 8.4 does not do any name validation, and is thus also not
  vulnerable - but the higher security modes are.

  Backpatch all the way. Even though versions 8.3.x and before didn't have
  certificate name validation support, they still exposed this field for
  the user to perform the validation in the application code, and there
  is no way to detect this problem through that API.

  Security: CVE-2009-4034
  5293cc8eb915f5f45ec206d3e770092b50cf445b:Reject certificates with embedded NULLs in the commonName field. This stops
  attacks where an attacker would put <attack>\0<propername> in the field and
  trick the validation code that the certificate was for <attack>.

  This is a very low risk attack since it reuqires the attacker to trick the
  CA into issuing a certificate with an incorrect field, and the common
  PostgreSQL deployments are with private CAs, and not external ones. Also,
  default mode in 8.4 does not do any name validation, and is thus also not
  vulnerable - but the higher security modes are.

  Backpatch all the way. Even though versions 8.3.x and before didn't have
  certificate name validation support, they still exposed this field for
  the user to perform the validation in the application code, and there
  is no way to detect this problem through that API.

  Security: CVE-2009-4034
  abf23ee86d871850347cfec80636537e9eb20ea6:Reject certificates with embedded NULLs in the commonName field. This stops
  attacks where an attacker would put <attack>\0<propername> in the field and
  trick the validation code that the certificate was for <attack>.

  This is a very low risk attack since it reuqires the attacker to trick the
  CA into issuing a certificate with an incorrect field, and the common
  PostgreSQL deployments are with private CAs, and not external ones. Also,
  default mode in 8.4 does not do any name validation, and is thus also not
  vulnerable - but the higher security modes are.

  Backpatch all the way. Even though versions 8.3.x and before didn't have
  certificate name validation support, they still exposed this field for
  the user to perform the validation in the application code, and there
  is no way to detect this problem through that API.

  Security: CVE-2009-4034
impacted_packages:
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 5293cc8eb915f5f45ec206d3e770092b50cf445b
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 1ac3651be28f556253dbcdca8aaf889df36fe2ba
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: d724237551b2b43c9c6f217de44bf210b0f50fdd
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 0a699bf3aa11a714033043b0f62643e401f7de56
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: abf23ee86d871850347cfec80636537e9eb20ea6
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: d585483ab9bf933f0dd9c24eb8c89a008f46865f
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: e27495f3c9ac38b28a004177174039f0621980bf
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/postgres/postgres/tree/0a699bf3aa11a714033043b0f62643e401f7de56
    reference_type: commit
    reference_id: 0a699bf3aa11a714033043b0f62643e401f7de56
  - url: https://github.com/postgres/postgres/tree/1ac3651be28f556253dbcdca8aaf889df36fe2ba
    reference_type: commit
    reference_id: 1ac3651be28f556253dbcdca8aaf889df36fe2ba
  - url: https://github.com/postgres/postgres/tree/5293cc8eb915f5f45ec206d3e770092b50cf445b
    reference_type: commit
    reference_id: 5293cc8eb915f5f45ec206d3e770092b50cf445b
  - url: https://github.com/postgres/postgres/tree/abf23ee86d871850347cfec80636537e9eb20ea6
    reference_type: commit
    reference_id: abf23ee86d871850347cfec80636537e9eb20ea6
  - url: https://github.com/postgres/postgres/tree/d585483ab9bf933f0dd9c24eb8c89a008f46865f
    reference_type: commit
    reference_id: d585483ab9bf933f0dd9c24eb8c89a008f46865f
  - url: https://github.com/postgres/postgres/tree/d724237551b2b43c9c6f217de44bf210b0f50fdd
    reference_type: commit
    reference_id: d724237551b2b43c9c6f217de44bf210b0f50fdd
  - url: https://github.com/postgres/postgres/tree/e27495f3c9ac38b28a004177174039f0621980bf
    reference_type: commit
    reference_id: e27495f3c9ac38b28a004177174039f0621980bf
