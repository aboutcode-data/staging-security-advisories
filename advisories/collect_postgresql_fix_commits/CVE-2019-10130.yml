advisory_id: CVE-2019-10130
datasource_id: collect_postgresql_fix_commits/CVE-2019-10130
datasource_url: https://github.com/postgres/postgres
aliases: []
summary: |
  585e8ffd195d868f23318caaed6fd586f8d56a0e:Last-minute updates for release notes.

  Security: CVE-2019-10129, CVE-2019-10130
  02814c381bbae9d23b19042fe356c000ae31d975:Last-minute updates for release notes.

  Security: CVE-2019-10129, CVE-2019-10130
  ffe69b4afdae8284ad3f0d4c57640f077799cfa9:Last-minute updates for release notes.

  Security: CVE-2019-10129, CVE-2019-10130
  1760514e73e942dcb73231b6d65f6c2ef210c7da:Last-minute updates for release notes.

  Security: CVE-2019-10129, CVE-2019-10130
  a70f2e4cdfb5a8a05ab178037ba39cf3ac190246:Last-minute updates for release notes.

  Security: CVE-2019-10129, CVE-2019-10130
  93c36145ad10f3b4795d8e411720ae55180ad274:Fix security checks for selectivity estimation functions with RLS.

  In commit e2d4ef8de8, security checks were added to prevent
  user-supplied operators from running over data from pg_statistic
  unless the user has table or column privileges on the table, or the
  operator is leakproof. For a table with RLS, however, checking for
  table or column privileges is insufficient, since that does not
  guarantee that the user has permission to view all of the column's
  data.

  Fix this by also checking for securityQuals on the RTE, and insisting
  that the operator be leakproof if there are any. Thus the
  leakproofness check will only be skipped if there are no securityQuals
  and the user has table or column privileges on the table -- i.e., only
  if we know that the user has access to all the data in the column.

  Back-patch to 9.5 where RLS was added.

  Dean Rasheed, reviewed by Jonathan Katz and Stephen Frost.

  Security: CVE-2019-10130
  085d64d9d236315dd646f42e195f822aeb15c54e:Fix security checks for selectivity estimation functions with RLS.

  In commit e2d4ef8de8, security checks were added to prevent
  user-supplied operators from running over data from pg_statistic
  unless the user has table or column privileges on the table, or the
  operator is leakproof. For a table with RLS, however, checking for
  table or column privileges is insufficient, since that does not
  guarantee that the user has permission to view all of the column's
  data.

  Fix this by also checking for securityQuals on the RTE, and insisting
  that the operator be leakproof if there are any. Thus the
  leakproofness check will only be skipped if there are no securityQuals
  and the user has table or column privileges on the table -- i.e., only
  if we know that the user has access to all the data in the column.

  Back-patch to 9.5 where RLS was added.

  Dean Rasheed, reviewed by Jonathan Katz and Stephen Frost.

  Security: CVE-2019-10130
  9408028305ac86d9913eaea49442cd7fdfa8aaca:Fix security checks for selectivity estimation functions with RLS.

  In commit e2d4ef8de8, security checks were added to prevent
  user-supplied operators from running over data from pg_statistic
  unless the user has table or column privileges on the table, or the
  operator is leakproof. For a table with RLS, however, checking for
  table or column privileges is insufficient, since that does not
  guarantee that the user has permission to view all of the column's
  data.

  Fix this by also checking for securityQuals on the RTE, and insisting
  that the operator be leakproof if there are any. Thus the
  leakproofness check will only be skipped if there are no securityQuals
  and the user has table or column privileges on the table -- i.e., only
  if we know that the user has access to all the data in the column.

  Back-patch to 9.5 where RLS was added.

  Dean Rasheed, reviewed by Jonathan Katz and Stephen Frost.

  Security: CVE-2019-10130
  0027ee3c52d824764f7f8391edb2695c3d2b424f:Fix security checks for selectivity estimation functions with RLS.

  In commit e2d4ef8de8, security checks were added to prevent
  user-supplied operators from running over data from pg_statistic
  unless the user has table or column privileges on the table, or the
  operator is leakproof. For a table with RLS, however, checking for
  table or column privileges is insufficient, since that does not
  guarantee that the user has permission to view all of the column's
  data.

  Fix this by also checking for securityQuals on the RTE, and insisting
  that the operator be leakproof if there are any. Thus the
  leakproofness check will only be skipped if there are no securityQuals
  and the user has table or column privileges on the table -- i.e., only
  if we know that the user has access to all the data in the column.

  Back-patch to 9.5 where RLS was added.

  Dean Rasheed, reviewed by Jonathan Katz and Stephen Frost.

  Security: CVE-2019-10130
  1aebfbea83c4a3e1a0aba4b0910135dc5a45666c:Fix security checks for selectivity estimation functions with RLS.

  In commit e2d4ef8de8, security checks were added to prevent
  user-supplied operators from running over data from pg_statistic
  unless the user has table or column privileges on the table, or the
  operator is leakproof. For a table with RLS, however, checking for
  table or column privileges is insufficient, since that does not
  guarantee that the user has permission to view all of the column's
  data.

  Fix this by also checking for securityQuals on the RTE, and insisting
  that the operator be leakproof if there are any. Thus the
  leakproofness check will only be skipped if there are no securityQuals
  and the user has table or column privileges on the table -- i.e., only
  if we know that the user has access to all the data in the column.

  Back-patch to 9.5 where RLS was added.

  Dean Rasheed, reviewed by Jonathan Katz and Stephen Frost.

  Security: CVE-2019-10130
impacted_packages:
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 02814c381bbae9d23b19042fe356c000ae31d975
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 9408028305ac86d9913eaea49442cd7fdfa8aaca
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 93c36145ad10f3b4795d8e411720ae55180ad274
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 1aebfbea83c4a3e1a0aba4b0910135dc5a45666c
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: ffe69b4afdae8284ad3f0d4c57640f077799cfa9
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 585e8ffd195d868f23318caaed6fd586f8d56a0e
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 1760514e73e942dcb73231b6d65f6c2ef210c7da
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 0027ee3c52d824764f7f8391edb2695c3d2b424f
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: a70f2e4cdfb5a8a05ab178037ba39cf3ac190246
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 085d64d9d236315dd646f42e195f822aeb15c54e
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/postgres/postgres/tree/0027ee3c52d824764f7f8391edb2695c3d2b424f
    reference_type: commit
    reference_id: 0027ee3c52d824764f7f8391edb2695c3d2b424f
  - url: https://github.com/postgres/postgres/tree/02814c381bbae9d23b19042fe356c000ae31d975
    reference_type: commit
    reference_id: 02814c381bbae9d23b19042fe356c000ae31d975
  - url: https://github.com/postgres/postgres/tree/085d64d9d236315dd646f42e195f822aeb15c54e
    reference_type: commit
    reference_id: 085d64d9d236315dd646f42e195f822aeb15c54e
  - url: https://github.com/postgres/postgres/tree/1760514e73e942dcb73231b6d65f6c2ef210c7da
    reference_type: commit
    reference_id: 1760514e73e942dcb73231b6d65f6c2ef210c7da
  - url: https://github.com/postgres/postgres/tree/1aebfbea83c4a3e1a0aba4b0910135dc5a45666c
    reference_type: commit
    reference_id: 1aebfbea83c4a3e1a0aba4b0910135dc5a45666c
  - url: https://github.com/postgres/postgres/tree/585e8ffd195d868f23318caaed6fd586f8d56a0e
    reference_type: commit
    reference_id: 585e8ffd195d868f23318caaed6fd586f8d56a0e
  - url: https://github.com/postgres/postgres/tree/93c36145ad10f3b4795d8e411720ae55180ad274
    reference_type: commit
    reference_id: 93c36145ad10f3b4795d8e411720ae55180ad274
  - url: https://github.com/postgres/postgres/tree/9408028305ac86d9913eaea49442cd7fdfa8aaca
    reference_type: commit
    reference_id: 9408028305ac86d9913eaea49442cd7fdfa8aaca
  - url: https://github.com/postgres/postgres/tree/a70f2e4cdfb5a8a05ab178037ba39cf3ac190246
    reference_type: commit
    reference_id: a70f2e4cdfb5a8a05ab178037ba39cf3ac190246
  - url: https://github.com/postgres/postgres/tree/ffe69b4afdae8284ad3f0d4c57640f077799cfa9
    reference_type: commit
    reference_id: ffe69b4afdae8284ad3f0d4c57640f077799cfa9
