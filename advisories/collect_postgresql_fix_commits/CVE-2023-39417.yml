advisory_id: CVE-2023-39417
datasource_id: collect_postgresql_fix_commits/CVE-2023-39417
datasource_url: https://github.com/postgres/postgres
aliases: []
summary: |
  023fa8f326dad5e0f841fcc4247b449881215cb7:Last-minute updates for release notes.

  Security: CVE-2023-39417, CVE-2023-39418
  c79434d7fcabdf2a5b27b235c0fb85912e686087:Last-minute updates for release notes.

  Security: CVE-2023-39417, CVE-2023-39418
  5d81700859adc9462b9663789f4491611c3d11b8:Last-minute updates for release notes.

  Security: CVE-2023-39417, CVE-2023-39418
  93eb661713338b2b51f36ec397e42397b5e441e2:Last-minute updates for release notes.

  Security: CVE-2023-39417, CVE-2023-39418
  948757fe493c1031d43bb082b6466db9a08f34a3:Last-minute updates for release notes.

  Security: CVE-2023-39417, CVE-2023-39418
  919ebb023e74546c6293352556365091c5402366:Reject substituting extension schemas or owners matching ["$'\].

  Substituting such values in extension scripts facilitated SQL injection
  when @extowner@, @extschema@, or @extschema:...@ appeared inside a
  quoting construct (dollar quoting, '', or "").  No bundled extension was
  vulnerable.  Vulnerable uses do appear in a documentation example and in
  non-bundled extensions.  Hence, the attack prerequisite was an
  administrator having installed files of a vulnerable, trusted,
  non-bundled extension.  Subject to that prerequisite, this enabled an
  attacker having database-level CREATE privilege to execute arbitrary
  code as the bootstrap superuser.  By blocking this attack in the core
  server, there's no need to modify individual extensions.  Back-patch to
  v11 (all supported versions).

  Reported by Micah Gate, Valerie Woolard, Tim Carey-Smith, and Christoph
  Berg.

  Security: CVE-2023-39417
  eb044d8f0aee1ba4950b0867f6ca9328374318db:Reject substituting extension schemas or owners matching ["$'\].

  Substituting such values in extension scripts facilitated SQL injection
  when @extowner@, @extschema@, or @extschema:...@ appeared inside a
  quoting construct (dollar quoting, '', or "").  No bundled extension was
  vulnerable.  Vulnerable uses do appear in a documentation example and in
  non-bundled extensions.  Hence, the attack prerequisite was an
  administrator having installed files of a vulnerable, trusted,
  non-bundled extension.  Subject to that prerequisite, this enabled an
  attacker having database-level CREATE privilege to execute arbitrary
  code as the bootstrap superuser.  By blocking this attack in the core
  server, there's no need to modify individual extensions.  Back-patch to
  v11 (all supported versions).

  Reported by Micah Gate, Valerie Woolard, Tim Carey-Smith, and Christoph
  Berg.

  Security: CVE-2023-39417
  b1b585e0fc3dd195bc2e338c80760bede08de5f1:Reject substituting extension schemas or owners matching ["$'\].

  Substituting such values in extension scripts facilitated SQL injection
  when @extowner@, @extschema@, or @extschema:...@ appeared inside a
  quoting construct (dollar quoting, '', or "").  No bundled extension was
  vulnerable.  Vulnerable uses do appear in a documentation example and in
  non-bundled extensions.  Hence, the attack prerequisite was an
  administrator having installed files of a vulnerable, trusted,
  non-bundled extension.  Subject to that prerequisite, this enabled an
  attacker having database-level CREATE privilege to execute arbitrary
  code as the bootstrap superuser.  By blocking this attack in the core
  server, there's no need to modify individual extensions.  Back-patch to
  v11 (all supported versions).

  Reported by Micah Gate, Valerie Woolard, Tim Carey-Smith, and Christoph
  Berg.

  Security: CVE-2023-39417
  d4648a74be07bfb23b449c722303c320297c0327:Reject substituting extension schemas or owners matching ["$'\].

  Substituting such values in extension scripts facilitated SQL injection
  when @extowner@, @extschema@, or @extschema:...@ appeared inside a
  quoting construct (dollar quoting, '', or "").  No bundled extension was
  vulnerable.  Vulnerable uses do appear in a documentation example and in
  non-bundled extensions.  Hence, the attack prerequisite was an
  administrator having installed files of a vulnerable, trusted,
  non-bundled extension.  Subject to that prerequisite, this enabled an
  attacker having database-level CREATE privilege to execute arbitrary
  code as the bootstrap superuser.  By blocking this attack in the core
  server, there's no need to modify individual extensions.  Back-patch to
  v11 (all supported versions).

  Reported by Micah Gate, Valerie Woolard, Tim Carey-Smith, and Christoph
  Berg.

  Security: CVE-2023-39417
  de494ec14f6bd7f2676623a5934723a6c8ba51c2:Reject substituting extension schemas or owners matching ["$'\].

  Substituting such values in extension scripts facilitated SQL injection
  when @extowner@, @extschema@, or @extschema:...@ appeared inside a
  quoting construct (dollar quoting, '', or "").  No bundled extension was
  vulnerable.  Vulnerable uses do appear in a documentation example and in
  non-bundled extensions.  Hence, the attack prerequisite was an
  administrator having installed files of a vulnerable, trusted,
  non-bundled extension.  Subject to that prerequisite, this enabled an
  attacker having database-level CREATE privilege to execute arbitrary
  code as the bootstrap superuser.  By blocking this attack in the core
  server, there's no need to modify individual extensions.  Back-patch to
  v11 (all supported versions).

  Reported by Micah Gate, Valerie Woolard, Tim Carey-Smith, and Christoph
  Berg.

  Security: CVE-2023-39417
  f53511010b72d7d314e22be7c63ef94792fee345:Reject substituting extension schemas or owners matching ["$'\].

  Substituting such values in extension scripts facilitated SQL injection
  when @extowner@, @extschema@, or @extschema:...@ appeared inside a
  quoting construct (dollar quoting, '', or "").  No bundled extension was
  vulnerable.  Vulnerable uses do appear in a documentation example and in
  non-bundled extensions.  Hence, the attack prerequisite was an
  administrator having installed files of a vulnerable, trusted,
  non-bundled extension.  Subject to that prerequisite, this enabled an
  attacker having database-level CREATE privilege to execute arbitrary
  code as the bootstrap superuser.  By blocking this attack in the core
  server, there's no need to modify individual extensions.  Back-patch to
  v11 (all supported versions).

  Reported by Micah Gate, Valerie Woolard, Tim Carey-Smith, and Christoph
  Berg.

  Security: CVE-2023-39417
  cd5f2a357014d5ed8205191f8e1fb180f1439599:Reject substituting extension schemas or owners matching ["$'\].

  Substituting such values in extension scripts facilitated SQL injection
  when @extowner@, @extschema@, or @extschema:...@ appeared inside a
  quoting construct (dollar quoting, '', or "").  No bundled extension was
  vulnerable.  Vulnerable uses do appear in a documentation example and in
  non-bundled extensions.  Hence, the attack prerequisite was an
  administrator having installed files of a vulnerable, trusted,
  non-bundled extension.  Subject to that prerequisite, this enabled an
  attacker having database-level CREATE privilege to execute arbitrary
  code as the bootstrap superuser.  By blocking this attack in the core
  server, there's no need to modify individual extensions.  Back-patch to
  v11 (all supported versions).

  Reported by Micah Gate, Valerie Woolard, Tim Carey-Smith, and Christoph
  Berg.

  Security: CVE-2023-39417
impacted_packages:
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: f53511010b72d7d314e22be7c63ef94792fee345
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: eb044d8f0aee1ba4950b0867f6ca9328374318db
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: b1b585e0fc3dd195bc2e338c80760bede08de5f1
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 919ebb023e74546c6293352556365091c5402366
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: c79434d7fcabdf2a5b27b235c0fb85912e686087
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 023fa8f326dad5e0f841fcc4247b449881215cb7
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: de494ec14f6bd7f2676623a5934723a6c8ba51c2
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: cd5f2a357014d5ed8205191f8e1fb180f1439599
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 948757fe493c1031d43bb082b6466db9a08f34a3
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 5d81700859adc9462b9663789f4491611c3d11b8
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: d4648a74be07bfb23b449c722303c320297c0327
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 93eb661713338b2b51f36ec397e42397b5e441e2
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/postgres/postgres/tree/023fa8f326dad5e0f841fcc4247b449881215cb7
    reference_type: commit
    reference_id: 023fa8f326dad5e0f841fcc4247b449881215cb7
  - url: https://github.com/postgres/postgres/tree/5d81700859adc9462b9663789f4491611c3d11b8
    reference_type: commit
    reference_id: 5d81700859adc9462b9663789f4491611c3d11b8
  - url: https://github.com/postgres/postgres/tree/919ebb023e74546c6293352556365091c5402366
    reference_type: commit
    reference_id: 919ebb023e74546c6293352556365091c5402366
  - url: https://github.com/postgres/postgres/tree/93eb661713338b2b51f36ec397e42397b5e441e2
    reference_type: commit
    reference_id: 93eb661713338b2b51f36ec397e42397b5e441e2
  - url: https://github.com/postgres/postgres/tree/948757fe493c1031d43bb082b6466db9a08f34a3
    reference_type: commit
    reference_id: 948757fe493c1031d43bb082b6466db9a08f34a3
  - url: https://github.com/postgres/postgres/tree/b1b585e0fc3dd195bc2e338c80760bede08de5f1
    reference_type: commit
    reference_id: b1b585e0fc3dd195bc2e338c80760bede08de5f1
  - url: https://github.com/postgres/postgres/tree/c79434d7fcabdf2a5b27b235c0fb85912e686087
    reference_type: commit
    reference_id: c79434d7fcabdf2a5b27b235c0fb85912e686087
  - url: https://github.com/postgres/postgres/tree/cd5f2a357014d5ed8205191f8e1fb180f1439599
    reference_type: commit
    reference_id: cd5f2a357014d5ed8205191f8e1fb180f1439599
  - url: https://github.com/postgres/postgres/tree/d4648a74be07bfb23b449c722303c320297c0327
    reference_type: commit
    reference_id: d4648a74be07bfb23b449c722303c320297c0327
  - url: https://github.com/postgres/postgres/tree/de494ec14f6bd7f2676623a5934723a6c8ba51c2
    reference_type: commit
    reference_id: de494ec14f6bd7f2676623a5934723a6c8ba51c2
  - url: https://github.com/postgres/postgres/tree/eb044d8f0aee1ba4950b0867f6ca9328374318db
    reference_type: commit
    reference_id: eb044d8f0aee1ba4950b0867f6ca9328374318db
  - url: https://github.com/postgres/postgres/tree/f53511010b72d7d314e22be7c63ef94792fee345
    reference_type: commit
    reference_id: f53511010b72d7d314e22be7c63ef94792fee345
