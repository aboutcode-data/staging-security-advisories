advisory_id: CVE-2025-1094
datasource_id: collect_postgresql_fix_commits/CVE-2025-1094
datasource_url: https://github.com/postgres/postgres
aliases: []
summary: |
  a7f95859ef7763ffb7f87894553ab25f5268f33c:In fmtIdEnc(), handle failure of enlargePQExpBuffer().

  Coverity complained that we weren't doing that, and it's right.

  This fix just makes fmtIdEnc() honor the general convention that OOM
  causes a PQExpBuffer to become marked "broken", without any immediate
  error.  In the pretty-unlikely case that we actually did hit OOM here,
  the end result would be to return an empty string to the caller,
  probably resulting in invalid SQL syntax in an issued command (if
  nothing else went wrong, which is even more unlikely).  It's tempting
  to throw an "out of memory" error if the buffer becomes broken, but
  there's not a lot of point in doing that only here and not in hundreds
  of other PQExpBuffer-using places in pg_dump and similar callers.
  The whole issue could do with some non-time-crunched redesign, perhaps.

  This is a followup to the fixes for CVE-2025-1094, and should be
  included if cherry-picking those fixes.
  9f052613e44606773aead07e2cd9e22710d7fbc5:In fmtIdEnc(), handle failure of enlargePQExpBuffer().

  Coverity complained that we weren't doing that, and it's right.

  This fix just makes fmtIdEnc() honor the general convention that OOM
  causes a PQExpBuffer to become marked "broken", without any immediate
  error.  In the pretty-unlikely case that we actually did hit OOM here,
  the end result would be to return an empty string to the caller,
  probably resulting in invalid SQL syntax in an issued command (if
  nothing else went wrong, which is even more unlikely).  It's tempting
  to throw an "out of memory" error if the buffer becomes broken, but
  there's not a lot of point in doing that only here and not in hundreds
  of other PQExpBuffer-using places in pg_dump and similar callers.
  The whole issue could do with some non-time-crunched redesign, perhaps.

  This is a followup to the fixes for CVE-2025-1094, and should be
  included if cherry-picking those fixes.
  f864a4cdfcec1de50ef969772a59daeed39c4a1d:In fmtIdEnc(), handle failure of enlargePQExpBuffer().

  Coverity complained that we weren't doing that, and it's right.

  This fix just makes fmtIdEnc() honor the general convention that OOM
  causes a PQExpBuffer to become marked "broken", without any immediate
  error.  In the pretty-unlikely case that we actually did hit OOM here,
  the end result would be to return an empty string to the caller,
  probably resulting in invalid SQL syntax in an issued command (if
  nothing else went wrong, which is even more unlikely).  It's tempting
  to throw an "out of memory" error if the buffer becomes broken, but
  there's not a lot of point in doing that only here and not in hundreds
  of other PQExpBuffer-using places in pg_dump and similar callers.
  The whole issue could do with some non-time-crunched redesign, perhaps.

  This is a followup to the fixes for CVE-2025-1094, and should be
  included if cherry-picking those fixes.
  2226a2e266dbabc5597fff5f624b3fcd71ce5fa8:In fmtIdEnc(), handle failure of enlargePQExpBuffer().

  Coverity complained that we weren't doing that, and it's right.

  This fix just makes fmtIdEnc() honor the general convention that OOM
  causes a PQExpBuffer to become marked "broken", without any immediate
  error.  In the pretty-unlikely case that we actually did hit OOM here,
  the end result would be to return an empty string to the caller,
  probably resulting in invalid SQL syntax in an issued command (if
  nothing else went wrong, which is even more unlikely).  It's tempting
  to throw an "out of memory" error if the buffer becomes broken, but
  there's not a lot of point in doing that only here and not in hundreds
  of other PQExpBuffer-using places in pg_dump and similar callers.
  The whole issue could do with some non-time-crunched redesign, perhaps.

  This is a followup to the fixes for CVE-2025-1094, and should be
  included if cherry-picking those fixes.
  644b7d686e4d4173265c01ef11957a0bee1f6a2c:In fmtIdEnc(), handle failure of enlargePQExpBuffer().

  Coverity complained that we weren't doing that, and it's right.

  This fix just makes fmtIdEnc() honor the general convention that OOM
  causes a PQExpBuffer to become marked "broken", without any immediate
  error.  In the pretty-unlikely case that we actually did hit OOM here,
  the end result would be to return an empty string to the caller,
  probably resulting in invalid SQL syntax in an issued command (if
  nothing else went wrong, which is even more unlikely).  It's tempting
  to throw an "out of memory" error if the buffer becomes broken, but
  there's not a lot of point in doing that only here and not in hundreds
  of other PQExpBuffer-using places in pg_dump and similar callers.
  The whole issue could do with some non-time-crunched redesign, perhaps.

  This is a followup to the fixes for CVE-2025-1094, and should be
  included if cherry-picking those fixes.
  3977bd2985de8c5e4b8b00f67dfec28dcfb343c9:In fmtIdEnc(), handle failure of enlargePQExpBuffer().

  Coverity complained that we weren't doing that, and it's right.

  This fix just makes fmtIdEnc() honor the general convention that OOM
  causes a PQExpBuffer to become marked "broken", without any immediate
  error.  In the pretty-unlikely case that we actually did hit OOM here,
  the end result would be to return an empty string to the caller,
  probably resulting in invalid SQL syntax in an issued command (if
  nothing else went wrong, which is even more unlikely).  It's tempting
  to throw an "out of memory" error if the buffer becomes broken, but
  there's not a lot of point in doing that only here and not in hundreds
  of other PQExpBuffer-using places in pg_dump and similar callers.
  The whole issue could do with some non-time-crunched redesign, perhaps.

  This is a followup to the fixes for CVE-2025-1094, and should be
  included if cherry-picking those fixes.
  9f45e6a91d8460ac0b1f30e6ae3eefb185b8d0ab:Make escaping functions retain trailing bytes of an invalid character.

  Instead of dropping the trailing byte(s) of an invalid or incomplete
  multibyte character, replace only the first byte with a known-invalid
  sequence, and process the rest normally.  This seems less likely to
  confuse incautious callers than the behavior adopted in 5dc1e42b4.

  While we're at it, adjust PQescapeStringInternal to produce at most
  one bleat about invalid multibyte characters per string.  This
  matches the behavior of PQescapeInternal, and avoids the risk of
  producing tons of repetitive junk if a long string is simply given
  in the wrong encoding.

  This is a followup to the fixes for CVE-2025-1094, and should be
  included if cherry-picking those fixes.

  Author: Andres Freund <andres@anarazel.de>
  Co-authored-by: Tom Lane <tgl@sss.pgh.pa.us>
  Reported-by: Jeff Davis <pgsql@j-davis.com>
  Discussion: https://postgr.es/m/20250215012712.45@rfd.leadboat.com
  Backpatch-through: 13
  d6d29b2133f1c2a7d4f332bf68b2f40c8de3044c:Make escaping functions retain trailing bytes of an invalid character.

  Instead of dropping the trailing byte(s) of an invalid or incomplete
  multibyte character, replace only the first byte with a known-invalid
  sequence, and process the rest normally.  This seems less likely to
  confuse incautious callers than the behavior adopted in 5dc1e42b4.

  While we're at it, adjust PQescapeStringInternal to produce at most
  one bleat about invalid multibyte characters per string.  This
  matches the behavior of PQescapeInternal, and avoids the risk of
  producing tons of repetitive junk if a long string is simply given
  in the wrong encoding.

  This is a followup to the fixes for CVE-2025-1094, and should be
  included if cherry-picking those fixes.

  Author: Andres Freund <andres@anarazel.de>
  Co-authored-by: Tom Lane <tgl@sss.pgh.pa.us>
  Reported-by: Jeff Davis <pgsql@j-davis.com>
  Discussion: https://postgr.es/m/20250215012712.45@rfd.leadboat.com
  Backpatch-through: 13
  c08309584ac58a28072fa2c4765fb4c4c01a901d:Make escaping functions retain trailing bytes of an invalid character.

  Instead of dropping the trailing byte(s) of an invalid or incomplete
  multibyte character, replace only the first byte with a known-invalid
  sequence, and process the rest normally.  This seems less likely to
  confuse incautious callers than the behavior adopted in 5dc1e42b4.

  While we're at it, adjust PQescapeStringInternal to produce at most
  one bleat about invalid multibyte characters per string.  This
  matches the behavior of PQescapeInternal, and avoids the risk of
  producing tons of repetitive junk if a long string is simply given
  in the wrong encoding.

  This is a followup to the fixes for CVE-2025-1094, and should be
  included if cherry-picking those fixes.

  Author: Andres Freund <andres@anarazel.de>
  Co-authored-by: Tom Lane <tgl@sss.pgh.pa.us>
  Reported-by: Jeff Davis <pgsql@j-davis.com>
  Discussion: https://postgr.es/m/20250215012712.45@rfd.leadboat.com
  Backpatch-through: 13
  e782a63ccb76a8db476abb8f5d96397806e3e51b:Make escaping functions retain trailing bytes of an invalid character.

  Instead of dropping the trailing byte(s) of an invalid or incomplete
  multibyte character, replace only the first byte with a known-invalid
  sequence, and process the rest normally.  This seems less likely to
  confuse incautious callers than the behavior adopted in 5dc1e42b4.

  While we're at it, adjust PQescapeStringInternal to produce at most
  one bleat about invalid multibyte characters per string.  This
  matches the behavior of PQescapeInternal, and avoids the risk of
  producing tons of repetitive junk if a long string is simply given
  in the wrong encoding.

  This is a followup to the fixes for CVE-2025-1094, and should be
  included if cherry-picking those fixes.

  Author: Andres Freund <andres@anarazel.de>
  Co-authored-by: Tom Lane <tgl@sss.pgh.pa.us>
  Reported-by: Jeff Davis <pgsql@j-davis.com>
  Discussion: https://postgr.es/m/20250215012712.45@rfd.leadboat.com
  Backpatch-through: 13
  991a60a9f23bd2b160e223c46bb2ae1db58f738a:Make escaping functions retain trailing bytes of an invalid character.

  Instead of dropping the trailing byte(s) of an invalid or incomplete
  multibyte character, replace only the first byte with a known-invalid
  sequence, and process the rest normally.  This seems less likely to
  confuse incautious callers than the behavior adopted in 5dc1e42b4.

  While we're at it, adjust PQescapeStringInternal to produce at most
  one bleat about invalid multibyte characters per string.  This
  matches the behavior of PQescapeInternal, and avoids the risk of
  producing tons of repetitive junk if a long string is simply given
  in the wrong encoding.

  This is a followup to the fixes for CVE-2025-1094, and should be
  included if cherry-picking those fixes.

  Author: Andres Freund <andres@anarazel.de>
  Co-authored-by: Tom Lane <tgl@sss.pgh.pa.us>
  Reported-by: Jeff Davis <pgsql@j-davis.com>
  Discussion: https://postgr.es/m/20250215012712.45@rfd.leadboat.com
  Backpatch-through: 13
  3abe6e04cc69d1076a695d90e179dd64010a2667:Make escaping functions retain trailing bytes of an invalid character.

  Instead of dropping the trailing byte(s) of an invalid or incomplete
  multibyte character, replace only the first byte with a known-invalid
  sequence, and process the rest normally.  This seems less likely to
  confuse incautious callers than the behavior adopted in 5dc1e42b4.

  While we're at it, adjust PQescapeStringInternal to produce at most
  one bleat about invalid multibyte characters per string.  This
  matches the behavior of PQescapeInternal, and avoids the risk of
  producing tons of repetitive junk if a long string is simply given
  in the wrong encoding.

  This is a followup to the fixes for CVE-2025-1094, and should be
  included if cherry-picking those fixes.

  Author: Andres Freund <andres@anarazel.de>
  Co-authored-by: Tom Lane <tgl@sss.pgh.pa.us>
  Reported-by: Jeff Davis <pgsql@j-davis.com>
  Discussion: https://postgr.es/m/20250215012712.45@rfd.leadboat.com
  Backpatch-through: 13
  fa3ddd2ea8d62518f1f523027c55655856d5cc39:Last-minute updates for release notes.

  Security: CVE-2025-1094
  e748064669f40a2dc9cf29b8518902620e47e2db:Last-minute updates for release notes.

  Security: CVE-2025-1094
  1c77ff9f9a0278bb23b3629417ed7ce097c1697a:Last-minute updates for release notes.

  Security: CVE-2025-1094
  7e06ffbc6230a6f3e4cdc7599a5617d081d611f7:Last-minute updates for release notes.

  Security: CVE-2025-1094
  1ea6e890b225fa45911f58602b8c425ae0581897:Last-minute updates for release notes.

  Security: CVE-2025-1094
  f9fceef6ee020717ffbd18cfaa0b77e583348734:Adapt appendPsqlMetaConnect() to the new fmtId() encoding expectations.

  We need to tell fmtId() what encoding to assume, but this function
  doesn't know that.  Fortunately we can fix that without changing the
  function's API, because we can just use SQL_ASCII.  That's because
  database names in connection requests are effectively binary not text:
  no encoding-aware processing will happen on them.

  This fixes XversionUpgrade failures seen in the buildfarm.  The
  alternative of having pg_upgrade use setFmtEncoding() is unappetizing,
  given that it's connecting to multiple databases that may have
  different encodings.

  Andres Freund, Noah Misch, Tom Lane

  Security: CVE-2025-1094
  e1f1b030d7d9fea27a77a335699372e0b222c61a:Adapt appendPsqlMetaConnect() to the new fmtId() encoding expectations.

  We need to tell fmtId() what encoding to assume, but this function
  doesn't know that.  Fortunately we can fix that without changing the
  function's API, because we can just use SQL_ASCII.  That's because
  database names in connection requests are effectively binary not text:
  no encoding-aware processing will happen on them.

  This fixes XversionUpgrade failures seen in the buildfarm.  The
  alternative of having pg_upgrade use setFmtEncoding() is unappetizing,
  given that it's connecting to multiple databases that may have
  different encodings.

  Andres Freund, Noah Misch, Tom Lane

  Security: CVE-2025-1094
  9862de9176ef161e20a40f327afe18c6a11ecdcc:Adapt appendPsqlMetaConnect() to the new fmtId() encoding expectations.

  We need to tell fmtId() what encoding to assume, but this function
  doesn't know that.  Fortunately we can fix that without changing the
  function's API, because we can just use SQL_ASCII.  That's because
  database names in connection requests are effectively binary not text:
  no encoding-aware processing will happen on them.

  This fixes XversionUpgrade failures seen in the buildfarm.  The
  alternative of having pg_upgrade use setFmtEncoding() is unappetizing,
  given that it's connecting to multiple databases that may have
  different encodings.

  Andres Freund, Noah Misch, Tom Lane

  Security: CVE-2025-1094
  0075a5c6ce5bb6f3ee005a54cd5b518f16659655:Adapt appendPsqlMetaConnect() to the new fmtId() encoding expectations.

  We need to tell fmtId() what encoding to assume, but this function
  doesn't know that.  Fortunately we can fix that without changing the
  function's API, because we can just use SQL_ASCII.  That's because
  database names in connection requests are effectively binary not text:
  no encoding-aware processing will happen on them.

  This fixes XversionUpgrade failures seen in the buildfarm.  The
  alternative of having pg_upgrade use setFmtEncoding() is unappetizing,
  given that it's connecting to multiple databases that may have
  different encodings.

  Andres Freund, Noah Misch, Tom Lane

  Security: CVE-2025-1094
  85c1fcc6563843d7ee7ae6f81f29ef813e77a4b6:Adapt appendPsqlMetaConnect() to the new fmtId() encoding expectations.

  We need to tell fmtId() what encoding to assume, but this function
  doesn't know that.  Fortunately we can fix that without changing the
  function's API, because we can just use SQL_ASCII.  That's because
  database names in connection requests are effectively binary not text:
  no encoding-aware processing will happen on them.

  This fixes XversionUpgrade failures seen in the buildfarm.  The
  alternative of having pg_upgrade use setFmtEncoding() is unappetizing,
  given that it's connecting to multiple databases that may have
  different encodings.

  Andres Freund, Noah Misch, Tom Lane

  Security: CVE-2025-1094
  5bf12323b6b8b05790aab6876555568898f4fc81:Adapt appendPsqlMetaConnect() to the new fmtId() encoding expectations.

  We need to tell fmtId() what encoding to assume, but this function
  doesn't know that.  Fortunately we can fix that without changing the
  function's API, because we can just use SQL_ASCII.  That's because
  database names in connection requests are effectively binary not text:
  no encoding-aware processing will happen on them.

  This fixes XversionUpgrade failures seen in the buildfarm.  The
  alternative of having pg_upgrade use setFmtEncoding() is unappetizing,
  given that it's connecting to multiple databases that may have
  different encodings.

  Andres Freund, Noah Misch, Tom Lane

  Security: CVE-2025-1094
  7beb2af5e635304334820895e49662fbf08a3702:Fix type in test_escape test

  On machines where char is unsigned this could lead to option parsing looping
  endlessly. It's also too narrow a type on other hardware.

  Found via Tom Lane's monitoring of the buildfarm.

  Reported-by: Tom Lane <tgl@sss.pgh.pa.us>
  Security: CVE-2025-1094
  Backpatch-through: 13
  4a6825c762112f085d6ee03bbce8e7abe2bf98e5:Fix type in test_escape test

  On machines where char is unsigned this could lead to option parsing looping
  endlessly. It's also too narrow a type on other hardware.

  Found via Tom Lane's monitoring of the buildfarm.

  Reported-by: Tom Lane <tgl@sss.pgh.pa.us>
  Security: CVE-2025-1094
  Backpatch-through: 13
  a085fa73169d6c0df079cfa4ddfeade812368a64:Fix type in test_escape test

  On machines where char is unsigned this could lead to option parsing looping
  endlessly. It's also too narrow a type on other hardware.

  Found via Tom Lane's monitoring of the buildfarm.

  Reported-by: Tom Lane <tgl@sss.pgh.pa.us>
  Security: CVE-2025-1094
  Backpatch-through: 13
  41343f84052eb53a900ea464a8ce16a548cab901:Fix type in test_escape test

  On machines where char is unsigned this could lead to option parsing looping
  endlessly. It's also too narrow a type on other hardware.

  Found via Tom Lane's monitoring of the buildfarm.

  Reported-by: Tom Lane <tgl@sss.pgh.pa.us>
  Security: CVE-2025-1094
  Backpatch-through: 13
  05abb0f8303a78921f7113bee1d72586142df99e:Fix type in test_escape test

  On machines where char is unsigned this could lead to option parsing looping
  endlessly. It's also too narrow a type on other hardware.

  Found via Tom Lane's monitoring of the buildfarm.

  Reported-by: Tom Lane <tgl@sss.pgh.pa.us>
  Security: CVE-2025-1094
  Backpatch-through: 13
  979205e47bdc094787b10142e84a7634f7c720dd:Fix type in test_escape test

  On machines where char is unsigned this could lead to option parsing looping
  endlessly. It's also too narrow a type on other hardware.

  Found via Tom Lane's monitoring of the buildfarm.

  Reported-by: Tom Lane <tgl@sss.pgh.pa.us>
  Security: CVE-2025-1094
  Backpatch-through: 13
  9dc952d9a077d4c5407b2da751d2e985d83e4924:docs: EUC_TW can be up to four bytes wide, not three

  Backpatch-through: 13
  Security: CVE-2025-1094
  17b789469106e156f559fcdab0c720db3c38151a:docs: EUC_TW can be up to four bytes wide, not three

  Backpatch-through: 13
  Security: CVE-2025-1094
  4ea3f5ef35f0d4aff89230eed63b76574b629f83:Add test of various escape functions

  As highlighted by the prior commit, writing correct escape functions is less
  trivial than one might hope.

  This test module tries to verify that different escaping functions behave
  reasonably. It e.g. tests:

  - Invalidly encoded input to an escape function leads to invalidly encoded
    output

  - Trailing incomplete multi-byte characters are handled sensibly

  - Escaped strings are parsed as single statement by psql's parser (which
    derives from the backend parser)

  There are further tests that would be good to add. But even in the current
  state it was rather useful for writing the fix in the prior commit.

  Reviewed-by: Noah Misch <noah@leadboat.com>
  Backpatch-through: 13
  Security: CVE-2025-1094
  46ddf98df0517d39108abdf5da29e0cae8d4ebfd:Add test of various escape functions

  As highlighted by the prior commit, writing correct escape functions is less
  trivial than one might hope.

  This test module tries to verify that different escaping functions behave
  reasonably. It e.g. tests:

  - Invalidly encoded input to an escape function leads to invalidly encoded
    output

  - Trailing incomplete multi-byte characters are handled sensibly

  - Escaped strings are parsed as single statement by psql's parser (which
    derives from the backend parser)

  There are further tests that would be good to add. But even in the current
  state it was rather useful for writing the fix in the prior commit.

  Reviewed-by: Noah Misch <noah@leadboat.com>
  Backpatch-through: 13
  Security: CVE-2025-1094
  c906bfe1b87280ab5b94d5d84e7cd019a1ff09d3:Fix handling of invalidly encoded data in escaping functions

  Previously invalidly encoded input to various escaping functions could lead to
  the escaped string getting incorrectly parsed by psql.  To be safe, escaping
  functions need to ensure that neither invalid nor incomplete multi-byte
  characters can be used to "escape" from being quoted.

  Functions which can report errors now return an error in more cases than
  before. Functions that cannot report errors now replace invalid input bytes
  with a byte sequence that cannot be used to escape the quotes and that is
  guaranteed to error out when a query is sent to the server.

  The following functions are fixed by this commit:
  - PQescapeLiteral()
  - PQescapeIdentifier()
  - PQescapeString()
  - PQescapeStringConn()
  - fmtId()
  - appendStringLiteral()

  Reported-by: Stephen Fewer <stephen_fewer@rapid7.com>
  Reviewed-by: Noah Misch <noah@leadboat.com>
  Reviewed-by: Tom Lane <tgl@sss.pgh.pa.us>
  Backpatch-through: 13
  Security: CVE-2025-1094
  e0ef3d776a349db2c63075241626563b79477bd4:Fix handling of invalidly encoded data in escaping functions

  Previously invalidly encoded input to various escaping functions could lead to
  the escaped string getting incorrectly parsed by psql.  To be safe, escaping
  functions need to ensure that neither invalid nor incomplete multi-byte
  characters can be used to "escape" from being quoted.

  Functions which can report errors now return an error in more cases than
  before. Functions that cannot report errors now replace invalid input bytes
  with a byte sequence that cannot be used to escape the quotes and that is
  guaranteed to error out when a query is sent to the server.

  The following functions are fixed by this commit:
  - PQescapeLiteral()
  - PQescapeIdentifier()
  - PQescapeString()
  - PQescapeStringConn()
  - fmtId()
  - appendStringLiteral()

  Reported-by: Stephen Fewer <stephen_fewer@rapid7.com>
  Reviewed-by: Noah Misch <noah@leadboat.com>
  Reviewed-by: Tom Lane <tgl@sss.pgh.pa.us>
  Backpatch-through: 13
  Security: CVE-2025-1094
  5df4e1632e65323ad9b33d7dfe721117a6060fbe:Specify the encoding of input to fmtId()

  This commit adds fmtIdEnc() and fmtQualifiedIdEnc(), which allow to specify
  the encoding as an explicit argument.  Additionally setFmtEncoding() is
  provided, which defines the encoding when no explicit encoding is provided, to
  avoid breaking all code using fmtId().

  All users of fmtId()/fmtQualifiedId() are either converted to the explicit
  version or a call to setFmtEncoding() has been added.

  This commit does not yet utilize the now well-defined encoding, that will
  happen in a subsequent commit.

  Reviewed-by: Noah Misch <noah@leadboat.com>
  Reviewed-by: Tom Lane <tgl@sss.pgh.pa.us>
  Backpatch-through: 13
  Security: CVE-2025-1094
  2ae54ae17eaad592991e7459140b2cad2e82745c:Specify the encoding of input to fmtId()

  This commit adds fmtIdEnc() and fmtQualifiedIdEnc(), which allow to specify
  the encoding as an explicit argument.  Additionally setFmtEncoding() is
  provided, which defines the encoding when no explicit encoding is provided, to
  avoid breaking all code using fmtId().

  All users of fmtId()/fmtQualifiedId() are either converted to the explicit
  version or a call to setFmtEncoding() has been added.

  This commit does not yet utilize the now well-defined encoding, that will
  happen in a subsequent commit.

  Reviewed-by: Noah Misch <noah@leadboat.com>
  Reviewed-by: Tom Lane <tgl@sss.pgh.pa.us>
  Backpatch-through: 13
  Security: CVE-2025-1094
  db3eb0e8256a7089d16cb6ed1ea7a65654c0e105:Add pg_encoding_set_invalid()

  There are cases where we cannot / do not want to error out for invalidly
  encoded input. In such cases it can be useful to replace e.g. an incomplete
  multi-byte characters with bytes that will trigger an error when getting
  validated as part of a larger string.

  Unfortunately, until now, for some encoding no such sequence existed. For
  those encodings this commit removes one previously accepted input combination
  - we consider that to be ok, as the chosen bytes are outside of the valid
  ranges for the encodings, we just previously failed to detect that.

  As we cannot add a new field to pg_wchar_table without breaking ABI, this is
  implemented "in-line" in the newly added function.

  Author: Noah Misch <noah@leadboat.com>
  Reviewed-by: Andres Freund <andres@anarazel.de>
  Backpatch-through: 13
  Security: CVE-2025-1094
  5bc33cbeae0e5cb8ecb410f8e47efb92811380fd:Add pg_encoding_set_invalid()

  There are cases where we cannot / do not want to error out for invalidly
  encoded input. In such cases it can be useful to replace e.g. an incomplete
  multi-byte characters with bytes that will trigger an error when getting
  validated as part of a larger string.

  Unfortunately, until now, for some encoding no such sequence existed. For
  those encodings this commit removes one previously accepted input combination
  - we consider that to be ok, as the chosen bytes are outside of the valid
  ranges for the encodings, we just previously failed to detect that.

  As we cannot add a new field to pg_wchar_table without breaking ABI, this is
  implemented "in-line" in the newly added function.

  Author: Noah Misch <noah@leadboat.com>
  Reviewed-by: Andres Freund <andres@anarazel.de>
  Backpatch-through: 13
  Security: CVE-2025-1094
  00f1a1f665f078f5abadbf8baddc5c187fba80f8:Back-patch pg_encoding_verifymbstr()/pg_encoding_verifymbchar() to v13.

  A security fix will need those functions, so back-patch the v14+ functions to
  v13.

  When commit b80e10638e36b9d2f0b39170c613837af2ca2aac introduced the v14+
  implementation of pg_encoding_verifymbstr(), it added a callback to each
  pg_wchar_table entry.  For simplicity and ABI stability, this instead
  implements the function in terms of the existing per-character callback.

  Author: Noah Misch <noah@leadboat.com>
  Author: Andres Freund <andres@anarazel.de>
  Security: CVE-2025-1094
  57bda2508f1c666fd18f2b233823b7c98308226b:docs: EUC_TW can be up to four bytes wide, not three

  Backpatch-through: 13
  Security: CVE-2025-1094
  16ce519533bd03db726953db2364877a8944da4c:docs: EUC_TW can be up to four bytes wide, not three

  Backpatch-through: 13
  Security: CVE-2025-1094
  de4b92f3332b7ea3373ae7bad0d790473b3665e6:Add test of various escape functions

  As highlighted by the prior commit, writing correct escape functions is less
  trivial than one might hope.

  This test module tries to verify that different escaping functions behave
  reasonably. It e.g. tests:

  - Invalidly encoded input to an escape function leads to invalidly encoded
    output

  - Trailing incomplete multi-byte characters are handled sensibly

  - Escaped strings are parsed as single statement by psql's parser (which
    derives from the backend parser)

  There are further tests that would be good to add. But even in the current
  state it was rather useful for writing the fix in the prior commit.

  Reviewed-by: Noah Misch <noah@leadboat.com>
  Backpatch-through: 13
  Security: CVE-2025-1094
  01784793fca3d998dd36ea21f120a78f0b3d5e85:Add test of various escape functions

  As highlighted by the prior commit, writing correct escape functions is less
  trivial than one might hope.

  This test module tries to verify that different escaping functions behave
  reasonably. It e.g. tests:

  - Invalidly encoded input to an escape function leads to invalidly encoded
    output

  - Trailing incomplete multi-byte characters are handled sensibly

  - Escaped strings are parsed as single statement by psql's parser (which
    derives from the backend parser)

  There are further tests that would be good to add. But even in the current
  state it was rather useful for writing the fix in the prior commit.

  Reviewed-by: Noah Misch <noah@leadboat.com>
  Backpatch-through: 13
  Security: CVE-2025-1094
  370c94d4cce179736f9a255779eb8e653e1edfb2:Fix handling of invalidly encoded data in escaping functions

  Previously invalidly encoded input to various escaping functions could lead to
  the escaped string getting incorrectly parsed by psql.  To be safe, escaping
  functions need to ensure that neither invalid nor incomplete multi-byte
  characters can be used to "escape" from being quoted.

  Functions which can report errors now return an error in more cases than
  before. Functions that cannot report errors now replace invalid input bytes
  with a byte sequence that cannot be used to escape the quotes and that is
  guaranteed to error out when a query is sent to the server.

  The following functions are fixed by this commit:
  - PQescapeLiteral()
  - PQescapeIdentifier()
  - PQescapeString()
  - PQescapeStringConn()
  - fmtId()
  - appendStringLiteral()

  Reported-by: Stephen Fewer <stephen_fewer@rapid7.com>
  Reviewed-by: Noah Misch <noah@leadboat.com>
  Reviewed-by: Tom Lane <tgl@sss.pgh.pa.us>
  Backpatch-through: 13
  Security: CVE-2025-1094
  92e4170f421832208a75645f4a4ea94494bdad4d:Fix handling of invalidly encoded data in escaping functions

  Previously invalidly encoded input to various escaping functions could lead to
  the escaped string getting incorrectly parsed by psql.  To be safe, escaping
  functions need to ensure that neither invalid nor incomplete multi-byte
  characters can be used to "escape" from being quoted.

  Functions which can report errors now return an error in more cases than
  before. Functions that cannot report errors now replace invalid input bytes
  with a byte sequence that cannot be used to escape the quotes and that is
  guaranteed to error out when a query is sent to the server.

  The following functions are fixed by this commit:
  - PQescapeLiteral()
  - PQescapeIdentifier()
  - PQescapeString()
  - PQescapeStringConn()
  - fmtId()
  - appendStringLiteral()

  Reported-by: Stephen Fewer <stephen_fewer@rapid7.com>
  Reviewed-by: Noah Misch <noah@leadboat.com>
  Reviewed-by: Tom Lane <tgl@sss.pgh.pa.us>
  Backpatch-through: 13
  Security: CVE-2025-1094
  b1756da7541323eae07fe23eaad17ce12f20a56b:Specify the encoding of input to fmtId()

  This commit adds fmtIdEnc() and fmtQualifiedIdEnc(), which allow to specify
  the encoding as an explicit argument.  Additionally setFmtEncoding() is
  provided, which defines the encoding when no explicit encoding is provided, to
  avoid breaking all code using fmtId().

  All users of fmtId()/fmtQualifiedId() are either converted to the explicit
  version or a call to setFmtEncoding() has been added.

  This commit does not yet utilize the now well-defined encoding, that will
  happen in a subsequent commit.

  Reviewed-by: Noah Misch <noah@leadboat.com>
  Reviewed-by: Tom Lane <tgl@sss.pgh.pa.us>
  Backpatch-through: 13
  Security: CVE-2025-1094
  56aa2dcddeb299f62dad98ba50ad8db47cddaf97:Specify the encoding of input to fmtId()

  This commit adds fmtIdEnc() and fmtQualifiedIdEnc(), which allow to specify
  the encoding as an explicit argument.  Additionally setFmtEncoding() is
  provided, which defines the encoding when no explicit encoding is provided, to
  avoid breaking all code using fmtId().

  All users of fmtId()/fmtQualifiedId() are either converted to the explicit
  version or a call to setFmtEncoding() has been added.

  This commit does not yet utilize the now well-defined encoding, that will
  happen in a subsequent commit.

  Reviewed-by: Noah Misch <noah@leadboat.com>
  Reviewed-by: Tom Lane <tgl@sss.pgh.pa.us>
  Backpatch-through: 13
  Security: CVE-2025-1094
  703b3fd5de5d7bfe9cb3948601bc165da024256d:Add pg_encoding_set_invalid()

  There are cases where we cannot / do not want to error out for invalidly
  encoded input. In such cases it can be useful to replace e.g. an incomplete
  multi-byte characters with bytes that will trigger an error when getting
  validated as part of a larger string.

  Unfortunately, until now, for some encoding no such sequence existed. For
  those encodings this commit removes one previously accepted input combination
  - we consider that to be ok, as the chosen bytes are outside of the valid
  ranges for the encodings, we just previously failed to detect that.

  As we cannot add a new field to pg_wchar_table without breaking ABI, this is
  implemented "in-line" in the newly added function.

  Author: Noah Misch <noah@leadboat.com>
  Reviewed-by: Andres Freund <andres@anarazel.de>
  Backpatch-through: 13
  Security: CVE-2025-1094
  6e05b195d0e192e143db8c4c7ef2526860341a2c:Add pg_encoding_set_invalid()

  There are cases where we cannot / do not want to error out for invalidly
  encoded input. In such cases it can be useful to replace e.g. an incomplete
  multi-byte characters with bytes that will trigger an error when getting
  validated as part of a larger string.

  Unfortunately, until now, for some encoding no such sequence existed. For
  those encodings this commit removes one previously accepted input combination
  - we consider that to be ok, as the chosen bytes are outside of the valid
  ranges for the encodings, we just previously failed to detect that.

  As we cannot add a new field to pg_wchar_table without breaking ABI, this is
  implemented "in-line" in the newly added function.

  Author: Noah Misch <noah@leadboat.com>
  Reviewed-by: Andres Freund <andres@anarazel.de>
  Backpatch-through: 13
  Security: CVE-2025-1094
  dd3c1eb38e9add293f8be59b6aec7574e8584bdb:docs: EUC_TW can be up to four bytes wide, not three

  Backpatch-through: 13
  Security: CVE-2025-1094
  02d4d87ac20e2698b5375b347c451c55045e388d:Add test of various escape functions

  As highlighted by the prior commit, writing correct escape functions is less
  trivial than one might hope.

  This test module tries to verify that different escaping functions behave
  reasonably. It e.g. tests:

  - Invalidly encoded input to an escape function leads to invalidly encoded
    output

  - Trailing incomplete multi-byte characters are handled sensibly

  - Escaped strings are parsed as single statement by psql's parser (which
    derives from the backend parser)

  There are further tests that would be good to add. But even in the current
  state it was rather useful for writing the fix in the prior commit.

  Reviewed-by: Noah Misch <noah@leadboat.com>
  Backpatch-through: 13
  Security: CVE-2025-1094
  43a77239d412db194a69b18b7850580e3b78218f:Fix handling of invalidly encoded data in escaping functions

  Previously invalidly encoded input to various escaping functions could lead to
  the escaped string getting incorrectly parsed by psql.  To be safe, escaping
  functions need to ensure that neither invalid nor incomplete multi-byte
  characters can be used to "escape" from being quoted.

  Functions which can report errors now return an error in more cases than
  before. Functions that cannot report errors now replace invalid input bytes
  with a byte sequence that cannot be used to escape the quotes and that is
  guaranteed to error out when a query is sent to the server.

  The following functions are fixed by this commit:
  - PQescapeLiteral()
  - PQescapeIdentifier()
  - PQescapeString()
  - PQescapeStringConn()
  - fmtId()
  - appendStringLiteral()

  Reported-by: Stephen Fewer <stephen_fewer@rapid7.com>
  Reviewed-by: Noah Misch <noah@leadboat.com>
  Reviewed-by: Tom Lane <tgl@sss.pgh.pa.us>
  Backpatch-through: 13
  Security: CVE-2025-1094
  61ad93cdd48ecc8c6edf943f4d888a9325b66882:Specify the encoding of input to fmtId()

  This commit adds fmtIdEnc() and fmtQualifiedIdEnc(), which allow to specify
  the encoding as an explicit argument.  Additionally setFmtEncoding() is
  provided, which defines the encoding when no explicit encoding is provided, to
  avoid breaking all code using fmtId().

  All users of fmtId()/fmtQualifiedId() are either converted to the explicit
  version or a call to setFmtEncoding() has been added.

  This commit does not yet utilize the now well-defined encoding, that will
  happen in a subsequent commit.

  Reviewed-by: Noah Misch <noah@leadboat.com>
  Reviewed-by: Tom Lane <tgl@sss.pgh.pa.us>
  Backpatch-through: 13
  Security: CVE-2025-1094
  7d43ca6fe068015b403ffa1762f4df4efdf68b69:Add pg_encoding_set_invalid()

  There are cases where we cannot / do not want to error out for invalidly
  encoded input. In such cases it can be useful to replace e.g. an incomplete
  multi-byte characters with bytes that will trigger an error when getting
  validated as part of a larger string.

  Unfortunately, until now, for some encoding no such sequence existed. For
  those encodings this commit removes one previously accepted input combination
  - we consider that to be ok, as the chosen bytes are outside of the valid
  ranges for the encodings, we just previously failed to detect that.

  As we cannot add a new field to pg_wchar_table without breaking ABI, this is
  implemented "in-line" in the newly added function.

  Author: Noah Misch <noah@leadboat.com>
  Reviewed-by: Andres Freund <andres@anarazel.de>
  Backpatch-through: 13
  Security: CVE-2025-1094
  32c34006b24bf7432c2d0f47da10492de7253d52:docs: EUC_TW can be up to four bytes wide, not three

  Backpatch-through: 13
  Security: CVE-2025-1094
  ac00ff1c96081ea4981f1001209b4719f5cd82ac:Add test of various escape functions

  As highlighted by the prior commit, writing correct escape functions is less
  trivial than one might hope.

  This test module tries to verify that different escaping functions behave
  reasonably. It e.g. tests:

  - Invalidly encoded input to an escape function leads to invalidly encoded
    output

  - Trailing incomplete multi-byte characters are handled sensibly

  - Escaped strings are parsed as single statement by psql's parser (which
    derives from the backend parser)

  There are further tests that would be good to add. But even in the current
  state it was rather useful for writing the fix in the prior commit.

  Reviewed-by: Noah Misch <noah@leadboat.com>
  Backpatch-through: 13
  Security: CVE-2025-1094
  5dc1e42b4fa6a4434afa7d7cdcf0291351a7b873:Fix handling of invalidly encoded data in escaping functions

  Previously invalidly encoded input to various escaping functions could lead to
  the escaped string getting incorrectly parsed by psql.  To be safe, escaping
  functions need to ensure that neither invalid nor incomplete multi-byte
  characters can be used to "escape" from being quoted.

  Functions which can report errors now return an error in more cases than
  before. Functions that cannot report errors now replace invalid input bytes
  with a byte sequence that cannot be used to escape the quotes and that is
  guaranteed to error out when a query is sent to the server.

  The following functions are fixed by this commit:
  - PQescapeLiteral()
  - PQescapeIdentifier()
  - PQescapeString()
  - PQescapeStringConn()
  - fmtId()
  - appendStringLiteral()

  Reported-by: Stephen Fewer <stephen_fewer@rapid7.com>
  Reviewed-by: Noah Misch <noah@leadboat.com>
  Reviewed-by: Tom Lane <tgl@sss.pgh.pa.us>
  Backpatch-through: 13
  Security: CVE-2025-1094
  3e98c8ce50e46d58b91bf3ea806e995296dc5b91:Specify the encoding of input to fmtId()

  This commit adds fmtIdEnc() and fmtQualifiedIdEnc(), which allow to specify
  the encoding as an explicit argument.  Additionally setFmtEncoding() is
  provided, which defines the encoding when no explicit encoding is provided, to
  avoid breaking all code using fmtId().

  All users of fmtId()/fmtQualifiedId() are either converted to the explicit
  version or a call to setFmtEncoding() has been added.

  This commit does not yet utilize the now well-defined encoding, that will
  happen in a subsequent commit.

  Reviewed-by: Noah Misch <noah@leadboat.com>
  Reviewed-by: Tom Lane <tgl@sss.pgh.pa.us>
  Backpatch-through: 13
  Security: CVE-2025-1094
  4dc28963533704fc7dd922b9447467466a233d89:Add pg_encoding_set_invalid()

  There are cases where we cannot / do not want to error out for invalidly
  encoded input. In such cases it can be useful to replace e.g. an incomplete
  multi-byte characters with bytes that will trigger an error when getting
  validated as part of a larger string.

  Unfortunately, until now, for some encoding no such sequence existed. For
  those encodings this commit removes one previously accepted input combination
  - we consider that to be ok, as the chosen bytes are outside of the valid
  ranges for the encodings, we just previously failed to detect that.

  As we cannot add a new field to pg_wchar_table without breaking ABI, this is
  implemented "in-line" in the newly added function.

  Author: Noah Misch <noah@leadboat.com>
  Reviewed-by: Andres Freund <andres@anarazel.de>
  Backpatch-through: 13
  Security: CVE-2025-1094
impacted_packages:
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 56aa2dcddeb299f62dad98ba50ad8db47cddaf97
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 4dc28963533704fc7dd922b9447467466a233d89
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 1c77ff9f9a0278bb23b3629417ed7ce097c1697a
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 9f052613e44606773aead07e2cd9e22710d7fbc5
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 00f1a1f665f078f5abadbf8baddc5c187fba80f8
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: e782a63ccb76a8db476abb8f5d96397806e3e51b
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: fa3ddd2ea8d62518f1f523027c55655856d5cc39
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: a7f95859ef7763ffb7f87894553ab25f5268f33c
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: c906bfe1b87280ab5b94d5d84e7cd019a1ff09d3
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 2ae54ae17eaad592991e7459140b2cad2e82745c
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 644b7d686e4d4173265c01ef11957a0bee1f6a2c
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 5bc33cbeae0e5cb8ecb410f8e47efb92811380fd
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: b1756da7541323eae07fe23eaad17ce12f20a56b
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 01784793fca3d998dd36ea21f120a78f0b3d5e85
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 4a6825c762112f085d6ee03bbce8e7abe2bf98e5
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 9f45e6a91d8460ac0b1f30e6ae3eefb185b8d0ab
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: ac00ff1c96081ea4981f1001209b4719f5cd82ac
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 3e98c8ce50e46d58b91bf3ea806e995296dc5b91
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 02d4d87ac20e2698b5375b347c451c55045e388d
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: d6d29b2133f1c2a7d4f332bf68b2f40c8de3044c
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 46ddf98df0517d39108abdf5da29e0cae8d4ebfd
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 57bda2508f1c666fd18f2b233823b7c98308226b
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 3abe6e04cc69d1076a695d90e179dd64010a2667
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 7beb2af5e635304334820895e49662fbf08a3702
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 85c1fcc6563843d7ee7ae6f81f29ef813e77a4b6
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: a085fa73169d6c0df079cfa4ddfeade812368a64
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: e0ef3d776a349db2c63075241626563b79477bd4
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 16ce519533bd03db726953db2364877a8944da4c
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 32c34006b24bf7432c2d0f47da10492de7253d52
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 5dc1e42b4fa6a4434afa7d7cdcf0291351a7b873
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 2226a2e266dbabc5597fff5f624b3fcd71ce5fa8
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 9862de9176ef161e20a40f327afe18c6a11ecdcc
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 05abb0f8303a78921f7113bee1d72586142df99e
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 43a77239d412db194a69b18b7850580e3b78218f
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 370c94d4cce179736f9a255779eb8e653e1edfb2
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 0075a5c6ce5bb6f3ee005a54cd5b518f16659655
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 4ea3f5ef35f0d4aff89230eed63b76574b629f83
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 979205e47bdc094787b10142e84a7634f7c720dd
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 7d43ca6fe068015b403ffa1762f4df4efdf68b69
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 3977bd2985de8c5e4b8b00f67dfec28dcfb343c9
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: c08309584ac58a28072fa2c4765fb4c4c01a901d
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: f9fceef6ee020717ffbd18cfaa0b77e583348734
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 41343f84052eb53a900ea464a8ce16a548cab901
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 9dc952d9a077d4c5407b2da751d2e985d83e4924
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 6e05b195d0e192e143db8c4c7ef2526860341a2c
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: dd3c1eb38e9add293f8be59b6aec7574e8584bdb
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 61ad93cdd48ecc8c6edf943f4d888a9325b66882
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 7e06ffbc6230a6f3e4cdc7599a5617d081d611f7
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 17b789469106e156f559fcdab0c720db3c38151a
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: e1f1b030d7d9fea27a77a335699372e0b222c61a
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 991a60a9f23bd2b160e223c46bb2ae1db58f738a
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: de4b92f3332b7ea3373ae7bad0d790473b3665e6
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 5df4e1632e65323ad9b33d7dfe721117a6060fbe
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: db3eb0e8256a7089d16cb6ed1ea7a65654c0e105
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 92e4170f421832208a75645f4a4ea94494bdad4d
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: f864a4cdfcec1de50ef969772a59daeed39c4a1d
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 5bf12323b6b8b05790aab6876555568898f4fc81
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 703b3fd5de5d7bfe9cb3948601bc165da024256d
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 1ea6e890b225fa45911f58602b8c425ae0581897
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: e748064669f40a2dc9cf29b8518902620e47e2db
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/postgres/postgres/tree/0075a5c6ce5bb6f3ee005a54cd5b518f16659655
    reference_type: commit
    reference_id: 0075a5c6ce5bb6f3ee005a54cd5b518f16659655
  - url: https://github.com/postgres/postgres/tree/00f1a1f665f078f5abadbf8baddc5c187fba80f8
    reference_type: commit
    reference_id: 00f1a1f665f078f5abadbf8baddc5c187fba80f8
  - url: https://github.com/postgres/postgres/tree/01784793fca3d998dd36ea21f120a78f0b3d5e85
    reference_type: commit
    reference_id: 01784793fca3d998dd36ea21f120a78f0b3d5e85
  - url: https://github.com/postgres/postgres/tree/02d4d87ac20e2698b5375b347c451c55045e388d
    reference_type: commit
    reference_id: 02d4d87ac20e2698b5375b347c451c55045e388d
  - url: https://github.com/postgres/postgres/tree/05abb0f8303a78921f7113bee1d72586142df99e
    reference_type: commit
    reference_id: 05abb0f8303a78921f7113bee1d72586142df99e
  - url: https://github.com/postgres/postgres/tree/16ce519533bd03db726953db2364877a8944da4c
    reference_type: commit
    reference_id: 16ce519533bd03db726953db2364877a8944da4c
  - url: https://github.com/postgres/postgres/tree/17b789469106e156f559fcdab0c720db3c38151a
    reference_type: commit
    reference_id: 17b789469106e156f559fcdab0c720db3c38151a
  - url: https://github.com/postgres/postgres/tree/1c77ff9f9a0278bb23b3629417ed7ce097c1697a
    reference_type: commit
    reference_id: 1c77ff9f9a0278bb23b3629417ed7ce097c1697a
  - url: https://github.com/postgres/postgres/tree/1ea6e890b225fa45911f58602b8c425ae0581897
    reference_type: commit
    reference_id: 1ea6e890b225fa45911f58602b8c425ae0581897
  - url: https://github.com/postgres/postgres/tree/2226a2e266dbabc5597fff5f624b3fcd71ce5fa8
    reference_type: commit
    reference_id: 2226a2e266dbabc5597fff5f624b3fcd71ce5fa8
  - url: https://github.com/postgres/postgres/tree/2ae54ae17eaad592991e7459140b2cad2e82745c
    reference_type: commit
    reference_id: 2ae54ae17eaad592991e7459140b2cad2e82745c
  - url: https://github.com/postgres/postgres/tree/32c34006b24bf7432c2d0f47da10492de7253d52
    reference_type: commit
    reference_id: 32c34006b24bf7432c2d0f47da10492de7253d52
  - url: https://github.com/postgres/postgres/tree/370c94d4cce179736f9a255779eb8e653e1edfb2
    reference_type: commit
    reference_id: 370c94d4cce179736f9a255779eb8e653e1edfb2
  - url: https://github.com/postgres/postgres/tree/3977bd2985de8c5e4b8b00f67dfec28dcfb343c9
    reference_type: commit
    reference_id: 3977bd2985de8c5e4b8b00f67dfec28dcfb343c9
  - url: https://github.com/postgres/postgres/tree/3abe6e04cc69d1076a695d90e179dd64010a2667
    reference_type: commit
    reference_id: 3abe6e04cc69d1076a695d90e179dd64010a2667
  - url: https://github.com/postgres/postgres/tree/3e98c8ce50e46d58b91bf3ea806e995296dc5b91
    reference_type: commit
    reference_id: 3e98c8ce50e46d58b91bf3ea806e995296dc5b91
  - url: https://github.com/postgres/postgres/tree/41343f84052eb53a900ea464a8ce16a548cab901
    reference_type: commit
    reference_id: 41343f84052eb53a900ea464a8ce16a548cab901
  - url: https://github.com/postgres/postgres/tree/43a77239d412db194a69b18b7850580e3b78218f
    reference_type: commit
    reference_id: 43a77239d412db194a69b18b7850580e3b78218f
  - url: https://github.com/postgres/postgres/tree/46ddf98df0517d39108abdf5da29e0cae8d4ebfd
    reference_type: commit
    reference_id: 46ddf98df0517d39108abdf5da29e0cae8d4ebfd
  - url: https://github.com/postgres/postgres/tree/4a6825c762112f085d6ee03bbce8e7abe2bf98e5
    reference_type: commit
    reference_id: 4a6825c762112f085d6ee03bbce8e7abe2bf98e5
  - url: https://github.com/postgres/postgres/tree/4dc28963533704fc7dd922b9447467466a233d89
    reference_type: commit
    reference_id: 4dc28963533704fc7dd922b9447467466a233d89
  - url: https://github.com/postgres/postgres/tree/4ea3f5ef35f0d4aff89230eed63b76574b629f83
    reference_type: commit
    reference_id: 4ea3f5ef35f0d4aff89230eed63b76574b629f83
  - url: https://github.com/postgres/postgres/tree/56aa2dcddeb299f62dad98ba50ad8db47cddaf97
    reference_type: commit
    reference_id: 56aa2dcddeb299f62dad98ba50ad8db47cddaf97
  - url: https://github.com/postgres/postgres/tree/57bda2508f1c666fd18f2b233823b7c98308226b
    reference_type: commit
    reference_id: 57bda2508f1c666fd18f2b233823b7c98308226b
  - url: https://github.com/postgres/postgres/tree/5bc33cbeae0e5cb8ecb410f8e47efb92811380fd
    reference_type: commit
    reference_id: 5bc33cbeae0e5cb8ecb410f8e47efb92811380fd
  - url: https://github.com/postgres/postgres/tree/5bf12323b6b8b05790aab6876555568898f4fc81
    reference_type: commit
    reference_id: 5bf12323b6b8b05790aab6876555568898f4fc81
  - url: https://github.com/postgres/postgres/tree/5dc1e42b4fa6a4434afa7d7cdcf0291351a7b873
    reference_type: commit
    reference_id: 5dc1e42b4fa6a4434afa7d7cdcf0291351a7b873
  - url: https://github.com/postgres/postgres/tree/5df4e1632e65323ad9b33d7dfe721117a6060fbe
    reference_type: commit
    reference_id: 5df4e1632e65323ad9b33d7dfe721117a6060fbe
  - url: https://github.com/postgres/postgres/tree/61ad93cdd48ecc8c6edf943f4d888a9325b66882
    reference_type: commit
    reference_id: 61ad93cdd48ecc8c6edf943f4d888a9325b66882
  - url: https://github.com/postgres/postgres/tree/644b7d686e4d4173265c01ef11957a0bee1f6a2c
    reference_type: commit
    reference_id: 644b7d686e4d4173265c01ef11957a0bee1f6a2c
  - url: https://github.com/postgres/postgres/tree/6e05b195d0e192e143db8c4c7ef2526860341a2c
    reference_type: commit
    reference_id: 6e05b195d0e192e143db8c4c7ef2526860341a2c
  - url: https://github.com/postgres/postgres/tree/703b3fd5de5d7bfe9cb3948601bc165da024256d
    reference_type: commit
    reference_id: 703b3fd5de5d7bfe9cb3948601bc165da024256d
  - url: https://github.com/postgres/postgres/tree/7beb2af5e635304334820895e49662fbf08a3702
    reference_type: commit
    reference_id: 7beb2af5e635304334820895e49662fbf08a3702
  - url: https://github.com/postgres/postgres/tree/7d43ca6fe068015b403ffa1762f4df4efdf68b69
    reference_type: commit
    reference_id: 7d43ca6fe068015b403ffa1762f4df4efdf68b69
  - url: https://github.com/postgres/postgres/tree/7e06ffbc6230a6f3e4cdc7599a5617d081d611f7
    reference_type: commit
    reference_id: 7e06ffbc6230a6f3e4cdc7599a5617d081d611f7
  - url: https://github.com/postgres/postgres/tree/85c1fcc6563843d7ee7ae6f81f29ef813e77a4b6
    reference_type: commit
    reference_id: 85c1fcc6563843d7ee7ae6f81f29ef813e77a4b6
  - url: https://github.com/postgres/postgres/tree/92e4170f421832208a75645f4a4ea94494bdad4d
    reference_type: commit
    reference_id: 92e4170f421832208a75645f4a4ea94494bdad4d
  - url: https://github.com/postgres/postgres/tree/979205e47bdc094787b10142e84a7634f7c720dd
    reference_type: commit
    reference_id: 979205e47bdc094787b10142e84a7634f7c720dd
  - url: https://github.com/postgres/postgres/tree/9862de9176ef161e20a40f327afe18c6a11ecdcc
    reference_type: commit
    reference_id: 9862de9176ef161e20a40f327afe18c6a11ecdcc
  - url: https://github.com/postgres/postgres/tree/991a60a9f23bd2b160e223c46bb2ae1db58f738a
    reference_type: commit
    reference_id: 991a60a9f23bd2b160e223c46bb2ae1db58f738a
  - url: https://github.com/postgres/postgres/tree/9dc952d9a077d4c5407b2da751d2e985d83e4924
    reference_type: commit
    reference_id: 9dc952d9a077d4c5407b2da751d2e985d83e4924
  - url: https://github.com/postgres/postgres/tree/9f052613e44606773aead07e2cd9e22710d7fbc5
    reference_type: commit
    reference_id: 9f052613e44606773aead07e2cd9e22710d7fbc5
  - url: https://github.com/postgres/postgres/tree/9f45e6a91d8460ac0b1f30e6ae3eefb185b8d0ab
    reference_type: commit
    reference_id: 9f45e6a91d8460ac0b1f30e6ae3eefb185b8d0ab
  - url: https://github.com/postgres/postgres/tree/a085fa73169d6c0df079cfa4ddfeade812368a64
    reference_type: commit
    reference_id: a085fa73169d6c0df079cfa4ddfeade812368a64
  - url: https://github.com/postgres/postgres/tree/a7f95859ef7763ffb7f87894553ab25f5268f33c
    reference_type: commit
    reference_id: a7f95859ef7763ffb7f87894553ab25f5268f33c
  - url: https://github.com/postgres/postgres/tree/ac00ff1c96081ea4981f1001209b4719f5cd82ac
    reference_type: commit
    reference_id: ac00ff1c96081ea4981f1001209b4719f5cd82ac
  - url: https://github.com/postgres/postgres/tree/b1756da7541323eae07fe23eaad17ce12f20a56b
    reference_type: commit
    reference_id: b1756da7541323eae07fe23eaad17ce12f20a56b
  - url: https://github.com/postgres/postgres/tree/c08309584ac58a28072fa2c4765fb4c4c01a901d
    reference_type: commit
    reference_id: c08309584ac58a28072fa2c4765fb4c4c01a901d
  - url: https://github.com/postgres/postgres/tree/c906bfe1b87280ab5b94d5d84e7cd019a1ff09d3
    reference_type: commit
    reference_id: c906bfe1b87280ab5b94d5d84e7cd019a1ff09d3
  - url: https://github.com/postgres/postgres/tree/d6d29b2133f1c2a7d4f332bf68b2f40c8de3044c
    reference_type: commit
    reference_id: d6d29b2133f1c2a7d4f332bf68b2f40c8de3044c
  - url: https://github.com/postgres/postgres/tree/db3eb0e8256a7089d16cb6ed1ea7a65654c0e105
    reference_type: commit
    reference_id: db3eb0e8256a7089d16cb6ed1ea7a65654c0e105
  - url: https://github.com/postgres/postgres/tree/dd3c1eb38e9add293f8be59b6aec7574e8584bdb
    reference_type: commit
    reference_id: dd3c1eb38e9add293f8be59b6aec7574e8584bdb
  - url: https://github.com/postgres/postgres/tree/de4b92f3332b7ea3373ae7bad0d790473b3665e6
    reference_type: commit
    reference_id: de4b92f3332b7ea3373ae7bad0d790473b3665e6
  - url: https://github.com/postgres/postgres/tree/e0ef3d776a349db2c63075241626563b79477bd4
    reference_type: commit
    reference_id: e0ef3d776a349db2c63075241626563b79477bd4
  - url: https://github.com/postgres/postgres/tree/e1f1b030d7d9fea27a77a335699372e0b222c61a
    reference_type: commit
    reference_id: e1f1b030d7d9fea27a77a335699372e0b222c61a
  - url: https://github.com/postgres/postgres/tree/e748064669f40a2dc9cf29b8518902620e47e2db
    reference_type: commit
    reference_id: e748064669f40a2dc9cf29b8518902620e47e2db
  - url: https://github.com/postgres/postgres/tree/e782a63ccb76a8db476abb8f5d96397806e3e51b
    reference_type: commit
    reference_id: e782a63ccb76a8db476abb8f5d96397806e3e51b
  - url: https://github.com/postgres/postgres/tree/f864a4cdfcec1de50ef969772a59daeed39c4a1d
    reference_type: commit
    reference_id: f864a4cdfcec1de50ef969772a59daeed39c4a1d
  - url: https://github.com/postgres/postgres/tree/f9fceef6ee020717ffbd18cfaa0b77e583348734
    reference_type: commit
    reference_id: f9fceef6ee020717ffbd18cfaa0b77e583348734
  - url: https://github.com/postgres/postgres/tree/fa3ddd2ea8d62518f1f523027c55655856d5cc39
    reference_type: commit
    reference_id: fa3ddd2ea8d62518f1f523027c55655856d5cc39
