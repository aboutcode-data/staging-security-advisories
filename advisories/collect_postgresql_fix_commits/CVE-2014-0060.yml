advisory_id: CVE-2014-0060
datasource_id: collect_postgresql_fix_commits/CVE-2014-0060
datasource_url: https://github.com/postgres/postgres
aliases: []
summary: |
  7b1fab3fd2e17063fb1ec98e8ff5512a6b3da9b6:Last-minute updates for release notes.

  Add entries for security issues.

  Security: CVE-2014-0060 through CVE-2014-0067
  56e55cfd265a5e675e99fb67b0d55d78e018076c:Last-minute updates for release notes.

  Add entries for security issues.

  Security: CVE-2014-0060 through CVE-2014-0067
  8f979e789347d3dec15d020945a7c6e1b416f759:Last-minute updates for release notes.

  Add entries for security issues.

  Security: CVE-2014-0060 through CVE-2014-0067
  c09f340eb35bdfcbecf4606a7fcbd6369c4bb9e0:Last-minute updates for release notes.

  Add entries for security issues.

  Security: CVE-2014-0060 through CVE-2014-0067
  4bde115e7e5177abcee018b136716e69f90738b5:Last-minute updates for release notes.

  Add entries for security issues.

  Security: CVE-2014-0060 through CVE-2014-0067
  4239753338c8ef36d26615beb9b567bdd1814f73:Last-minute updates for release notes.

  Add entries for security issues.

  Security: CVE-2014-0060 through CVE-2014-0067
  ff35425c8f81541c8dc10486ed21ef1cfdae693e:Shore up ADMIN OPTION restrictions.

  Granting a role without ADMIN OPTION is supposed to prevent the grantee
  from adding or removing members from the granted role.  Issuing SET ROLE
  before the GRANT bypassed that, because the role itself had an implicit
  right to add or remove members.  Plug that hole by recognizing that
  implicit right only when the session user matches the current role.
  Additionally, do not recognize it during a security-restricted operation
  or during execution of a SECURITY DEFINER function.  The restriction on
  SECURITY DEFINER is not security-critical.  However, it seems best for a
  user testing his own SECURITY DEFINER function to see the same behavior
  others will see.  Back-patch to 8.4 (all supported versions).

  The SQL standards do not conflate roles and users as PostgreSQL does;
  only SQL roles have members, and only SQL users initiate sessions.  An
  application using PostgreSQL users and roles as SQL users and roles will
  never attempt to grant membership in the role that is the session user,
  so the implicit right to add or remove members will never arise.

  The security impact was mostly that a role member could revoke access
  from others, contrary to the wishes of his own grantor.  Unapproved role
  member additions are less notable, because the member can still largely
  achieve that by creating a view or a SECURITY DEFINER function.

  Reviewed by Andres Freund and Tom Lane.  Reported, independently, by
  Jonas Sundman and Noah Misch.

  Security: CVE-2014-0060
  789063697908d7531fc4fe9c72976ea642e68d15:Shore up ADMIN OPTION restrictions.

  Granting a role without ADMIN OPTION is supposed to prevent the grantee
  from adding or removing members from the granted role.  Issuing SET ROLE
  before the GRANT bypassed that, because the role itself had an implicit
  right to add or remove members.  Plug that hole by recognizing that
  implicit right only when the session user matches the current role.
  Additionally, do not recognize it during a security-restricted operation
  or during execution of a SECURITY DEFINER function.  The restriction on
  SECURITY DEFINER is not security-critical.  However, it seems best for a
  user testing his own SECURITY DEFINER function to see the same behavior
  others will see.  Back-patch to 8.4 (all supported versions).

  The SQL standards do not conflate roles and users as PostgreSQL does;
  only SQL roles have members, and only SQL users initiate sessions.  An
  application using PostgreSQL users and roles as SQL users and roles will
  never attempt to grant membership in the role that is the session user,
  so the implicit right to add or remove members will never arise.

  The security impact was mostly that a role member could revoke access
  from others, contrary to the wishes of his own grantor.  Unapproved role
  member additions are less notable, because the member can still largely
  achieve that by creating a view or a SECURITY DEFINER function.

  Reviewed by Andres Freund and Tom Lane.  Reported, independently, by
  Jonas Sundman and Noah Misch.

  Security: CVE-2014-0060
  5d320a16ca544d6e125e962ed325463ad8bec240:Shore up ADMIN OPTION restrictions.

  Granting a role without ADMIN OPTION is supposed to prevent the grantee
  from adding or removing members from the granted role.  Issuing SET ROLE
  before the GRANT bypassed that, because the role itself had an implicit
  right to add or remove members.  Plug that hole by recognizing that
  implicit right only when the session user matches the current role.
  Additionally, do not recognize it during a security-restricted operation
  or during execution of a SECURITY DEFINER function.  The restriction on
  SECURITY DEFINER is not security-critical.  However, it seems best for a
  user testing his own SECURITY DEFINER function to see the same behavior
  others will see.  Back-patch to 8.4 (all supported versions).

  The SQL standards do not conflate roles and users as PostgreSQL does;
  only SQL roles have members, and only SQL users initiate sessions.  An
  application using PostgreSQL users and roles as SQL users and roles will
  never attempt to grant membership in the role that is the session user,
  so the implicit right to add or remove members will never arise.

  The security impact was mostly that a role member could revoke access
  from others, contrary to the wishes of his own grantor.  Unapproved role
  member additions are less notable, because the member can still largely
  achieve that by creating a view or a SECURITY DEFINER function.

  Reviewed by Andres Freund and Tom Lane.  Reported, independently, by
  Jonas Sundman and Noah Misch.

  Security: CVE-2014-0060
  15a8f97b9d16aaf659f58c981242b9da591cf24c:Shore up ADMIN OPTION restrictions.

  Granting a role without ADMIN OPTION is supposed to prevent the grantee
  from adding or removing members from the granted role.  Issuing SET ROLE
  before the GRANT bypassed that, because the role itself had an implicit
  right to add or remove members.  Plug that hole by recognizing that
  implicit right only when the session user matches the current role.
  Additionally, do not recognize it during a security-restricted operation
  or during execution of a SECURITY DEFINER function.  The restriction on
  SECURITY DEFINER is not security-critical.  However, it seems best for a
  user testing his own SECURITY DEFINER function to see the same behavior
  others will see.  Back-patch to 8.4 (all supported versions).

  The SQL standards do not conflate roles and users as PostgreSQL does;
  only SQL roles have members, and only SQL users initiate sessions.  An
  application using PostgreSQL users and roles as SQL users and roles will
  never attempt to grant membership in the role that is the session user,
  so the implicit right to add or remove members will never arise.

  The security impact was mostly that a role member could revoke access
  from others, contrary to the wishes of his own grantor.  Unapproved role
  member additions are less notable, because the member can still largely
  achieve that by creating a view or a SECURITY DEFINER function.

  Reviewed by Andres Freund and Tom Lane.  Reported, independently, by
  Jonas Sundman and Noah Misch.

  Security: CVE-2014-0060
  475a1fbc41a120ea3bd5f903e37c48d7a1769ff8:Shore up ADMIN OPTION restrictions.

  Granting a role without ADMIN OPTION is supposed to prevent the grantee
  from adding or removing members from the granted role.  Issuing SET ROLE
  before the GRANT bypassed that, because the role itself had an implicit
  right to add or remove members.  Plug that hole by recognizing that
  implicit right only when the session user matches the current role.
  Additionally, do not recognize it during a security-restricted operation
  or during execution of a SECURITY DEFINER function.  The restriction on
  SECURITY DEFINER is not security-critical.  However, it seems best for a
  user testing his own SECURITY DEFINER function to see the same behavior
  others will see.  Back-patch to 8.4 (all supported versions).

  The SQL standards do not conflate roles and users as PostgreSQL does;
  only SQL roles have members, and only SQL users initiate sessions.  An
  application using PostgreSQL users and roles as SQL users and roles will
  never attempt to grant membership in the role that is the session user,
  so the implicit right to add or remove members will never arise.

  The security impact was mostly that a role member could revoke access
  from others, contrary to the wishes of his own grantor.  Unapproved role
  member additions are less notable, because the member can still largely
  achieve that by creating a view or a SECURITY DEFINER function.

  Reviewed by Andres Freund and Tom Lane.  Reported, independently, by
  Jonas Sundman and Noah Misch.

  Security: CVE-2014-0060
  fea164a72a7bfd50d77ba5fb418d357f8f2bb7d0:Shore up ADMIN OPTION restrictions.

  Granting a role without ADMIN OPTION is supposed to prevent the grantee
  from adding or removing members from the granted role.  Issuing SET ROLE
  before the GRANT bypassed that, because the role itself had an implicit
  right to add or remove members.  Plug that hole by recognizing that
  implicit right only when the session user matches the current role.
  Additionally, do not recognize it during a security-restricted operation
  or during execution of a SECURITY DEFINER function.  The restriction on
  SECURITY DEFINER is not security-critical.  However, it seems best for a
  user testing his own SECURITY DEFINER function to see the same behavior
  others will see.  Back-patch to 8.4 (all supported versions).

  The SQL standards do not conflate roles and users as PostgreSQL does;
  only SQL roles have members, and only SQL users initiate sessions.  An
  application using PostgreSQL users and roles as SQL users and roles will
  never attempt to grant membership in the role that is the session user,
  so the implicit right to add or remove members will never arise.

  The security impact was mostly that a role member could revoke access
  from others, contrary to the wishes of his own grantor.  Unapproved role
  member additions are less notable, because the member can still largely
  achieve that by creating a view or a SECURITY DEFINER function.

  Reviewed by Andres Freund and Tom Lane.  Reported, independently, by
  Jonas Sundman and Noah Misch.

  Security: CVE-2014-0060
impacted_packages:
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 8f979e789347d3dec15d020945a7c6e1b416f759
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 4239753338c8ef36d26615beb9b567bdd1814f73
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 15a8f97b9d16aaf659f58c981242b9da591cf24c
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 475a1fbc41a120ea3bd5f903e37c48d7a1769ff8
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 4bde115e7e5177abcee018b136716e69f90738b5
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 5d320a16ca544d6e125e962ed325463ad8bec240
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 56e55cfd265a5e675e99fb67b0d55d78e018076c
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 7b1fab3fd2e17063fb1ec98e8ff5512a6b3da9b6
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: ff35425c8f81541c8dc10486ed21ef1cfdae693e
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 789063697908d7531fc4fe9c72976ea642e68d15
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: c09f340eb35bdfcbecf4606a7fcbd6369c4bb9e0
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: fea164a72a7bfd50d77ba5fb418d357f8f2bb7d0
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/postgres/postgres/tree/15a8f97b9d16aaf659f58c981242b9da591cf24c
    reference_type: commit
    reference_id: 15a8f97b9d16aaf659f58c981242b9da591cf24c
  - url: https://github.com/postgres/postgres/tree/4239753338c8ef36d26615beb9b567bdd1814f73
    reference_type: commit
    reference_id: 4239753338c8ef36d26615beb9b567bdd1814f73
  - url: https://github.com/postgres/postgres/tree/475a1fbc41a120ea3bd5f903e37c48d7a1769ff8
    reference_type: commit
    reference_id: 475a1fbc41a120ea3bd5f903e37c48d7a1769ff8
  - url: https://github.com/postgres/postgres/tree/4bde115e7e5177abcee018b136716e69f90738b5
    reference_type: commit
    reference_id: 4bde115e7e5177abcee018b136716e69f90738b5
  - url: https://github.com/postgres/postgres/tree/56e55cfd265a5e675e99fb67b0d55d78e018076c
    reference_type: commit
    reference_id: 56e55cfd265a5e675e99fb67b0d55d78e018076c
  - url: https://github.com/postgres/postgres/tree/5d320a16ca544d6e125e962ed325463ad8bec240
    reference_type: commit
    reference_id: 5d320a16ca544d6e125e962ed325463ad8bec240
  - url: https://github.com/postgres/postgres/tree/789063697908d7531fc4fe9c72976ea642e68d15
    reference_type: commit
    reference_id: 789063697908d7531fc4fe9c72976ea642e68d15
  - url: https://github.com/postgres/postgres/tree/7b1fab3fd2e17063fb1ec98e8ff5512a6b3da9b6
    reference_type: commit
    reference_id: 7b1fab3fd2e17063fb1ec98e8ff5512a6b3da9b6
  - url: https://github.com/postgres/postgres/tree/8f979e789347d3dec15d020945a7c6e1b416f759
    reference_type: commit
    reference_id: 8f979e789347d3dec15d020945a7c6e1b416f759
  - url: https://github.com/postgres/postgres/tree/c09f340eb35bdfcbecf4606a7fcbd6369c4bb9e0
    reference_type: commit
    reference_id: c09f340eb35bdfcbecf4606a7fcbd6369c4bb9e0
  - url: https://github.com/postgres/postgres/tree/fea164a72a7bfd50d77ba5fb418d357f8f2bb7d0
    reference_type: commit
    reference_id: fea164a72a7bfd50d77ba5fb418d357f8f2bb7d0
  - url: https://github.com/postgres/postgres/tree/ff35425c8f81541c8dc10486ed21ef1cfdae693e
    reference_type: commit
    reference_id: ff35425c8f81541c8dc10486ed21ef1cfdae693e
