advisory_id: CVE-2006-2314
datasource_id: collect_postgresql_fix_commits/CVE-2006-2314
datasource_url: https://github.com/postgres/postgres
aliases: []
summary: |
  e6f43f7786bdd01c93d6bdcb429d3e724022bf1c:Modify libpq's string-escaping routines to be aware of encoding considerations
  and standard_conforming_strings.  The encoding changes are needed for proper
  escaping in multibyte encodings, as per the SQL-injection vulnerabilities
  noted in CVE-2006-2313 and CVE-2006-2314.  Concurrent fixes are being applied
  to the server to ensure that it rejects queries that may have been corrupted
  by attempted SQL injection, but this merely guarantees that unpatched clients
  will fail rather than allow injection.  An actual fix requires changing the
  client-side code.  While at it we have also fixed these routines to understand
  about standard_conforming_strings, so that the upcoming changeover to SQL-spec
  string syntax can be somewhat transparent to client code.

  Since the existing API of PQescapeString and PQescapeBytea provides no way to
  inform them which settings are in use, these functions are now deprecated in
  favor of new functions PQescapeStringConn and PQescapeByteaConn.  The new
  functions take the PGconn to which the string will be sent as an additional
  parameter, and look inside the connection structure to determine what to do.
  So as to provide some functionality for clients using the old functions,
  libpq stores the latest encoding and standard_conforming_strings values
  received from the backend in static variables, and the old functions consult
  these variables.  This will work reliably in clients using only one Postgres
  connection at a time, or even multiple connections if they all use the same
  encoding and string syntax settings; which should cover many practical
  scenarios.

  Clients that use homebrew escaping methods, such as PHP's addslashes()
  function or even hardwired regexp substitution, will require extra effort
  to fix :-(.  It is strongly recommended that such code be replaced by use of
  PQescapeStringConn/PQescapeByteaConn if at all feasible.
  96871fc236a19a4c3c74dbab81c63838e7de0c32:Modify libpq's string-escaping routines to be aware of encoding considerations
  and standard_conforming_strings.  The encoding changes are needed for proper
  escaping in multibyte encodings, as per the SQL-injection vulnerabilities
  noted in CVE-2006-2313 and CVE-2006-2314.  Concurrent fixes are being applied
  to the server to ensure that it rejects queries that may have been corrupted
  by attempted SQL injection, but this merely guarantees that unpatched clients
  will fail rather than allow injection.  An actual fix requires changing the
  client-side code.  While at it we have also fixed these routines to understand
  about standard_conforming_strings, so that the upcoming changeover to SQL-spec
  string syntax can be somewhat transparent to client code.

  Since the existing API of PQescapeString and PQescapeBytea provides no way to
  inform them which settings are in use, these functions are now deprecated in
  favor of new functions PQescapeStringConn and PQescapeByteaConn.  The new
  functions take the PGconn to which the string will be sent as an additional
  parameter, and look inside the connection structure to determine what to do.
  So as to provide some functionality for clients using the old functions,
  libpq stores the latest encoding and standard_conforming_strings values
  received from the backend in static variables, and the old functions consult
  these variables.  This will work reliably in clients using only one Postgres
  connection at a time, or even multiple connections if they all use the same
  encoding and string syntax settings; which should cover many practical
  scenarios.

  Clients that use homebrew escaping methods, such as PHP's addslashes()
  function or even hardwired regexp substitution, will require extra effort
  to fix :-(.  It is strongly recommended that such code be replaced by use of
  PQescapeStringConn/PQescapeByteaConn if at all feasible.
  94dec9114b5c3b29966223f4e9f2a0c997070e1c:Modify libpq's string-escaping routines to be aware of encoding considerations
  and standard_conforming_strings.  The encoding changes are needed for proper
  escaping in multibyte encodings, as per the SQL-injection vulnerabilities
  noted in CVE-2006-2313 and CVE-2006-2314.  Concurrent fixes are being applied
  to the server to ensure that it rejects queries that may have been corrupted
  by attempted SQL injection, but this merely guarantees that unpatched clients
  will fail rather than allow injection.  An actual fix requires changing the
  client-side code.  While at it we have also fixed these routines to understand
  about standard_conforming_strings, so that the upcoming changeover to SQL-spec
  string syntax can be somewhat transparent to client code.

  Since the existing API of PQescapeString and PQescapeBytea provides no way to
  inform them which settings are in use, these functions are now deprecated in
  favor of new functions PQescapeStringConn and PQescapeByteaConn.  The new
  functions take the PGconn to which the string will be sent as an additional
  parameter, and look inside the connection structure to determine what to do.
  So as to provide some functionality for clients using the old functions,
  libpq stores the latest encoding and standard_conforming_strings values
  received from the backend in static variables, and the old functions consult
  these variables.  This will work reliably in clients using only one Postgres
  connection at a time, or even multiple connections if they all use the same
  encoding and string syntax settings; which should cover many practical
  scenarios.

  Clients that use homebrew escaping methods, such as PHP's addslashes()
  function or even hardwired regexp substitution, will require extra effort
  to fix :-(.  It is strongly recommended that such code be replaced by use of
  PQescapeStringConn/PQescapeByteaConn if at all feasible.
  7f615cab574dc5d93a39a43d9b720c17f19f63e1:Modify libpq's string-escaping routines to be aware of encoding considerations
  and standard_conforming_strings.  The encoding changes are needed for proper
  escaping in multibyte encodings, as per the SQL-injection vulnerabilities
  noted in CVE-2006-2313 and CVE-2006-2314.  Concurrent fixes are being applied
  to the server to ensure that it rejects queries that may have been corrupted
  by attempted SQL injection, but this merely guarantees that unpatched clients
  will fail rather than allow injection.  An actual fix requires changing the
  client-side code.  While at it we have also fixed these routines to understand
  about standard_conforming_strings, so that the upcoming changeover to SQL-spec
  string syntax can be somewhat transparent to client code.

  Since the existing API of PQescapeString and PQescapeBytea provides no way to
  inform them which settings are in use, these functions are now deprecated in
  favor of new functions PQescapeStringConn and PQescapeByteaConn.  The new
  functions take the PGconn to which the string will be sent as an additional
  parameter, and look inside the connection structure to determine what to do.
  So as to provide some functionality for clients using the old functions,
  libpq stores the latest encoding and standard_conforming_strings values
  received from the backend in static variables, and the old functions consult
  these variables.  This will work reliably in clients using only one Postgres
  connection at a time, or even multiple connections if they all use the same
  encoding and string syntax settings; which should cover many practical
  scenarios.

  Clients that use homebrew escaping methods, such as PHP's addslashes()
  function or even hardwired regexp substitution, will require extra effort
  to fix :-(.  It is strongly recommended that such code be replaced by use of
  PQescapeStringConn/PQescapeByteaConn if at all feasible.
  515112f9d4874aaedd0c093f41c0ba3e0bf7f660:Modify libpq's string-escaping routines to be aware of encoding considerations
  and standard_conforming_strings.  The encoding changes are needed for proper
  escaping in multibyte encodings, as per the SQL-injection vulnerabilities
  noted in CVE-2006-2313 and CVE-2006-2314.  Concurrent fixes are being applied
  to the server to ensure that it rejects queries that may have been corrupted
  by attempted SQL injection, but this merely guarantees that unpatched clients
  will fail rather than allow injection.  An actual fix requires changing the
  client-side code.  While at it we have also fixed these routines to understand
  about standard_conforming_strings, so that the upcoming changeover to SQL-spec
  string syntax can be somewhat transparent to client code.

  Since the existing API of PQescapeString and PQescapeBytea provides no way to
  inform them which settings are in use, these functions are now deprecated in
  favor of new functions PQescapeStringConn and PQescapeByteaConn.  The new
  functions take the PGconn to which the string will be sent as an additional
  parameter, and look inside the connection structure to determine what to do.
  So as to provide some functionality for clients using the old functions,
  libpq stores the latest encoding and standard_conforming_strings values
  received from the backend in static variables, and the old functions consult
  these variables.  This will work reliably in clients using only one Postgres
  connection at a time, or even multiple connections if they all use the same
  encoding and string syntax settings; which should cover many practical
  scenarios.

  Clients that use homebrew escaping methods, such as PHP's addslashes()
  function or even hardwired regexp substitution, will require extra effort
  to fix :-(.  It is strongly recommended that such code be replaced by use of
  PQescapeStringConn/PQescapeByteaConn if at all feasible.
  16e77740ea9e7f585393e4c5e20495f5ebce8d88:Add a new GUC parameter backslash_quote, which determines whether the SQL
  parser will allow "\'" to be used to represent a literal quote mark.  The
  "\'" representation has been deprecated for some time in favor of the
  SQL-standard representation "''" (two single quote marks), but it has been
  used often enough that just disallowing it immediately won't do.  Hence
  backslash_quote allows the settings "on", "off", and "safe_encoding",
  the last meaning to allow "\'" only if client_encoding is a valid server
  encoding.  That is now the default, and the reason is that in encodings
  such as SJIS that allow 0x5c (ASCII backslash) to be the last byte of a
  multibyte character, accepting "\'" allows SQL-injection attacks as per
  CVE-2006-2314 (further details will be published after release).  The
  "on" setting is available for backward compatibility, but it must not be
  used with clients that are exposed to untrusted input.

  Thanks to Akio Ishida and Yasuo Ohgaki for identifying this security issue.
  2e319b0e40e19561ca67946bc68948426bf7e1d9:Add a new GUC parameter backslash_quote, which determines whether the SQL
  parser will allow "\'" to be used to represent a literal quote mark.  The
  "\'" representation has been deprecated for some time in favor of the
  SQL-standard representation "''" (two single quote marks), but it has been
  used often enough that just disallowing it immediately won't do.  Hence
  backslash_quote allows the settings "on", "off", and "safe_encoding",
  the last meaning to allow "\'" only if client_encoding is a valid server
  encoding.  That is now the default, and the reason is that in encodings
  such as SJIS that allow 0x5c (ASCII backslash) to be the last byte of a
  multibyte character, accepting "\'" allows SQL-injection attacks as per
  CVE-2006-2314 (further details will be published after release).  The
  "on" setting is available for backward compatibility, but it must not be
  used with clients that are exposed to untrusted input.

  Thanks to Akio Ishida and Yasuo Ohgaki for identifying this security issue.
  9bc62ddd5f0581998730d763390f5412fba8336b:Add a new GUC parameter backslash_quote, which determines whether the SQL
  parser will allow "\'" to be used to represent a literal quote mark.  The
  "\'" representation has been deprecated for some time in favor of the
  SQL-standard representation "''" (two single quote marks), but it has been
  used often enough that just disallowing it immediately won't do.  Hence
  backslash_quote allows the settings "on", "off", and "safe_encoding",
  the last meaning to allow "\'" only if client_encoding is a valid server
  encoding.  That is now the default, and the reason is that in encodings
  such as SJIS that allow 0x5c (ASCII backslash) to be the last byte of a
  multibyte character, accepting "\'" allows SQL-injection attacks as per
  CVE-2006-2314 (further details will be published after release).  The
  "on" setting is available for backward compatibility, but it must not be
  used with clients that are exposed to untrusted input.

  Thanks to Akio Ishida and Yasuo Ohgaki for identifying this security issue.
  3d4dc1acf5047c2067c411e3403c27c5c41f45cf:Add a new GUC parameter backslash_quote, which determines whether the SQL
  parser will allow "\'" to be used to represent a literal quote mark.  The
  "\'" representation has been deprecated for some time in favor of the
  SQL-standard representation "''" (two single quote marks), but it has been
  used often enough that just disallowing it immediately won't do.  Hence
  backslash_quote allows the settings "on", "off", and "safe_encoding",
  the last meaning to allow "\'" only if client_encoding is a valid server
  encoding.  That is now the default, and the reason is that in encodings
  such as SJIS that allow 0x5c (ASCII backslash) to be the last byte of a
  multibyte character, accepting "\'" allows SQL-injection attacks as per
  CVE-2006-2314 (further details will be published after release).  The
  "on" setting is available for backward compatibility, but it must not be
  used with clients that are exposed to untrusted input.

  Thanks to Akio Ishida and Yasuo Ohgaki for identifying this security issue.
  b3eb4ea5d8c35ba9ec890b0f51d04c0b62d53a03:Add a new GUC parameter backslash_quote, which determines whether the SQL
  parser will allow "\'" to be used to represent a literal quote mark.  The
  "\'" representation has been deprecated for some time in favor of the
  SQL-standard representation "''" (two single quote marks), but it has been
  used often enough that just disallowing it immediately won't do.  Hence
  backslash_quote allows the settings "on", "off", and "safe_encoding",
  the last meaning to allow "\'" only if client_encoding is a valid server
  encoding.  That is now the default, and the reason is that in encodings
  such as SJIS that allow 0x5c (ASCII backslash) to be the last byte of a
  multibyte character, accepting "\'" allows SQL-injection attacks as per
  CVE-2006-2314 (further details will be published after release).  The
  "on" setting is available for backward compatibility, but it must not be
  used with clients that are exposed to untrusted input.

  Thanks to Akio Ishida and Yasuo Ohgaki for identifying this security issue.
impacted_packages:
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: b3eb4ea5d8c35ba9ec890b0f51d04c0b62d53a03
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 16e77740ea9e7f585393e4c5e20495f5ebce8d88
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 3d4dc1acf5047c2067c411e3403c27c5c41f45cf
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 7f615cab574dc5d93a39a43d9b720c17f19f63e1
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: e6f43f7786bdd01c93d6bdcb429d3e724022bf1c
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 9bc62ddd5f0581998730d763390f5412fba8336b
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 2e319b0e40e19561ca67946bc68948426bf7e1d9
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 94dec9114b5c3b29966223f4e9f2a0c997070e1c
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 515112f9d4874aaedd0c093f41c0ba3e0bf7f660
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 96871fc236a19a4c3c74dbab81c63838e7de0c32
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/postgres/postgres/tree/16e77740ea9e7f585393e4c5e20495f5ebce8d88
    reference_type: commit
    reference_id: 16e77740ea9e7f585393e4c5e20495f5ebce8d88
  - url: https://github.com/postgres/postgres/tree/2e319b0e40e19561ca67946bc68948426bf7e1d9
    reference_type: commit
    reference_id: 2e319b0e40e19561ca67946bc68948426bf7e1d9
  - url: https://github.com/postgres/postgres/tree/3d4dc1acf5047c2067c411e3403c27c5c41f45cf
    reference_type: commit
    reference_id: 3d4dc1acf5047c2067c411e3403c27c5c41f45cf
  - url: https://github.com/postgres/postgres/tree/515112f9d4874aaedd0c093f41c0ba3e0bf7f660
    reference_type: commit
    reference_id: 515112f9d4874aaedd0c093f41c0ba3e0bf7f660
  - url: https://github.com/postgres/postgres/tree/7f615cab574dc5d93a39a43d9b720c17f19f63e1
    reference_type: commit
    reference_id: 7f615cab574dc5d93a39a43d9b720c17f19f63e1
  - url: https://github.com/postgres/postgres/tree/94dec9114b5c3b29966223f4e9f2a0c997070e1c
    reference_type: commit
    reference_id: 94dec9114b5c3b29966223f4e9f2a0c997070e1c
  - url: https://github.com/postgres/postgres/tree/96871fc236a19a4c3c74dbab81c63838e7de0c32
    reference_type: commit
    reference_id: 96871fc236a19a4c3c74dbab81c63838e7de0c32
  - url: https://github.com/postgres/postgres/tree/9bc62ddd5f0581998730d763390f5412fba8336b
    reference_type: commit
    reference_id: 9bc62ddd5f0581998730d763390f5412fba8336b
  - url: https://github.com/postgres/postgres/tree/b3eb4ea5d8c35ba9ec890b0f51d04c0b62d53a03
    reference_type: commit
    reference_id: b3eb4ea5d8c35ba9ec890b0f51d04c0b62d53a03
  - url: https://github.com/postgres/postgres/tree/e6f43f7786bdd01c93d6bdcb429d3e724022bf1c
    reference_type: commit
    reference_id: e6f43f7786bdd01c93d6bdcb429d3e724022bf1c
