advisory_id: CVE-2025-4207
datasource_id: collect_postgresql_fix_commits/CVE-2025-4207
datasource_url: https://github.com/postgres/postgres
aliases: []
summary: |
  5dff5ce8636660772f23493918e69af91c820321:Last-minute updates for release notes.

  Security: CVE-2025-4207
  d9cee6a5f2ad73e1c13b619fdc2d42961079dbc3:Last-minute updates for release notes.

  Security: CVE-2025-4207
  4b6f246b6791904b16d277138800a3f8a4ece847:Last-minute updates for release notes.

  Security: CVE-2025-4207
  ce12d66ce731a863abb489dfb9b3f01a4537ee73:Last-minute updates for release notes.

  Security: CVE-2025-4207
  ecbe349e9128b678311a2b8e328cbe258d7807ed:Last-minute updates for release notes.

  Security: CVE-2025-4207
  cbadeaca9271a1bade8ef9790bae09dc92e0ed30:With GB18030, prevent SIGSEGV from reading past end of allocation.

  With GB18030 as source encoding, applications could crash the server via
  SQL functions convert() or convert_from().  Applications themselves
  could crash after passing unterminated GB18030 input to libpq functions
  PQescapeLiteral(), PQescapeIdentifier(), PQescapeStringConn(), or
  PQescapeString().  Extension code could crash by passing unterminated
  GB18030 input to jsonapi.h functions.  All those functions have been
  intended to handle untrusted, unterminated input safely.

  A crash required allocating the input such that the last byte of the
  allocation was the last byte of a virtual memory page.  Some malloc()
  implementations take measures against that, making the SIGSEGV hard to
  reach.  Back-patch to v13 (all supported versions).

  Author: Noah Misch <noah@leadboat.com>
  Author: Andres Freund <andres@anarazel.de>
  Reviewed-by: Masahiko Sawada <sawada.mshk@gmail.com>
  Backpatch-through: 13
  Security: CVE-2025-4207
  3f2ab73934ab1e27151ecd14fd7d8ef602555093:With GB18030, prevent SIGSEGV from reading past end of allocation.

  With GB18030 as source encoding, applications could crash the server via
  SQL functions convert() or convert_from().  Applications themselves
  could crash after passing unterminated GB18030 input to libpq functions
  PQescapeLiteral(), PQescapeIdentifier(), PQescapeStringConn(), or
  PQescapeString().  Extension code could crash by passing unterminated
  GB18030 input to jsonapi.h functions.  All those functions have been
  intended to handle untrusted, unterminated input safely.

  A crash required allocating the input such that the last byte of the
  allocation was the last byte of a virtual memory page.  Some malloc()
  implementations take measures against that, making the SIGSEGV hard to
  reach.  Back-patch to v13 (all supported versions).

  Author: Noah Misch <noah@leadboat.com>
  Author: Andres Freund <andres@anarazel.de>
  Reviewed-by: Masahiko Sawada <sawada.mshk@gmail.com>
  Backpatch-through: 13
  Security: CVE-2025-4207
  44ba3f55f552b56b2fbefae028fcf3ea5b53461d:With GB18030, prevent SIGSEGV from reading past end of allocation.

  With GB18030 as source encoding, applications could crash the server via
  SQL functions convert() or convert_from().  Applications themselves
  could crash after passing unterminated GB18030 input to libpq functions
  PQescapeLiteral(), PQescapeIdentifier(), PQescapeStringConn(), or
  PQescapeString().  Extension code could crash by passing unterminated
  GB18030 input to jsonapi.h functions.  All those functions have been
  intended to handle untrusted, unterminated input safely.

  A crash required allocating the input such that the last byte of the
  allocation was the last byte of a virtual memory page.  Some malloc()
  implementations take measures against that, making the SIGSEGV hard to
  reach.  Back-patch to v13 (all supported versions).

  Author: Noah Misch <noah@leadboat.com>
  Author: Andres Freund <andres@anarazel.de>
  Reviewed-by: Masahiko Sawada <sawada.mshk@gmail.com>
  Backpatch-through: 13
  Security: CVE-2025-4207
  7279e58205813305fc09d2cc9977731c05014b84:Refactor test_escape.c for additional ways of testing.

  Start the file with static functions not specific to pe_test_vectors
  tests.  This way, new tests can use them without disrupting the file's
  layout.  Change report_result() PQExpBuffer arguments to plain strings.
  Back-patch to v13 (all supported versions), for the next commit.

  Reviewed-by: Masahiko Sawada <sawada.mshk@gmail.com>
  Backpatch-through: 13
  Security: CVE-2025-4207
  258cde839d902ad9dd41cbd7ab58ebf4ba086874:Refactor test_escape.c for additional ways of testing.

  Start the file with static functions not specific to pe_test_vectors
  tests.  This way, new tests can use them without disrupting the file's
  layout.  Change report_result() PQExpBuffer arguments to plain strings.
  Back-patch to v13 (all supported versions), for the next commit.

  Reviewed-by: Masahiko Sawada <sawada.mshk@gmail.com>
  Backpatch-through: 13
  Security: CVE-2025-4207
  45fe7e08f00ae90904da0a404159db08e1e7390b:Refactor test_escape.c for additional ways of testing.

  Start the file with static functions not specific to pe_test_vectors
  tests.  This way, new tests can use them without disrupting the file's
  layout.  Change report_result() PQExpBuffer arguments to plain strings.
  Back-patch to v13 (all supported versions), for the next commit.

  Reviewed-by: Masahiko Sawada <sawada.mshk@gmail.com>
  Backpatch-through: 13
  Security: CVE-2025-4207
  d1264948fccef7a7eac549b78d327f4d1640e946:With GB18030, prevent SIGSEGV from reading past end of allocation.

  With GB18030 as source encoding, applications could crash the server via
  SQL functions convert() or convert_from().  Applications themselves
  could crash after passing unterminated GB18030 input to libpq functions
  PQescapeLiteral(), PQescapeIdentifier(), PQescapeStringConn(), or
  PQescapeString().  Extension code could crash by passing unterminated
  GB18030 input to jsonapi.h functions.  All those functions have been
  intended to handle untrusted, unterminated input safely.

  A crash required allocating the input such that the last byte of the
  allocation was the last byte of a virtual memory page.  Some malloc()
  implementations take measures against that, making the SIGSEGV hard to
  reach.  Back-patch to v13 (all supported versions).

  Author: Noah Misch <noah@leadboat.com>
  Author: Andres Freund <andres@anarazel.de>
  Reviewed-by: Masahiko Sawada <sawada.mshk@gmail.com>
  Backpatch-through: 13
  Security: CVE-2025-4207
  ec5f89e8a29f32c7dbc4dd8734ed8406d771de2f:With GB18030, prevent SIGSEGV from reading past end of allocation.

  With GB18030 as source encoding, applications could crash the server via
  SQL functions convert() or convert_from().  Applications themselves
  could crash after passing unterminated GB18030 input to libpq functions
  PQescapeLiteral(), PQescapeIdentifier(), PQescapeStringConn(), or
  PQescapeString().  Extension code could crash by passing unterminated
  GB18030 input to jsonapi.h functions.  All those functions have been
  intended to handle untrusted, unterminated input safely.

  A crash required allocating the input such that the last byte of the
  allocation was the last byte of a virtual memory page.  Some malloc()
  implementations take measures against that, making the SIGSEGV hard to
  reach.  Back-patch to v13 (all supported versions).

  Author: Noah Misch <noah@leadboat.com>
  Author: Andres Freund <andres@anarazel.de>
  Reviewed-by: Masahiko Sawada <sawada.mshk@gmail.com>
  Backpatch-through: 13
  Security: CVE-2025-4207
  f3bb0b2c4a1a09efa18a76a153269d24980163d4:Refactor test_escape.c for additional ways of testing.

  Start the file with static functions not specific to pe_test_vectors
  tests.  This way, new tests can use them without disrupting the file's
  layout.  Change report_result() PQExpBuffer arguments to plain strings.
  Back-patch to v13 (all supported versions), for the next commit.

  Reviewed-by: Masahiko Sawada <sawada.mshk@gmail.com>
  Backpatch-through: 13
  Security: CVE-2025-4207
  617d34908b5dd1a7a643e82af871fa5b69a37491:Refactor test_escape.c for additional ways of testing.

  Start the file with static functions not specific to pe_test_vectors
  tests.  This way, new tests can use them without disrupting the file's
  layout.  Change report_result() PQExpBuffer arguments to plain strings.
  Back-patch to v13 (all supported versions), for the next commit.

  Reviewed-by: Masahiko Sawada <sawada.mshk@gmail.com>
  Backpatch-through: 13
  Security: CVE-2025-4207
  627acc3caa74caa736b2c5587e944d2ea510ea67:With GB18030, prevent SIGSEGV from reading past end of allocation.

  With GB18030 as source encoding, applications could crash the server via
  SQL functions convert() or convert_from().  Applications themselves
  could crash after passing unterminated GB18030 input to libpq functions
  PQescapeLiteral(), PQescapeIdentifier(), PQescapeStringConn(), or
  PQescapeString().  Extension code could crash by passing unterminated
  GB18030 input to jsonapi.h functions.  All those functions have been
  intended to handle untrusted, unterminated input safely.

  A crash required allocating the input such that the last byte of the
  allocation was the last byte of a virtual memory page.  Some malloc()
  implementations take measures against that, making the SIGSEGV hard to
  reach.  Back-patch to v13 (all supported versions).

  Author: Noah Misch <noah@leadboat.com>
  Author: Andres Freund <andres@anarazel.de>
  Reviewed-by: Masahiko Sawada <sawada.mshk@gmail.com>
  Backpatch-through: 13
  Security: CVE-2025-4207
  5be213caaa1a9a65dfdbbf400b6a53b5e743b8d1:Refactor test_escape.c for additional ways of testing.

  Start the file with static functions not specific to pe_test_vectors
  tests.  This way, new tests can use them without disrupting the file's
  layout.  Change report_result() PQExpBuffer arguments to plain strings.
  Back-patch to v13 (all supported versions), for the next commit.

  Reviewed-by: Masahiko Sawada <sawada.mshk@gmail.com>
  Backpatch-through: 13
  Security: CVE-2025-4207
impacted_packages:
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 3f2ab73934ab1e27151ecd14fd7d8ef602555093
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 7279e58205813305fc09d2cc9977731c05014b84
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 45fe7e08f00ae90904da0a404159db08e1e7390b
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: ecbe349e9128b678311a2b8e328cbe258d7807ed
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 4b6f246b6791904b16d277138800a3f8a4ece847
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: ce12d66ce731a863abb489dfb9b3f01a4537ee73
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: f3bb0b2c4a1a09efa18a76a153269d24980163d4
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 627acc3caa74caa736b2c5587e944d2ea510ea67
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 44ba3f55f552b56b2fbefae028fcf3ea5b53461d
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 258cde839d902ad9dd41cbd7ab58ebf4ba086874
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: ec5f89e8a29f32c7dbc4dd8734ed8406d771de2f
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: cbadeaca9271a1bade8ef9790bae09dc92e0ed30
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 5dff5ce8636660772f23493918e69af91c820321
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 617d34908b5dd1a7a643e82af871fa5b69a37491
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: d1264948fccef7a7eac549b78d327f4d1640e946
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: 5be213caaa1a9a65dfdbbf400b6a53b5e743b8d1
    introduced_in_commits: []
  - purl: pkg:github/postgres/postgres
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/postgres/postgres
        commit: d9cee6a5f2ad73e1c13b619fdc2d42961079dbc3
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/postgres/postgres/tree/258cde839d902ad9dd41cbd7ab58ebf4ba086874
    reference_type: commit
    reference_id: 258cde839d902ad9dd41cbd7ab58ebf4ba086874
  - url: https://github.com/postgres/postgres/tree/3f2ab73934ab1e27151ecd14fd7d8ef602555093
    reference_type: commit
    reference_id: 3f2ab73934ab1e27151ecd14fd7d8ef602555093
  - url: https://github.com/postgres/postgres/tree/44ba3f55f552b56b2fbefae028fcf3ea5b53461d
    reference_type: commit
    reference_id: 44ba3f55f552b56b2fbefae028fcf3ea5b53461d
  - url: https://github.com/postgres/postgres/tree/45fe7e08f00ae90904da0a404159db08e1e7390b
    reference_type: commit
    reference_id: 45fe7e08f00ae90904da0a404159db08e1e7390b
  - url: https://github.com/postgres/postgres/tree/4b6f246b6791904b16d277138800a3f8a4ece847
    reference_type: commit
    reference_id: 4b6f246b6791904b16d277138800a3f8a4ece847
  - url: https://github.com/postgres/postgres/tree/5be213caaa1a9a65dfdbbf400b6a53b5e743b8d1
    reference_type: commit
    reference_id: 5be213caaa1a9a65dfdbbf400b6a53b5e743b8d1
  - url: https://github.com/postgres/postgres/tree/5dff5ce8636660772f23493918e69af91c820321
    reference_type: commit
    reference_id: 5dff5ce8636660772f23493918e69af91c820321
  - url: https://github.com/postgres/postgres/tree/617d34908b5dd1a7a643e82af871fa5b69a37491
    reference_type: commit
    reference_id: 617d34908b5dd1a7a643e82af871fa5b69a37491
  - url: https://github.com/postgres/postgres/tree/627acc3caa74caa736b2c5587e944d2ea510ea67
    reference_type: commit
    reference_id: 627acc3caa74caa736b2c5587e944d2ea510ea67
  - url: https://github.com/postgres/postgres/tree/7279e58205813305fc09d2cc9977731c05014b84
    reference_type: commit
    reference_id: 7279e58205813305fc09d2cc9977731c05014b84
  - url: https://github.com/postgres/postgres/tree/cbadeaca9271a1bade8ef9790bae09dc92e0ed30
    reference_type: commit
    reference_id: cbadeaca9271a1bade8ef9790bae09dc92e0ed30
  - url: https://github.com/postgres/postgres/tree/ce12d66ce731a863abb489dfb9b3f01a4537ee73
    reference_type: commit
    reference_id: ce12d66ce731a863abb489dfb9b3f01a4537ee73
  - url: https://github.com/postgres/postgres/tree/d1264948fccef7a7eac549b78d327f4d1640e946
    reference_type: commit
    reference_id: d1264948fccef7a7eac549b78d327f4d1640e946
  - url: https://github.com/postgres/postgres/tree/d9cee6a5f2ad73e1c13b619fdc2d42961079dbc3
    reference_type: commit
    reference_id: d9cee6a5f2ad73e1c13b619fdc2d42961079dbc3
  - url: https://github.com/postgres/postgres/tree/ec5f89e8a29f32c7dbc4dd8734ed8406d771de2f
    reference_type: commit
    reference_id: ec5f89e8a29f32c7dbc4dd8734ed8406d771de2f
  - url: https://github.com/postgres/postgres/tree/ecbe349e9128b678311a2b8e328cbe258d7807ed
    reference_type: commit
    reference_id: ecbe349e9128b678311a2b8e328cbe258d7807ed
  - url: https://github.com/postgres/postgres/tree/f3bb0b2c4a1a09efa18a76a153269d24980163d4
    reference_type: commit
    reference_id: f3bb0b2c4a1a09efa18a76a153269d24980163d4
