advisory_id: mfsa2009-19
datasource_id: mozilla_importer_v2/mfsa2009-19
datasource_url: https://github.com/mozilla/foundation-security-advisories/blob/master/announce/2009/mfsa2009-19.md
aliases: []
summary: |
  Mozilla security researcher moz_bug_r_a4 reported
  that it is possible to create a document whose URI does not match the
  document's principal using XMLHttpRequest.  This type of
  mismatch leads to incorrect results in principal-based security
  checks.  An attacker could use this vulnerability to execute arbitrary
  JavaScript within the context of another site.
  moz_bug_r_a4 separately reported
  that XPCNativeWrapper.toString's
  __proto__ comes from the wrong scope which results in
  calls to that function being executed in the wrong context in certain
  circumstances.  An attacker could use this vulnerability to run
  arbitrary code within the context of a different site.  Alternatively,
  if chrome were to call content.toString.call(), then
  attacker-defined functions could be run with chrome privileges.
  Thunderbird shares the browser engine with Firefox and
  could be vulnerable if JavaScript were to be enabled in mail. This is
  not the default setting and we strongly discourage users from running
  JavaScript in mail.
impacted_packages:
  - purl: pkg:mozilla/Firefox
    affected_versions:
    fixed_versions: vers:generic/3.0.9
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: high
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://www.mozilla.org/en-US/security/advisories/mfsa2009-19
weaknesses: []
references:
  - url: https://www.mozilla.org/en-US/security/advisories/mfsa2009-19
    reference_type:
    reference_id:
