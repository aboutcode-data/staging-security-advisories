advisory_id: mfsa2007-07
datasource_id: mozilla_importer_v2/mfsa2007-07
datasource_url: https://github.com/mozilla/foundation-security-advisories/blob/master/announce/2007/mfsa2007-07.md
aliases: []
summary: |
  Michal Zalewski demonstrated that setting location.hostname
  to a value with embedded null characters can confuse the browsers domain
  checks. Setting the value triggers a load, but the networking software reads
  the hostname only up to the null character while other checks for "parent
  domain" start at the right and so can have a completely different idea of what
  the current host is.
  This cannot be used for a direct same-origin violation to perform cross-site
  scripting: those checks are performed on the complete hostname including
  the nulls. However, other mechanisms rely on matching parent domains and those
  can be fooled by this trick. For example, this flaw allows a malicious page
  to set domain cookies for any arbitrary site, which might be useful in a
  session-fixation attack. This also allows setting document.domain to any
  arbitrary value which could be used to perform a cross-site scripting
  attack against any page which also sets document.domain.
impacted_packages:
  - purl: pkg:mozilla/SeaMonkey
    affected_versions:
    fixed_versions: vers:generic/1.0.8
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: high
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://www.mozilla.org/en-US/security/advisories/mfsa2007-07
weaknesses: []
references:
  - url: https://www.mozilla.org/en-US/security/advisories/mfsa2007-07
    reference_type:
    reference_id:
