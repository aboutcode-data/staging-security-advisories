advisory_id: mfsa2005-48
datasource_id: mozilla_importer_v2/mfsa2005-48
datasource_url: https://github.com/mozilla/foundation-security-advisories/blob/master/announce/2005/mfsa2005-48.md
aliases: []
summary: "The InstallTrigger.install() method for launching an install \naccepts a callback\
  \ function that will be called with the final success \nor error status. By forcing a page\
  \ navigation immediately after \ncalling the install method this callback function can end\
  \ up running \nin the context of the new page selected by the attacker. This is true \neven\
  \ if the user cancels the unwanted install dialog: cancel is an \nerror status. This callback\
  \ script can steal data from the new page such \nas cookies or passwords, or perform actions\
  \ on the user's behalf such \nas make a purchase if the user is already logged into the target\
  \ site.\nIn Firefox the default settings allow only http://addons.mozilla.org to\nbring up\
  \ this install dialog. This could only be exploited if users have\nadded questionable sites\
  \ to the install whitelist, and if a malicious site\ncan convince you to install from their\
  \ site that's a much more powerful\nattack vector.\nIn the Mozilla Suite the whitelist feature\
  \ is turned off by default, any site\ncan prompt the user to install software and exploit\
  \ this vulnerability.\nThe browser has been fixed to clear any pending callback function when\
  \ switching\nto a new site."
impacted_packages:
  - purl: pkg:mozilla/Firefox
    affected_versions:
    fixed_versions: vers:generic/1.0.5
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:mozilla/Mozilla%20Suite
    affected_versions:
    fixed_versions: vers:generic/1.7.10
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: high
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://www.mozilla.org/en-US/security/advisories/mfsa2005-48
weaknesses: []
references:
  - url: https://www.mozilla.org/en-US/security/advisories/mfsa2005-48
    reference_type:
    reference_id:
