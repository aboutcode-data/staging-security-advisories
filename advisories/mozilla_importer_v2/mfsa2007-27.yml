advisory_id: mfsa2007-27
datasource_id: mozilla_importer_v2/mfsa2007-27
datasource_url: https://github.com/mozilla/foundation-security-advisories/blob/master/announce/2007/mfsa2007-27.md
aliases: []
summary: |
  Jesper Johansson pointed out that Mozilla did not
  percent-encode spaces and double-quotes in URIs handed off to external
  programs for handling, which can cause the receiving program to
  mistakenly interpret a single URI as multiple arguments. The danger
  depends on the arguments supported by the specific receiving program,
  though at the very least we know Firefox (and Thunderbird) 2.0.0.4 and
  older could be used to run arbitrary script (see
  MFSA 2007-23). The vast majority of programs
  do not have dangerous arguments, though many could still be made to do
  something unexpected.
  A similar issue with URIs passed to external handlers was reported by
  Billy Rios and Nate McFeters. When running
  Firefox on Windows XP with IE7 installed, URIs for certain
  common protocols (such as mailto:) that contain a %00 do not
  launch the protocol handler registered for that scheme but instead launch
  a file handling program based on the file extension at the end of the URI.
  Coupled with the issue reported by Jesper Johansson this appears to allow
  execution of any program installed at a known location and limited argument
  passing that might be enough to exploit a system.
  Further investigation by Secunia showed that a % not
  followed by a valid two-digit hexadecimal number also triggered the problem
  for the affected protocols. The Firefox and Thunderbird 2.0.0.6 releases
  contain fixes that prevent the original demonstrations of this variant, but
  it is still possible to launch a filetype handler based on extension rather
  than the registered protocol handler. A way to exploit a common handler with
  a single unexpected URI as an argument may yet be found. Since this handling
  is a property of the Windows Shell API this variant appears to affect other
  internet-enabled applications that pass these URIs to the Windows Shell.
impacted_packages:
  - purl: pkg:mozilla/SeaMonkey
    affected_versions:
    fixed_versions: vers:generic/1.1.4
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: critical
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://www.mozilla.org/en-US/security/advisories/mfsa2007-27
weaknesses: []
references:
  - url: https://www.mozilla.org/en-US/security/advisories/mfsa2007-27
    reference_type:
    reference_id:
