advisory_id: mfsa2011-43
datasource_id: mozilla_importer_v2/mfsa2011-43
datasource_url: https://github.com/mozilla/foundation-security-advisories/blob/master/announce/2011/mfsa2011-43.md
aliases: []
summary: |
  David Rees reported that the JSSubScriptLoader (a
  feature used by some add-ons) was "unwrapping" XPCNativeWrappers when they
  were used as the scope parameter to loadSubScript(). Without
  the protection of the wrappers the add-on could be vulnerable to privilege
  escalation attacks from malicious web content. Whether any given add-on
  were vulnerable would depend on how the add-on used the feature
  and whether it interacted directly with web content, but we did find
  at least one vulnerable add-on and presume there are more.

  The unwrapping behavior was a change introduced during Firefox 4
  development.  Firefox 3.6 and earlier versions are not affected.
impacted_packages:
  - purl: pkg:mozilla/Firefox
    affected_versions:
    fixed_versions: vers:generic/7.0.0
    fixed_in_commits: []
    introduced_in_commits: []
  - purl: pkg:mozilla/SeaMonkey
    affected_versions:
    fixed_versions: vers:generic/2.4.0
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: critical
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://www.mozilla.org/en-US/security/advisories/mfsa2011-43
weaknesses: []
references:
  - url: https://www.mozilla.org/en-US/security/advisories/mfsa2011-43
    reference_type:
    reference_id:
