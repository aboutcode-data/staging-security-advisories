advisory_id: mfsa2007-39
datasource_id: mozilla_importer_v2/mfsa2007-39
datasource_url: https://github.com/mozilla/foundation-security-advisories/blob/master/announce/2007/mfsa2007-39.md
aliases: []
summary: |
  Gregory Fleischer demonstrated that it was possible
  to generate a fake HTTP Referer header by exploiting a timing
  condition when setting the window.location property. This could
  be used to conduct a Cross-site Request Forgery (CSRF) attack against
  websites that rely only on the Referer header as protection against
  such attacks.

  When navigation occurs due to setting window.location
  the Referer header is supposed to reflect the address of the content which
  initiated the script. Instead, the referer was set to the address of the
  window (or frame) in which the script was running, and this vulnerability
  arises from that tiny difference. Using a modal alert()
  dialog Fleischer was able to suspend the attack script so that it did not
  load the target URI until after the attacker's initial content had been
  replaced by the intended referring page. When the Referer is set to the
  current URI of the script's window it is no longer the correct one.
impacted_packages:
  - purl: pkg:mozilla/SeaMonkey
    affected_versions:
    fixed_versions: vers:generic/1.1.7
    fixed_in_commits: []
    introduced_in_commits: []
severities:
  - score: high
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://www.mozilla.org/en-US/security/advisories/mfsa2007-39
weaknesses: []
references:
  - url: https://www.mozilla.org/en-US/security/advisories/mfsa2007-39
    reference_type:
    reference_id:
