advisory_id: CVE-2006-2451
datasource_id: collect_wireshark_fix_commits/CVE-2006-2451
datasource_url: https://gitlab.com/wireshark/wireshark
aliases: []
summary: |
  92d1e1f4f78e35f1c523d6c3fa7bf6d94d7602a5:dumpcap: LeakSanitizer issues

  If AddressSanitizer is enabled, we build dumpcap with it, which
  can be useful for catching issues - at least when run standalone.
  Disable it when running in capture child mode, and ensure that the
  sanitizers don't change dumpcap's exit code, since capture/capture_sync
  uses the exitcode value and doesn't expect the sanitizer values.

  Also disable LSan if prctl(PR_GET_DUMPABLE) is 2 on Linux, since
  that means that the process will fail to run LSan and die with a
  fatal error in the attempt due to not being able to ptrace. It
  cannot be disabled through the normal method of using environment
  variables since not being dumpable also means that /proc/self/environ
  isn't readable. (LSan is able to deal with a dumpable value of 0,
  temporarily setting it to 1, but not 2, because it's not allowed to
  set it back to 2, due to CVE-2006-2451.)

  Fix #18907
impacted_packages:
  - purl: pkg:gitlab/wireshark/wireshark
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/wireshark/wireshark
        commit: 92d1e1f4f78e35f1c523d6c3fa7bf6d94d7602a5
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://gitlab.com/wireshark/wireshark
    reference_type: commit
    reference_id: 3fa8b2e13086d81270f27993512635854e71df9a
