advisory_id: CVE-2017-5753
datasource_id: collect_wireshark_fix_commits/CVE-2017-5753
datasource_url: https://gitlab.com/wireshark/wireshark
aliases: []
summary: |
  b4af4e93a8e18e568114ce5181da85ec48be3cef:Do not automatically enable the linux kernel's BPF JIT compiler

  The default value of kernel.unprivileged_bpf_disabled is 0 which means
  this is enabling the BPF JIT compiler for unprivileged users. Given that
  this is a known attack vector for Spectre variant 1 (CVE-2017-5753) this
  is not a setting that a utility should be tampering with.

  Tshark's and dumpcap's help message is changed by Balint Reczey to suggest
  enabling BPF manually after considering security-related implications.

  Change-Id: I1cc34cbd6e84485eba9dee79a8700aa388354885
  Signed-off-by: Balint Reczey <balint.reczey@canonical.com>
  Bug: 14313
  (cherry picked from commit 51e0d22ec6db124abca69a1cc35905c9342c884a)
  Reviewed-on: https://code.wireshark.org/review/25207
  Petri-Dish: Gerald Combs <gerald@wireshark.org>
  Tested-by: Petri Dish Buildbot
  Reviewed-by: Gerald Combs <gerald@wireshark.org>
  db66351946e8c90bc8c2ceca1e47da6f53066be4:Do not automatically enable the linux kernel's BPF JIT compiler

  The default value of kernel.unprivileged_bpf_disabled is 0 which means
  this is enabling the BPF JIT compiler for unprivileged users. Given that
  this is a known attack vector for Spectre variant 1 (CVE-2017-5753) this
  is not a setting that a utility should be tampering with.

  Tshark's and dumpcap's help message is changed by Balint Reczey to suggest
  enabling BPF manually after considering security-related implications.

  Change-Id: I1cc34cbd6e84485eba9dee79a8700aa388354885
  Signed-off-by: Balint Reczey <balint.reczey@canonical.com>
  Bug: 14313
  Reviewed-on: https://code.wireshark.org/review/25192
  Reviewed-by: Balint Reczey <balint@balintreczey.hu>
  Petri-Dish: Balint Reczey <balint@balintreczey.hu>
  Reviewed-by: João Valverde <j@v6e.pt>
  Tested-by: Petri Dish Buildbot
  Reviewed-by: Gerald Combs <gerald@wireshark.org>
  (cherry-picked from commit 51e0d22ec6db124abca69a1cc35905c9342c884a)
  Reviewed-on: https://code.wireshark.org/review/25206
  51e0d22ec6db124abca69a1cc35905c9342c884a:Do not automatically enable the linux kernel's BPF JIT compiler

  The default value of kernel.unprivileged_bpf_disabled is 0 which means
  this is enabling the BPF JIT compiler for unprivileged users. Given that
  this is a known attack vector for Spectre variant 1 (CVE-2017-5753) this
  is not a setting that a utility should be tampering with.

  Tshark's and dumpcap's help message is changed by Balint Reczey to suggest
  enabling BPF manually after considering security-related implications.

  Change-Id: I1cc34cbd6e84485eba9dee79a8700aa388354885
  Signed-off-by: Balint Reczey <balint.reczey@canonical.com>
  Bug: 14313
  Reviewed-on: https://code.wireshark.org/review/25192
  Reviewed-by: Balint Reczey <balint@balintreczey.hu>
  Petri-Dish: Balint Reczey <balint@balintreczey.hu>
  Reviewed-by: João Valverde <j@v6e.pt>
  Tested-by: Petri Dish Buildbot
  Reviewed-by: Gerald Combs <gerald@wireshark.org>
impacted_packages:
  - purl: pkg:gitlab/wireshark/wireshark
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/wireshark/wireshark
        commit: db66351946e8c90bc8c2ceca1e47da6f53066be4
    introduced_in_commits: []
  - purl: pkg:gitlab/wireshark/wireshark
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/wireshark/wireshark
        commit: b4af4e93a8e18e568114ce5181da85ec48be3cef
    introduced_in_commits: []
  - purl: pkg:gitlab/wireshark/wireshark
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://gitlab.com/wireshark/wireshark
        commit: 51e0d22ec6db124abca69a1cc35905c9342c884a
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://gitlab.com/wireshark/wireshark
    reference_type: commit
    reference_id: 3fa8b2e13086d81270f27993512635854e71df9a
