advisory_id: CVE-2024-45336
datasource_id: collect_docker_moby_fix_commits/CVE-2024-45336
datasource_url: https://github.com/moby/moby
aliases: []
summary: |
  822b2b6a1d81cf7466a1c2056ccd23838cebe3d1:Merge pull request #49345 from austinvazquez/cherry-pick-c83862c5419508bcdfafb07165b1a21ecb73c1e2-to-25.0

  [25.0 backport] update to go1.22.11 (fix CVE-2024-45341, CVE-2024-45336)
  a2802d074663d7674da7115624b4afedd477beec:update to go1.22.11 (fix CVE-2024-45341, CVE-2024-45336)

  go1.22.11 (released 2025-01-16) includes security fixes to the crypto/x509 and
  net/http packages, as well as bug fixes to the runtime. See the Go 1.22.11
  milestone on our issue tracker for details.

  - https://github.com/golang/go/issues?q=milestone%3AGo1.22.11+label%3ACherryPickApproved
  - full diff: https://github.com/golang/go/compare/go1.22.10...go1.22.11

  Hello gophers,

  We have just released Go versions 1.23.5 and 1.22.11, minor point releases.

  These minor releases include 2 security fixes following the security policy:

  - crypto/x509: usage of IPv6 zone IDs can bypass URI name constraints

    A certificate with a URI which has a IPv6 address with a zone ID may
    incorrectly satisfy a URI name constraint that applies to the certificate
    chain.

    Certificates containing URIs are not permitted in the web PKI, so this
    only affects users of private PKIs which make use of URIs.

    Thanks to Juho Forsén of Mattermost for reporting this issue.

    This is CVE-2024-45341 and Go issue https://go.dev/issue/71156.

  - net/http: sensitive headers incorrectly sent after cross-domain redirect

    The HTTP client drops sensitive headers after following a cross-domain redirect.
    For example, a request to a.com/ containing an Authorization header which is
    redirected to b.com/ will not send that header to b.com.

    In the event that the client received a subsequent same-domain redirect, however,
    the sensitive headers would be restored. For example, a chain of redirects from
    a.com/, to b.com/1, and finally to b.com/2 would incorrectly send the Authorization
    header to b.com/2.

    Thanks to Kyle Seely for reporting this issue.

    This is CVE-2024-45336 and Go issue https://go.dev/issue/70530.

  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
  (cherry picked from commit c83862c5419508bcdfafb07165b1a21ecb73c1e2)
  Signed-off-by: Austin Vazquez <macedonv@amazon.com>
  a2802d074663d7674da7115624b4afedd477beec:update to go1.22.11 (fix CVE-2024-45341, CVE-2024-45336)

  go1.22.11 (released 2025-01-16) includes security fixes to the crypto/x509 and
  net/http packages, as well as bug fixes to the runtime. See the Go 1.22.11
  milestone on our issue tracker for details.

  - https://github.com/golang/go/issues?q=milestone%3AGo1.22.11+label%3ACherryPickApproved
  - full diff: https://github.com/golang/go/compare/go1.22.10...go1.22.11

  Hello gophers,

  We have just released Go versions 1.23.5 and 1.22.11, minor point releases.

  These minor releases include 2 security fixes following the security policy:

  - crypto/x509: usage of IPv6 zone IDs can bypass URI name constraints

    A certificate with a URI which has a IPv6 address with a zone ID may
    incorrectly satisfy a URI name constraint that applies to the certificate
    chain.

    Certificates containing URIs are not permitted in the web PKI, so this
    only affects users of private PKIs which make use of URIs.

    Thanks to Juho Forsén of Mattermost for reporting this issue.

    This is CVE-2024-45341 and Go issue https://go.dev/issue/71156.

  - net/http: sensitive headers incorrectly sent after cross-domain redirect

    The HTTP client drops sensitive headers after following a cross-domain redirect.
    For example, a request to a.com/ containing an Authorization header which is
    redirected to b.com/ will not send that header to b.com.

    In the event that the client received a subsequent same-domain redirect, however,
    the sensitive headers would be restored. For example, a chain of redirects from
    a.com/, to b.com/1, and finally to b.com/2 would incorrectly send the Authorization
    header to b.com/2.

    Thanks to Kyle Seely for reporting this issue.

    This is CVE-2024-45336 and Go issue https://go.dev/issue/70530.

  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
  (cherry picked from commit c83862c5419508bcdfafb07165b1a21ecb73c1e2)
  Signed-off-by: Austin Vazquez <macedonv@amazon.com>
  13eca8859708a41ba9eade1e6759f595f55f3376:Merge pull request #49312 from thaJeztah/27.x_bump_golang_1.22.11

  [27.x] update to go1.22.11 (fix CVE-2024-45341, CVE-2024-45336)
  101ff268864fda642c88f9d6c0df103b23e60791:Merge pull request #49311 from thaJeztah/bump_golang_1.23.5

  update to go1.23.5 (fix CVE-2024-45341, CVE-2024-45336)
  c83862c5419508bcdfafb07165b1a21ecb73c1e2:update to go1.22.11 (fix CVE-2024-45341, CVE-2024-45336)

  go1.22.11 (released 2025-01-16) includes security fixes to the crypto/x509 and
  net/http packages, as well as bug fixes to the runtime. See the Go 1.22.11
  milestone on our issue tracker for details.

  - https://github.com/golang/go/issues?q=milestone%3AGo1.22.11+label%3ACherryPickApproved
  - full diff: https://github.com/golang/go/compare/go1.22.10...go1.22.11

  Hello gophers,

  We have just released Go versions 1.23.5 and 1.22.11, minor point releases.

  These minor releases include 2 security fixes following the security policy:

  - crypto/x509: usage of IPv6 zone IDs can bypass URI name constraints

    A certificate with a URI which has a IPv6 address with a zone ID may
    incorrectly satisfy a URI name constraint that applies to the certificate
    chain.

    Certificates containing URIs are not permitted in the web PKI, so this
    only affects users of private PKIs which make use of URIs.

    Thanks to Juho Forsén of Mattermost for reporting this issue.

    This is CVE-2024-45341 and Go issue https://go.dev/issue/71156.

  - net/http: sensitive headers incorrectly sent after cross-domain redirect

    The HTTP client drops sensitive headers after following a cross-domain redirect.
    For example, a request to a.com/ containing an Authorization header which is
    redirected to b.com/ will not send that header to b.com.

    In the event that the client received a subsequent same-domain redirect, however,
    the sensitive headers would be restored. For example, a chain of redirects from
    a.com/, to b.com/1, and finally to b.com/2 would incorrectly send the Authorization
    header to b.com/2.

    Thanks to Kyle Seely for reporting this issue.

    This is CVE-2024-45336 and Go issue https://go.dev/issue/70530.

  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
  c83862c5419508bcdfafb07165b1a21ecb73c1e2:update to go1.22.11 (fix CVE-2024-45341, CVE-2024-45336)

  go1.22.11 (released 2025-01-16) includes security fixes to the crypto/x509 and
  net/http packages, as well as bug fixes to the runtime. See the Go 1.22.11
  milestone on our issue tracker for details.

  - https://github.com/golang/go/issues?q=milestone%3AGo1.22.11+label%3ACherryPickApproved
  - full diff: https://github.com/golang/go/compare/go1.22.10...go1.22.11

  Hello gophers,

  We have just released Go versions 1.23.5 and 1.22.11, minor point releases.

  These minor releases include 2 security fixes following the security policy:

  - crypto/x509: usage of IPv6 zone IDs can bypass URI name constraints

    A certificate with a URI which has a IPv6 address with a zone ID may
    incorrectly satisfy a URI name constraint that applies to the certificate
    chain.

    Certificates containing URIs are not permitted in the web PKI, so this
    only affects users of private PKIs which make use of URIs.

    Thanks to Juho Forsén of Mattermost for reporting this issue.

    This is CVE-2024-45341 and Go issue https://go.dev/issue/71156.

  - net/http: sensitive headers incorrectly sent after cross-domain redirect

    The HTTP client drops sensitive headers after following a cross-domain redirect.
    For example, a request to a.com/ containing an Authorization header which is
    redirected to b.com/ will not send that header to b.com.

    In the event that the client received a subsequent same-domain redirect, however,
    the sensitive headers would be restored. For example, a chain of redirects from
    a.com/, to b.com/1, and finally to b.com/2 would incorrectly send the Authorization
    header to b.com/2.

    Thanks to Kyle Seely for reporting this issue.

    This is CVE-2024-45336 and Go issue https://go.dev/issue/70530.

  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
  ae0fda655b01eb96614acff1dfeeb1859df22802:update to go1.23.5 (fix CVE-2024-45341, CVE-2024-45336)

  go1.23.5 (released 2025-01-16) includes security fixes to the crypto/x509 and
  net/http packages, as well as bug fixes to the compiler, the runtime, and the
  net package. See the Go 1.23.5 milestone on our issue tracker for details;

  - https://github.com/golang/go/issues?q=milestone%3AGo1.23.5+label%3ACherryPickApproved
  - full diff: https://github.com/golang/go/compare/go1.23.4...go1.23.5

  Hello gophers,

  We have just released Go versions 1.23.5 and 1.22.11, minor point releases.

  These minor releases include 2 security fixes following the security policy:

  - crypto/x509: usage of IPv6 zone IDs can bypass URI name constraints

    A certificate with a URI which has a IPv6 address with a zone ID may
    incorrectly satisfy a URI name constraint that applies to the certificate
    chain.

    Certificates containing URIs are not permitted in the web PKI, so this
    only affects users of private PKIs which make use of URIs.

    Thanks to Juho Forsén of Mattermost for reporting this issue.

    This is CVE-2024-45341 and Go issue https://go.dev/issue/71156.

  - net/http: sensitive headers incorrectly sent after cross-domain redirect

    The HTTP client drops sensitive headers after following a cross-domain redirect.
    For example, a request to a.com/ containing an Authorization header which is
    redirected to b.com/ will not send that header to b.com.

    In the event that the client received a subsequent same-domain redirect, however,
    the sensitive headers would be restored. For example, a chain of redirects from
    a.com/, to b.com/1, and finally to b.com/2 would incorrectly send the Authorization
    header to b.com/2.

    Thanks to Kyle Seely for reporting this issue.

    This is CVE-2024-45336 and Go issue https://go.dev/issue/70530.

  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
  ae0fda655b01eb96614acff1dfeeb1859df22802:update to go1.23.5 (fix CVE-2024-45341, CVE-2024-45336)

  go1.23.5 (released 2025-01-16) includes security fixes to the crypto/x509 and
  net/http packages, as well as bug fixes to the compiler, the runtime, and the
  net package. See the Go 1.23.5 milestone on our issue tracker for details;

  - https://github.com/golang/go/issues?q=milestone%3AGo1.23.5+label%3ACherryPickApproved
  - full diff: https://github.com/golang/go/compare/go1.23.4...go1.23.5

  Hello gophers,

  We have just released Go versions 1.23.5 and 1.22.11, minor point releases.

  These minor releases include 2 security fixes following the security policy:

  - crypto/x509: usage of IPv6 zone IDs can bypass URI name constraints

    A certificate with a URI which has a IPv6 address with a zone ID may
    incorrectly satisfy a URI name constraint that applies to the certificate
    chain.

    Certificates containing URIs are not permitted in the web PKI, so this
    only affects users of private PKIs which make use of URIs.

    Thanks to Juho Forsén of Mattermost for reporting this issue.

    This is CVE-2024-45341 and Go issue https://go.dev/issue/71156.

  - net/http: sensitive headers incorrectly sent after cross-domain redirect

    The HTTP client drops sensitive headers after following a cross-domain redirect.
    For example, a request to a.com/ containing an Authorization header which is
    redirected to b.com/ will not send that header to b.com.

    In the event that the client received a subsequent same-domain redirect, however,
    the sensitive headers would be restored. For example, a chain of redirects from
    a.com/, to b.com/1, and finally to b.com/2 would incorrectly send the Authorization
    header to b.com/2.

    Thanks to Kyle Seely for reporting this issue.

    This is CVE-2024-45336 and Go issue https://go.dev/issue/70530.

  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
impacted_packages:
  - purl: pkg:github/moby/moby
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/moby/moby
        commit: 101ff268864fda642c88f9d6c0df103b23e60791
    introduced_in_commits: []
  - purl: pkg:github/moby/moby
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/moby/moby
        commit: ae0fda655b01eb96614acff1dfeeb1859df22802
    introduced_in_commits: []
  - purl: pkg:github/moby/moby
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/moby/moby
        commit: a2802d074663d7674da7115624b4afedd477beec
    introduced_in_commits: []
  - purl: pkg:github/moby/moby
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/moby/moby
        commit: 822b2b6a1d81cf7466a1c2056ccd23838cebe3d1
    introduced_in_commits: []
  - purl: pkg:github/moby/moby
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/moby/moby
        commit: c83862c5419508bcdfafb07165b1a21ecb73c1e2
    introduced_in_commits: []
  - purl: pkg:github/moby/moby
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/moby/moby
        commit: 13eca8859708a41ba9eade1e6759f595f55f3376
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/moby/moby/tree/101ff268864fda642c88f9d6c0df103b23e60791
    reference_type: commit
    reference_id: 101ff268864fda642c88f9d6c0df103b23e60791
  - url: https://github.com/moby/moby/tree/13eca8859708a41ba9eade1e6759f595f55f3376
    reference_type: commit
    reference_id: 13eca8859708a41ba9eade1e6759f595f55f3376
  - url: https://github.com/moby/moby/tree/822b2b6a1d81cf7466a1c2056ccd23838cebe3d1
    reference_type: commit
    reference_id: 822b2b6a1d81cf7466a1c2056ccd23838cebe3d1
  - url: https://github.com/moby/moby/tree/a2802d074663d7674da7115624b4afedd477beec
    reference_type: commit
    reference_id: a2802d074663d7674da7115624b4afedd477beec
  - url: https://github.com/moby/moby/tree/ae0fda655b01eb96614acff1dfeeb1859df22802
    reference_type: commit
    reference_id: ae0fda655b01eb96614acff1dfeeb1859df22802
  - url: https://github.com/moby/moby/tree/c83862c5419508bcdfafb07165b1a21ecb73c1e2
    reference_type: commit
    reference_id: c83862c5419508bcdfafb07165b1a21ecb73c1e2
