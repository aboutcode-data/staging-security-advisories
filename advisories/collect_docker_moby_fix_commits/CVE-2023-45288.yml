advisory_id: CVE-2023-45288
datasource_id: collect_docker_moby_fix_commits/CVE-2023-45288
datasource_url: https://github.com/moby/moby
aliases: []
summary: |
  0ee31c2bca86ac3784fd666ad90f5c87cd4f4cc1:vendor: bump golang.org/x/net to v0.23.0

  Resolves GO-2024-2687, a.k.a. CVE-2023-45288.

      $ hack/with-go-mod.sh go get -modfile=vendor.mod golang.org/x/net@v0.23.0
      [...]
      full diffs:
          - https://github.com/golang/crypto/compare/v0.14.0..v0.21.0
          - https://github.com/golang/net/compare/v0.17.0..v0.23.0
          - https://github.com/golang/sys/compare/v0.13.0..v0.18.0
          - https://github.com/golang/text/compare/v0.13.0..v0.14.0

  Signed-off-by: Andrey Epifanov <aepifanov@mirantis.com>
  ee5909c2d0d949fea5896a66d105eb2785d2448d:vendor: golang.org/x/net v0.23.0

  full diff: https://github.com/golang/net/compare/v0.22.0...v0.23.0

  Includes a fix for CVE-2023-45288, which is also addressed in go1.22.2
  and go1.21.9;

  > http2: close connections when receiving too many headers
  >
  > Maintaining HPACK state requires that we parse and process
  > all HEADERS and CONTINUATION frames on a connection.
  > When a request's headers exceed MaxHeaderBytes, we don't
  > allocate memory to store the excess headers but we do
  > parse them. This permits an attacker to cause an HTTP/2
  > endpoint to read arbitrary amounts of data, all associated
  > with a request which is going to be rejected.
  >
  > Set a limit on the amount of excess header frames we
  > will process before closing a connection.
  >
  > Thanks to Bartek Nowotarski for reporting this issue.

  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
  (cherry picked from commit d66589496e5ab42d31f3fddaf8075fb37f1b77c6)
  Signed-off-by: Austin Vazquez <macedonv@amazon.com>
  8b7940f03771d226d0f6d64bdf842d0185117e8b:vendor: golang.org/x/net v0.23.0

  full diff: https://github.com/golang/net/compare/v0.22.0...v0.23.0

  Includes a fix for CVE-2023-45288, which is also addressed in go1.22.2
  and go1.21.9;

  > http2: close connections when receiving too many headers
  >
  > Maintaining HPACK state requires that we parse and process
  > all HEADERS and CONTINUATION frames on a connection.
  > When a request's headers exceed MaxHeaderBytes, we don't
  > allocate memory to store the excess headers but we do
  > parse them. This permits an attacker to cause an HTTP/2
  > endpoint to read arbitrary amounts of data, all associated
  > with a request which is going to be rejected.
  >
  > Set a limit on the amount of excess header frames we
  > will process before closing a connection.
  >
  > Thanks to Bartek Nowotarski for reporting this issue.

  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
  (cherry picked from commit d66589496e5ab42d31f3fddaf8075fb37f1b77c6)
  Signed-off-by: Paweł Gronowski <pawel.gronowski@docker.com>
  50bd133ad3733bc50c86a8e3e836c1a0db7e2110:update to go1.21.9

  go1.21.9 (released 2024-04-03) includes a security fix to the net/http
  package, as well as bug fixes to the linker, and the go/types and
  net/http packages. See the [Go 1.21.9 milestone](https://github.com/golang/go/issues?q=milestone%3AGo1.21.9+label%3ACherryPickApproved)
  for more details.

  These minor releases include 1 security fixes following the security policy:

  - http2: close connections when receiving too many headers

  Maintaining HPACK state requires that we parse and process all HEADERS
  and CONTINUATION frames on a connection. When a request's headers exceed
  MaxHeaderBytes, we don't allocate memory to store the excess headers but
  we do parse them. This permits an attacker to cause an HTTP/2 endpoint
  to read arbitrary amounts of header data, all associated with a request
  which is going to be rejected. These headers can include Huffman-encoded
  data which is significantly more expensive for the receiver to decode
  than for an attacker to send.

  Set a limit on the amount of excess header frames we will process before
  closing a connection.

  Thanks to Bartek Nowotarski (https://nowotarski.info/) for reporting this issue.

  This is CVE-2023-45288 and Go issue https://go.dev/issue/65051.

  View the release notes for more information:
  https://go.dev/doc/devel/release#go1.22.2

  - https://github.com/golang/go/issues?q=milestone%3AGo1.21.9+label%3ACherryPickApproved
  - full diff: https://github.com/golang/go/compare/go1.21.8...go1.21.9

  Signed-off-by: Paweł Gronowski <pawel.gronowski@docker.com>
  (cherry picked from commit 329d403e209dd66691321430cf162d0daf6f9023)
  Signed-off-by: Paweł Gronowski <pawel.gronowski@docker.com>
  e0815819de44d12e850810d981afd382a4f3cdca:update to go1.21.9

  go1.21.9 (released 2024-04-03) includes a security fix to the net/http
  package, as well as bug fixes to the linker, and the go/types and
  net/http packages. See the [Go 1.21.9 milestone](https://github.com/golang/go/issues?q=milestone%3AGo1.21.9+label%3ACherryPickApproved)
  for more details.

  These minor releases include 1 security fixes following the security policy:

  - http2: close connections when receiving too many headers

  Maintaining HPACK state requires that we parse and process all HEADERS
  and CONTINUATION frames on a connection. When a request's headers exceed
  MaxHeaderBytes, we don't allocate memory to store the excess headers but
  we do parse them. This permits an attacker to cause an HTTP/2 endpoint
  to read arbitrary amounts of header data, all associated with a request
  which is going to be rejected. These headers can include Huffman-encoded
  data which is significantly more expensive for the receiver to decode
  than for an attacker to send.

  Set a limit on the amount of excess header frames we will process before
  closing a connection.

  Thanks to Bartek Nowotarski (https://nowotarski.info/) for reporting this issue.

  This is CVE-2023-45288 and Go issue https://go.dev/issue/65051.

  View the release notes for more information:
  https://go.dev/doc/devel/release#go1.22.2

  - https://github.com/golang/go/issues?q=milestone%3AGo1.21.9+label%3ACherryPickApproved
  - full diff: https://github.com/golang/go/compare/go1.21.8...go1.21.9

  Signed-off-by: Paweł Gronowski <pawel.gronowski@docker.com>
  (cherry picked from commit 329d403e209dd66691321430cf162d0daf6f9023)
  Signed-off-by: Paweł Gronowski <pawel.gronowski@docker.com>
  329d403e209dd66691321430cf162d0daf6f9023:update to go1.21.9

  go1.21.9 (released 2024-04-03) includes a security fix to the net/http
  package, as well as bug fixes to the linker, and the go/types and
  net/http packages. See the [Go 1.21.9 milestone](https://github.com/golang/go/issues?q=milestone%3AGo1.21.9+label%3ACherryPickApproved)
  for more details.

  These minor releases include 1 security fixes following the security policy:

  - http2: close connections when receiving too many headers

  Maintaining HPACK state requires that we parse and process all HEADERS
  and CONTINUATION frames on a connection. When a request's headers exceed
  MaxHeaderBytes, we don't allocate memory to store the excess headers but
  we do parse them. This permits an attacker to cause an HTTP/2 endpoint
  to read arbitrary amounts of header data, all associated with a request
  which is going to be rejected. These headers can include Huffman-encoded
  data which is significantly more expensive for the receiver to decode
  than for an attacker to send.

  Set a limit on the amount of excess header frames we will process before
  closing a connection.

  Thanks to Bartek Nowotarski (https://nowotarski.info/) for reporting this issue.

  This is CVE-2023-45288 and Go issue https://go.dev/issue/65051.

  View the release notes for more information:
  https://go.dev/doc/devel/release#go1.22.2

  - https://github.com/golang/go/issues?q=milestone%3AGo1.21.9+label%3ACherryPickApproved
  - full diff: https://github.com/golang/go/compare/go1.21.8...go1.21.9

  Signed-off-by: Paweł Gronowski <pawel.gronowski@docker.com>
  d66589496e5ab42d31f3fddaf8075fb37f1b77c6:vendor: golang.org/x/net v0.23.0

  full diff: https://github.com/golang/net/compare/v0.22.0...v0.23.0

  Includes a fix for CVE-2023-45288, which is also addressed in go1.22.2
  and go1.21.9;

  > http2: close connections when receiving too many headers
  >
  > Maintaining HPACK state requires that we parse and process
  > all HEADERS and CONTINUATION frames on a connection.
  > When a request's headers exceed MaxHeaderBytes, we don't
  > allocate memory to store the excess headers but we do
  > parse them. This permits an attacker to cause an HTTP/2
  > endpoint to read arbitrary amounts of data, all associated
  > with a request which is going to be rejected.
  >
  > Set a limit on the amount of excess header frames we
  > will process before closing a connection.
  >
  > Thanks to Bartek Nowotarski for reporting this issue.

  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
impacted_packages:
  - purl: pkg:github/moby/moby
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/moby/moby
        commit: 0ee31c2bca86ac3784fd666ad90f5c87cd4f4cc1
    introduced_in_commits: []
  - purl: pkg:github/moby/moby
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/moby/moby
        commit: ee5909c2d0d949fea5896a66d105eb2785d2448d
    introduced_in_commits: []
  - purl: pkg:github/moby/moby
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/moby/moby
        commit: e0815819de44d12e850810d981afd382a4f3cdca
    introduced_in_commits: []
  - purl: pkg:github/moby/moby
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/moby/moby
        commit: 329d403e209dd66691321430cf162d0daf6f9023
    introduced_in_commits: []
  - purl: pkg:github/moby/moby
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/moby/moby
        commit: d66589496e5ab42d31f3fddaf8075fb37f1b77c6
    introduced_in_commits: []
  - purl: pkg:github/moby/moby
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/moby/moby
        commit: 8b7940f03771d226d0f6d64bdf842d0185117e8b
    introduced_in_commits: []
  - purl: pkg:github/moby/moby
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/moby/moby
        commit: 50bd133ad3733bc50c86a8e3e836c1a0db7e2110
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/moby/moby/tree/0ee31c2bca86ac3784fd666ad90f5c87cd4f4cc1
    reference_type: commit
    reference_id: 0ee31c2bca86ac3784fd666ad90f5c87cd4f4cc1
  - url: https://github.com/moby/moby/tree/329d403e209dd66691321430cf162d0daf6f9023
    reference_type: commit
    reference_id: 329d403e209dd66691321430cf162d0daf6f9023
  - url: https://github.com/moby/moby/tree/50bd133ad3733bc50c86a8e3e836c1a0db7e2110
    reference_type: commit
    reference_id: 50bd133ad3733bc50c86a8e3e836c1a0db7e2110
  - url: https://github.com/moby/moby/tree/8b7940f03771d226d0f6d64bdf842d0185117e8b
    reference_type: commit
    reference_id: 8b7940f03771d226d0f6d64bdf842d0185117e8b
  - url: https://github.com/moby/moby/tree/d66589496e5ab42d31f3fddaf8075fb37f1b77c6
    reference_type: commit
    reference_id: d66589496e5ab42d31f3fddaf8075fb37f1b77c6
  - url: https://github.com/moby/moby/tree/e0815819de44d12e850810d981afd382a4f3cdca
    reference_type: commit
    reference_id: e0815819de44d12e850810d981afd382a4f3cdca
  - url: https://github.com/moby/moby/tree/ee5909c2d0d949fea5896a66d105eb2785d2448d
    reference_type: commit
    reference_id: ee5909c2d0d949fea5896a66d105eb2785d2448d
