advisory_id: CVE-2022-24765
datasource_id: collect_docker_moby_fix_commits/CVE-2022-24765
datasource_url: https://github.com/moby/moby
aliases: []
summary: |
  ecf2eee0f6cba623f1a02faf3fa4bc3e6dad5d19:Merge pull request #43486 from thaJeztah/20.10_backport_fix_dco_check

  [20.10 backport] Jenkinsfile: add workaround for CVE-2022-24765
  c110770e084aa081ba205a2d6cd12550ce2edea7:Merge pull request #43485 from thaJeztah/fix_dco_check

  Jenkinsfile: add workaround for CVE-2022-24765
  a80884126b4170499536d206f64e01cf6483c825:Jenkinsfile: add workaround for CVE-2022-24765

  git published an advisory Yesterday, which (as a counter-measure)
  requires the git repository's directory to be owned by the current
  user, and otherwise produce an error:

      fatal: unsafe repository ('/workspace' is owned by someone else)
      To add an exception for this directory, call:

          git config --global --add safe.directory /workspace

  The DCO check is run within a container, which is running as `root`
  (to allow packages to be installed), but because of this, the user
  does not match the files that are bind-mounted from the host (as they
  are checked out by Jenkins, using a different user).

  To work around this issue, this patch configures git to consider the
  `/workspace` directory as "safe". We configure it in the `--system`
  configuration so that it takes effect for "all users" inside the
  container.

  More details on the advisory can be found on GitHub's blog:
  https://github.blog/2022-04-12-git-security-vulnerability-announced/

  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
  (cherry picked from commit efe03aa2d83383d494a86f6a3029cc02b6379024)
  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
  efe03aa2d83383d494a86f6a3029cc02b6379024:Jenkinsfile: add workaround for CVE-2022-24765

  git published an advisory Yesterday, which (as a counter-measure)
  requires the git repository's directory to be owned by the current
  user, and otherwise produce an error:

      fatal: unsafe repository ('/workspace' is owned by someone else)
      To add an exception for this directory, call:

          git config --global --add safe.directory /workspace

  The DCO check is run within a container, which is running as `root`
  (to allow packages to be installed), but because of this, the user
  does not match the files that are bind-mounted from the host (as they
  are checked out by Jenkins, using a different user).

  To work around this issue, this patch configures git to consider the
  `/workspace` directory as "safe". We configure it in the `--system`
  configuration so that it takes effect for "all users" inside the
  container.

  More details on the advisory can be found on GitHub's blog:
  https://github.blog/2022-04-12-git-security-vulnerability-announced/

  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
impacted_packages:
  - purl: pkg:github/moby/moby
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/moby/moby
        commit: c110770e084aa081ba205a2d6cd12550ce2edea7
    introduced_in_commits: []
  - purl: pkg:github/moby/moby
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/moby/moby
        commit: ecf2eee0f6cba623f1a02faf3fa4bc3e6dad5d19
    introduced_in_commits: []
  - purl: pkg:github/moby/moby
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/moby/moby
        commit: a80884126b4170499536d206f64e01cf6483c825
    introduced_in_commits: []
  - purl: pkg:github/moby/moby
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/moby/moby
        commit: efe03aa2d83383d494a86f6a3029cc02b6379024
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/moby/moby/tree/a80884126b4170499536d206f64e01cf6483c825
    reference_type: commit
    reference_id: a80884126b4170499536d206f64e01cf6483c825
  - url: https://github.com/moby/moby/tree/c110770e084aa081ba205a2d6cd12550ce2edea7
    reference_type: commit
    reference_id: c110770e084aa081ba205a2d6cd12550ce2edea7
  - url: https://github.com/moby/moby/tree/ecf2eee0f6cba623f1a02faf3fa4bc3e6dad5d19
    reference_type: commit
    reference_id: ecf2eee0f6cba623f1a02faf3fa4bc3e6dad5d19
  - url: https://github.com/moby/moby/tree/efe03aa2d83383d494a86f6a3029cc02b6379024
    reference_type: commit
    reference_id: efe03aa2d83383d494a86f6a3029cc02b6379024
