advisory_id: CVE-2023-39326
datasource_id: collect_docker_moby_fix_commits/CVE-2023-39326
datasource_url: https://github.com/moby/moby
aliases: []
summary: |
  583e29949eda11a6106a3be0d36aaeb54a562b4f:update to go1.20.12

  go1.20.12 (released 2023-12-05) includes security fixes to the go command,
  and the net/http and path/filepath packages, as well as bug fixes to the
  compiler and the go command. See the Go 1.20.12 milestone on our issue
  tracker for details.

  - https://github.com/golang/go/issues?q=milestone%3AGo1.20.12+label%3ACherryPickApproved
  - full diff: https://github.com/golang/go/compare/go1.20.11...go1.20.12

  from the security mailing:

  [security] Go 1.21.5 and Go 1.20.12 are released

  Hello gophers,

  We have just released Go versions 1.21.5 and 1.20.12, minor point releases.

  These minor releases include 3 security fixes following the security policy:

  - net/http: limit chunked data overhead

    A malicious HTTP sender can use chunk extensions to cause a receiver
    reading from a request or response body to read many more bytes from
    the network than are in the body.

    A malicious HTTP client can further exploit this to cause a server to
    automatically read a large amount of data (up to about 1GiB) when a
    handler fails to read the entire body of a request.

    Chunk extensions are a little-used HTTP feature which permit including
    additional metadata in a request or response body sent using the chunked
    encoding. The net/http chunked encoding reader discards this metadata.
    A sender can exploit this by inserting a large metadata segment with
    each byte transferred. The chunk reader now produces an error if the
    ratio of real body to encoded bytes grows too small.

    Thanks to Bartek Nowotarski for reporting this issue.

    This is CVE-2023-39326 and Go issue https://go.dev/issue/64433.

  - cmd/go: go get may unexpectedly fallback to insecure git

    Using go get to fetch a module with the ".git" suffix may unexpectedly
    fallback to the insecure "git://" protocol if the module is unavailable
    via the secure "https://" and "git+ssh://" protocols, even if GOINSECURE
    is not set for said module. This only affects users who are not using
    the module proxy and are fetching modules directly (i.e. GOPROXY=off).

    Thanks to David Leadbeater for reporting this issue.

    This is CVE-2023-45285 and Go issue https://go.dev/issue/63845.

  - path/filepath: retain trailing \ when cleaning paths like \\?\c:\

    Go 1.20.11 and Go 1.21.4 inadvertently changed the definition of the
    volume name in Windows paths starting with \\?\, resulting in
    filepath.Clean(\\?\c:\) returning \\?\c: rather than \\?\c:\ (among
    other effects). The previous behavior has been restored.

    This is an update to CVE-2023-45283 and Go issue https://go.dev/issue/64028.

  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
  9d596a1bfa762e0b5309af974a803c7a7c09ceba:update to go1.20.12

  go1.20.12 (released 2023-12-05) includes security fixes to the go command,
  and the net/http and path/filepath packages, as well as bug fixes to the
  compiler and the go command. See the Go 1.20.12 milestone on our issue
  tracker for details.

  - https://github.com/golang/go/issues?q=milestone%3AGo1.20.12+label%3ACherryPickApproved
  - full diff: https://github.com/golang/go/compare/go1.20.11...go1.20.12

  from the security mailing:

  [security] Go 1.21.5 and Go 1.20.12 are released

  Hello gophers,

  We have just released Go versions 1.21.5 and 1.20.12, minor point releases.

  These minor releases include 3 security fixes following the security policy:

  - net/http: limit chunked data overhead

    A malicious HTTP sender can use chunk extensions to cause a receiver
    reading from a request or response body to read many more bytes from
    the network than are in the body.

    A malicious HTTP client can further exploit this to cause a server to
    automatically read a large amount of data (up to about 1GiB) when a
    handler fails to read the entire body of a request.

    Chunk extensions are a little-used HTTP feature which permit including
    additional metadata in a request or response body sent using the chunked
    encoding. The net/http chunked encoding reader discards this metadata.
    A sender can exploit this by inserting a large metadata segment with
    each byte transferred. The chunk reader now produces an error if the
    ratio of real body to encoded bytes grows too small.

    Thanks to Bartek Nowotarski for reporting this issue.

    This is CVE-2023-39326 and Go issue https://go.dev/issue/64433.

  - cmd/go: go get may unexpectedly fallback to insecure git

    Using go get to fetch a module with the ".git" suffix may unexpectedly
    fallback to the insecure "git://" protocol if the module is unavailable
    via the secure "https://" and "git+ssh://" protocols, even if GOINSECURE
    is not set for said module. This only affects users who are not using
    the module proxy and are fetching modules directly (i.e. GOPROXY=off).

    Thanks to David Leadbeater for reporting this issue.

    This is CVE-2023-45285 and Go issue https://go.dev/issue/63845.

  - path/filepath: retain trailing \ when cleaning paths like \\?\c:\

    Go 1.20.11 and Go 1.21.4 inadvertently changed the definition of the
    volume name in Windows paths starting with \\?\, resulting in
    filepath.Clean(\\?\c:\) returning \\?\c: rather than \\?\c:\ (among
    other effects). The previous behavior has been restored.

    This is an update to CVE-2023-45283 and Go issue https://go.dev/issue/64028.

  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
  862caf826c5cd99f0122ac8b858b958a456a5233:update to go1.21.5

  go1.21.5 (released 2023-12-05) includes security fixes to the go command,
  and the net/http and path/filepath packages, as well as bug fixes to the
  compiler, the go command, the runtime, and the crypto/rand, net, os, and
  syscall packages. See the Go 1.21.5 milestone on our issue tracker for
  details:

  - https://github.com/golang/go/issues?q=milestone%3AGo1.21.5+label%3ACherryPickApproved
  - full diff: https://github.com/golang/go/compare/go1.21.4...go1.21.5

  from the security mailing:

  [security] Go 1.21.5 and Go 1.20.12 are released

  Hello gophers,

  We have just released Go versions 1.21.5 and 1.20.12, minor point releases.

  These minor releases include 3 security fixes following the security policy:

  - net/http: limit chunked data overhead

    A malicious HTTP sender can use chunk extensions to cause a receiver
    reading from a request or response body to read many more bytes from
    the network than are in the body.

    A malicious HTTP client can further exploit this to cause a server to
    automatically read a large amount of data (up to about 1GiB) when a
    handler fails to read the entire body of a request.

    Chunk extensions are a little-used HTTP feature which permit including
    additional metadata in a request or response body sent using the chunked
    encoding. The net/http chunked encoding reader discards this metadata.
    A sender can exploit this by inserting a large metadata segment with
    each byte transferred. The chunk reader now produces an error if the
    ratio of real body to encoded bytes grows too small.

    Thanks to Bartek Nowotarski for reporting this issue.

    This is CVE-2023-39326 and Go issue https://go.dev/issue/64433.

  - cmd/go: go get may unexpectedly fallback to insecure git

    Using go get to fetch a module with the ".git" suffix may unexpectedly
    fallback to the insecure "git://" protocol if the module is unavailable
    via the secure "https://" and "git+ssh://" protocols, even if GOINSECURE
    is not set for said module. This only affects users who are not using
    the module proxy and are fetching modules directly (i.e. GOPROXY=off).

    Thanks to David Leadbeater for reporting this issue.

    This is CVE-2023-45285 and Go issue https://go.dev/issue/63845.

  - path/filepath: retain trailing \ when cleaning paths like \\?\c:\

    Go 1.20.11 and Go 1.21.4 inadvertently changed the definition of the
    volume name in Windows paths starting with \\?\, resulting in
    filepath.Clean(\\?\c:\) returning \\?\c: rather than \\?\c:\ (among
    other effects). The previous behavior has been restored.

    This is an update to CVE-2023-45283 and Go issue https://go.dev/issue/64028.

  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
impacted_packages:
  - purl: pkg:github/moby/moby
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/moby/moby
        commit: 862caf826c5cd99f0122ac8b858b958a456a5233
    introduced_in_commits: []
  - purl: pkg:github/moby/moby
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/moby/moby
        commit: 583e29949eda11a6106a3be0d36aaeb54a562b4f
    introduced_in_commits: []
  - purl: pkg:github/moby/moby
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/moby/moby
        commit: 9d596a1bfa762e0b5309af974a803c7a7c09ceba
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/moby/moby/tree/583e29949eda11a6106a3be0d36aaeb54a562b4f
    reference_type: commit
    reference_id: 583e29949eda11a6106a3be0d36aaeb54a562b4f
  - url: https://github.com/moby/moby/tree/862caf826c5cd99f0122ac8b858b958a456a5233
    reference_type: commit
    reference_id: 862caf826c5cd99f0122ac8b858b958a456a5233
  - url: https://github.com/moby/moby/tree/9d596a1bfa762e0b5309af974a803c7a7c09ceba
    reference_type: commit
    reference_id: 9d596a1bfa762e0b5309af974a803c7a7c09ceba
