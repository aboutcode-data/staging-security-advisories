advisory_id: CVE-2022-27191
datasource_id: collect_docker_moby_fix_commits/CVE-2022-27191
datasource_url: https://github.com/moby/moby
aliases: []
summary: |
  917b44799d9a51da9c7a4fa92dfaf1df9cc06648:vendor: golang.org/x/crypto v0.0.0-20220315160706-3147a52a75dd

  full diff: https://github.com/golang/crypto/compare/5770296d904e...3147a52a75dd

  This version contains a fix for CVE-2022-27191 (not sure if it affects us).

  From the golang mailing list:

      Hello gophers,

      Version v0.0.0-20220315160706-3147a52a75dd of golang.org/x/crypto/ssh implements
      client authentication support for signature algorithms based on SHA-2 for use with
      existing RSA keys.

      Previously, a client would fail to authenticate with RSA keys to servers that
      reject signature algorithms based on SHA-1. This includes OpenSSH 8.8 by default
      and—starting today March 15, 2022 for recently uploaded keys.

      We are providing this announcement as the error (“ssh: unable to authenticate”)
      might otherwise be difficult to troubleshoot.

      Version v0.0.0-20220314234659-1baeb1ce4c0b (included in the version above) also
      fixes a potential security issue where an attacker could cause a crash in a
      golang.org/x/crypto/ssh server under these conditions:

      - The server has been configured by passing a Signer to ServerConfig.AddHostKey.
      - The Signer passed to AddHostKey does not also implement AlgorithmSigner.
      - The Signer passed to AddHostKey does return a key of type “ssh-rsa” from its PublicKey method.

      Servers that only use Signer implementations provided by the ssh package are
      unaffected. This is CVE-2022-27191.

      Alla prossima,

      Filippo for the Go Security team

  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
  917b44799d9a51da9c7a4fa92dfaf1df9cc06648:vendor: golang.org/x/crypto v0.0.0-20220315160706-3147a52a75dd

  full diff: https://github.com/golang/crypto/compare/5770296d904e...3147a52a75dd

  This version contains a fix for CVE-2022-27191 (not sure if it affects us).

  From the golang mailing list:

      Hello gophers,

      Version v0.0.0-20220315160706-3147a52a75dd of golang.org/x/crypto/ssh implements
      client authentication support for signature algorithms based on SHA-2 for use with
      existing RSA keys.

      Previously, a client would fail to authenticate with RSA keys to servers that
      reject signature algorithms based on SHA-1. This includes OpenSSH 8.8 by default
      and—starting today March 15, 2022 for recently uploaded keys.

      We are providing this announcement as the error (“ssh: unable to authenticate”)
      might otherwise be difficult to troubleshoot.

      Version v0.0.0-20220314234659-1baeb1ce4c0b (included in the version above) also
      fixes a potential security issue where an attacker could cause a crash in a
      golang.org/x/crypto/ssh server under these conditions:

      - The server has been configured by passing a Signer to ServerConfig.AddHostKey.
      - The Signer passed to AddHostKey does not also implement AlgorithmSigner.
      - The Signer passed to AddHostKey does return a key of type “ssh-rsa” from its PublicKey method.

      Servers that only use Signer implementations provided by the ssh package are
      unaffected. This is CVE-2022-27191.

      Alla prossima,

      Filippo for the Go Security team

  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
impacted_packages:
  - purl: pkg:github/moby/moby
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/moby/moby
        commit: 917b44799d9a51da9c7a4fa92dfaf1df9cc06648
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/moby/moby/tree/917b44799d9a51da9c7a4fa92dfaf1df9cc06648
    reference_type: commit
    reference_id: 917b44799d9a51da9c7a4fa92dfaf1df9cc06648
