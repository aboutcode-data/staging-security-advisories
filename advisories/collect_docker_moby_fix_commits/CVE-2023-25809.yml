advisory_id: CVE-2023-25809
datasource_id: collect_docker_moby_fix_commits/CVE-2023-25809
datasource_url: https://github.com/moby/moby
aliases: []
summary: |
  40ec0eb9fe21d5fe8a9e98c8aa26e49a442f6036:vendor: github.com/opencontainers/runc v1.1.5

  no changes in vendored code, just keeping scanners happy :)

  release notes: https://github.com/opencontainers/runc/releases/tag/v1.1.5
  diff: https://github.com/opencontainers/runc/compare/v1.1.4...v1.1.5

  This is the fifth patch release in the 1.1.z series of runc, which fixes
  three CVEs found in runc.

  * CVE-2023-25809 is a vulnerability involving rootless containers where
    (under specific configurations), the container would have write access
    to the /sys/fs/cgroup/user.slice/... cgroup hierarchy. No other
    hierarchies on the host were affected. This vulnerability was
    discovered by Akihiro Suda.
    <https://github.com/opencontainers/runc/security/advisories/GHSA-m8cg-xc2p-r3fc>

  * CVE-2023-27561 was a regression which effectively re-introduced
    CVE-2019-19921. This bug was present from v1.0.0-rc95 to v1.1.4. This
    regression was discovered by @Beuc.
    <https://github.com/advisories/GHSA-vpvm-3wq2-2wvm>

  * CVE-2023-28642 is a variant of CVE-2023-27561 and was fixed by the same
    patch. This variant of the above vulnerability was reported by Lei
    Wang.
    <https://github.com/opencontainers/runc/security/advisories/GHSA-g2j6-57v7-gm8c>

  In addition, the following other fixes are included in this release:

  * Fix the inability to use `/dev/null` when inside a container.
  * Fix changing the ownership of host's `/dev/null` caused by fd redirection
    (a regression in 1.1.1).
  * Fix rare runc exec/enter unshare error on older kernels, including
    CentOS < 7.7.
  * nsexec: Check for errors in `write_log()`.

  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
  (cherry picked from commit a17029ba4911843c1a429660caab02c41e5d3c56)
  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
  7a778373c84d1ba440a336e1dcb9076481828ff6:update runc binary to v1.1.5

  release notes: https://github.com/opencontainers/runc/releases/tag/v1.1.5
  diff: https://github.com/opencontainers/runc/compare/v1.1.4...v1.1.5

  This is the fifth patch release in the 1.1.z series of runc, which fixes
  three CVEs found in runc.

  * CVE-2023-25809 is a vulnerability involving rootless containers where
    (under specific configurations), the container would have write access
    to the /sys/fs/cgroup/user.slice/... cgroup hierarchy. No other
    hierarchies on the host were affected. This vulnerability was
    discovered by Akihiro Suda.
    <https://github.com/opencontainers/runc/security/advisories/GHSA-m8cg-xc2p-r3fc>

  * CVE-2023-27561 was a regression which effectively re-introduced
    CVE-2019-19921. This bug was present from v1.0.0-rc95 to v1.1.4. This
    regression was discovered by @Beuc.
    <https://github.com/advisories/GHSA-vpvm-3wq2-2wvm>

  * CVE-2023-28642 is a variant of CVE-2023-27561 and was fixed by the same
    patch. This variant of the above vulnerability was reported by Lei
    Wang.
    <https://github.com/opencontainers/runc/security/advisories/GHSA-g2j6-57v7-gm8c>

  In addition, the following other fixes are included in this release:

  * Fix the inability to use `/dev/null` when inside a container.
  * Fix changing the ownership of host's `/dev/null` caused by fd redirection
    (a regression in 1.1.1).
  * Fix rare runc exec/enter unshare error on older kernels, including
    CentOS < 7.7.
  * nsexec: Check for errors in `write_log()`.

  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
  (cherry picked from commit 77be7b777c1e3fd997690f88d4dc1da1aeaa8210)
  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
  3923e302a445a48703c59eead4bced1528636ea1:update runc binary to v1.1.5

  release notes: https://github.com/opencontainers/runc/releases/tag/v1.1.5
  diff: https://github.com/opencontainers/runc/compare/v1.1.4...v1.1.5

  This is the fifth patch release in the 1.1.z series of runc, which fixes
  three CVEs found in runc.

  * CVE-2023-25809 is a vulnerability involving rootless containers where
    (under specific configurations), the container would have write access
    to the /sys/fs/cgroup/user.slice/... cgroup hierarchy. No other
    hierarchies on the host were affected. This vulnerability was
    discovered by Akihiro Suda.
    <https://github.com/opencontainers/runc/security/advisories/GHSA-m8cg-xc2p-r3fc>

  * CVE-2023-27561 was a regression which effectively re-introduced
    CVE-2019-19921. This bug was present from v1.0.0-rc95 to v1.1.4. This
    regression was discovered by @Beuc.
    <https://github.com/advisories/GHSA-vpvm-3wq2-2wvm>

  * CVE-2023-28642 is a variant of CVE-2023-27561 and was fixed by the same
    patch. This variant of the above vulnerability was reported by Lei
    Wang.
    <https://github.com/opencontainers/runc/security/advisories/GHSA-g2j6-57v7-gm8c>

  In addition, the following other fixes are included in this release:

  * Fix the inability to use `/dev/null` when inside a container.
  * Fix changing the ownership of host's `/dev/null` caused by fd redirection
    (a regression in 1.1.1).
  * Fix rare runc exec/enter unshare error on older kernels, including
    CentOS < 7.7.
  * nsexec: Check for errors in `write_log()`.

  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
  (cherry picked from commit 77be7b777c1e3fd997690f88d4dc1da1aeaa8210)
  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
  77be7b777c1e3fd997690f88d4dc1da1aeaa8210:update runc binary to v1.1.5

  release notes: https://github.com/opencontainers/runc/releases/tag/v1.1.5
  diff: https://github.com/opencontainers/runc/compare/v1.1.4...v1.1.5

  This is the fifth patch release in the 1.1.z series of runc, which fixes
  three CVEs found in runc.

  * CVE-2023-25809 is a vulnerability involving rootless containers where
    (under specific configurations), the container would have write access
    to the /sys/fs/cgroup/user.slice/... cgroup hierarchy. No other
    hierarchies on the host were affected. This vulnerability was
    discovered by Akihiro Suda.
    <https://github.com/opencontainers/runc/security/advisories/GHSA-m8cg-xc2p-r3fc>

  * CVE-2023-27561 was a regression which effectively re-introduced
    CVE-2019-19921. This bug was present from v1.0.0-rc95 to v1.1.4. This
    regression was discovered by @Beuc.
    <https://github.com/advisories/GHSA-vpvm-3wq2-2wvm>

  * CVE-2023-28642 is a variant of CVE-2023-27561 and was fixed by the same
    patch. This variant of the above vulnerability was reported by Lei
    Wang.
    <https://github.com/opencontainers/runc/security/advisories/GHSA-g2j6-57v7-gm8c>

  In addition, the following other fixes are included in this release:

  * Fix the inability to use `/dev/null` when inside a container.
  * Fix changing the ownership of host's `/dev/null` caused by fd redirection
    (a regression in 1.1.1).
  * Fix rare runc exec/enter unshare error on older kernels, including
    CentOS < 7.7.
  * nsexec: Check for errors in `write_log()`.

  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
  a17029ba4911843c1a429660caab02c41e5d3c56:vendor: github.com/opencontainers/runc v1.1.5

  no changes in vendored code, just keeping scanners happy :)

  release notes: https://github.com/opencontainers/runc/releases/tag/v1.1.5
  diff: https://github.com/opencontainers/runc/compare/v1.1.4...v1.1.5

  This is the fifth patch release in the 1.1.z series of runc, which fixes
  three CVEs found in runc.

  * CVE-2023-25809 is a vulnerability involving rootless containers where
    (under specific configurations), the container would have write access
    to the /sys/fs/cgroup/user.slice/... cgroup hierarchy. No other
    hierarchies on the host were affected. This vulnerability was
    discovered by Akihiro Suda.
    <https://github.com/opencontainers/runc/security/advisories/GHSA-m8cg-xc2p-r3fc>

  * CVE-2023-27561 was a regression which effectively re-introduced
    CVE-2019-19921. This bug was present from v1.0.0-rc95 to v1.1.4. This
    regression was discovered by @Beuc.
    <https://github.com/advisories/GHSA-vpvm-3wq2-2wvm>

  * CVE-2023-28642 is a variant of CVE-2023-27561 and was fixed by the same
    patch. This variant of the above vulnerability was reported by Lei
    Wang.
    <https://github.com/opencontainers/runc/security/advisories/GHSA-g2j6-57v7-gm8c>

  In addition, the following other fixes are included in this release:

  * Fix the inability to use `/dev/null` when inside a container.
  * Fix changing the ownership of host's `/dev/null` caused by fd redirection
    (a regression in 1.1.1).
  * Fix rare runc exec/enter unshare error on older kernels, including
    CentOS < 7.7.
  * nsexec: Check for errors in `write_log()`.

  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
impacted_packages:
  - purl: pkg:github/moby/moby
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/moby/moby
        commit: 77be7b777c1e3fd997690f88d4dc1da1aeaa8210
    introduced_in_commits: []
  - purl: pkg:github/moby/moby
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/moby/moby
        commit: 40ec0eb9fe21d5fe8a9e98c8aa26e49a442f6036
    introduced_in_commits: []
  - purl: pkg:github/moby/moby
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/moby/moby
        commit: 3923e302a445a48703c59eead4bced1528636ea1
    introduced_in_commits: []
  - purl: pkg:github/moby/moby
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/moby/moby
        commit: 7a778373c84d1ba440a336e1dcb9076481828ff6
    introduced_in_commits: []
  - purl: pkg:github/moby/moby
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/moby/moby
        commit: a17029ba4911843c1a429660caab02c41e5d3c56
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/moby/moby/tree/3923e302a445a48703c59eead4bced1528636ea1
    reference_type: commit
    reference_id: 3923e302a445a48703c59eead4bced1528636ea1
  - url: https://github.com/moby/moby/tree/40ec0eb9fe21d5fe8a9e98c8aa26e49a442f6036
    reference_type: commit
    reference_id: 40ec0eb9fe21d5fe8a9e98c8aa26e49a442f6036
  - url: https://github.com/moby/moby/tree/77be7b777c1e3fd997690f88d4dc1da1aeaa8210
    reference_type: commit
    reference_id: 77be7b777c1e3fd997690f88d4dc1da1aeaa8210
  - url: https://github.com/moby/moby/tree/7a778373c84d1ba440a336e1dcb9076481828ff6
    reference_type: commit
    reference_id: 7a778373c84d1ba440a336e1dcb9076481828ff6
  - url: https://github.com/moby/moby/tree/a17029ba4911843c1a429660caab02c41e5d3c56
    reference_type: commit
    reference_id: a17029ba4911843c1a429660caab02c41e5d3c56
