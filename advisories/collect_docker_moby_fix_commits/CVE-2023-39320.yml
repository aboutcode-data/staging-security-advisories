advisory_id: CVE-2023-39320
datasource_id: collect_docker_moby_fix_commits/CVE-2023-39320
datasource_url: https://github.com/moby/moby
aliases: []
summary: |
  0dae84ca6455cd6217751ddae8a1ee8be15812d8:update to go1.20.8

  go1.20.8 (released 2023-09-06) includes two security fixes to the html/template
  package, as well as bug fixes to the compiler, the go command, the runtime,
  and the crypto/tls, go/types, net/http, and path/filepath packages. See the
  Go 1.20.8 milestone on our issue tracker for details:

  https://github.com/golang/go/issues?q=milestone%3AGo1.20.8+label%3ACherryPickApproved

  full diff: https://github.com/golang/go/compare/go1.20.7...go1.20.8

  From the security mailing:

  [security] Go 1.21.1 and Go 1.20.8 are released

  Hello gophers,

  We have just released Go versions 1.21.1 and 1.20.8, minor point releases.

  These minor releases include 4 security fixes following the security policy:

  - cmd/go: go.mod toolchain directive allows arbitrary execution
    The go.mod toolchain directive, introduced in Go 1.21, could be leveraged to
    execute scripts and binaries relative to the root of the module when the "go"
    command was executed within the module. This applies to modules downloaded using
    the "go" command from the module proxy, as well as modules downloaded directly
    using VCS software.

    Thanks to Juho Nurminen of Mattermost for reporting this issue.

    This is CVE-2023-39320 and Go issue https://go.dev/issue/62198.

  - html/template: improper handling of HTML-like comments within script contexts
    The html/template package did not properly handle HMTL-like "<!--" and "-->"
    comment tokens, nor hashbang "#!" comment tokens, in <script> contexts. This may
    cause the template parser to improperly interpret the contents of <script>
    contexts, causing actions to be improperly escaped. This could be leveraged to
    perform an XSS attack.

    Thanks to Takeshi Kaneko (GMO Cybersecurity by Ierae, Inc.) for reporting this
    issue.

    This is CVE-2023-39318 and Go issue https://go.dev/issue/62196.

  - html/template: improper handling of special tags within script contexts
    The html/template package did not apply the proper rules for handling occurrences
    of "<script", "<!--", and "</script" within JS literals in <script> contexts.
    This may cause the template parser to improperly consider script contexts to be
    terminated early, causing actions to be improperly escaped. This could be
    leveraged to perform an XSS attack.

    Thanks to Takeshi Kaneko (GMO Cybersecurity by Ierae, Inc.) for reporting this
    issue.

    This is CVE-2023-39319 and Go issue https://go.dev/issue/62197.

  - crypto/tls: panic when processing post-handshake message on QUIC connections
    Processing an incomplete post-handshake message for a QUIC connection caused a panic.

    Thanks to Marten Seemann for reporting this issue.

    This is CVE-2023-39321 and CVE-2023-39322 and Go issue https://go.dev/issue/62266.

  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
  (cherry picked from commit c41121cc48537b3b18084e14831fa254be714446)
  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
  f014c349a0fd00df3bdca57aed124a93d2f8d2de:update to go1.20.8

  go1.20.8 (released 2023-09-06) includes two security fixes to the html/template
  package, as well as bug fixes to the compiler, the go command, the runtime,
  and the crypto/tls, go/types, net/http, and path/filepath packages. See the
  Go 1.20.8 milestone on our issue tracker for details:

  https://github.com/golang/go/issues?q=milestone%3AGo1.20.8+label%3ACherryPickApproved

  full diff: https://github.com/golang/go/compare/go1.20.7...go1.20.8

  From the security mailing:

  [security] Go 1.21.1 and Go 1.20.8 are released

  Hello gophers,

  We have just released Go versions 1.21.1 and 1.20.8, minor point releases.

  These minor releases include 4 security fixes following the security policy:

  - cmd/go: go.mod toolchain directive allows arbitrary execution
    The go.mod toolchain directive, introduced in Go 1.21, could be leveraged to
    execute scripts and binaries relative to the root of the module when the "go"
    command was executed within the module. This applies to modules downloaded using
    the "go" command from the module proxy, as well as modules downloaded directly
    using VCS software.

    Thanks to Juho Nurminen of Mattermost for reporting this issue.

    This is CVE-2023-39320 and Go issue https://go.dev/issue/62198.

  - html/template: improper handling of HTML-like comments within script contexts
    The html/template package did not properly handle HMTL-like "<!--" and "-->"
    comment tokens, nor hashbang "#!" comment tokens, in <script> contexts. This may
    cause the template parser to improperly interpret the contents of <script>
    contexts, causing actions to be improperly escaped. This could be leveraged to
    perform an XSS attack.

    Thanks to Takeshi Kaneko (GMO Cybersecurity by Ierae, Inc.) for reporting this
    issue.

    This is CVE-2023-39318 and Go issue https://go.dev/issue/62196.

  - html/template: improper handling of special tags within script contexts
    The html/template package did not apply the proper rules for handling occurrences
    of "<script", "<!--", and "</script" within JS literals in <script> contexts.
    This may cause the template parser to improperly consider script contexts to be
    terminated early, causing actions to be improperly escaped. This could be
    leveraged to perform an XSS attack.

    Thanks to Takeshi Kaneko (GMO Cybersecurity by Ierae, Inc.) for reporting this
    issue.

    This is CVE-2023-39319 and Go issue https://go.dev/issue/62197.

  - crypto/tls: panic when processing post-handshake message on QUIC connections
    Processing an incomplete post-handshake message for a QUIC connection caused a panic.

    Thanks to Marten Seemann for reporting this issue.

    This is CVE-2023-39321 and CVE-2023-39322 and Go issue https://go.dev/issue/62266.

  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
  (cherry picked from commit c41121cc48537b3b18084e14831fa254be714446)
  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
  c41121cc48537b3b18084e14831fa254be714446:update to go1.20.8

  go1.20.8 (released 2023-09-06) includes two security fixes to the html/template
  package, as well as bug fixes to the compiler, the go command, the runtime,
  and the crypto/tls, go/types, net/http, and path/filepath packages. See the
  Go 1.20.8 milestone on our issue tracker for details:

  https://github.com/golang/go/issues?q=milestone%3AGo1.20.8+label%3ACherryPickApproved

  full diff: https://github.com/golang/go/compare/go1.20.7...go1.20.8

  From the security mailing:

  [security] Go 1.21.1 and Go 1.20.8 are released

  Hello gophers,

  We have just released Go versions 1.21.1 and 1.20.8, minor point releases.

  These minor releases include 4 security fixes following the security policy:

  - cmd/go: go.mod toolchain directive allows arbitrary execution
    The go.mod toolchain directive, introduced in Go 1.21, could be leveraged to
    execute scripts and binaries relative to the root of the module when the "go"
    command was executed within the module. This applies to modules downloaded using
    the "go" command from the module proxy, as well as modules downloaded directly
    using VCS software.

    Thanks to Juho Nurminen of Mattermost for reporting this issue.

    This is CVE-2023-39320 and Go issue https://go.dev/issue/62198.

  - html/template: improper handling of HTML-like comments within script contexts
    The html/template package did not properly handle HMTL-like "<!--" and "-->"
    comment tokens, nor hashbang "#!" comment tokens, in <script> contexts. This may
    cause the template parser to improperly interpret the contents of <script>
    contexts, causing actions to be improperly escaped. This could be leveraged to
    perform an XSS attack.

    Thanks to Takeshi Kaneko (GMO Cybersecurity by Ierae, Inc.) for reporting this
    issue.

    This is CVE-2023-39318 and Go issue https://go.dev/issue/62196.

  - html/template: improper handling of special tags within script contexts
    The html/template package did not apply the proper rules for handling occurrences
    of "<script", "<!--", and "</script" within JS literals in <script> contexts.
    This may cause the template parser to improperly consider script contexts to be
    terminated early, causing actions to be improperly escaped. This could be
    leveraged to perform an XSS attack.

    Thanks to Takeshi Kaneko (GMO Cybersecurity by Ierae, Inc.) for reporting this
    issue.

    This is CVE-2023-39319 and Go issue https://go.dev/issue/62197.

  - crypto/tls: panic when processing post-handshake message on QUIC connections
    Processing an incomplete post-handshake message for a QUIC connection caused a panic.

    Thanks to Marten Seemann for reporting this issue.

    This is CVE-2023-39321 and CVE-2023-39322 and Go issue https://go.dev/issue/62266.

  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
impacted_packages:
  - purl: pkg:github/moby/moby
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/moby/moby
        commit: f014c349a0fd00df3bdca57aed124a93d2f8d2de
    introduced_in_commits: []
  - purl: pkg:github/moby/moby
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/moby/moby
        commit: 0dae84ca6455cd6217751ddae8a1ee8be15812d8
    introduced_in_commits: []
  - purl: pkg:github/moby/moby
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/moby/moby
        commit: c41121cc48537b3b18084e14831fa254be714446
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/moby/moby/tree/0dae84ca6455cd6217751ddae8a1ee8be15812d8
    reference_type: commit
    reference_id: 0dae84ca6455cd6217751ddae8a1ee8be15812d8
  - url: https://github.com/moby/moby/tree/c41121cc48537b3b18084e14831fa254be714446
    reference_type: commit
    reference_id: c41121cc48537b3b18084e14831fa254be714446
  - url: https://github.com/moby/moby/tree/f014c349a0fd00df3bdca57aed124a93d2f8d2de
    reference_type: commit
    reference_id: f014c349a0fd00df3bdca57aed124a93d2f8d2de
