advisory_id: CVE-2025-4674
datasource_id: collect_docker_moby_fix_commits/CVE-2025-4674
datasource_url: https://github.com/moby/moby
aliases: []
summary: |
  38c0abffceeac49449c48866d28facd7f0ca285b:update to go1.24.5

  - https://github.com/golang/go/issues?q=milestone%3AGo1.24.5+label%3ACherryPickApproved
  - full diff: https://github.com/golang/go/compare/go1.24.4...go1.24.5

  This minor releases include 1 security fixes following the security policy:

  - cmd/go: unexpected command execution in untrusted VCS repositories

      Various uses of the Go toolchain in untrusted VCS repositories can result in
      unexpected code execution. When using the Go toolchain in directories fetched
      using various VCS tools (such as directly cloning Git or Mercurial repositories)
      can cause the toolchain to execute unexpected commands, if said directory
      contains multiple VCS configuration metadata (such as a '.hg' directory in a Git
      repository). This is due to how the Go toolchain attempts to resolve which VCS
      is being used in order to embed build information in binaries and determine
      module versions.

      The toolchain will now abort attempting to resolve which VCS is being used if it
      detects multiple VCS configuration metadata in a module directory or nested VCS
      configuration metadata (such as a '.git' directoy in a parent directory and a
      '.hg' directory in a child directory). This will not prevent the toolchain from
      building modules, but will result in binaries omitting VCS related build
      information.

      If this behavior is expected by the user, the old behavior can be re-enabled by
      setting GODEBUG=allowmultiplevcs=1. This should only be done in trusted
      repositories.

      Thanks to RyotaK (https://ryotak.net) of GMO Flatt Security Inc for reporting
      this issue.

      This is CVE-2025-4674 and https://go.dev/issue/74380.

  View the release notes for more information:
  https://go.dev/doc/devel/release#go1.24.5

  Signed-off-by: Paweł Gronowski <pawel.gronowski@docker.com>
  (cherry picked from commit 0a047e825cf2b8c6f829c3118eaf9a44311f5f2e)
  Signed-off-by: Paweł Gronowski <pawel.gronowski@docker.com>
  0a047e825cf2b8c6f829c3118eaf9a44311f5f2e:update to go1.24.5

  - https://github.com/golang/go/issues?q=milestone%3AGo1.24.5+label%3ACherryPickApproved
  - full diff: https://github.com/golang/go/compare/go1.24.4...go1.24.5

  This minor releases include 1 security fixes following the security policy:

  - cmd/go: unexpected command execution in untrusted VCS repositories

      Various uses of the Go toolchain in untrusted VCS repositories can result in
      unexpected code execution. When using the Go toolchain in directories fetched
      using various VCS tools (such as directly cloning Git or Mercurial repositories)
      can cause the toolchain to execute unexpected commands, if said directory
      contains multiple VCS configuration metadata (such as a '.hg' directory in a Git
      repository). This is due to how the Go toolchain attempts to resolve which VCS
      is being used in order to embed build information in binaries and determine
      module versions.

      The toolchain will now abort attempting to resolve which VCS is being used if it
      detects multiple VCS configuration metadata in a module directory or nested VCS
      configuration metadata (such as a '.git' directoy in a parent directory and a
      '.hg' directory in a child directory). This will not prevent the toolchain from
      building modules, but will result in binaries omitting VCS related build
      information.

      If this behavior is expected by the user, the old behavior can be re-enabled by
      setting GODEBUG=allowmultiplevcs=1. This should only be done in trusted
      repositories.

      Thanks to RyotaK (https://ryotak.net) of GMO Flatt Security Inc for reporting
      this issue.

      This is CVE-2025-4674 and https://go.dev/issue/74380.

  View the release notes for more information:
  https://go.dev/doc/devel/release#go1.24.5

  Signed-off-by: Paweł Gronowski <pawel.gronowski@docker.com>
impacted_packages:
  - purl: pkg:github/moby/moby
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/moby/moby
        commit: 0a047e825cf2b8c6f829c3118eaf9a44311f5f2e
    introduced_in_commits: []
  - purl: pkg:github/moby/moby
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/moby/moby
        commit: 38c0abffceeac49449c48866d28facd7f0ca285b
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/moby/moby/tree/0a047e825cf2b8c6f829c3118eaf9a44311f5f2e
    reference_type: commit
    reference_id: 0a047e825cf2b8c6f829c3118eaf9a44311f5f2e
  - url: https://github.com/moby/moby/tree/38c0abffceeac49449c48866d28facd7f0ca285b
    reference_type: commit
    reference_id: 38c0abffceeac49449c48866d28facd7f0ca285b
