advisory_id: CVE-2023-45284
datasource_id: collect_docker_moby_fix_commits/CVE-2023-45284
datasource_url: https://github.com/moby/moby
aliases: []
summary: |
  1dcd83acb405aeb6f28d1c29f9d75144d7e233a6:update to go1.20.11

  go1.20.11 (released 2023-11-07) includes security fixes to the path/filepath
  package, as well as bug fixes to the linker and the net/http package. See the
  Go 1.20.11 milestone on our issue tracker for details:

  - https://github.com/golang/go/issues?q=milestone%3AGo1.20.11+label%3ACherryPickApproved
  - full diff: https://github.com/golang/go/compare/go1.20.10...go1.20.11

  from the security mailing:

  [security] Go 1.21.4 and Go 1.20.11 are released

  Hello gophers,

  We have just released Go versions 1.21.4 and 1.20.11, minor point releases.

  These minor releases include 2 security fixes following the security policy:

  - path/filepath: recognize `\??\` as a Root Local Device path prefix.

    On Windows, a path beginning with `\??\` is a Root Local Device path equivalent
    to a path beginning with `\\?\`. Paths with a `\??\` prefix may be used to
    access arbitrary locations on the system. For example, the path `\??\c:\x`
    is equivalent to the more common path c:\x.

    The filepath package did not recognize paths with a `\??\` prefix as special.

    Clean could convert a rooted path such as `\a\..\??\b` into
    the root local device path `\??\b`. It will now convert this
    path into `.\??\b`.

    `IsAbs` did not report paths beginning with `\??\` as absolute.
    It now does so.

    VolumeName now reports the `\??\` prefix as a volume name.

    `Join(`\`, `??`, `b`)` could convert a seemingly innocent
    sequence of path elements into the root local device path
    `\??\b`. It will now convert this to `\.\??\b`.

    This is CVE-2023-45283 and https://go.dev/issue/63713.

  - path/filepath: recognize device names with trailing spaces and superscripts

    The `IsLocal` function did not correctly detect reserved names in some cases:

    - reserved names followed by spaces, such as "COM1 ".
    - "COM" or "LPT" followed by a superscript 1, 2, or 3.

    `IsLocal` now correctly reports these names as non-local.

    This is CVE-2023-45284 and https://go.dev/issue/63713.

  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
  e6aa30b26ec00d368fe9058464011af8e688cccd:update to go1.20.11

  go1.20.11 (released 2023-11-07) includes security fixes to the path/filepath
  package, as well as bug fixes to the linker and the net/http package. See the
  Go 1.20.11 milestone on our issue tracker for details:

  - https://github.com/golang/go/issues?q=milestone%3AGo1.20.11+label%3ACherryPickApproved
  - full diff: https://github.com/golang/go/compare/go1.20.10...go1.20.11

  from the security mailing:

  [security] Go 1.21.4 and Go 1.20.11 are released

  Hello gophers,

  We have just released Go versions 1.21.4 and 1.20.11, minor point releases.

  These minor releases include 2 security fixes following the security policy:

  - path/filepath: recognize `\??\` as a Root Local Device path prefix.

    On Windows, a path beginning with `\??\` is a Root Local Device path equivalent
    to a path beginning with `\\?\`. Paths with a `\??\` prefix may be used to
    access arbitrary locations on the system. For example, the path `\??\c:\x`
    is equivalent to the more common path c:\x.

    The filepath package did not recognize paths with a `\??\` prefix as special.

    Clean could convert a rooted path such as `\a\..\??\b` into
    the root local device path `\??\b`. It will now convert this
    path into `.\??\b`.

    `IsAbs` did not report paths beginning with `\??\` as absolute.
    It now does so.

    VolumeName now reports the `\??\` prefix as a volume name.

    `Join(`\`, `??`, `b`)` could convert a seemingly innocent
    sequence of path elements into the root local device path
    `\??\b`. It will now convert this to `\.\??\b`.

    This is CVE-2023-45283 and https://go.dev/issue/63713.

  - path/filepath: recognize device names with trailing spaces and superscripts

    The `IsLocal` function did not correctly detect reserved names in some cases:

    - reserved names followed by spaces, such as "COM1 ".
    - "COM" or "LPT" followed by a superscript 1, 2, or 3.

    `IsLocal` now correctly reports these names as non-local.

    This is CVE-2023-45284 and https://go.dev/issue/63713.

  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
  0bf6ffba437d90230eddc8950215e122680ef439:update to go1.21.4

  go1.21.4 (released 2023-11-07) includes security fixes to the path/filepath
  package, as well as bug fixes to the linker, the runtime, the compiler, and
  the go/types, net/http, and runtime/cgo packages. See the Go 1.21.4 milestone
  on our issue tracker for details:

  - https://github.com/golang/go/issues?q=milestone%3AGo1.21.4+label%3ACherryPickApproved
  - full diff: https://github.com/golang/go/compare/go1.21.3...go1.21.4

  from the security mailing:

  [security] Go 1.21.4 and Go 1.20.11 are released

  Hello gophers,

  We have just released Go versions 1.21.4 and 1.20.11, minor point releases.

  These minor releases include 2 security fixes following the security policy:

  - path/filepath: recognize `\??\` as a Root Local Device path prefix.

    On Windows, a path beginning with `\??\` is a Root Local Device path equivalent
    to a path beginning with `\\?\`. Paths with a `\??\` prefix may be used to
    access arbitrary locations on the system. For example, the path `\??\c:\x`
    is equivalent to the more common path c:\x.

    The filepath package did not recognize paths with a `\??\` prefix as special.

    Clean could convert a rooted path such as `\a\..\??\b` into
    the root local device path `\??\b`. It will now convert this
    path into `.\??\b`.

    `IsAbs` did not report paths beginning with `\??\` as absolute.
    It now does so.

    VolumeName now reports the `\??\` prefix as a volume name.

    `Join(`\`, `??`, `b`)` could convert a seemingly innocent
    sequence of path elements into the root local device path
    `\??\b`. It will now convert this to `\.\??\b`.

    This is CVE-2023-45283 and https://go.dev/issue/63713.

  - path/filepath: recognize device names with trailing spaces and superscripts

    The `IsLocal` function did not correctly detect reserved names in some cases:

    - reserved names followed by spaces, such as "COM1 ".
    - "COM" or "LPT" followed by a superscript 1, 2, or 3.

    `IsLocal` now correctly reports these names as non-local.

    This is CVE-2023-45284 and https://go.dev/issue/63713.

  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
impacted_packages:
  - purl: pkg:github/moby/moby
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/moby/moby
        commit: e6aa30b26ec00d368fe9058464011af8e688cccd
    introduced_in_commits: []
  - purl: pkg:github/moby/moby
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/moby/moby
        commit: 1dcd83acb405aeb6f28d1c29f9d75144d7e233a6
    introduced_in_commits: []
  - purl: pkg:github/moby/moby
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/moby/moby
        commit: 0bf6ffba437d90230eddc8950215e122680ef439
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/moby/moby/tree/0bf6ffba437d90230eddc8950215e122680ef439
    reference_type: commit
    reference_id: 0bf6ffba437d90230eddc8950215e122680ef439
  - url: https://github.com/moby/moby/tree/1dcd83acb405aeb6f28d1c29f9d75144d7e233a6
    reference_type: commit
    reference_id: 1dcd83acb405aeb6f28d1c29f9d75144d7e233a6
  - url: https://github.com/moby/moby/tree/e6aa30b26ec00d368fe9058464011af8e688cccd
    reference_type: commit
    reference_id: e6aa30b26ec00d368fe9058464011af8e688cccd
