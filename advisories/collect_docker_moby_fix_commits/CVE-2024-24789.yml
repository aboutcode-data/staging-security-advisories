advisory_id: CVE-2024-24789
datasource_id: collect_docker_moby_fix_commits/CVE-2024-24789
datasource_url: https://github.com/moby/moby
aliases: []
summary: |
  b1aac1b13498202e295969fd0e70bc05f71cff7b:update to go1.21.11

  go1.21.11 (released 2024-06-04) includes security fixes to the archive/zip
  and net/netip packages, as well as bug fixes to the compiler, the go command,
  the runtime, and the os package. See the Go 1.21.11 milestone on our issue
  tracker for details;

  - https://github.com/golang/go/issues?q=milestone%3AGo1.21.11+label%3ACherryPickApproved
  - full diff: https://github.com/golang/go/compare/go1.21.10...go1.21.11

  From the security announcement;

  We have just released Go versions 1.22.4 and 1.21.11, minor point releases.
  These minor releases include 2 security fixes following the security policy:

  - archive/zip: mishandling of corrupt central directory record

    The archive/zip package's handling of certain types of invalid zip files
    differed from the behavior of most zip implementations. This misalignment
    could be exploited to create an zip file with contents that vary depending
    on the implementation reading the file. The archive/zip package now rejects
    files containing these errors.

    Thanks to Yufan You for reporting this issue.

    This is CVE-2024-24789 and Go issue https://go.dev/issue/66869.

  - net/netip: unexpected behavior from Is methods for IPv4-mapped IPv6 addresses

    The various Is methods (IsPrivate, IsLoopback, etc) did not work as expected
    for IPv4-mapped IPv6 addresses, returning false for addresses which would
    return true in their traditional IPv4 forms.

    Thanks to Enze Wang of Alioth and Jianjun Chen of Zhongguancun Lab
    for reporting this issue.

    This is CVE-2024-24790 and Go issue https://go.dev/issue/67680.

  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
  (cherry picked from commit 91e2c29865184924451ec03f675c0bfe91b63ac2)
  Signed-off-by: Austin Vazquez <macedonv@amazon.com>
  6ce2dd68661ca687591620e9afd2cccf361cfffc:update to go1.21.11

  go1.21.11 (released 2024-06-04) includes security fixes to the archive/zip
  and net/netip packages, as well as bug fixes to the compiler, the go command,
  the runtime, and the os package. See the Go 1.21.11 milestone on our issue
  tracker for details;

  - https://github.com/golang/go/issues?q=milestone%3AGo1.21.11+label%3ACherryPickApproved
  - full diff: https://github.com/golang/go/compare/go1.21.10...go1.21.11

  From the security announcement;

  We have just released Go versions 1.22.4 and 1.21.11, minor point releases.
  These minor releases include 2 security fixes following the security policy:

  - archive/zip: mishandling of corrupt central directory record

    The archive/zip package's handling of certain types of invalid zip files
    differed from the behavior of most zip implementations. This misalignment
    could be exploited to create an zip file with contents that vary depending
    on the implementation reading the file. The archive/zip package now rejects
    files containing these errors.

    Thanks to Yufan You for reporting this issue.

    This is CVE-2024-24789 and Go issue https://go.dev/issue/66869.

  - net/netip: unexpected behavior from Is methods for IPv4-mapped IPv6 addresses

    The various Is methods (IsPrivate, IsLoopback, etc) did not work as expected
    for IPv4-mapped IPv6 addresses, returning false for addresses which would
    return true in their traditional IPv4 forms.

    Thanks to Enze Wang of Alioth and Jianjun Chen of Zhongguancun Lab
    for reporting this issue.

    This is CVE-2024-24790 and Go issue https://go.dev/issue/67680.

  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
  (cherry picked from commit 91e2c29865184924451ec03f675c0bfe91b63ac2)
  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
  3115daaa91e57ab8668c44244642d5a174ae4ad7:update to go1.21.11

  go1.21.11 (released 2024-06-04) includes security fixes to the archive/zip
  and net/netip packages, as well as bug fixes to the compiler, the go command,
  the runtime, and the os package. See the Go 1.21.11 milestone on our issue
  tracker for details;

  - https://github.com/golang/go/issues?q=milestone%3AGo1.21.11+label%3ACherryPickApproved
  - full diff: https://github.com/golang/go/compare/go1.21.10...go1.21.11

  From the security announcement;

  We have just released Go versions 1.22.4 and 1.21.11, minor point releases.
  These minor releases include 2 security fixes following the security policy:

  - archive/zip: mishandling of corrupt central directory record

    The archive/zip package's handling of certain types of invalid zip files
    differed from the behavior of most zip implementations. This misalignment
    could be exploited to create an zip file with contents that vary depending
    on the implementation reading the file. The archive/zip package now rejects
    files containing these errors.

    Thanks to Yufan You for reporting this issue.

    This is CVE-2024-24789 and Go issue https://go.dev/issue/66869.

  - net/netip: unexpected behavior from Is methods for IPv4-mapped IPv6 addresses

    The various Is methods (IsPrivate, IsLoopback, etc) did not work as expected
    for IPv4-mapped IPv6 addresses, returning false for addresses which would
    return true in their traditional IPv4 forms.

    Thanks to Enze Wang of Alioth and Jianjun Chen of Zhongguancun Lab
    for reporting this issue.

    This is CVE-2024-24790 and Go issue https://go.dev/issue/67680.

  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
  (cherry picked from commit 91e2c29865184924451ec03f675c0bfe91b63ac2)
  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
  91e2c29865184924451ec03f675c0bfe91b63ac2:update to go1.21.11

  go1.21.11 (released 2024-06-04) includes security fixes to the archive/zip
  and net/netip packages, as well as bug fixes to the compiler, the go command,
  the runtime, and the os package. See the Go 1.21.11 milestone on our issue
  tracker for details;

  - https://github.com/golang/go/issues?q=milestone%3AGo1.21.11+label%3ACherryPickApproved
  - full diff: https://github.com/golang/go/compare/go1.21.10...go1.21.11

  From the security announcement;

  We have just released Go versions 1.22.4 and 1.21.11, minor point releases.
  These minor releases include 2 security fixes following the security policy:

  - archive/zip: mishandling of corrupt central directory record

    The archive/zip package's handling of certain types of invalid zip files
    differed from the behavior of most zip implementations. This misalignment
    could be exploited to create an zip file with contents that vary depending
    on the implementation reading the file. The archive/zip package now rejects
    files containing these errors.

    Thanks to Yufan You for reporting this issue.

    This is CVE-2024-24789 and Go issue https://go.dev/issue/66869.

  - net/netip: unexpected behavior from Is methods for IPv4-mapped IPv6 addresses

    The various Is methods (IsPrivate, IsLoopback, etc) did not work as expected
    for IPv4-mapped IPv6 addresses, returning false for addresses which would
    return true in their traditional IPv4 forms.

    Thanks to Enze Wang of Alioth and Jianjun Chen of Zhongguancun Lab
    for reporting this issue.

    This is CVE-2024-24790 and Go issue https://go.dev/issue/67680.

  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
impacted_packages:
  - purl: pkg:github/moby/moby
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/moby/moby
        commit: 91e2c29865184924451ec03f675c0bfe91b63ac2
    introduced_in_commits: []
  - purl: pkg:github/moby/moby
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/moby/moby
        commit: b1aac1b13498202e295969fd0e70bc05f71cff7b
    introduced_in_commits: []
  - purl: pkg:github/moby/moby
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/moby/moby
        commit: 3115daaa91e57ab8668c44244642d5a174ae4ad7
    introduced_in_commits: []
  - purl: pkg:github/moby/moby
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/moby/moby
        commit: 6ce2dd68661ca687591620e9afd2cccf361cfffc
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/moby/moby/tree/3115daaa91e57ab8668c44244642d5a174ae4ad7
    reference_type: commit
    reference_id: 3115daaa91e57ab8668c44244642d5a174ae4ad7
  - url: https://github.com/moby/moby/tree/6ce2dd68661ca687591620e9afd2cccf361cfffc
    reference_type: commit
    reference_id: 6ce2dd68661ca687591620e9afd2cccf361cfffc
  - url: https://github.com/moby/moby/tree/91e2c29865184924451ec03f675c0bfe91b63ac2
    reference_type: commit
    reference_id: 91e2c29865184924451ec03f675c0bfe91b63ac2
  - url: https://github.com/moby/moby/tree/b1aac1b13498202e295969fd0e70bc05f71cff7b
    reference_type: commit
    reference_id: b1aac1b13498202e295969fd0e70bc05f71cff7b
