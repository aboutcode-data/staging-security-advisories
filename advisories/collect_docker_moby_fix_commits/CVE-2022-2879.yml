advisory_id: CVE-2022-2879
datasource_id: collect_docker_moby_fix_commits/CVE-2022-2879
datasource_url: https://github.com/moby/moby
aliases: []
summary: |
  e3a0f2e6904a6a6eb6ef70eabcb93553c0532512:vendor: github.com/vbatts/tar-split v0.12.1

  archive/tar: fix for CVE-2022-2879

  full diff: https://github.com/vbatts/tar-split/compare/v0.11.6...v0.12.1

  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
  1c8c16524f94ae69eb33c5c9000e87615ce973a6:Update to go 1.19.2 to address CVE-2022-2879, CVE-2022-2880, CVE-2022-41715

  From the mailing list:

  We have just released Go versions 1.19.2 and 1.18.7, minor point releases.

  These minor releases include 3 security fixes following the security policy:

  - archive/tar: unbounded memory consumption when reading headers

    Reader.Read did not set a limit on the maximum size of file headers.
    A maliciously crafted archive could cause Read to allocate unbounded
    amounts of memory, potentially causing resource exhaustion or panics.
    Reader.Read now limits the maximum size of header blocks to 1 MiB.

    Thanks to Adam Korczynski (ADA Logics) and OSS-Fuzz for reporting this issue.

    This is CVE-2022-2879 and Go issue https://go.dev/issue/54853.

  - net/http/httputil: ReverseProxy should not forward unparseable query parameters

    Requests forwarded by ReverseProxy included the raw query parameters from the
    inbound request, including unparseable parameters rejected by net/http. This
    could permit query parameter smuggling when a Go proxy forwards a parameter
    with an unparseable value.

    ReverseProxy will now sanitize the query parameters in the forwarded query
    when the outbound request's Form field is set after the ReverseProxy.Director
    function returns, indicating that the proxy has parsed the query parameters.
    Proxies which do not parse query parameters continue to forward the original
    query parameters unchanged.

    Thanks to Gal Goldstein (Security Researcher, Oxeye) and
    Daniel Abeles (Head of Research, Oxeye) for reporting this issue.

    This is CVE-2022-2880 and Go issue https://go.dev/issue/54663.

  - regexp/syntax: limit memory used by parsing regexps

    The parsed regexp representation is linear in the size of the input,
    but in some cases the constant factor can be as high as 40,000,
    making relatively small regexps consume much larger amounts of memory.

    Each regexp being parsed is now limited to a 256 MB memory footprint.
    Regular expressions whose representation would use more space than that
    are now rejected. Normal use of regular expressions is unaffected.

    Thanks to Adam Korczynski (ADA Logics) and OSS-Fuzz for reporting this issue.

    This is CVE-2022-41715 and Go issue https://go.dev/issue/55949.

  View the release notes for more information: https://go.dev/doc/devel/release#go1.19.2

  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
  (cherry picked from commit 7b4e4c08b5a03cd7448adb72626382bd36bef981)
  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
  1c8c16524f94ae69eb33c5c9000e87615ce973a6:Update to go 1.19.2 to address CVE-2022-2879, CVE-2022-2880, CVE-2022-41715

  From the mailing list:

  We have just released Go versions 1.19.2 and 1.18.7, minor point releases.

  These minor releases include 3 security fixes following the security policy:

  - archive/tar: unbounded memory consumption when reading headers

    Reader.Read did not set a limit on the maximum size of file headers.
    A maliciously crafted archive could cause Read to allocate unbounded
    amounts of memory, potentially causing resource exhaustion or panics.
    Reader.Read now limits the maximum size of header blocks to 1 MiB.

    Thanks to Adam Korczynski (ADA Logics) and OSS-Fuzz for reporting this issue.

    This is CVE-2022-2879 and Go issue https://go.dev/issue/54853.

  - net/http/httputil: ReverseProxy should not forward unparseable query parameters

    Requests forwarded by ReverseProxy included the raw query parameters from the
    inbound request, including unparseable parameters rejected by net/http. This
    could permit query parameter smuggling when a Go proxy forwards a parameter
    with an unparseable value.

    ReverseProxy will now sanitize the query parameters in the forwarded query
    when the outbound request's Form field is set after the ReverseProxy.Director
    function returns, indicating that the proxy has parsed the query parameters.
    Proxies which do not parse query parameters continue to forward the original
    query parameters unchanged.

    Thanks to Gal Goldstein (Security Researcher, Oxeye) and
    Daniel Abeles (Head of Research, Oxeye) for reporting this issue.

    This is CVE-2022-2880 and Go issue https://go.dev/issue/54663.

  - regexp/syntax: limit memory used by parsing regexps

    The parsed regexp representation is linear in the size of the input,
    but in some cases the constant factor can be as high as 40,000,
    making relatively small regexps consume much larger amounts of memory.

    Each regexp being parsed is now limited to a 256 MB memory footprint.
    Regular expressions whose representation would use more space than that
    are now rejected. Normal use of regular expressions is unaffected.

    Thanks to Adam Korczynski (ADA Logics) and OSS-Fuzz for reporting this issue.

    This is CVE-2022-41715 and Go issue https://go.dev/issue/55949.

  View the release notes for more information: https://go.dev/doc/devel/release#go1.19.2

  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
  (cherry picked from commit 7b4e4c08b5a03cd7448adb72626382bd36bef981)
  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
  435c40ce1561e3fae3027445bbcbe72ddfaa4b20:Merge pull request #44247 from thaJeztah/20.10_bump_go_1.18.7

  [20.10] Update to go 1.18.7 to address CVE-2022-2879, CVE-2022-2880, CVE-2022-41715
  11bdbf40b9720592c28b3d28c0bcdae0eca3b052:[20.10] Update to go 1.18.7 to address CVE-2022-2879, CVE-2022-2880, CVE-2022-41715

  From the mailing list:

  We have just released Go versions 1.19.2 and 1.18.7, minor point releases.

  These minor releases include 3 security fixes following the security policy:

  - archive/tar: unbounded memory consumption when reading headers

    Reader.Read did not set a limit on the maximum size of file headers.
    A maliciously crafted archive could cause Read to allocate unbounded
    amounts of memory, potentially causing resource exhaustion or panics.
    Reader.Read now limits the maximum size of header blocks to 1 MiB.

    Thanks to Adam Korczynski (ADA Logics) and OSS-Fuzz for reporting this issue.

    This is CVE-2022-2879 and Go issue https://go.dev/issue/54853.

  - net/http/httputil: ReverseProxy should not forward unparseable query parameters

    Requests forwarded by ReverseProxy included the raw query parameters from the
    inbound request, including unparseable parameters rejected by net/http. This
    could permit query parameter smuggling when a Go proxy forwards a parameter
    with an unparseable value.

    ReverseProxy will now sanitize the query parameters in the forwarded query
    when the outbound request's Form field is set after the ReverseProxy.Director
    function returns, indicating that the proxy has parsed the query parameters.
    Proxies which do not parse query parameters continue to forward the original
    query parameters unchanged.

    Thanks to Gal Goldstein (Security Researcher, Oxeye) and
    Daniel Abeles (Head of Research, Oxeye) for reporting this issue.

    This is CVE-2022-2880 and Go issue https://go.dev/issue/54663.

  - regexp/syntax: limit memory used by parsing regexps

    The parsed regexp representation is linear in the size of the input,
    but in some cases the constant factor can be as high as 40,000,
    making relatively small regexps consume much larger amounts of memory.

    Each regexp being parsed is now limited to a 256 MB memory footprint.
    Regular expressions whose representation would use more space than that
    are now rejected. Normal use of regular expressions is unaffected.

    Thanks to Adam Korczynski (ADA Logics) and OSS-Fuzz for reporting this issue.

    This is CVE-2022-41715 and Go issue https://go.dev/issue/55949.

  View the release notes for more information: https://go.dev/doc/devel/release#go1.18.7

  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
  11bdbf40b9720592c28b3d28c0bcdae0eca3b052:[20.10] Update to go 1.18.7 to address CVE-2022-2879, CVE-2022-2880, CVE-2022-41715

  From the mailing list:

  We have just released Go versions 1.19.2 and 1.18.7, minor point releases.

  These minor releases include 3 security fixes following the security policy:

  - archive/tar: unbounded memory consumption when reading headers

    Reader.Read did not set a limit on the maximum size of file headers.
    A maliciously crafted archive could cause Read to allocate unbounded
    amounts of memory, potentially causing resource exhaustion or panics.
    Reader.Read now limits the maximum size of header blocks to 1 MiB.

    Thanks to Adam Korczynski (ADA Logics) and OSS-Fuzz for reporting this issue.

    This is CVE-2022-2879 and Go issue https://go.dev/issue/54853.

  - net/http/httputil: ReverseProxy should not forward unparseable query parameters

    Requests forwarded by ReverseProxy included the raw query parameters from the
    inbound request, including unparseable parameters rejected by net/http. This
    could permit query parameter smuggling when a Go proxy forwards a parameter
    with an unparseable value.

    ReverseProxy will now sanitize the query parameters in the forwarded query
    when the outbound request's Form field is set after the ReverseProxy.Director
    function returns, indicating that the proxy has parsed the query parameters.
    Proxies which do not parse query parameters continue to forward the original
    query parameters unchanged.

    Thanks to Gal Goldstein (Security Researcher, Oxeye) and
    Daniel Abeles (Head of Research, Oxeye) for reporting this issue.

    This is CVE-2022-2880 and Go issue https://go.dev/issue/54663.

  - regexp/syntax: limit memory used by parsing regexps

    The parsed regexp representation is linear in the size of the input,
    but in some cases the constant factor can be as high as 40,000,
    making relatively small regexps consume much larger amounts of memory.

    Each regexp being parsed is now limited to a 256 MB memory footprint.
    Regular expressions whose representation would use more space than that
    are now rejected. Normal use of regular expressions is unaffected.

    Thanks to Adam Korczynski (ADA Logics) and OSS-Fuzz for reporting this issue.

    This is CVE-2022-41715 and Go issue https://go.dev/issue/55949.

  View the release notes for more information: https://go.dev/doc/devel/release#go1.18.7

  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
  1fe550cfc70c6d3c8a56c3ca270e81aafe83fbe6:Update to go 1.19.2 to address CVE-2022-2879, CVE-2022-2880, CVE-2022-41715

  From the mailing list:

  We have just released Go versions 1.19.2 and 1.18.7, minor point releases.

  These minor releases include 3 security fixes following the security policy:

  - archive/tar: unbounded memory consumption when reading headers

    Reader.Read did not set a limit on the maximum size of file headers.
    A maliciously crafted archive could cause Read to allocate unbounded
    amounts of memory, potentially causing resource exhaustion or panics.
    Reader.Read now limits the maximum size of header blocks to 1 MiB.

    Thanks to Adam Korczynski (ADA Logics) and OSS-Fuzz for reporting this issue.

    This is CVE-2022-2879 and Go issue https://go.dev/issue/54853.

  - net/http/httputil: ReverseProxy should not forward unparseable query parameters

    Requests forwarded by ReverseProxy included the raw query parameters from the
    inbound request, including unparseable parameters rejected by net/http. This
    could permit query parameter smuggling when a Go proxy forwards a parameter
    with an unparseable value.

    ReverseProxy will now sanitize the query parameters in the forwarded query
    when the outbound request's Form field is set after the ReverseProxy.Director
    function returns, indicating that the proxy has parsed the query parameters.
    Proxies which do not parse query parameters continue to forward the original
    query parameters unchanged.

    Thanks to Gal Goldstein (Security Researcher, Oxeye) and
    Daniel Abeles (Head of Research, Oxeye) for reporting this issue.

    This is CVE-2022-2880 and Go issue https://go.dev/issue/54663.

  - regexp/syntax: limit memory used by parsing regexps

    The parsed regexp representation is linear in the size of the input,
    but in some cases the constant factor can be as high as 40,000,
    making relatively small regexps consume much larger amounts of memory.

    Each regexp being parsed is now limited to a 256 MB memory footprint.
    Regular expressions whose representation would use more space than that
    are now rejected. Normal use of regular expressions is unaffected.

    Thanks to Adam Korczynski (ADA Logics) and OSS-Fuzz for reporting this issue.

    This is CVE-2022-41715 and Go issue https://go.dev/issue/55949.

  View the release notes for more information: https://go.dev/doc/devel/release#go1.19.2

  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
  (cherry picked from commit 7b4e4c08b5a03cd7448adb72626382bd36bef981)
  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
  1fe550cfc70c6d3c8a56c3ca270e81aafe83fbe6:Update to go 1.19.2 to address CVE-2022-2879, CVE-2022-2880, CVE-2022-41715

  From the mailing list:

  We have just released Go versions 1.19.2 and 1.18.7, minor point releases.

  These minor releases include 3 security fixes following the security policy:

  - archive/tar: unbounded memory consumption when reading headers

    Reader.Read did not set a limit on the maximum size of file headers.
    A maliciously crafted archive could cause Read to allocate unbounded
    amounts of memory, potentially causing resource exhaustion or panics.
    Reader.Read now limits the maximum size of header blocks to 1 MiB.

    Thanks to Adam Korczynski (ADA Logics) and OSS-Fuzz for reporting this issue.

    This is CVE-2022-2879 and Go issue https://go.dev/issue/54853.

  - net/http/httputil: ReverseProxy should not forward unparseable query parameters

    Requests forwarded by ReverseProxy included the raw query parameters from the
    inbound request, including unparseable parameters rejected by net/http. This
    could permit query parameter smuggling when a Go proxy forwards a parameter
    with an unparseable value.

    ReverseProxy will now sanitize the query parameters in the forwarded query
    when the outbound request's Form field is set after the ReverseProxy.Director
    function returns, indicating that the proxy has parsed the query parameters.
    Proxies which do not parse query parameters continue to forward the original
    query parameters unchanged.

    Thanks to Gal Goldstein (Security Researcher, Oxeye) and
    Daniel Abeles (Head of Research, Oxeye) for reporting this issue.

    This is CVE-2022-2880 and Go issue https://go.dev/issue/54663.

  - regexp/syntax: limit memory used by parsing regexps

    The parsed regexp representation is linear in the size of the input,
    but in some cases the constant factor can be as high as 40,000,
    making relatively small regexps consume much larger amounts of memory.

    Each regexp being parsed is now limited to a 256 MB memory footprint.
    Regular expressions whose representation would use more space than that
    are now rejected. Normal use of regular expressions is unaffected.

    Thanks to Adam Korczynski (ADA Logics) and OSS-Fuzz for reporting this issue.

    This is CVE-2022-41715 and Go issue https://go.dev/issue/55949.

  View the release notes for more information: https://go.dev/doc/devel/release#go1.19.2

  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
  (cherry picked from commit 7b4e4c08b5a03cd7448adb72626382bd36bef981)
  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
  7b4e4c08b5a03cd7448adb72626382bd36bef981:Update to go 1.19.2 to address CVE-2022-2879, CVE-2022-2880, CVE-2022-41715

  From the mailing list:

  We have just released Go versions 1.19.2 and 1.18.7, minor point releases.

  These minor releases include 3 security fixes following the security policy:

  - archive/tar: unbounded memory consumption when reading headers

    Reader.Read did not set a limit on the maximum size of file headers.
    A maliciously crafted archive could cause Read to allocate unbounded
    amounts of memory, potentially causing resource exhaustion or panics.
    Reader.Read now limits the maximum size of header blocks to 1 MiB.

    Thanks to Adam Korczynski (ADA Logics) and OSS-Fuzz for reporting this issue.

    This is CVE-2022-2879 and Go issue https://go.dev/issue/54853.

  - net/http/httputil: ReverseProxy should not forward unparseable query parameters

    Requests forwarded by ReverseProxy included the raw query parameters from the
    inbound request, including unparseable parameters rejected by net/http. This
    could permit query parameter smuggling when a Go proxy forwards a parameter
    with an unparseable value.

    ReverseProxy will now sanitize the query parameters in the forwarded query
    when the outbound request's Form field is set after the ReverseProxy.Director
    function returns, indicating that the proxy has parsed the query parameters.
    Proxies which do not parse query parameters continue to forward the original
    query parameters unchanged.

    Thanks to Gal Goldstein (Security Researcher, Oxeye) and
    Daniel Abeles (Head of Research, Oxeye) for reporting this issue.

    This is CVE-2022-2880 and Go issue https://go.dev/issue/54663.

  - regexp/syntax: limit memory used by parsing regexps

    The parsed regexp representation is linear in the size of the input,
    but in some cases the constant factor can be as high as 40,000,
    making relatively small regexps consume much larger amounts of memory.

    Each regexp being parsed is now limited to a 256 MB memory footprint.
    Regular expressions whose representation would use more space than that
    are now rejected. Normal use of regular expressions is unaffected.

    Thanks to Adam Korczynski (ADA Logics) and OSS-Fuzz for reporting this issue.

    This is CVE-2022-41715 and Go issue https://go.dev/issue/55949.

  View the release notes for more information: https://go.dev/doc/devel/release#go1.19.2

  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
  7b4e4c08b5a03cd7448adb72626382bd36bef981:Update to go 1.19.2 to address CVE-2022-2879, CVE-2022-2880, CVE-2022-41715

  From the mailing list:

  We have just released Go versions 1.19.2 and 1.18.7, minor point releases.

  These minor releases include 3 security fixes following the security policy:

  - archive/tar: unbounded memory consumption when reading headers

    Reader.Read did not set a limit on the maximum size of file headers.
    A maliciously crafted archive could cause Read to allocate unbounded
    amounts of memory, potentially causing resource exhaustion or panics.
    Reader.Read now limits the maximum size of header blocks to 1 MiB.

    Thanks to Adam Korczynski (ADA Logics) and OSS-Fuzz for reporting this issue.

    This is CVE-2022-2879 and Go issue https://go.dev/issue/54853.

  - net/http/httputil: ReverseProxy should not forward unparseable query parameters

    Requests forwarded by ReverseProxy included the raw query parameters from the
    inbound request, including unparseable parameters rejected by net/http. This
    could permit query parameter smuggling when a Go proxy forwards a parameter
    with an unparseable value.

    ReverseProxy will now sanitize the query parameters in the forwarded query
    when the outbound request's Form field is set after the ReverseProxy.Director
    function returns, indicating that the proxy has parsed the query parameters.
    Proxies which do not parse query parameters continue to forward the original
    query parameters unchanged.

    Thanks to Gal Goldstein (Security Researcher, Oxeye) and
    Daniel Abeles (Head of Research, Oxeye) for reporting this issue.

    This is CVE-2022-2880 and Go issue https://go.dev/issue/54663.

  - regexp/syntax: limit memory used by parsing regexps

    The parsed regexp representation is linear in the size of the input,
    but in some cases the constant factor can be as high as 40,000,
    making relatively small regexps consume much larger amounts of memory.

    Each regexp being parsed is now limited to a 256 MB memory footprint.
    Regular expressions whose representation would use more space than that
    are now rejected. Normal use of regular expressions is unaffected.

    Thanks to Adam Korczynski (ADA Logics) and OSS-Fuzz for reporting this issue.

    This is CVE-2022-41715 and Go issue https://go.dev/issue/55949.

  View the release notes for more information: https://go.dev/doc/devel/release#go1.19.2

  Signed-off-by: Sebastiaan van Stijn <github@gone.nl>
impacted_packages:
  - purl: pkg:github/moby/moby
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/moby/moby
        commit: 435c40ce1561e3fae3027445bbcbe72ddfaa4b20
    introduced_in_commits: []
  - purl: pkg:github/moby/moby
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/moby/moby
        commit: 1fe550cfc70c6d3c8a56c3ca270e81aafe83fbe6
    introduced_in_commits: []
  - purl: pkg:github/moby/moby
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/moby/moby
        commit: 11bdbf40b9720592c28b3d28c0bcdae0eca3b052
    introduced_in_commits: []
  - purl: pkg:github/moby/moby
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/moby/moby
        commit: 7b4e4c08b5a03cd7448adb72626382bd36bef981
    introduced_in_commits: []
  - purl: pkg:github/moby/moby
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/moby/moby
        commit: 1c8c16524f94ae69eb33c5c9000e87615ce973a6
    introduced_in_commits: []
  - purl: pkg:github/moby/moby
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/moby/moby
        commit: e3a0f2e6904a6a6eb6ef70eabcb93553c0532512
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/moby/moby/tree/11bdbf40b9720592c28b3d28c0bcdae0eca3b052
    reference_type: commit
    reference_id: 11bdbf40b9720592c28b3d28c0bcdae0eca3b052
  - url: https://github.com/moby/moby/tree/1c8c16524f94ae69eb33c5c9000e87615ce973a6
    reference_type: commit
    reference_id: 1c8c16524f94ae69eb33c5c9000e87615ce973a6
  - url: https://github.com/moby/moby/tree/1fe550cfc70c6d3c8a56c3ca270e81aafe83fbe6
    reference_type: commit
    reference_id: 1fe550cfc70c6d3c8a56c3ca270e81aafe83fbe6
  - url: https://github.com/moby/moby/tree/435c40ce1561e3fae3027445bbcbe72ddfaa4b20
    reference_type: commit
    reference_id: 435c40ce1561e3fae3027445bbcbe72ddfaa4b20
  - url: https://github.com/moby/moby/tree/7b4e4c08b5a03cd7448adb72626382bd36bef981
    reference_type: commit
    reference_id: 7b4e4c08b5a03cd7448adb72626382bd36bef981
  - url: https://github.com/moby/moby/tree/e3a0f2e6904a6a6eb6ef70eabcb93553c0532512
    reference_type: commit
    reference_id: e3a0f2e6904a6a6eb6ef70eabcb93553c0532512
