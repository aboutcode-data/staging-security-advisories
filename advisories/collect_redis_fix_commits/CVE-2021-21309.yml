advisory_id: CVE-2021-21309
datasource_id: collect_redis_fix_commits/CVE-2021-21309
datasource_url: https://github.com/redis/redis
aliases: []
summary: "c992857618db99776917f10bf4f2345a5fdc78b0:Fix integer overflow (CVE-2021-21309). (#8522)\n\
  \nOn 32-bit systems, setting the proto-max-bulk-len config parameter to a high value may result\
  \ with integer overflow and a subsequent heap overflow when parsing an input bulk (CVE-2021-21309).\n\
  \nThis fix has two parts:\n\nSet a reasonable limit to the config parameter.\nAdd additional\
  \ checks to prevent the problem in other potential but unknown code paths.\n\n(cherry picked\
  \ from commit d32f2e9999ce003bad0bd2c3bca29f64dcce4433)\nc992857618db99776917f10bf4f2345a5fdc78b0:Fix\
  \ integer overflow (CVE-2021-21309). (#8522)\n\nOn 32-bit systems, setting the proto-max-bulk-len\
  \ config parameter to a high value may result with integer overflow and a subsequent heap\
  \ overflow when parsing an input bulk (CVE-2021-21309).\n\nThis fix has two parts:\n\nSet\
  \ a reasonable limit to the config parameter.\nAdd additional checks to prevent the problem\
  \ in other potential but unknown code paths.\n\n(cherry picked from commit d32f2e9999ce003bad0bd2c3bca29f64dcce4433)\n\
  48f04a82a0ac542341fb644a4cfbebadd5c59a33:Fix integer overflow (CVE-2021-21309). (#8522)\n\n\
  On 32-bit systems, setting the proto-max-bulk-len config parameter to a high value may result\
  \ with integer overflow and a subsequent heap overflow when parsing an input bulk (CVE-2021-21309).\n\
  \nThis fix has two parts:\n\nSet a reasonable limit to the config parameter.\nAdd additional\
  \ checks to prevent the problem in other potential but unknown code paths.\n\n(cherry picked\
  \ from commit d32f2e9999ce003bad0bd2c3bca29f64dcce4433)\n\nFix MSVR reported issue.\n48f04a82a0ac542341fb644a4cfbebadd5c59a33:Fix\
  \ integer overflow (CVE-2021-21309). (#8522)\n\nOn 32-bit systems, setting the proto-max-bulk-len\
  \ config parameter to a high value may result with integer overflow and a subsequent heap\
  \ overflow when parsing an input bulk (CVE-2021-21309).\n\nThis fix has two parts:\n\nSet\
  \ a reasonable limit to the config parameter.\nAdd additional checks to prevent the problem\
  \ in other potential but unknown code paths.\n\n(cherry picked from commit d32f2e9999ce003bad0bd2c3bca29f64dcce4433)\n\
  \nFix MSVR reported issue.\nd32f2e9999ce003bad0bd2c3bca29f64dcce4433:Fix integer overflow\
  \ (CVE-2021-21309). (#8522)\n\nOn 32-bit systems, setting the proto-max-bulk-len config parameter\
  \ to a high value may result with integer overflow and a subsequent heap overflow when parsing\
  \ an input bulk (CVE-2021-21309).\r\n\r\nThis fix has two parts:\r\n\r\nSet a reasonable limit\
  \ to the config parameter.\r\nAdd additional checks to prevent the problem in other potential\
  \ but unknown code paths.\nd32f2e9999ce003bad0bd2c3bca29f64dcce4433:Fix integer overflow (CVE-2021-21309).\
  \ (#8522)\n\nOn 32-bit systems, setting the proto-max-bulk-len config parameter to a high\
  \ value may result with integer overflow and a subsequent heap overflow when parsing an input\
  \ bulk (CVE-2021-21309).\r\n\r\nThis fix has two parts:\r\n\r\nSet a reasonable limit to the\
  \ config parameter.\r\nAdd additional checks to prevent the problem in other potential but\
  \ unknown code paths."
impacted_packages:
  - purl: pkg:github/redis/redis
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/redis/redis
        commit: c992857618db99776917f10bf4f2345a5fdc78b0
    introduced_in_commits: []
  - purl: pkg:github/redis/redis
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/redis/redis
        commit: 48f04a82a0ac542341fb644a4cfbebadd5c59a33
    introduced_in_commits: []
  - purl: pkg:github/redis/redis
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/redis/redis
        commit: d32f2e9999ce003bad0bd2c3bca29f64dcce4433
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/redis/redis/tree/48f04a82a0ac542341fb644a4cfbebadd5c59a33
    reference_type: commit
    reference_id: 48f04a82a0ac542341fb644a4cfbebadd5c59a33
  - url: https://github.com/redis/redis/tree/c992857618db99776917f10bf4f2345a5fdc78b0
    reference_type: commit
    reference_id: c992857618db99776917f10bf4f2345a5fdc78b0
  - url: https://github.com/redis/redis/tree/d32f2e9999ce003bad0bd2c3bca29f64dcce4433
    reference_type: commit
    reference_id: d32f2e9999ce003bad0bd2c3bca29f64dcce4433
