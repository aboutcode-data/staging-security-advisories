advisory_id: CVE-2021-32672
datasource_id: collect_redis_fix_commits/CVE-2021-32672
datasource_url: https://github.com/redis/redis
aliases: []
summary: "3e09be56a8a65ad2549452e5bf7a36eb991b8954:Fix protocol parsing on 'ldbReplParseCommand'\
  \ (CVE-2021-32672)\n\nThe protocol parsing on 'ldbReplParseCommand' (LUA debugging)\nAssumed\
  \ protocol correctness. This means that if the following\nis given:\n*1\n$100\ntest\nThe parser\
  \ will try to read additional 94 unallocated bytes after\nthe client buffer.\nThis commit\
  \ fixes this issue by validating that there are actually enough\nbytes to read. It also limits\
  \ the amount of data that can be sent by\nthe debugger client to 1M so the client will not\
  \ be able to explode\nthe memory.\n6ac3c0b7abd35f37201ed2d6298ecef4ea1ae1dd:Fix protocol parsing\
  \ on 'ldbReplParseCommand' (CVE-2021-32672)\n\nThe protocol parsing on 'ldbReplParseCommand'\
  \ (LUA debugging)\nAssumed protocol correctness. This means that if the following\nis given:\n\
  *1\n$100\ntest\nThe parser will try to read additional 94 unallocated bytes after\nthe client\
  \ buffer.\nThis commit fixes this issue by validating that there are actually enough\nbytes\
  \ to read. It also limits the amount of data that can be sent by\nthe debugger client to 1M\
  \ so the client will not be able to explode\nthe memory.\nf621c0a4cbf6b69a674495eb3c0dd16fffeea902:Fix\
  \ protocol parsing on 'ldbReplParseCommand' (CVE-2021-32672)\n\nThe protocol parsing on 'ldbReplParseCommand'\
  \ (LUA debugging)\nAssumed protocol correctness. This means that if the following\nis given:\n\
  *1\n$100\ntest\nThe parser will try to read additional 94 unallocated bytes after\nthe client\
  \ buffer.\nThis commit fixes this issue by validating that there are actually enough\nbytes\
  \ to read. It also limits the amount of data that can be sent by\nthe debugger client to 1M\
  \ so the client will not be able to explode\nthe memory.\n\n(cherry picked from commit 4f95e6809902665ced50646107d174dd8137bcaa)\n\
  b0ca3be2bba3092ec7cc18e1d87380b1af951d48:Fix protocol parsing on 'ldbReplParseCommand' (CVE-2021-32672)\
  \ (#9590)\n\nThe protocol parsing on 'ldbReplParseCommand' (LUA debugging)\r\nAssumed protocol\
  \ correctness. This means that if the following\r\nis given:\r\n*1\r\n$100\r\ntest\r\nThe\
  \ parser will try to read additional 94 unallocated bytes after\r\nthe client buffer.\r\n\
  This commit fixes this issue by validating that there are actually enough\r\nbytes to read.\
  \ It also limits the amount of data that can be sent by\r\nthe debugger client to 1M so the\
  \ client will not be able to explode\r\nthe memory.\r\n\r\nCo-authored-by: meir@redislabs.com\
  \ <meir@redislabs.com>"
impacted_packages:
  - purl: pkg:github/redis/redis
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/redis/redis
        commit: 6ac3c0b7abd35f37201ed2d6298ecef4ea1ae1dd
    introduced_in_commits: []
  - purl: pkg:github/redis/redis
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/redis/redis
        commit: 3e09be56a8a65ad2549452e5bf7a36eb991b8954
    introduced_in_commits: []
  - purl: pkg:github/redis/redis
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/redis/redis
        commit: b0ca3be2bba3092ec7cc18e1d87380b1af951d48
    introduced_in_commits: []
  - purl: pkg:github/redis/redis
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/redis/redis
        commit: f621c0a4cbf6b69a674495eb3c0dd16fffeea902
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/redis/redis/tree/3e09be56a8a65ad2549452e5bf7a36eb991b8954
    reference_type: commit
    reference_id: 3e09be56a8a65ad2549452e5bf7a36eb991b8954
  - url: https://github.com/redis/redis/tree/6ac3c0b7abd35f37201ed2d6298ecef4ea1ae1dd
    reference_type: commit
    reference_id: 6ac3c0b7abd35f37201ed2d6298ecef4ea1ae1dd
  - url: https://github.com/redis/redis/tree/b0ca3be2bba3092ec7cc18e1d87380b1af951d48
    reference_type: commit
    reference_id: b0ca3be2bba3092ec7cc18e1d87380b1af951d48
  - url: https://github.com/redis/redis/tree/f621c0a4cbf6b69a674495eb3c0dd16fffeea902
    reference_type: commit
    reference_id: f621c0a4cbf6b69a674495eb3c0dd16fffeea902
