advisory_id: CVE-2021-32627
datasource_id: collect_redis_fix_commits/CVE-2021-32627
datasource_url: https://github.com/redis/redis
aliases: []
summary: "2775a3526e3e8bb040e72995231632c801977395:Fix ziplist and listpack overflows and truncations\
  \ (CVE-2021-32627, CVE-2021-32628)\n\n- fix possible heap corruption in ziplist and listpack\
  \ resulting by trying to\n  allocate more than the maximum size of 4GB.\n- prevent ziplist\
  \ (hash and zset) from reaching size of above 1GB, will be\n  converted to HT encoding, that's\
  \ not a useful size.\n- prevent listpack (stream) from reaching size of above 1GB.\n- XADD\
  \ will start a new listpack if the new record may cause the previous\n  listpack to grow over\
  \ 1GB.\n- XADD will respond with an error if a single stream record is over 1GB\n- List type\
  \ (ziplist in quicklist) was truncating strings that were over 4GB,\n  now it'll respond with\
  \ an error.\nf6a40570fa63d5afdd596c78083d754081d80ae3:Fix ziplist and listpack overflows and\
  \ truncations (CVE-2021-32627, CVE-2021-32628)\n\n- fix possible heap corruption in ziplist\
  \ and listpack resulting by trying to\n  allocate more than the maximum size of 4GB.\n- prevent\
  \ ziplist (hash and zset) from reaching size of above 1GB, will be\n  converted to HT encoding,\
  \ that's not a useful size.\n- prevent listpack (stream) from reaching size of above 1GB.\n\
  - XADD will start a new listpack if the new record may cause the previous\n  listpack to grow\
  \ over 1GB.\n- XADD will respond with an error if a single stream record is over 1GB\n- List\
  \ type (ziplist in quicklist) was truncating strings that were over 4GB,\n  now it'll respond\
  \ with an error.\n6facfb7a103b26b9a602253a738b2130afb7c5d3:Fix ziplist and listpack overflows\
  \ and truncations (CVE-2021-32627, CVE-2021-32628)\n\n- fix possible heap corruption in ziplist\
  \ and listpack resulting by trying to\n  allocate more than the maximum size of 4GB.\n- prevent\
  \ ziplist (hash and zset) from reaching size of above 1GB, will be\n  converted to HT encoding,\
  \ that's not a useful size.\n- prevent listpack (stream) from reaching size of above 1GB.\n\
  - XADD will start a new listpack if the new record may cause the previous\n  listpack to grow\
  \ over 1GB.\n- XADD will respond with an error if a single stream record is over 1GB\n- List\
  \ type (ziplist in quicklist) was truncating strings that were over 4GB,\n  now it'll respond\
  \ with an error.\n\n(cherry picked from commit 68e221a3f98a427805d31c1760b4cdf37ba810ab)\n\
  c5e6a6204c4cf57f85e7c83a9b4e99f1a7204fd2:Fix ziplist and listpack overflows and truncations\
  \ (CVE-2021-32627, CVE-2021-32628) (#9589)\n\n- fix possible heap corruption in ziplist and\
  \ listpack resulting by trying to\r\n  allocate more than the maximum size of 4GB.\r\n- prevent\
  \ ziplist (hash and zset) from reaching size of above 1GB, will be\r\n  converted to HT encoding,\
  \ that's not a useful size.\r\n- prevent listpack (stream) from reaching size of above 1GB.\r\
  \n- XADD will start a new listpack if the new record may cause the previous\r\n  listpack\
  \ to grow over 1GB.\r\n- XADD will respond with an error if a single stream record is over\
  \ 1GB\r\n- List type (ziplist in quicklist) was truncating strings that were over 4GB,\r\n\
  \  now it'll respond with an error.\r\n\r\nCo-authored-by: sundb <sundbcn@gmail.com>"
impacted_packages:
  - purl: pkg:github/redis/redis
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/redis/redis
        commit: f6a40570fa63d5afdd596c78083d754081d80ae3
    introduced_in_commits: []
  - purl: pkg:github/redis/redis
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/redis/redis
        commit: c5e6a6204c4cf57f85e7c83a9b4e99f1a7204fd2
    introduced_in_commits: []
  - purl: pkg:github/redis/redis
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/redis/redis
        commit: 2775a3526e3e8bb040e72995231632c801977395
    introduced_in_commits: []
  - purl: pkg:github/redis/redis
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/redis/redis
        commit: 6facfb7a103b26b9a602253a738b2130afb7c5d3
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/redis/redis/tree/2775a3526e3e8bb040e72995231632c801977395
    reference_type: commit
    reference_id: 2775a3526e3e8bb040e72995231632c801977395
  - url: https://github.com/redis/redis/tree/6facfb7a103b26b9a602253a738b2130afb7c5d3
    reference_type: commit
    reference_id: 6facfb7a103b26b9a602253a738b2130afb7c5d3
  - url: https://github.com/redis/redis/tree/c5e6a6204c4cf57f85e7c83a9b4e99f1a7204fd2
    reference_type: commit
    reference_id: c5e6a6204c4cf57f85e7c83a9b4e99f1a7204fd2
  - url: https://github.com/redis/redis/tree/f6a40570fa63d5afdd596c78083d754081d80ae3
    reference_type: commit
    reference_id: f6a40570fa63d5afdd596c78083d754081d80ae3
