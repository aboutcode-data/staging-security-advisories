advisory_id: CVE-2021-29478
datasource_id: collect_redis_fix_commits/CVE-2021-29478
datasource_url: https://github.com/redis/redis
aliases: []
summary: |
  046352069396fe3be0a50ca505cb65af15c0d995:Fix integer overflow in intset (CVE-2021-29478)

  An integer overflow bug in Redis 6.2 could be exploited to corrupt the heap and
  potentially result with remote code execution.

  The vulnerability involves changing the default set-max-intset-entries
  configuration value, creating a large set key that consists of integer values
  and using the COPY command to duplicate it.

  The integer overflow bug exists in all versions of Redis starting with 2.6,
  where it could result with a corrupted RDB or DUMP payload, but not exploited
  through COPY (which did not exist before 6.2).

  (cherry picked from commit 29900d4e6bccdf3691bedf0ea9a5d84863fa3592)
  789f10156009b404950ad717642a9496ed887083:Fix integer overflow in intset (CVE-2021-29478)

  An integer overflow bug in Redis 6.2 could be exploited to corrupt the heap and
  potentially result with remote code execution.

  The vulnerability involves changing the default set-max-intset-entries
  configuration value, creating a large set key that consists of integer values
  and using the COPY command to duplicate it.

  The integer overflow bug exists in all versions of Redis starting with 2.6,
  where it could result with a corrupted RDB or DUMP payload, but not exploited
  through COPY (which did not exist before 6.2).

  (cherry picked from commit 29900d4e6bccdf3691bedf0ea9a5d84863fa3592)
  29900d4e6bccdf3691bedf0ea9a5d84863fa3592:Fix integer overflow in intset (CVE-2021-29478)

  An integer overflow bug in Redis 6.2 could be exploited to corrupt the heap and
  potentially result with remote code execution.

  The vulnerability involves changing the default set-max-intset-entries
  configuration value, creating a large set key that consists of integer values
  and using the COPY command to duplicate it.

  The integer overflow bug exists in all versions of Redis starting with 2.6,
  where it could result with a corrupted RDB or DUMP payload, but not exploited
  through COPY (which did not exist before 6.2).
impacted_packages:
  - purl: pkg:github/redis/redis
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/redis/redis
        commit: 789f10156009b404950ad717642a9496ed887083
    introduced_in_commits: []
  - purl: pkg:github/redis/redis
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/redis/redis
        commit: 29900d4e6bccdf3691bedf0ea9a5d84863fa3592
    introduced_in_commits: []
  - purl: pkg:github/redis/redis
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/redis/redis
        commit: 046352069396fe3be0a50ca505cb65af15c0d995
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/redis/redis/tree/046352069396fe3be0a50ca505cb65af15c0d995
    reference_type: commit
    reference_id: 046352069396fe3be0a50ca505cb65af15c0d995
  - url: https://github.com/redis/redis/tree/29900d4e6bccdf3691bedf0ea9a5d84863fa3592
    reference_type: commit
    reference_id: 29900d4e6bccdf3691bedf0ea9a5d84863fa3592
  - url: https://github.com/redis/redis/tree/789f10156009b404950ad717642a9496ed887083
    reference_type: commit
    reference_id: 789f10156009b404950ad717642a9496ed887083
