advisory_id: CVE-2023-45145
datasource_id: collect_redis_fix_commits/CVE-2023-45145
datasource_url: https://github.com/redis/redis
aliases: []
summary: "03345ddc7faf7af079485f2cbe5d17a1611cbce1:Fix issue of listen before chmod on Unix\
  \ sockets (CVE-2023-45145) (#12671)\n\nBefore this commit, Unix socket setup performed chmod(2)\
  \ on the socket\r\nfile after calling listen(2). Depending on what umask is used, this\r\n\
  could leave the file with the wrong permissions for a short period of\r\ntime. As a result,\
  \ another process could exploit this race condition and\r\nestablish a connection that would\
  \ otherwise not be possible.\r\n\r\nWe now make sure the socket permissions are set up prior\
  \ to calling\r\nlisten(2).\r\n\r\n(cherry picked from commit 1119ecae6fd8796fa337df2212f09173ab6c7b0a)\r\
  \n\r\nCo-authored-by: Yossi Gottlieb <yossigo@gmail.com>\n1119ecae6fd8796fa337df2212f09173ab6c7b0a:Fix\
  \ issue of listen before chmod on Unix sockets (CVE-2023-45145)\n\nBefore this commit, Unix\
  \ socket setup performed chmod(2) on the socket\nfile after calling listen(2). Depending on\
  \ what umask is used, this\ncould leave the file with the wrong permissions for a short period\
  \ of\ntime. As a result, another process could exploit this race condition and\nestablish\
  \ a connection that would otherwise not be possible.\n\nWe now make sure the socket permissions\
  \ are set up prior to calling\nlisten(2).\n7f486ea6eebf0afce74f2e59763b9b82b78629dc:Fix issue\
  \ of listen before chmod on Unix sockets (CVE-2023-45145)\n\nBefore this commit, Unix socket\
  \ setup performed chmod(2) on the socket\nfile after calling listen(2). Depending on what\
  \ umask is used, this\ncould leave the file with the wrong permissions for a short period\
  \ of\ntime. As a result, another process could exploit this race condition and\nestablish\
  \ a connection that would otherwise not be possible.\n\nWe now make sure the socket permissions\
  \ are set up prior to calling\nlisten(2).\n\n(cherry picked from commit a11b3bc34a054818f2ac70e50adfc542ca1cba42)\n\
  8f30d2a6043b765d9dded2c9308b9de7fb5c127c:Fix issue of listen before chmod on Unix sockets\
  \ (CVE-2023-45145)\n\nBefore this commit, Unix socket setup performed chmod(2) on the socket\n\
  file after calling listen(2). Depending on what umask is used, this\ncould leave the file\
  \ with the wrong permissions for a short period of\ntime. As a result, another process could\
  \ exploit this race condition and\nestablish a connection that would otherwise not be possible.\n\
  \nWe now make sure the socket permissions are set up prior to calling\nlisten(2).\n\n(cherry\
  \ picked from commit a11b3bc34a054818f2ac70e50adfc542ca1cba42)\n(cherry picked from commit\
  \ 3ca02a0c541e019d77014424e207123160520cec)"
impacted_packages:
  - purl: pkg:github/redis/redis
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/redis/redis
        commit: 1119ecae6fd8796fa337df2212f09173ab6c7b0a
    introduced_in_commits: []
  - purl: pkg:github/redis/redis
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/redis/redis
        commit: 03345ddc7faf7af079485f2cbe5d17a1611cbce1
    introduced_in_commits: []
  - purl: pkg:github/redis/redis
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/redis/redis
        commit: 8f30d2a6043b765d9dded2c9308b9de7fb5c127c
    introduced_in_commits: []
  - purl: pkg:github/redis/redis
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/redis/redis
        commit: 7f486ea6eebf0afce74f2e59763b9b82b78629dc
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/redis/redis/tree/03345ddc7faf7af079485f2cbe5d17a1611cbce1
    reference_type: commit
    reference_id: 03345ddc7faf7af079485f2cbe5d17a1611cbce1
  - url: https://github.com/redis/redis/tree/1119ecae6fd8796fa337df2212f09173ab6c7b0a
    reference_type: commit
    reference_id: 1119ecae6fd8796fa337df2212f09173ab6c7b0a
  - url: https://github.com/redis/redis/tree/7f486ea6eebf0afce74f2e59763b9b82b78629dc
    reference_type: commit
    reference_id: 7f486ea6eebf0afce74f2e59763b9b82b78629dc
  - url: https://github.com/redis/redis/tree/8f30d2a6043b765d9dded2c9308b9de7fb5c127c
    reference_type: commit
    reference_id: 8f30d2a6043b765d9dded2c9308b9de7fb5c127c
