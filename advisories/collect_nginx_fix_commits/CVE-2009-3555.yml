advisory_id: CVE-2009-3555
datasource_id: collect_nginx_fix_commits/CVE-2009-3555
datasource_url: https://github.com/nginx/nginx
aliases: []
summary: |
  36be79301e513a97ec170950b6c9216100b2c264:SSL: disabled renegotiation detection in client mode.

  CVE-2009-3555 is no longer relevant and mitigated by the renegotiation
  info extension (secure renegotiation).  On the other hand, unexpected
  renegotiation still introduces potential security risks, and hence we do
  not allow renegotiation on the server side, as we never request renegotiation.

  On the client side the situation is different though.  There are backends
  which explicitly request renegotiation, and disabled renegotiation
  introduces interoperability problems.  This change allows renegotiation
  on the client side, and fixes interoperability problems as observed with
  such backends (ticket #872).

  Additionally, with TLSv1.3 the SSL_CB_HANDSHAKE_START flag is currently set
  by OpenSSL when receiving a NewSessionTicket message, and was detected by
  nginx as a renegotiation attempt.  This looks like a bug in OpenSSL, though
  this change also allows better interoperability till the problem is fixed.
  0da83434d705483a7cd8c710396c9238622843a6:r3301 merge:

  disable SSL renegotiation (CVE-2009-3555)
  70bd187c4c386d82d6e4d180e0db84f361d1be02:disable SSL renegotiation (CVE-2009-3555)
impacted_packages:
  - purl: pkg:github/nginx/nginx
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nginx/nginx
        commit: 70bd187c4c386d82d6e4d180e0db84f361d1be02
    introduced_in_commits: []
  - purl: pkg:github/nginx/nginx
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nginx/nginx
        commit: 36be79301e513a97ec170950b6c9216100b2c264
    introduced_in_commits: []
  - purl: pkg:github/nginx/nginx
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/nginx/nginx
        commit: 0da83434d705483a7cd8c710396c9238622843a6
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/nginx/nginx/tree/0da83434d705483a7cd8c710396c9238622843a6
    reference_type: commit
    reference_id: 0da83434d705483a7cd8c710396c9238622843a6
  - url: https://github.com/nginx/nginx/tree/36be79301e513a97ec170950b6c9216100b2c264
    reference_type: commit
    reference_id: 36be79301e513a97ec170950b6c9216100b2c264
  - url: https://github.com/nginx/nginx/tree/70bd187c4c386d82d6e4d180e0db84f361d1be02
    reference_type: commit
    reference_id: 70bd187c4c386d82d6e4d180e0db84f361d1be02
