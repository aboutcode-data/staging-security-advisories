advisory_id: CVE-2017-12995
datasource_id: collect_tcpdump_fix_commits/CVE-2017-12995
datasource_url: https://github.com/the-tcpdump-group/tcpdump
aliases: []
summary: |
  3a76fd7c95fced2c2f8c8148a9055c3a542eff29:CVE-2017-12995/Check for DNS compression pointers that don't point backwards.

  This is what BIND 9.11.0-P2 does; it not only detects pointers that
  loop, as "point backwards" means "point before anything we've processed
  so far, including what we're processing right now", so the pointer can't
  point to itself (as that's what we're processing right now).

  This fixes an infinite loop discovered by Forcepoint's security
  researchers Otto Airamo & Antti Levomäki.

  Add a test using the capture file supplied by the reporter(s).

  Also, add some infinite-pointer-loop captures.

  More checks should be done.  We might, for example, want to make sure
  the upper 2 bits of the label length/pointer byte are 00 or 11, and that
  if we encounter a pointer and jump backwards to what we think is a label
  the label ends before the beginning of the last label we processed, to
  make sure the pointer doesn't point backwards into the *middle* of a
  label, and also make sure the entire name is <= 255 bytes long.
  d609d7c6ae2505ea3337b2e00cb18e1f551dfbf2:CVE-2017-12995/Check for DNS compression pointers that don't point backwards.

  This is what BIND 9.11.0-P2 does; it not only detects pointers that
  loop, as "point backwards" means "point before anything we've processed
  so far, including what we're processing right now", so the pointer can't
  point to itself (as that's what we're processing right now).

  This fixes an infinite loop discovered by Forcepoint's security
  researchers Otto Airamo & Antti Levomäki.

  Add a test using the capture file supplied by the reporter(s).

  Also, add some infinite-pointer-loop captures.

  More checks should be done.  We might, for example, want to make sure
  the upper 2 bits of the label length/pointer byte are 00 or 11, and that
  if we encounter a pointer and jump backwards to what we think is a label
  the label ends before the beginning of the last label we processed, to
  make sure the pointer doesn't point backwards into the *middle* of a
  label, and also make sure the entire name is <= 255 bytes long.
impacted_packages:
  - purl: pkg:github/the-tcpdump-group/tcpdump
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/the-tcpdump-group/tcpdump
        commit: d609d7c6ae2505ea3337b2e00cb18e1f551dfbf2
    introduced_in_commits: []
  - purl: pkg:github/the-tcpdump-group/tcpdump
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/the-tcpdump-group/tcpdump
        commit: 3a76fd7c95fced2c2f8c8148a9055c3a542eff29
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/the-tcpdump-group/tcpdump/tree/3a76fd7c95fced2c2f8c8148a9055c3a542eff29
    reference_type: commit
    reference_id: 3a76fd7c95fced2c2f8c8148a9055c3a542eff29
  - url: https://github.com/the-tcpdump-group/tcpdump/tree/d609d7c6ae2505ea3337b2e00cb18e1f551dfbf2
    reference_type: commit
    reference_id: d609d7c6ae2505ea3337b2e00cb18e1f551dfbf2
