advisory_id: CVE-2017-12985
datasource_id: collect_tcpdump_fix_commits/CVE-2017-12985
datasource_url: https://github.com/the-tcpdump-group/tcpdump
aliases: []
summary: |
  66df248b49095c261138b5a5e34d341a6bf9ac7f:CVE-2017-12985/IPv6: Check for print routines returning -1 when running past the end.

  rt6_print(), ah_print(), and esp_print() return -1 if they run up
  against the end of the packet while dissecting; if that happens, stop
  dissecting, don't try to fetch the next header value, because 1) *it*
  might be past the end of the packet and 2) we won't be using it in any
  case, as we'll be exiting the loop.

  Also, change mobility_print() to return -1 if it runs up against the
  end of the packet, and stop dissecting if it does so.

  This fixes a buffer over-read discovered by Brian 'geeknik' Carpenter.

  Add tests using the capture files supplied by the reporter(s).
  67abbfb5c79407a68d845ee14a038ed7d69e1ad1:CVE-2017-12985/IPv6: Check for print routines returning -1 when running past the end.

  rt6_print(), ah_print(), and esp_print() return -1 if they run up
  against the end of the packet while dissecting; if that happens, stop
  dissecting, don't try to fetch the next header value, because 1) *it*
  might be past the end of the packet and 2) we won't be using it in any
  case, as we'll be exiting the loop.

  Also, change mobility_print() to return -1 if it runs up against the
  end of the packet, and stop dissecting if it does so.

  This fixes a buffer over-read discovered by Brian 'geeknik' Carpenter.

  Add tests using the capture files supplied by the reporter(s).
impacted_packages:
  - purl: pkg:github/the-tcpdump-group/tcpdump
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/the-tcpdump-group/tcpdump
        commit: 67abbfb5c79407a68d845ee14a038ed7d69e1ad1
    introduced_in_commits: []
  - purl: pkg:github/the-tcpdump-group/tcpdump
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/the-tcpdump-group/tcpdump
        commit: 66df248b49095c261138b5a5e34d341a6bf9ac7f
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/the-tcpdump-group/tcpdump/tree/66df248b49095c261138b5a5e34d341a6bf9ac7f
    reference_type: commit
    reference_id: 66df248b49095c261138b5a5e34d341a6bf9ac7f
  - url: https://github.com/the-tcpdump-group/tcpdump/tree/67abbfb5c79407a68d845ee14a038ed7d69e1ad1
    reference_type: commit
    reference_id: 67abbfb5c79407a68d845ee14a038ed7d69e1ad1
