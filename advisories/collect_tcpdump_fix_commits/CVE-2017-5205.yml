advisory_id: CVE-2017-5205
datasource_id: collect_tcpdump_fix_commits/CVE-2017-5205
datasource_url: https://github.com/the-tcpdump-group/tcpdump
aliases: []
summary: |
  77b9208db08be891fa2f63c40c249b3b641dcc03:CVE-2017-5205/add a test case

  The .pcap file comes from Francois-Xavier Le Bail.
  51d66a246aacc081d05590fa11cc367d7e6778f4:CVE-2017-5205/Clean up parsing of IKEv2 Security Associations.

  The payload of a Security Association has a sequence of proposal
  substructures; the Last Substruc field should only be 0 (for the last
  proposal substructure) or 2 (if there's another proposal substructure
  after the current one).  If it's neither, don't try to dissect the next
  item as a payload with the Last Substruc field's value as a payload
  type.

  The payload of a proposal substructure has a sequence of transform
  substructures; the Last Substruc field should only be 0 (for the last
  transform substructure) or 3 (if there's another transform substructure
  after the current one).  If it's neither, don't try to dissect the next
  item as a payload with the Last Substruc field's value as a payload
  type.

  That keeps us from trying to, for example, dissect a bogus substructure
  as an encrypted payload item and passing a null pointer as the struct
  isakmp structure pointer.

  Do more checks while we're at it.
impacted_packages:
  - purl: pkg:github/the-tcpdump-group/tcpdump
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/the-tcpdump-group/tcpdump
        commit: 51d66a246aacc081d05590fa11cc367d7e6778f4
    introduced_in_commits: []
  - purl: pkg:github/the-tcpdump-group/tcpdump
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/the-tcpdump-group/tcpdump
        commit: 77b9208db08be891fa2f63c40c249b3b641dcc03
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/the-tcpdump-group/tcpdump/tree/51d66a246aacc081d05590fa11cc367d7e6778f4
    reference_type: commit
    reference_id: 51d66a246aacc081d05590fa11cc367d7e6778f4
  - url: https://github.com/the-tcpdump-group/tcpdump/tree/77b9208db08be891fa2f63c40c249b3b641dcc03
    reference_type: commit
    reference_id: 77b9208db08be891fa2f63c40c249b3b641dcc03
