advisory_id: CVE-2017-12986
datasource_id: collect_tcpdump_fix_commits/CVE-2017-12986
datasource_url: https://github.com/the-tcpdump-group/tcpdump
aliases: []
summary: |
  7ac73d6cd41e9d4ac0ca7e6830ca390e195bb21c:CVE-2017-12986/IPv6 R.H.: Update to reflect the actual IPv6 RFC.

  In RFC 1883, the Type 0 routing header had a 1-byte reserved field and a
  3-byte strict/loose bit map; in RFC 2460, that changed to a 4-byte
  reserved field.

  This fixes a buffer over-read discovered by Brian 'geeknik' Carpenter (by
  making an ND_TCHECK() call check for the presence in the captured data
  of all 4 bytes of the reserved field; we were printing it as a 4-byte
  field, so we needed to check for them).

  Add a test using the capture file supplied by the reporter(s).
  c8f1f24b6b2e8e0c0cdd6165cdfe561582d41ee3:CVE-2017-12986/IPv6 R.H.: Update to reflect the actual IPv6 RFC.

  In RFC 1883, the Type 0 routing header had a 1-byte reserved field and a
  3-byte strict/loose bit map; in RFC 2460, that changed to a 4-byte
  reserved field.

  This fixes a buffer over-read discovered by Brian 'geeknik' Carpenter (by
  making an ND_TCHECK() call check for the presence in the captured data
  of all 4 bytes of the reserved field; we were printing it as a 4-byte
  field, so we needed to check for them).

  Add a test using the capture file supplied by the reporter(s).
impacted_packages:
  - purl: pkg:github/the-tcpdump-group/tcpdump
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/the-tcpdump-group/tcpdump
        commit: 7ac73d6cd41e9d4ac0ca7e6830ca390e195bb21c
    introduced_in_commits: []
  - purl: pkg:github/the-tcpdump-group/tcpdump
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/the-tcpdump-group/tcpdump
        commit: c8f1f24b6b2e8e0c0cdd6165cdfe561582d41ee3
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/the-tcpdump-group/tcpdump/tree/7ac73d6cd41e9d4ac0ca7e6830ca390e195bb21c
    reference_type: commit
    reference_id: 7ac73d6cd41e9d4ac0ca7e6830ca390e195bb21c
  - url: https://github.com/the-tcpdump-group/tcpdump/tree/c8f1f24b6b2e8e0c0cdd6165cdfe561582d41ee3
    reference_type: commit
    reference_id: c8f1f24b6b2e8e0c0cdd6165cdfe561582d41ee3
