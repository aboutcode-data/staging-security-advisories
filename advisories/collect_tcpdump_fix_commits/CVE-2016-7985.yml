advisory_id: CVE-2016-7985
datasource_id: collect_tcpdump_fix_commits/CVE-2016-7985
datasource_url: https://github.com/the-tcpdump-group/tcpdump
aliases: []
summary: |
  cae54f4d943f163541dc7a90f7f5b432859955e4:CVE-2016-7985,7986/fixup medsa_print()

  The code in medsa_print() assumed that the MEDSA packet always follows
  an Ethernet header that is inside the allocated memory buffer. But
  this is not always the case, see commit 6bc4429 for rationale.

  Eliminate the Ethernet header pointer and just pass on the struct
  lladdr_info arguments provided.
  6bc44295cfbe1f7b6633c755841518f4b159aa8a:CVE-2016-7985,7986/Change the way protocols print link-layer addresses.

  If a protocol that runs under a link-layer protocol would print the
  link-layer addresses for the packet as source and destination addresses
  for the packet, don't have it blithely assume those link-layer addresses
  are present or are at a particular offset from the beginning of that
  protocol's data; Ethertypes, for example, are used by a number of
  protocols, not all of which have Ethernet headers and not all of which
  have any MAC headers.

  Instead, pass the printers for those protocols structures with a pointer
  to the address data and a pointer to a routine that prints the address.

  Fixes some heap overflows found with American Fuzzy Lop by Hanno BÃ¶ck.
impacted_packages:
  - purl: pkg:github/the-tcpdump-group/tcpdump
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/the-tcpdump-group/tcpdump
        commit: cae54f4d943f163541dc7a90f7f5b432859955e4
    introduced_in_commits: []
  - purl: pkg:github/the-tcpdump-group/tcpdump
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/the-tcpdump-group/tcpdump
        commit: 6bc44295cfbe1f7b6633c755841518f4b159aa8a
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/the-tcpdump-group/tcpdump/tree/6bc44295cfbe1f7b6633c755841518f4b159aa8a
    reference_type: commit
    reference_id: 6bc44295cfbe1f7b6633c755841518f4b159aa8a
  - url: https://github.com/the-tcpdump-group/tcpdump/tree/cae54f4d943f163541dc7a90f7f5b432859955e4
    reference_type: commit
    reference_id: cae54f4d943f163541dc7a90f7f5b432859955e4
