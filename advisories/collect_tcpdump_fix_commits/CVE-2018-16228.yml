advisory_id: CVE-2018-16228
datasource_id: collect_tcpdump_fix_commits/CVE-2018-16228
datasource_url: https://github.com/the-tcpdump-group/tcpdump
aliases: []
summary: |
  83a412a5275cac973c5841eca3511c766bed778d:(for 4.9.3) CVE-2018-16228/HNCP: make buffer access safer

  print_prefix() has a buffer and does not initialize it. It may call
  decode_prefix6(), which also does not initialize the buffer on invalid
  input. When that happens, make sure to return from print_prefix() before
  trying to print the [still uninitialized] buffer.

  This fixes a buffer over-read discovered by Wang Junjie of 360 ESG
  Codesafe Team.

  Add a test using the capture file supplied by the reporter(s).
impacted_packages:
  - purl: pkg:github/the-tcpdump-group/tcpdump
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/the-tcpdump-group/tcpdump
        commit: 83a412a5275cac973c5841eca3511c766bed778d
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/the-tcpdump-group/tcpdump/tree/83a412a5275cac973c5841eca3511c766bed778d
    reference_type: commit
    reference_id: 83a412a5275cac973c5841eca3511c766bed778d
