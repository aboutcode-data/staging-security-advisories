advisory_id: CVE-2017-5342
datasource_id: collect_tcpdump_fix_commits/CVE-2017-5342
datasource_url: https://github.com/the-tcpdump-group/tcpdump
aliases: []
summary: |
  0db4dcafe5ae38201d3869c96a96cb714d82ff35:CVE-2017-5342/pass correct caplen value to ether_print()

  In that function the "length" parameter means off-the-wire length, that
  is, the length declared inside the outer header. The "caplen" parameter
  means the amount of bytes actually available in the captured packet.

  gre_print_0() and the functions modelled after it passed the value of
  "length" instead of the value of "caplen", this could make ether_print()
  access beyond the memory allocated for the captured packet. Brian
  Carpenter had demonstrated this for the OTV case.

  Fix the involved functions that call ether_print() to pass the correct
  value and leave a comment to dismiss "caplen" later as its value can be
  reliably derived from the other ether_print() parameters.
impacted_packages:
  - purl: pkg:github/the-tcpdump-group/tcpdump
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/the-tcpdump-group/tcpdump
        commit: 0db4dcafe5ae38201d3869c96a96cb714d82ff35
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/the-tcpdump-group/tcpdump/tree/0db4dcafe5ae38201d3869c96a96cb714d82ff35
    reference_type: commit
    reference_id: 0db4dcafe5ae38201d3869c96a96cb714d82ff35
