advisory_id: CVE-2017-13033
datasource_id: collect_tcpdump_fix_commits/CVE-2017-13033
datasource_url: https://github.com/the-tcpdump-group/tcpdump
aliases: []
summary: |
  ae83295915d08a854de27a88efac5dd7353e6d3f:CVE-2017-13033/VTP: Add more bound and length checks.

  This fixes a buffer over-read discovered by Bhargava Shastry.

  Add a test using the capture file supplied by the reporter(s), modified
  so the capture file won't be rejected as an invalid capture.

  Update another VTP test's .out file for this change.

  Don't treate a TLV type or length of 0 as invalid; a type of 0 should
  just be reported as illegal if that type isn't used, and the length is
  the length of the *value*, not the length of the entire TLV, so if it's
  zero there won't be an infinite loop.  (It's still not *legal*, as the
  values of all the TLVs we handle are 1 16-bit word long; we added a
  check for that.)

  Update some comments while we're at it, to give a new URL for one Cisco
  page and a non-Cisco URL for another former Cisco page (Cisco's UniverCD
  pages don't seem to be available any more, and Cisco's robots.txt file
  didn't allow the Wayback Machine to archive it).
  11a07ed27ba5122c8cbd34e8c15bcf0b4969889d:CVE-2017-13033/VTP: Add more bound and length checks.

  This fixes a buffer over-read discovered by Bhargava Shastry.

  Add a test using the capture file supplied by the reporter(s), modified
  so the capture file won't be rejected as an invalid capture.

  Update another VTP test's .out file for this change.

  Don't treate a TLV type or length of 0 as invalid; a type of 0 should
  just be reported as illegal if that type isn't used, and the length is
  the length of the *value*, not the length of the entire TLV, so if it's
  zero there won't be an infinite loop.  (It's still not *legal*, as the
  values of all the TLVs we handle are 1 16-bit word long; we added a
  check for that.)

  Update some comments while we're at it, to give a new URL for one Cisco
  page and a non-Cisco URL for another former Cisco page (Cisco's UniverCD
  pages don't seem to be available any more, and Cisco's robots.txt file
  didn't allow the Wayback Machine to archive it).
impacted_packages:
  - purl: pkg:github/the-tcpdump-group/tcpdump
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/the-tcpdump-group/tcpdump
        commit: ae83295915d08a854de27a88efac5dd7353e6d3f
    introduced_in_commits: []
  - purl: pkg:github/the-tcpdump-group/tcpdump
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/the-tcpdump-group/tcpdump
        commit: 11a07ed27ba5122c8cbd34e8c15bcf0b4969889d
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/the-tcpdump-group/tcpdump/tree/11a07ed27ba5122c8cbd34e8c15bcf0b4969889d
    reference_type: commit
    reference_id: 11a07ed27ba5122c8cbd34e8c15bcf0b4969889d
  - url: https://github.com/the-tcpdump-group/tcpdump/tree/ae83295915d08a854de27a88efac5dd7353e6d3f
    reference_type: commit
    reference_id: ae83295915d08a854de27a88efac5dd7353e6d3f
