advisory_id: CVE-2017-12989
datasource_id: collect_tcpdump_fix_commits/CVE-2017-12989
datasource_url: https://github.com/the-tcpdump-group/tcpdump
aliases: []
summary: |
  db24063b01cba8e9d4d88b7d8ac70c9000c104e4:CVE-2017-12989/RESP: Make sure resp_get_length() advances the pointer for invalid lengths.

  Make sure that it always sends *endp before returning and that, for
  invalid lengths where we don't like a character in the length string,
  what it sets *endp to is past the character in question, so we don't
  run the risk of infinitely looping (or doing something else random) if a
  character in the length is invalid.

  This fixes an infinite loop discovered by Forcepoint's security
  researchers Otto Airamo & Antti Levomäki.

  Add a test using the capture file supplied by the reporter(s).
  527e63d35882e162bce652afc9f692ff5f4529c1:CVE-2017-12989/RESP: Make sure resp_get_length() advances the pointer for invalid lengths.

  Make sure that it always sends *endp before returning and that, for
  invalid lengths where we don't like a character in the length string,
  what it sets *endp to is past the character in question, so we don't
  run the risk of infinitely looping (or doing something else random) if a
  character in the length is invalid.

  This fixes an infinite loop discovered by Forcepoint's security
  researchers Otto Airamo & Antti Levomäki.

  Add a test using the capture file supplied by the reporter(s).
impacted_packages:
  - purl: pkg:github/the-tcpdump-group/tcpdump
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/the-tcpdump-group/tcpdump
        commit: 527e63d35882e162bce652afc9f692ff5f4529c1
    introduced_in_commits: []
  - purl: pkg:github/the-tcpdump-group/tcpdump
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/the-tcpdump-group/tcpdump
        commit: db24063b01cba8e9d4d88b7d8ac70c9000c104e4
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/the-tcpdump-group/tcpdump/tree/527e63d35882e162bce652afc9f692ff5f4529c1
    reference_type: commit
    reference_id: 527e63d35882e162bce652afc9f692ff5f4529c1
  - url: https://github.com/the-tcpdump-group/tcpdump/tree/db24063b01cba8e9d4d88b7d8ac70c9000c104e4
    reference_type: commit
    reference_id: db24063b01cba8e9d4d88b7d8ac70c9000c104e4
