advisory_id: CVE-2018-16452
datasource_id: collect_tcpdump_fix_commits/CVE-2018-16452
datasource_url: https://github.com/the-tcpdump-group/tcpdump
aliases: []
summary: |
  42857bd6a9ce8838e0c7765677cf2aa99937f612:SMB: prevent stack exhaustion

  Enforce a limit on how many times smb_fdata() can recurse.

  This change fixes CVE-2018-16452.

  This fixes a stack exhaustion discovered by Include Security working
  under the Mozilla SOS program in 2018 by means of code audit.

  Cherry picked from 24182d959f661327525a20d9a94c98a8ec016778
  in 4.9 branch.
  24182d959f661327525a20d9a94c98a8ec016778:(for 4.9.3) CVE-2018-16452/SMB: prevent stack exhaustion

  Enforce a limit on how many times smb_fdata() can recurse.

  This fixes a stack exhaustion discovered by Include Security working
  under the Mozilla SOS program in 2018 by means of code audit.
impacted_packages:
  - purl: pkg:github/the-tcpdump-group/tcpdump
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/the-tcpdump-group/tcpdump
        commit: 42857bd6a9ce8838e0c7765677cf2aa99937f612
    introduced_in_commits: []
  - purl: pkg:github/the-tcpdump-group/tcpdump
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/the-tcpdump-group/tcpdump
        commit: 24182d959f661327525a20d9a94c98a8ec016778
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/the-tcpdump-group/tcpdump/tree/24182d959f661327525a20d9a94c98a8ec016778
    reference_type: commit
    reference_id: 24182d959f661327525a20d9a94c98a8ec016778
  - url: https://github.com/the-tcpdump-group/tcpdump/tree/42857bd6a9ce8838e0c7765677cf2aa99937f612
    reference_type: commit
    reference_id: 42857bd6a9ce8838e0c7765677cf2aa99937f612
