advisory_id: CVE-2017-13055
datasource_id: collect_tcpdump_fix_commits/CVE-2017-13055
datasource_url: https://github.com/the-tcpdump-group/tcpdump
aliases: []
summary: |
  5d0d76e88ee2d3236d7e032589d6f1d4ec5f7b1e:CVE-2017-13055/IS-IS: fix an Extended IS Reachability sub-TLV

  In isis_print_is_reach_subtlv() one of the case blocks did not check that
  the sub-TLV "V" is actually present and could over-read the input buffer.
  Add a length check to fix that and remove a useless boundary check from
  a loop because the boundary is tested for the full length of "V" before
  the switch block.

  Update one of the prior test cases as it turns out it depended on this
  previously incorrect code path to make it to its own malformed structure
  further down the buffer, the bugfix has changed its output.

  This fixes a buffer over-read discovered by Bhargava Shastry,
  SecT/TU Berlin.

  Add a test using the capture file supplied by the reporter(s).
  71968ea3db996f70e4f3c01581231ce210c85720:CVE-2017-13055/IS-IS: fix an Extended IS Reachability sub-TLV

  In isis_print_is_reach_subtlv() one of the case blocks did not check that
  the sub-TLV "V" is actually present and could over-read the input buffer.
  Add a length check to fix that and remove a useless boundary check from
  a loop because the boundary is tested for the full length of "V" before
  the switch block.

  Update one of the prior test cases as it turns out it depended on this
  previously incorrect code path to make it to its own malformed structure
  further down the buffer, the bugfix has changed its output.

  This fixes a buffer over-read discovered by Bhargava Shastry,
  SecT/TU Berlin.

  Add a test using the capture file supplied by the reporter(s).
impacted_packages:
  - purl: pkg:github/the-tcpdump-group/tcpdump
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/the-tcpdump-group/tcpdump
        commit: 71968ea3db996f70e4f3c01581231ce210c85720
    introduced_in_commits: []
  - purl: pkg:github/the-tcpdump-group/tcpdump
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/the-tcpdump-group/tcpdump
        commit: 5d0d76e88ee2d3236d7e032589d6f1d4ec5f7b1e
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/the-tcpdump-group/tcpdump/tree/5d0d76e88ee2d3236d7e032589d6f1d4ec5f7b1e
    reference_type: commit
    reference_id: 5d0d76e88ee2d3236d7e032589d6f1d4ec5f7b1e
  - url: https://github.com/the-tcpdump-group/tcpdump/tree/71968ea3db996f70e4f3c01581231ce210c85720
    reference_type: commit
    reference_id: 71968ea3db996f70e4f3c01581231ce210c85720
