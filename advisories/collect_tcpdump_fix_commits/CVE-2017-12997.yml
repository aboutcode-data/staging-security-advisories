advisory_id: CVE-2017-12997
datasource_id: collect_tcpdump_fix_commits/CVE-2017-12997
datasource_url: https://github.com/the-tcpdump-group/tcpdump
aliases: []
summary: "34cec721d39c76be1e0a600829a7b17bdfb832b6:CVE-2017-12997/LLDP: Don't use an 8-bit loop\
  \ counter.\n\nIf you have a\n\n\tfor (i = 0; i < N; i++)\n\nloop, you'd better make sure that\
  \ i is big enough to hold N - not N-1,\nN.\n\nThe TLV length here is 9 bits long, not 8 bits\
  \ long, so an 8-bit loop\ncounter will overflow and you can loop infinitely.\n\nThis fixes\
  \ an infinite loop discovered by Forcepoint's security\nresearchers Otto Airamo & Antti Levomäki.\n\
  \nAdd tests using the capture files supplied by the reporter(s).\n\nClean up the output a\
  \ bit while we're at it.\n15af5b613ee8b262cdc5903a5f5fbb7d5b882c78:CVE-2017-12997/LLDP: Don't\
  \ use an 8-bit loop counter.\n\nIf you have a\n\n\tfor (i = 0; i < N; i++)\n\nloop, you'd\
  \ better make sure that i is big enough to hold N - not N-1,\nN.\n\nThe TLV length here is\
  \ 9 bits long, not 8 bits long, so an 8-bit loop\ncounter will overflow and you can loop infinitely.\n\
  \nThis fixes an infinite loop discovered by Forcepoint's security\nresearchers Otto Airamo\
  \ & Antti Levomäki.\n\nAdd tests using the capture files supplied by the reporter(s).\n\n\
  Clean up the output a bit while we're at it."
impacted_packages:
  - purl: pkg:github/the-tcpdump-group/tcpdump
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/the-tcpdump-group/tcpdump
        commit: 34cec721d39c76be1e0a600829a7b17bdfb832b6
    introduced_in_commits: []
  - purl: pkg:github/the-tcpdump-group/tcpdump
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/the-tcpdump-group/tcpdump
        commit: 15af5b613ee8b262cdc5903a5f5fbb7d5b882c78
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/the-tcpdump-group/tcpdump/tree/15af5b613ee8b262cdc5903a5f5fbb7d5b882c78
    reference_type: commit
    reference_id: 15af5b613ee8b262cdc5903a5f5fbb7d5b882c78
  - url: https://github.com/the-tcpdump-group/tcpdump/tree/34cec721d39c76be1e0a600829a7b17bdfb832b6
    reference_type: commit
    reference_id: 34cec721d39c76be1e0a600829a7b17bdfb832b6
