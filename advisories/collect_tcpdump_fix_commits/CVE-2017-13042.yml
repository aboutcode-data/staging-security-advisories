advisory_id: CVE-2017-13042
datasource_id: collect_tcpdump_fix_commits/CVE-2017-13042
datasource_url: https://github.com/the-tcpdump-group/tcpdump
aliases: []
summary: |
  39582c04cc5e34054b2936b423072fb9df2ff6ef:CVE-2017-13042/HNCP: add DHCPv6-Data bounds checks

  hncp_print_rec() validates each HNCP TLV to be within the declared as
  well as the on-the-wire packet space. However, dhcpv6_print() in the same
  file didn't do the same for the DHCPv6 options within the HNCP
  DHCPv6-Data TLV value, which could cause an out-of-bounds read when
  decoding an invalid packet. Add missing checks to dhcpv6_print().

  This fixes a buffer over-read discovered by Bhargava Shastry,
  SecT/TU Berlin.

  Add a test using the capture file supplied by the reporter(s).
  72ca42c7f3e691bbf29dcd1449c95c0744e7287b:CVE-2017-13042/HNCP: add DHCPv6-Data bounds checks

  hncp_print_rec() validates each HNCP TLV to be within the declared as
  well as the on-the-wire packet space. However, dhcpv6_print() in the same
  file didn't do the same for the DHCPv6 options within the HNCP
  DHCPv6-Data TLV value, which could cause an out-of-bounds read when
  decoding an invalid packet. Add missing checks to dhcpv6_print().

  This fixes a buffer over-read discovered by Bhargava Shastry,
  SecT/TU Berlin.

  Add a test using the capture file supplied by the reporter(s).
impacted_packages:
  - purl: pkg:github/the-tcpdump-group/tcpdump
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/the-tcpdump-group/tcpdump
        commit: 39582c04cc5e34054b2936b423072fb9df2ff6ef
    introduced_in_commits: []
  - purl: pkg:github/the-tcpdump-group/tcpdump
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/the-tcpdump-group/tcpdump
        commit: 72ca42c7f3e691bbf29dcd1449c95c0744e7287b
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/the-tcpdump-group/tcpdump/tree/39582c04cc5e34054b2936b423072fb9df2ff6ef
    reference_type: commit
    reference_id: 39582c04cc5e34054b2936b423072fb9df2ff6ef
  - url: https://github.com/the-tcpdump-group/tcpdump/tree/72ca42c7f3e691bbf29dcd1449c95c0744e7287b
    reference_type: commit
    reference_id: 72ca42c7f3e691bbf29dcd1449c95c0744e7287b
