advisory_id: CVE-2017-13050
datasource_id: collect_tcpdump_fix_commits/CVE-2017-13050
datasource_url: https://github.com/the-tcpdump-group/tcpdump
aliases: []
summary: |
  83c64fce3a5226b080e535f5131a8a318f30e79b:CVE-2017-13050/RPKI-Router: fix a few bugs

  The decoder didn't properly check that the PDU length stored in the PDU
  header is correct. The only check in place was in rpki_rtr_print() and it
  tested whether the length is zero but that is not sufficient. Make all
  necessary length and bounds checks, both generic and type-specific, in
  rpki_rtr_pdu_print() and reduce rpki_rtr_print() to a simple loop.

  This also fixes a minor bug and PDU type 0 (Serial Notify from RFC 6810
  Section 5.2) is valid again.

  In rpki_rtr_pdu_print() any protocol version was considered version 0,
  fix it to skip the rest of input if the PDU protocol version is unknown.

  Ibid, the PDU type 10 (Error Report from RFC 6810 Section 5.10) case
  block didn't consider the "Length of Error Text" data element mandatory,
  put it right.

  Ibid, when printing an encapsulated PDU, give itself (via recursion)
  respective buffer length to make it possible to tell whether the
  encapsulated PDU fits. Do not recurse deeper than 2nd level.

  Update prior RPKI-Router test cases that now stop to decode earlier
  because of the stricter checks.

  This fixes a buffer over-read discovered by Bhargava Shastry,
  SecT/TU Berlin.

  Add a test using the capture file supplied by the reporter(s).
  0c384810276380683e26709b932b3af5f3928ee0:CVE-2017-13050/RPKI-Router: fix a few bugs

  The decoder didn't properly check that the PDU length stored in the PDU
  header is correct. The only check in place was in rpki_rtr_print() and it
  tested whether the length is zero but that is not sufficient. Make all
  necessary length and bounds checks, both generic and type-specific, in
  rpki_rtr_pdu_print() and reduce rpki_rtr_print() to a simple loop.

  This also fixes a minor bug and PDU type 0 (Serial Notify from RFC 6810
  Section 5.2) is valid again.

  In rpki_rtr_pdu_print() any protocol version was considered version 0,
  fix it to skip the rest of input if the PDU protocol version is unknown.

  Ibid, the PDU type 10 (Error Report from RFC 6810 Section 5.10) case
  block didn't consider the "Length of Error Text" data element mandatory,
  put it right.

  Ibid, when printing an encapsulated PDU, give itself (via recursion)
  respective buffer length to make it possible to tell whether the
  encapsulated PDU fits. Do not recurse deeper than 2nd level.

  Update prior RPKI-Router test cases that now stop to decode earlier
  because of the stricter checks.

  This fixes a buffer over-read discovered by Bhargava Shastry,
  SecT/TU Berlin.

  Add a test using the capture file supplied by the reporter(s).
impacted_packages:
  - purl: pkg:github/the-tcpdump-group/tcpdump
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/the-tcpdump-group/tcpdump
        commit: 0c384810276380683e26709b932b3af5f3928ee0
    introduced_in_commits: []
  - purl: pkg:github/the-tcpdump-group/tcpdump
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/the-tcpdump-group/tcpdump
        commit: 83c64fce3a5226b080e535f5131a8a318f30e79b
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/the-tcpdump-group/tcpdump/tree/0c384810276380683e26709b932b3af5f3928ee0
    reference_type: commit
    reference_id: 0c384810276380683e26709b932b3af5f3928ee0
  - url: https://github.com/the-tcpdump-group/tcpdump/tree/83c64fce3a5226b080e535f5131a8a318f30e79b
    reference_type: commit
    reference_id: 83c64fce3a5226b080e535f5131a8a318f30e79b
