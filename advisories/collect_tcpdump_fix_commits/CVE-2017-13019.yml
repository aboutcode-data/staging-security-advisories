advisory_id: CVE-2017-13019
datasource_id: collect_tcpdump_fix_commits/CVE-2017-13019
datasource_url: https://github.com/the-tcpdump-group/tcpdump
aliases: []
summary: |
  4601c685e7fd19c3724d5e499c69b8d3ec49933e:CVE-2017-13019: Clean up PGM option processing.

  Add #defines for option lengths or the lengths of the fixed-length part
  of the option.  Sometimes those #defines differ from what was there
  before; what was there before was wrong, probably because the option
  lengths given in RFC 3208 were sometimes wrong - some lengths included
  the length of the option header, some lengths didn't.

  Don't use "sizeof(uintXX_t)" for sizes in the packet, just use the
  number of bytes directly.

  For the options that include an IPv4 or IPv6 address, check the option
  length against the length of what precedes the address before fetching
  any of that data.

  This fixes a buffer over-read discovered by Bhargava Shastry,
  SecT/TU Berlin.

  Add a test using the capture file supplied by the reporter(s), modified
  so the capture file won't be rejected as an invalid capture.
  d1d4404ddb982f94f39876852cfc53a97a105b35:CVE-2017-13019: Clean up PGM option processing.

  Add #defines for option lengths or the lengths of the fixed-length part
  of the option.  Sometimes those #defines differ from what was there
  before; what was there before was wrong, probably because the option
  lengths given in RFC 3208 were sometimes wrong - some lengths included
  the length of the option header, some lengths didn't.

  Don't use "sizeof(uintXX_t)" for sizes in the packet, just use the
  number of bytes directly.

  For the options that include an IPv4 or IPv6 address, check the option
  length against the length of what precedes the address before fetching
  any of that data.

  This fixes a buffer over-read discovered by Bhargava Shastry,
  SecT/TU Berlin.

  Add a test using the capture file supplied by the reporter(s), modified
  so the capture file won't be rejected as an invalid capture.
impacted_packages:
  - purl: pkg:github/the-tcpdump-group/tcpdump
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/the-tcpdump-group/tcpdump
        commit: 4601c685e7fd19c3724d5e499c69b8d3ec49933e
    introduced_in_commits: []
  - purl: pkg:github/the-tcpdump-group/tcpdump
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/the-tcpdump-group/tcpdump
        commit: d1d4404ddb982f94f39876852cfc53a97a105b35
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/the-tcpdump-group/tcpdump/tree/4601c685e7fd19c3724d5e499c69b8d3ec49933e
    reference_type: commit
    reference_id: 4601c685e7fd19c3724d5e499c69b8d3ec49933e
  - url: https://github.com/the-tcpdump-group/tcpdump/tree/d1d4404ddb982f94f39876852cfc53a97a105b35
    reference_type: commit
    reference_id: d1d4404ddb982f94f39876852cfc53a97a105b35
