advisory_id: CVE-2017-12990
datasource_id: collect_tcpdump_fix_commits/CVE-2017-12990
datasource_url: https://github.com/the-tcpdump-group/tcpdump
aliases: []
summary: |
  c2ef693866beae071a24b45c49f9674af1df4028:CVE-2017-12990/Fix printing of ISAKMPv1 Notification payload data.

  The closest thing to a specification for the contents of the payload
  data is draft-ietf-ipsec-notifymsg-04, and nothing in there says that it
  is ever a complete ISAKMP message, so don't dissect types we don't have
  specific code for as a complete ISAKMP message.

  While we're at it, fix a comment, and clean up printing of V1 Nonce,
  V2 Authentication payloads, and v2 Notice payloads.

  This fixes an infinite loop discovered by Forcepoint's security
  researchers Otto Airamo & Antti Levomäki.

  Add a test using the capture file supplied by the reporter(s).
  8bacee1c8e56ff92253366edd22f95b6e2c5e055:CVE-2017-12990/Fix printing of ISAKMPv1 Notification payload data.

  The closest thing to a specification for the contents of the payload
  data is draft-ietf-ipsec-notifymsg-04, and nothing in there says that it
  is ever a complete ISAKMP message, so don't dissect types we don't have
  specific code for as a complete ISAKMP message.

  While we're at it, fix a comment, and clean up printing of V1 Nonce,
  V2 Authentication payloads, and v2 Notice payloads.

  This fixes an infinite loop discovered by Forcepoint's security
  researchers Otto Airamo & Antti Levomäki.

  Add a test using the capture file supplied by the reporter(s).
impacted_packages:
  - purl: pkg:github/the-tcpdump-group/tcpdump
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/the-tcpdump-group/tcpdump
        commit: 8bacee1c8e56ff92253366edd22f95b6e2c5e055
    introduced_in_commits: []
  - purl: pkg:github/the-tcpdump-group/tcpdump
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/the-tcpdump-group/tcpdump
        commit: c2ef693866beae071a24b45c49f9674af1df4028
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/the-tcpdump-group/tcpdump/tree/8bacee1c8e56ff92253366edd22f95b6e2c5e055
    reference_type: commit
    reference_id: 8bacee1c8e56ff92253366edd22f95b6e2c5e055
  - url: https://github.com/the-tcpdump-group/tcpdump/tree/c2ef693866beae071a24b45c49f9674af1df4028
    reference_type: commit
    reference_id: c2ef693866beae071a24b45c49f9674af1df4028
