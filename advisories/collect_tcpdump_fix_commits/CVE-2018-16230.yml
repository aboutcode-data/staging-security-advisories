advisory_id: CVE-2018-16230
datasource_id: collect_tcpdump_fix_commits/CVE-2018-16230
datasource_url: https://github.com/the-tcpdump-group/tcpdump
aliases: []
summary: |
  13d52e9c0e7caf7e6325b0051bc90a49968be67f:(for 4.9.3) CVE-2018-16230/BGP: fix decoding of MP_REACH_NLRI

  When bgp_attr_print() tried to decode the variable-length nexthop value
  for the NSAP VPN case, it did not check that the declared length is good
  to interpret the value as a mapped IPv4 or IPv6 address. Add missing
  checks to make this safe.

  This fixes a buffer over-read discovered by Include Security working
  under the Mozilla SOS program in 2018 by means of code audit.

  Bhargava Shastry, SecT/TU Berlin, had independently identified this
  vulnerability by means of fuzzing and provided the packet capture file
  for the test.
impacted_packages:
  - purl: pkg:github/the-tcpdump-group/tcpdump
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/the-tcpdump-group/tcpdump
        commit: 13d52e9c0e7caf7e6325b0051bc90a49968be67f
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/the-tcpdump-group/tcpdump/tree/13d52e9c0e7caf7e6325b0051bc90a49968be67f
    reference_type: commit
    reference_id: 13d52e9c0e7caf7e6325b0051bc90a49968be67f
