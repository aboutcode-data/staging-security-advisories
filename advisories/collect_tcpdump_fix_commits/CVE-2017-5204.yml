advisory_id: CVE-2017-5204
datasource_id: collect_tcpdump_fix_commits/CVE-2017-5204
datasource_url: https://github.com/the-tcpdump-group/tcpdump
aliases: []
summary: |
  d6913f7e3fc6d3084ab64d179853468e58cdca4b:CVE-2017-5204/IPv6: fix header printing

  Add a few checks to ip6_print() to make it stop decoding the IPv6
  headers immediately when the header-specific functions signal an error
  condition. Without this it tried to fetch the next header selector for
  the next round regardless and could run outside of the allocated packet
  space on a specially crafted IPv6 packet.

  Brian Carpenter has demonstrated this for the Hop-by-Hop Options header.
  Fix that specific case and also the Destination Options and Fragment
  header processing as those use the same logic.
impacted_packages:
  - purl: pkg:github/the-tcpdump-group/tcpdump
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/the-tcpdump-group/tcpdump
        commit: d6913f7e3fc6d3084ab64d179853468e58cdca4b
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/the-tcpdump-group/tcpdump/tree/d6913f7e3fc6d3084ab64d179853468e58cdca4b
    reference_type: commit
    reference_id: d6913f7e3fc6d3084ab64d179853468e58cdca4b
