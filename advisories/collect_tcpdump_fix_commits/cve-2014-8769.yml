advisory_id: cve-2014-8769
datasource_id: collect_tcpdump_fix_commits/cve-2014-8769
datasource_url: https://github.com/the-tcpdump-group/tcpdump
aliases: []
summary: |
  ebfd00e6a59d8662bd2be3eb6ed47439bd3018c5:IP: Report another invalid case as invalid, not truncated

  When the IP total length is > (original) length, output example:
    [total length 85 > length 84] (invalid)

  We treat this as a warning and so don't stop decoding (as before).

  No need to use ND_TCHECK_SIZE(ip) before GET_BE_U_2(ip->ip_len).
  ND_TCHECK_SIZE(ip) could be moved further into the code in a future
  update.

  Add a test file.

  Update some test outputs accordingly.
  cve-2014-8769-AODV.out updated also because AODV has not yet been
  modernized in the 4.99 branch.

  (backported from commit 19fbfa53460f641b050f9f7fdfd718e2a30a4f0c)
impacted_packages:
  - purl: pkg:github/the-tcpdump-group/tcpdump
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/the-tcpdump-group/tcpdump
        commit: ebfd00e6a59d8662bd2be3eb6ed47439bd3018c5
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/the-tcpdump-group/tcpdump/tree/ebfd00e6a59d8662bd2be3eb6ed47439bd3018c5
    reference_type: commit
    reference_id: ebfd00e6a59d8662bd2be3eb6ed47439bd3018c5
