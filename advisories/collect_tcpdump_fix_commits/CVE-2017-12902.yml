advisory_id: CVE-2017-12902
datasource_id: collect_tcpdump_fix_commits/CVE-2017-12902
datasource_url: https://github.com/the-tcpdump-group/tcpdump
aliases: []
summary: |
  6ec0c6fa63412c7a07a5bcb790a529c3563b4173:CVE-2017-12902/Zephyr: Add an additional test.

  File from Kamil Frankowicz.
  d17507ffa3e9742199b02a66aa940e79ababfa30:CVE-2017-12902/Zephyr: Fix bounds checking.

  Use ND_TTEST() rather than comparing against ndo->ndo_snapend ourselves;
  it's easy to get the tests wrong.

  Check for running out of packet data before checking for running out of
  captured data, and distinguish between running out of packet data (which
  might just mean "no more strings") and running out of captured data
  (which means "truncated").

  This fixes a buffer over-read discovered by Forcepoint's security
  researchers Otto Airamo & Antti Levomäki.

  Add a test using the capture file supplied by the reporter(s).
  7318b2369b59ee497a6f5f1b236a2133851a2912:CVE-2017-12902/Zephyr: Add an additional test.

  File from Kamil Frankowicz.
  fd914592898f843f2600f49ad0556560807b5ef7:CVE-2017-12902/Zephyr: Fix bounds checking.

  Use ND_TTEST() rather than comparing against ndo->ndo_snapend ourselves;
  it's easy to get the tests wrong.

  Check for running out of packet data before checking for running out of
  captured data, and distinguish between running out of packet data (which
  might just mean "no more strings") and running out of captured data
  (which means "truncated").

  This fixes a buffer over-read discovered by Forcepoint's security
  researchers Otto Airamo & Antti Levomäki.

  Add a test using the capture file supplied by the reporter(s).
impacted_packages:
  - purl: pkg:github/the-tcpdump-group/tcpdump
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/the-tcpdump-group/tcpdump
        commit: 7318b2369b59ee497a6f5f1b236a2133851a2912
    introduced_in_commits: []
  - purl: pkg:github/the-tcpdump-group/tcpdump
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/the-tcpdump-group/tcpdump
        commit: d17507ffa3e9742199b02a66aa940e79ababfa30
    introduced_in_commits: []
  - purl: pkg:github/the-tcpdump-group/tcpdump
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/the-tcpdump-group/tcpdump
        commit: 6ec0c6fa63412c7a07a5bcb790a529c3563b4173
    introduced_in_commits: []
  - purl: pkg:github/the-tcpdump-group/tcpdump
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/the-tcpdump-group/tcpdump
        commit: fd914592898f843f2600f49ad0556560807b5ef7
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/the-tcpdump-group/tcpdump/tree/6ec0c6fa63412c7a07a5bcb790a529c3563b4173
    reference_type: commit
    reference_id: 6ec0c6fa63412c7a07a5bcb790a529c3563b4173
  - url: https://github.com/the-tcpdump-group/tcpdump/tree/7318b2369b59ee497a6f5f1b236a2133851a2912
    reference_type: commit
    reference_id: 7318b2369b59ee497a6f5f1b236a2133851a2912
  - url: https://github.com/the-tcpdump-group/tcpdump/tree/d17507ffa3e9742199b02a66aa940e79ababfa30
    reference_type: commit
    reference_id: d17507ffa3e9742199b02a66aa940e79ababfa30
  - url: https://github.com/the-tcpdump-group/tcpdump/tree/fd914592898f843f2600f49ad0556560807b5ef7
    reference_type: commit
    reference_id: fd914592898f843f2600f49ad0556560807b5ef7
