advisory_id: CVE-2017-13003
datasource_id: collect_tcpdump_fix_commits/CVE-2017-13003
datasource_url: https://github.com/the-tcpdump-group/tcpdump
aliases: []
summary: |
  a25211918f2e790c67d859d20ccf8dbb81da1598:CVE-2017-13003/Clean up the LMP dissector.

  Do a lot more bounds and length checks.

  Add a EXTRACT_8BITS() macro, for completeness, and so as not to confuse
  people into thinking that, to fetch a 1-byte value from a packet, they
  need to use EXTRACT_16BITS() to fetch a 2-byte value and then use
  shifting and masking to extract the desired byte.  Use that rather than
  using EXTRACT_16BITS() to fetch a 2-byte value and then shifting and
  masking to extract the desired byte.

  Don't treat IPv4 addresses and unnumbered interface IDs the same; the
  first should be printed as an IPv4 address but the latter should just be
  printed as numbers.  Handle IPv6 addresses in more object types while
  we're at it.

  This fixes a buffer over-read discovered by Forcepoint's security
  researchers Otto Airamo & Antti Levomäki.

  Add a test using the capture file supplied by the reporter(s).
  4d764e7052844fa73fbe500e11b24eb62bd43512:CVE-2017-13003/Clean up the LMP dissector.

  Do a lot more bounds and length checks.

  Add a EXTRACT_8BITS() macro, for completeness, and so as not to confuse
  people into thinking that, to fetch a 1-byte value from a packet, they
  need to use EXTRACT_16BITS() to fetch a 2-byte value and then use
  shifting and masking to extract the desired byte.  Use that rather than
  using EXTRACT_16BITS() to fetch a 2-byte value and then shifting and
  masking to extract the desired byte.

  Don't treat IPv4 addresses and unnumbered interface IDs the same; the
  first should be printed as an IPv4 address but the latter should just be
  printed as numbers.  Handle IPv6 addresses in more object types while
  we're at it.

  This fixes a buffer over-read discovered by Forcepoint's security
  researchers Otto Airamo & Antti Levomäki.

  Add a test using the capture file supplied by the reporter(s).
impacted_packages:
  - purl: pkg:github/the-tcpdump-group/tcpdump
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/the-tcpdump-group/tcpdump
        commit: a25211918f2e790c67d859d20ccf8dbb81da1598
    introduced_in_commits: []
  - purl: pkg:github/the-tcpdump-group/tcpdump
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/the-tcpdump-group/tcpdump
        commit: 4d764e7052844fa73fbe500e11b24eb62bd43512
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/the-tcpdump-group/tcpdump/tree/4d764e7052844fa73fbe500e11b24eb62bd43512
    reference_type: commit
    reference_id: 4d764e7052844fa73fbe500e11b24eb62bd43512
  - url: https://github.com/the-tcpdump-group/tcpdump/tree/a25211918f2e790c67d859d20ccf8dbb81da1598
    reference_type: commit
    reference_id: a25211918f2e790c67d859d20ccf8dbb81da1598
