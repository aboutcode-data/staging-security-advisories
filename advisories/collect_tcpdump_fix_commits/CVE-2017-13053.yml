advisory_id: CVE-2017-13053
datasource_id: collect_tcpdump_fix_commits/CVE-2017-13053
datasource_url: https://github.com/the-tcpdump-group/tcpdump
aliases: []
summary: |
  bd4e697ebd6c8457efa8f28f6831fc929b88a014:CVE-2017-13053/BGP: fix VPN route target bounds checks

  decode_rt_routing_info() didn't check bounds before fetching 4 octets of
  the origin AS field and could over-read the input buffer, put it right.

  It also fetched the varying number of octets of the route target field
  from 4 octets lower than the correct offset, put it right.

  It also used the same temporary buffer explicitly through as_printf()
  and implicitly through bgp_vpn_rd_print() so the end result of snprintf()
  was not what was originally intended.

  This fixes a buffer over-read discovered by Bhargava Shastry,
  SecT/TU Berlin.

  Add a test using the capture file supplied by the reporter(s).
  6b19892ea526f7e35999ab90a6734da8ff6b6111:CVE-2017-13053/BGP: fix VPN route target bounds checks

  decode_rt_routing_info() didn't check bounds before fetching 4 octets of
  the origin AS field and could over-read the input buffer, put it right.

  It also fetched the varying number of octets of the route target field
  from 4 octets lower than the correct offset, put it right.

  It also used the same temporary buffer explicitly through as_printf()
  and implicitly through bgp_vpn_rd_print() so the end result of snprintf()
  was not what was originally intended.

  This fixes a buffer over-read discovered by Bhargava Shastry,
  SecT/TU Berlin.

  Add a test using the capture file supplied by the reporter(s).
impacted_packages:
  - purl: pkg:github/the-tcpdump-group/tcpdump
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/the-tcpdump-group/tcpdump
        commit: 6b19892ea526f7e35999ab90a6734da8ff6b6111
    introduced_in_commits: []
  - purl: pkg:github/the-tcpdump-group/tcpdump
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/the-tcpdump-group/tcpdump
        commit: bd4e697ebd6c8457efa8f28f6831fc929b88a014
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/the-tcpdump-group/tcpdump/tree/6b19892ea526f7e35999ab90a6734da8ff6b6111
    reference_type: commit
    reference_id: 6b19892ea526f7e35999ab90a6734da8ff6b6111
  - url: https://github.com/the-tcpdump-group/tcpdump/tree/bd4e697ebd6c8457efa8f28f6831fc929b88a014
    reference_type: commit
    reference_id: bd4e697ebd6c8457efa8f28f6831fc929b88a014
