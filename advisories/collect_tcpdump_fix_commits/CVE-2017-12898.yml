advisory_id: CVE-2017-12898
datasource_id: collect_tcpdump_fix_commits/CVE-2017-12898
datasource_url: https://github.com/the-tcpdump-group/tcpdump
aliases: []
summary: |
  19d25dd8781620cd41bf178a5e2e27fc1cf242d0:CVE-2017-12898/NFS: Fix bounds checking.

  Fix the bounds checking for the NFSv3 WRITE procedure to check whether the
  length of the opaque data being written is present in the captured data,
  not just whether the byte count is present in the captured data.
  furthest forward in the packet, not the item before it.  (This also lets
  us eliminate the check for the "stable" argument being present in the
  captured data; rewrite the code to print that to make it a bit clearer.)

  Check that the entire ar_stat field is present in the capture.

  Note that parse_wcc_attr() is called after we've already checked whether
  the wcc_data is present.

  Check before fetching the "access" part of the NFSv3 ACCESS results.
  This fixes a buffer over-read discovered by Kamil Frankowicz.

  Include a test for the "check before fetching the "access" part..." fix,
  using the capture supplied by the reporter(s).
  f8a5350dfb546b1dc30c966b8b83d7341509fc34:CVE-2017-12898/NFS: Fix bounds checking.

  Fix the bounds checking for the NFSv3 WRITE procedure to check whether the
  length of the opaque data being written is present in the captured data,
  not just whether the byte count is present in the captured data.
  furthest forward in the packet, not the item before it.  (This also lets
  us eliminate the check for the "stable" argument being present in the
  captured data; rewrite the code to print that to make it a bit clearer.)

  Check that the entire ar_stat field is present in the capture.

  Note that parse_wcc_attr() is called after we've already checked whether
  the wcc_data is present.

  Check before fetching the "access" part of the NFSv3 ACCESS results.
  This fixes a buffer over-read discovered by Kamil Frankowicz.

  Include a test for the "check before fetching the "access" part..." fix,
  using the capture supplied by the reporter(s).
impacted_packages:
  - purl: pkg:github/the-tcpdump-group/tcpdump
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/the-tcpdump-group/tcpdump
        commit: '19d25dd8781620cd41bf178a5e2e27fc1cf242d0'
    introduced_in_commits: []
  - purl: pkg:github/the-tcpdump-group/tcpdump
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/the-tcpdump-group/tcpdump
        commit: f8a5350dfb546b1dc30c966b8b83d7341509fc34
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/the-tcpdump-group/tcpdump/tree/19d25dd8781620cd41bf178a5e2e27fc1cf242d0
    reference_type: commit
    reference_id: '19d25dd8781620cd41bf178a5e2e27fc1cf242d0'
  - url: https://github.com/the-tcpdump-group/tcpdump/tree/f8a5350dfb546b1dc30c966b8b83d7341509fc34
    reference_type: commit
    reference_id: f8a5350dfb546b1dc30c966b8b83d7341509fc34
