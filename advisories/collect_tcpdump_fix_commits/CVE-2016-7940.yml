advisory_id: CVE-2016-7940
datasource_id: collect_tcpdump_fix_commits/CVE-2016-7940
datasource_url: https://github.com/the-tcpdump-group/tcpdump
aliases: []
summary: |
  968776fbf5cd65c7ea2168912bd9f4379727eb11:CVE-2016-7940/Add a bunch of bounds checks, and fix some printing.

  The bounds checks fix some heap overflows found with American Fuzzy Lop
  by Hanno BÃ¶ck.

  Add some ND_TTEST_/ND_TCHECK_ macros to extract.h to simplify writing
  bounds checks for code that uses the other macros in that file.

  Fix the printing of the SPB BPDU agreement digest - I don't think the
  intent was to print the value of the first 4 bytes, that value + 4, that
  value + 8, etc., I suspect it was to print the first 4 bytes, the next 4
  bytes, etc..
impacted_packages:
  - purl: pkg:github/the-tcpdump-group/tcpdump
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/the-tcpdump-group/tcpdump
        commit: 968776fbf5cd65c7ea2168912bd9f4379727eb11
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/the-tcpdump-group/tcpdump/tree/968776fbf5cd65c7ea2168912bd9f4379727eb11
    reference_type: commit
    reference_id: 968776fbf5cd65c7ea2168912bd9f4379727eb11
