advisory_id: CVE-2017-13052
datasource_id: collect_tcpdump_fix_commits/CVE-2017-13052
datasource_url: https://github.com/the-tcpdump-group/tcpdump
aliases: []
summary: |
  5d340a5ca6e420a70297cdbdf777333f18bfdab7:CVE-2017-13052/CFM: refine decoding of the Sender ID TLV

  In cfm_network_addr_print() add a length argument and use it to validate
  the input buffer.

  In cfm_print() add a length check for MAC address chassis ID. Supply
  cfm_network_addr_print() with the length of its buffer and a correct
  pointer to the buffer (it was off-by-one before). Change some error
  handling blocks to skip to the next TLV in the current PDU rather than to
  stop decoding the PDU. Print the management domain and address contents,
  although in hex only so far.

  Add some comments to clarify the code flow and to tell exact sections in
  IEEE standard documents. Add new error messages and make some existing
  messages more specific.

  This fixes a buffer over-read discovered by Bhargava Shastry,
  SecT/TU Berlin.

  Add a test using the capture file supplied by the reporter(s).
  7a7f71ee3f77b8ac08f2f4f7747ce8b8fa5b91f9:CVE-2017-13052/CFM: refine decoding of the Sender ID TLV

  In cfm_network_addr_print() add a length argument and use it to validate
  the input buffer.

  In cfm_print() add a length check for MAC address chassis ID. Supply
  cfm_network_addr_print() with the length of its buffer and a correct
  pointer to the buffer (it was off-by-one before). Change some error
  handling blocks to skip to the next TLV in the current PDU rather than to
  stop decoding the PDU. Print the management domain and address contents,
  although in hex only so far.

  Add some comments to clarify the code flow and to tell exact sections in
  IEEE standard documents. Add new error messages and make some existing
  messages more specific.

  This fixes a buffer over-read discovered by Bhargava Shastry,
  SecT/TU Berlin.

  Add a test using the capture file supplied by the reporter(s).
impacted_packages:
  - purl: pkg:github/the-tcpdump-group/tcpdump
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/the-tcpdump-group/tcpdump
        commit: 7a7f71ee3f77b8ac08f2f4f7747ce8b8fa5b91f9
    introduced_in_commits: []
  - purl: pkg:github/the-tcpdump-group/tcpdump
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/the-tcpdump-group/tcpdump
        commit: 5d340a5ca6e420a70297cdbdf777333f18bfdab7
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/the-tcpdump-group/tcpdump/tree/5d340a5ca6e420a70297cdbdf777333f18bfdab7
    reference_type: commit
    reference_id: 5d340a5ca6e420a70297cdbdf777333f18bfdab7
  - url: https://github.com/the-tcpdump-group/tcpdump/tree/7a7f71ee3f77b8ac08f2f4f7747ce8b8fa5b91f9
    reference_type: commit
    reference_id: 7a7f71ee3f77b8ac08f2f4f7747ce8b8fa5b91f9
