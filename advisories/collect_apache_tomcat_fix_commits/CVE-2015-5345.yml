advisory_id: CVE-2015-5345
datasource_id: collect_apache_tomcat_fix_commits/CVE-2015-5345
datasource_url: https://github.com/apache/tomcat
aliases: []
summary: |
  127d8ea86d245846f0472865f0eb1eb111955e71:Additional fix for BZ 58660
  When Mapper root redirect is enabled, ensure '/' is added to path for redirect
  This is part 3 of 3 of the fix for CVE-2015-5345

  git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1716894 13f79535-47bb-0310-9956-ffa450edef68
  66daa4adc14b3e939659879153c0a579fdfcb099:Fix https://bz.apache.org/bugzilla/show_bug.cgi?id=58660
  With mapperContextRootRedirectEnabled ste to false, the redirect needs to be handled elsewhere.
  - Ensure the Mapper does not add the '/'
  - Handle the redirect in the DefaultServlet
  - Add a redirect to FORM auth if auth is occurring at the context root else the login page could be submitted to the wrong web application
  This is part 2 of 3 of the fix for CVE-2015-5345

  git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1716882 13f79535-47bb-0310-9956-ffa450edef68
  8437193708e4bf6b2861a7953dc472f9dad49111:Move the functionality that provides redirects for context roots and directories where a trailing <code>/</code> is added from the Mapper to the DefaultServlet. This enables such requests to be processed by any configured Valves and Filters before the redirect is made. This behaviour is configurable via the mapperContextRootRedirectEnabled and mapperDirectoryRedirectEnabled attributes of the Context which may be used to restore the previous behaviour.
  This is part 1 of 3 of the fix for CVE-2015-5345

  git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1715206 13f79535-47bb-0310-9956-ffa450edef68
impacted_packages:
  - purl: pkg:github/apache/tomcat
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/apache/tomcat
        commit: 8437193708e4bf6b2861a7953dc472f9dad49111
    introduced_in_commits: []
  - purl: pkg:github/apache/tomcat
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/apache/tomcat
        commit: 66daa4adc14b3e939659879153c0a579fdfcb099
    introduced_in_commits: []
  - purl: pkg:github/apache/tomcat
    affected_versions:
    fixed_versions:
    fixed_in_commits:
      - vcs_url: https://github.com/apache/tomcat
        commit: 127d8ea86d245846f0472865f0eb1eb111955e71
    introduced_in_commits: []
severities: []
weaknesses: []
references:
  - url: https://github.com/apache/tomcat/tree/127d8ea86d245846f0472865f0eb1eb111955e71
    reference_type: commit
    reference_id: 127d8ea86d245846f0472865f0eb1eb111955e71
  - url: https://github.com/apache/tomcat/tree/66daa4adc14b3e939659879153c0a579fdfcb099
    reference_type: commit
    reference_id: 66daa4adc14b3e939659879153c0a579fdfcb099
  - url: https://github.com/apache/tomcat/tree/8437193708e4bf6b2861a7953dc472f9dad49111
    reference_type: commit
    reference_id: 8437193708e4bf6b2861a7953dc472f9dad49111
